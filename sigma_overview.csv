"Title","Author","Description","Tags","Category","Product","Service","How To Investigate","Known False Positives","Query"
"Azure Subscription Permission Elevation Via ActivityLogs","Austin Songer @austinsonger","Detects when a user has been elevated to manage all Azure Subscriptions.
This change should be investigated immediately if it isn't planned.
This setting could allow an attacker access to Azure subscriptions in your environment.
","attack.initial_access, attack.t1078.004","Not classified","azure","activitylogs","Check with the system administrator or relevant team if the elevation of permissions was planned. 
Review change management records to verify if the elevation was part of an approved change. 
Correlate with other security events to determine if there are any indicators of compromise associated with the permission elevation. 
Investigate the user account that performed the elevation for any signs of compromise or unauthorized access.","Legitimate elevation of permissions by authorized personnel. 
Scheduled maintenance activities. 
Changes made by a trusted automated process.","operationName=""MICROSOFT.AUTHORIZATION/ELEVATEACCESS/ACTION"""
"Account Created And Deleted Within A Close Time Frame","Mark Morowczynski '@markmorow', MikeDuddington, '@dudders1', Tim Shelton","Detects when an account was created and deleted in a short period of time.","attack.defense_evasion, attack.t1078","Not classified","azure","auditlogs","Check if the account creation and deletion were part of a scheduled or documented process 
Review the account creation and deletion timestamps to determine the time frame between the two events 
Correlate the account creation and deletion events with additional logs or data sources to identify any suspicious activities 
Investigate the user accounts involved in the creation and deletion for any signs of compromise or unauthorized access","Legitimate account provisioning and deprovisioning processes 
Automated account creation and deletion scripts 
Testing or development environments where accounts are frequently created and deleted 
Third-party applications that manage user accounts","properties.message IN (""Add user"", ""Delete user"") Status=""Success"""
"Changes to Device Registration Policy","Michael Epping, '@mepples21'","Monitor and alert for changes to the device registration policy.","attack.defense_evasion, attack.privilege_escalation, attack.t1484","Not classified","azure","auditlogs","Review the details of the policy change event to determine the user or entity that initiated the change 
Cross-reference the timestamp of the policy change with authorized change management records 
Check if the policy change aligns with any ongoing IT projects or initiatives 
Investigate if the policy change was part of a known security configuration update","Legitimate changes to device registration policies by authorized administrators 
Changes made during scheduled maintenance windows 
Changes made by automated scripts or tools","Category=""Policy"" ActivityDisplayName=""Set device registration policies"""
"Users Added to Global or Device Admin Roles","Michael Epping, '@mepples21'","Monitor and alert for users added to device admin roles.","attack.defense_evasion, attack.privilege_escalation, attack.t1078.004","Not classified","azure","auditlogs","Review the user accounts that were added to the admin roles to determine if they are legitimate. 
Check if the role changes were performed by authorized personnel or automated processes. 
Correlate the timing of the role changes with any scheduled maintenance activities. 
Investigate if there are any known issues or bugs in the logging mechanism that could lead to false positives.","Legitimate role changes by authorized administrators. 
Automated role assignments by scripts or applications. 
Role changes during scheduled maintenance windows.","Category=""RoleManagement"" OperationName=""*Add*"" OperationName=""*member to role*"" TargetResources IN (""*7698a772-787b-4ac8-901f-60d6b08affd2*"", ""*62e90394-69f5-4237-9190-012177145e10*"")"
"Application AppID Uri Configuration Changes","Mark Morowczynski '@markmorow', Bailey Bercik '@baileybercik'","Detects when a configuration change is made to an applications AppID URI.","attack.persistence, attack.credential_access, attack.privilege_escalation, attack.t1552, attack.t1078.004","Not classified","azure","auditlogs","Review the audit logs for details of the user who made the configuration change. 
Check if the change aligns with any scheduled maintenance activities. 
Verify if the change was authorized by cross-referencing with change management records. 
Investigate if the change was part of a known service principal update process.","Planned changes to AppID URI configurations by authorized administrators. 
Routine updates to service principals that involve AppID URI modifications. 
Changes made during scheduled maintenance windows.","properties.message IN (""Update Application"", ""Update Service principal"")"
"Added Credentials to Existing Application","Mark Morowczynski '@markmorow', Bailey Bercik '@baileybercik'","Detects when a new credential is added to an existing application. Any additional credentials added outside of expected processes could be a malicious actor using those credentials.","attack.t1098.001, attack.persistence","Not classified","azure","auditlogs","Review the timestamp of the credential addition to check if it aligns with known maintenance schedules 
Check if the added credential matches a pattern of automated updates from trusted systems 
Verify the user or system account responsible for the credential addition against authorized personnel or systems 
Correlate with other security events to determine if the credential addition is part of a larger attack pattern","Scheduled credential rotations 
Automated credential updates by trusted systems 
Manual updates by authorized personnel during maintenance windows","properties.message IN (""Update Application-Certificates and secrets management"", ""Update Service principal/Update Application"")"
"Delegated Permissions Granted For All Users","Bailey Bercik '@baileybercik', Mark Morowczynski '@markmorow'","Detects when highly privileged delegated permissions are granted on behalf of all users","attack.credential_access, attack.t1528","Not classified","azure","auditlogs","Review the details of the permission grant to understand the scope and impact 
Check if the permission was granted by authorized personnel 
Verify if the permission aligns with any documented change control processes 
Investigate if the permission grant was part of a scheduled maintenance activity","Legitimate delegation for specific business requirements 
Routine permissions granted during application setup 
Permissions granted by trusted administrators","properties.message=""Add delegated permission grant"""
"App Granted Microsoft Permissions","Bailey Bercik '@baileybercik', Mark Morowczynski '@markmorow'","Detects when an application is granted delegated or app role permissions for Microsoft Graph, Exchange, Sharepoint, or Azure AD","attack.credential_access, attack.t1528","Not classified","azure","auditlogs","Review the application documentation to confirm the necessity of the permissions 
Check with the application owners or developers for justification of the permissions 
Compare the permissions granted with the expected permissions for the application 
Monitor for any unusual or unexpected behavior after the permissions were granted","Regular permission changes for legitimate application updates 
Permissions granted by authorized administrators 
Permissions granted during initial application setup","properties.message IN (""Add delegated permission grant"", ""Add app role assignment to service principal"")"
"App Granted Privileged Delegated Or App Permissions","Bailey Bercik '@baileybercik', Mark Morowczynski '@markmorow'","Detects when administrator grants either application permissions (app roles) or highly privileged delegated permissions","attack.persistence, attack.privilege_escalation, attack.t1098.003","Not classified","azure","auditlogs","Review the details of the app role assignment or delegated permission change in the Azure audit logs 
Check if the permission change aligns with any scheduled maintenance or known operational activities 
Verify the authorization and justification provided for the permission change with the responsible personnel 
Investigate if there are any associated tickets or change management records for the permission change","Routine app permission changes during legitimate maintenance activities 
Temporary elevation of permissions for specific tasks 
Changes made by authorized personnel during troubleshooting","properties.message=""Add app role assignment to service principal"""
"Application URI Configuration Changes","Mark Morowczynski '@markmorow', Bailey Bercik '@baileybercik'","Detects when a configuration change is made to an applications URI.
URIs for domain names that no longer exist (dangling URIs), not using HTTPS, wildcards at the end of the domain, URIs that are no unique to that app, or URIs that point to domains you do not control should be investigated.
","attack.t1528, attack.t1078.004, attack.persistence, attack.credential_access, attack.privilege_escalation","Not classified","azure","auditlogs","Review the details of the URI configuration change in the Azure audit logs to understand the nature of the change. 
Check if the change was part of a planned maintenance window or authorized activity. 
Verify if the URI change aligns with any documented change management processes. 
Investigate if the URI change introduces any security risks or violates organizational policies.","Scheduled maintenance activities that involve URI changes. 
Automated scripts or tools that update URIs based on predefined rules. 
Changes made by authorized third-party vendors with proper documentation.","properties.message=""Update Application Sucess- Property Name AppAddress"""
"PIM Approvals And Deny Elevation","Mark Morowczynski '@markmorow', Yochana Henderson, '@Yochana-H'","Detects when a PIM elevation is approved or denied. Outside of normal operations should be investigated.","attack.privilege_escalation, attack.t1078.004","Not classified","azure","auditlogs","Review the user associated with the PIM elevation request. 
Check if the elevation was part of a scheduled or automated process. 
Verify if the PIM operation was initiated during a planned testing activity. 
Correlate with other security events to determine the context of the elevation.","Actual admin using PIM may trigger this rule. 
Scheduled or automated PIM elevation approvals. 
Testing scenarios involving PIM operations.","properties.message=""Request Approved/Denied"""
"PIM Alert Setting Changes To Disabled","Mark Morowczynski '@markmorow', Yochana Henderson, '@Yochana-H'","Detects when PIM alerts are set to disabled.","attack.persistence, attack.privilege_escalation, attack.t1078","Not classified","azure","auditlogs","Review the user account associated with the action to determine if it was performed by an authorized administrator. 
Check for any scheduled maintenance activities or change management records that coincide with the alert. 
Correlate the event with any ongoing security assessments or penetration tests to validate the change. 
Investigate if there are any documented procedures or approvals for disabling PIM alerts in the environment.","Administrator performing a legitimate change to disable PIM alerts. 
Scheduled maintenance tasks that require temporary disabling of PIM alerts. 
Changes made by authorized security personnel during security assessments.","properties.message=""Disable PIM Alert"""
"Changes To PIM Settings","Mark Morowczynski '@markmorow', Yochana Henderson, '@Yochana-H'","Detects when changes are made to PIM roles","attack.privilege_escalation, attack.persistence, attack.t1078.004","Not classified","azure","auditlogs","Check the user account associated with the PIM role change for any suspicious activity or unauthorized access 
Review the timestamp of the PIM role change to correlate with other security events or incidents 
Verify if the PIM role change was part of a planned change management process 
Cross-reference the PIM role change with ticketing or change management systems for approval records","Scheduled or automated PIM role changes 
Changes made by authorized personnel during maintenance windows 
Changes made by security operations teams during investigations","properties.message=""Update role setting in PIM"""
"User Added To Privilege Role","Mark Morowczynski '@markmorow', Yochana Henderson, '@Yochana-H'","Detects when a user is added to a privileged role.","attack.privilege_escalation, attack.defense_evasion, attack.t1078.004","Not classified","azure","auditlogs","Check if the user added to the privileged role matches any scheduled scripts or automation tools 
Review the activity of the administrator who performed the role assignment 
Verify if the user role change aligns with any recent organizational changes or projects","Scheduled scripts or automation tools adding users to roles 
Bulk user role assignments by administrators 
User role changes due to organizational restructuring","properties.message IN (""Add eligible member (permanent)"", ""Add eligible member (eligible)"")"
"Bulk Deletion Changes To Privileged Account Permissions","Mark Morowczynski '@markmorow', Yochana Henderson, '@Yochana-H'","Detects when a user is removed from a privileged role. Bulk changes should be investigated.","attack.persistence, attack.t1098","Not classified","azure","auditlogs","Check if the user removal from the privileged role was part of a scheduled task or automation 
Verify if the user voluntarily left the role or if it was an authorized action 
Review logs from security tools or scripts that manage role assignments for any related activities 
Correlate the event with other security logs to determine the context of the user removal","Scheduled or automated processes that regularly remove users from roles 
User voluntarily leaving the privileged role 
Changes made by a security tool or script","properties.message IN (""Remove eligible member (permanent)"", ""Remove eligible member (eligible)"")"
"Azure Subscription Permission Elevation Via AuditLogs","Austin Songer @austinsonger","Detects when a user has been elevated to manage all Azure Subscriptions.
This change should be investigated immediately if it isn't planned.
This setting could allow an attacker access to Azure subscriptions in your environment.
","attack.initial_access, attack.t1078","Not classified","azure","auditlogs","Review the approval process for permission elevation within the organization. 
Check if the elevation was part of a planned change request. 
Verify if the user's role change aligns with any ongoing projects or incidents. 
Investigate if the elevation was performed by authorized personnel.","Scheduled elevation of permissions for maintenance tasks. 
Temporary elevation for specific project requirements. 
Elevation performed by a security team member during an incident response. 
Elevation as part of a documented change management process.","Category=""Administrative"" OperationName=""Assigns the caller to user access admin"""
"Temporary Access Pass Added To An Account","Mark Morowczynski '@markmorow', Yochana Henderson, '@Yochana-H'","Detects when a temporary access pass (TAP) is added to an account. TAPs added to priv accounts should be investigated","attack.persistence, attack.t1078.004","Not classified","azure","auditlogs","Review the details of the temporary access pass added to determine if it was expected or unauthorized 
Check if the temporary access pass addition aligns with any ongoing privileged account management activities 
Correlate the temporary access pass addition with other security events or alerts to identify any suspicious patterns 
Interview the administrator who added the temporary access pass to gather more context and justification","Scheduled scripts or automated processes adding temporary access passes 
Temporary access passes added during authorized maintenance activities 
Temporary access passes added by security tools or privileged access management solutions","properties.message=""Admin registered security info"" Status=""Admin registered temporary access pass method for user"""
"Discovery Using AzureHound","Janantha Marasinghe","Detects AzureHound (A BloodHound data collector for Microsoft Azure) activity via the default User-Agent that is used during its operation after successful authentication.","attack.discovery, attack.t1087.004, attack.t1526","Not classified","azure","signinlogs","Review Azure sign-in logs for entries with User-Agent containing 'azurehound' 
Check for successful authentications followed by AzureHound User-Agent activity 
Correlate AzureHound activity with other logs to determine the scope of the discovery 
Verify the source and destination of the AzureHound activity for any anomalies","Legitimate use of AzureHound by authorized personnel 
Custom User-Agent containing 'azurehound' string 
Third-party tools or scripts mimicking AzureHound behavior","userAgent=""*azurehound*"" ResultType=0"
"Suspicious SignIns From A Non Registered Device","Harjot Singh, '@cyb3rjy0t'","Detects risky authencaition from a non AD registered device without MFA being required.","attack.defense_evasion, attack.t1078","Not classified","azure","signinlogs","Check the Azure AD audit logs for additional information on the device in question. 
Verify if the user has been granted exceptions to use non-AD registered devices. 
Review network logs to identify any connectivity issues that may have impacted device registration. 
Conduct interviews with the user to confirm the legitimacy of the sign-in attempt.","Legitimate use of non-AD registered devices by authorized users. 
Temporary network issues causing device registration to fail. 
Misconfiguration in the Azure AD environment leading to false positives.","Status=""Success"" AuthenticationRequirement=""singleFactorAuthentication"" DeviceDetail.trusttype="""" RiskState=""atRisk"""
"Sign-ins from Non-Compliant Devices","Michael Epping, '@mepples21'","Monitor and alert for sign-ins where the device was non-compliant.","attack.defense_evasion, attack.t1078.004","Not classified","azure","signinlogs","Review the device compliance evaluation logs for the specific device 
Check for any recent changes in compliance policies or criteria 
Verify if the device was actually non-compliant by cross-referencing with other sources 
Investigate if there are any known issues with the compliance evaluation system","Temporary compliance issues causing false non-compliant status 
Misconfiguration in compliance evaluation settings 
Non-standard compliance criteria leading to false positives","DeviceDetail.isCompliant=""false"""
"Potential MFA Bypass Using Legacy Client Authentication","Harjot Singh, '@cyb3rjy0t'","Detects successful authentication from potential clients using legacy authentication via user agent strings. This could be a sign of MFA bypass using a password spray attack.","attack.initial_access, attack.credential_access, attack.t1078.004, attack.t1110","Not classified","azure","signinlogs","Review the user agent strings of the authentication events to identify the specific legacy clients 
Check if the authentication events are associated with known legacy accounts 
Investigate if there are legitimate reasons for the use of legacy authentication in the environment 
Correlate the authentication events with other security logs to determine the scope of potential MFA bypass","Service accounts using legacy authentication 
Specific applications requiring legacy authentication 
Third-party integrations with legacy support","Status=""Success"" userAgent IN (""*BAV2ROPC*"", ""*CBAinPROD*"", ""*CBAinTAR*"")"
"Sign-in Failure Due to Conditional Access Requirements Not Met","Yochana Henderson, '@Yochana-H'","Define a baseline threshold for failed sign-ins due to Conditional Access failures","attack.initial_access, attack.credential_access, attack.t1110, attack.t1078.004","Not classified","azure","signinlogs","Check the Conditional Access policies in Azure Active Directory for any recent changes or misconfigurations that could lead to false positives 
Review the sign-in logs for successful sign-ins to rule out intermittent issues with the Conditional Access policies 
Investigate if there are any ongoing vulnerability scans or misconfigurations on the systems that could trigger false positives","Service Account misconfigured 
Misconfigured Systems 
Vulnerability Scanners","ResultType=53003 Resultdescription=""Blocked by Conditional Access"""
"Use of Legacy Authentication Protocols","Yochana Henderson, '@Yochana-H'","Alert on when legacy authentication has been used on an account","attack.initial_access, attack.credential_access, attack.t1078.004, attack.t1110","Not classified","azure","signinlogs","Check if the user's account has been added to a group that allows legacy authentication 
Review the user's access rights and business justification for using legacy authentication 
Verify if there are any ongoing network or system issues that could lead to legacy authentication usage 
Investigate if the user is accessing a specific application or service that requires legacy authentication","User has a legitimate need to use legacy authentication due to specific business requirements 
User is accessing a legacy system that does not support modern authentication methods 
Temporary network issues causing fallback to legacy authentication mechanisms","ActivityDetails=""Sign-ins"" ClientApp IN (""Other client"", ""IMAP"", ""POP3"", ""MAPI"", ""SMTP"", ""Exchange ActiveSync"", ""Exchange Web Services"") Username=""UPN"""
"Auditing Configuration Changes on Linux Host","Mikhail Larin, oscd.community","Detect changes in auditd configuration files","attack.defense_evasion, attack.t1562.006","Not classified","linux","auditd","Review the logs for the specific file paths mentioned in the detection selection 
Correlate the changes with authorized change management records 
Check for any scheduled tasks or scripts that may have triggered the changes 
Verify if the changes were part of a planned security assessment or audit activity","Scheduled configuration management tools making changes 
Updates or patches applied to the auditd software 
Changes made by authorized personnel during security assessments","type=""PATH"" name IN (""/etc/audit/*"", ""/etc/libaudit.conf"", ""/etc/audisp/*"")"
"Binary Padding - Linux","Igor Fits, oscd.community","Adversaries may use binary padding to add junk data and change the on-disk representation of malware.
This rule detect using dd and truncate to add a junk data to file.
","attack.defense_evasion, attack.t1027.001","Not classified","linux","auditd","Review the command-line arguments of the processes that triggered the rule to determine the intent behind the binary padding 
Check for any legitimate reasons for using dd or truncate commands in the system logs or configuration management databases 
Correlate the events with system changes or software installations to rule out false positives 
Investigate the file in question to understand its purpose and whether the binary padding was malicious or benign","Legitimate use of dd or truncate commands for system maintenance or file operations 
Software installations that involve padding files 
Custom scripts or applications that utilize binary padding techniques 
Compression utilities that add padding to files","type=""EXECVE"" (""truncate"" ""-s"") OR (""dd"" ""if="" NOT ""of="")"
"BPFDoor Abnormal Process ID or Lock File Accessed","Rafal Piasecki","detects BPFDoor .lock and .pid files access in temporary file storage facility","attack.execution, attack.t1106, attack.t1059","Not classified","linux","auditd","Review the process accessing the .pid or .lock files for legitimacy 
Check if the file access is part of a known system operation or software behavior 
Correlate the file access with other security events to determine the context of the activity 
Investigate the parent-child process relationship to identify the origin of the file access","Legitimate software or scripts accessing similar files for normal operations 
Temporary files created by system processes 
File access related to authorized system monitoring tools","type=""PATH"" name IN (""/var/run/haldrund.pid"", ""/var/run/xinetd.lock"", ""/var/run/kdevrund.pid"")"
"Possible Coin Miner CPU Priority Param","Florian Roth (Nextron Systems)","Detects command line parameter very often used with coin miners","attack.privilege_escalation, attack.t1068","Not classified","linux","auditd","Review the process associated with the command line containing --cpu-priority 
Check the reputation of the process or application using the flag 
Correlate with other suspicious activities or indicators of compromise on the system 
Investigate the parent-child process relationship to understand the context of the flagged command","Legitimate applications that require CPU priority settings 
Development tools that utilize CPU priority flags 
Custom scripts or automation tasks with benign use of --cpu-priority 
System monitoring agents or tools that use --cpu-priority for legitimate purposes","a1=""--cpu-priority*"" OR a2=""--cpu-priority*"" OR a3=""--cpu-priority*"" OR a4=""--cpu-priority*"" OR a5=""--cpu-priority*"" OR a6=""--cpu-priority*"" OR a7=""--cpu-priority*"""
"Disable System Firewall","Pawel Mazur","Detects disabling of system firewalls which could be used by adversaries to bypass controls that limit usage of the network.","attack.t1562.004, attack.defense_evasion","Not classified","linux","auditd","Review audit logs for the specific service stop events 
Correlate with change management records to identify authorized changes 
Check for any related alerts or notifications from system monitoring tools 
Interview system administrators to understand the context of the firewall service stop","Scheduled maintenance tasks may stop the firewall service temporarily 
Firewall service restarts due to updates or configuration changes 
Legitimate administrative actions to troubleshoot firewall issues","type=""SERVICE_STOP"" unit IN (""firewalld"", ""iptables"", ""ufw"")"
"Credentials In Files - Linux","Igor Fits, oscd.community","Detecting attempts to extract passwords with grep","attack.credential_access, attack.t1552.001","Not classified","linux","auditd","Review the command-line arguments and context of the 'grep' command to determine if it was used maliciously 
Check if the 'grep' command was executed by a known script or tool in your environment 
Correlate the 'grep' command with other security events or logs to identify any suspicious patterns or activities 
Inspect the file or directory being searched by 'grep' for any unauthorized access or modifications","Legitimate use of grep to search for non-sensitive information containing the keyword 'password' 
Scripting or automation tools that use 'grep' and 'password' in a benign context 
Administrative tasks that involve searching for specific configurations or files containing the term 'password'","type=""EXECVE"" ""grep"" ""password"""
"Linux Keylogging with Pam.d","Pawel Mazur","Detect attempt to enable auditing of TTY input","attack.credential_access, attack.t1003, attack.t1056.001","Not classified","linux","auditd","Review the audit logs for changes to the specified PAM configuration files (/etc/pam.d/system-auth, /etc/pam.d/password-auth) 
Check for any TTY or USER_TTY events that indicate auditing of TTY input 
Correlate the events with any authorized administrative activities or system updates 
Verify if the changes were made as part of a security policy or monitoring requirement","Legitimate administrative changes to PAM configuration files 
System updates or software installations that modify PAM configurations 
User-initiated changes to enable auditing for legitimate monitoring purposes","(type=""PATH"" name IN (""/etc/pam.d/system-auth"", ""/etc/pam.d/password-auth"")) OR type IN (""TTY"", ""USER_TTY"")"
"Modification of ld.so.preload","E.M. Anhaus (originally from Atomic Blue Detections, Tony Lambert), oscd.community","Identifies modification of ld.so.preload for shared object injection. This technique is used by attackers to load arbitrary code into processes.","attack.defense_evasion, attack.t1574.006","Not classified","linux","auditd","Review the process that modified ld.so.preload to determine if it was a known and legitimate process. 
Check for any related logs or events that provide context around the modification of ld.so.preload. 
Compare the contents of ld.so.preload before and after the modification to identify any suspicious changes. 
Investigate the user account associated with the modification of ld.so.preload for any signs of unauthorized access.","Legitimate software installations or updates may modify ld.so.preload. 
System administrators may modify ld.so.preload for legitimate reasons. 
Certain security tools or scripts may also modify ld.so.preload. 
Upgrades or patches to the operating system may result in changes to ld.so.preload.","type=""PATH"" name=""/etc/ld.so.preload"""
"Loading of Kernel Module via Insmod","Pawel Mazur","Detects loading of kernel modules with insmod command.
Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand.
Adversaries may use LKMs to obtain persistence within the system or elevate the privileges.
","attack.persistence, attack.privilege_escalation, attack.t1547.006","Not classified","linux","auditd","Review the command-line arguments passed to insmod to identify the kernel module being loaded. 
Check if the loading of the kernel module aligns with any scheduled system updates or installations. 
Correlate the insmod activity with other security events or logs to determine if it is part of a larger attack. 
Verify the digital signature or checksum of the kernel module to determine its legitimacy.","Legitimate use of insmod to load kernel modules during system updates or software installations. 
Legitimate use of insmod by system administrators for authorized purposes. 
Legitimate use of insmod by security tools or monitoring agents. 
False positive due to misconfiguration or benign activity.","type=""SYSCALL"" comm=""insmod"" exe=""/usr/bin/kmod"""
"Logging Configuration Changes on Linux Host","Mikhail Larin, oscd.community","Detect changes of syslog daemons configuration files","attack.defense_evasion, attack.t1562.006","Not classified","linux","auditd","Review audit logs for the specific paths mentioned in the rule 
Check for any correlation with authorized change management tickets or requests 
Verify if the changes were part of a scheduled maintenance window 
Cross-reference with system administrator activity logs","Scheduled system updates that involve configuration changes 
Automated configuration management tools making changes 
Changes made by authorized system administrators","type=""PATH"" name IN (""/etc/syslog.conf"", ""/etc/rsyslog.conf"", ""/etc/syslog-ng/syslog-ng.conf"")"
"OMIGOD SCX RunAsProvider ExecuteShellCommand - Auditd","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.
SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including Microsoft Operations Manager.
Microsoft Azure, and Microsoft Operations Management Suite.
","attack.privilege_escalation, attack.initial_access, attack.execution, attack.t1068, attack.t1190, attack.t1203","Not classified","linux","auditd","Review the command executed to determine if it aligns with legitimate use cases. 
Check for any scheduled tasks or scripts that may be triggering the detection. 
Correlate with system or application logs to understand the context of the command execution. 
Verify if the user or process executing the command is authorized to use SCX RunAsProvider Invoke_ExecuteShellCommand.","Scheduled legitimate tasks that involve the use of SCX RunAsProvider Invoke_ExecuteShellCommand. 
Administrative scripts or automation that leverage SCX RunAsProvider Invoke_ExecuteShellCommand. 
Known security tools or configurations that trigger the SCX RunAsProvider Invoke_ExecuteShellCommand for authorized purposes.","type=""SYSCALL"" syscall=""execve"" uid=0 cwd=""/var/opt/microsoft/scx/tmp"" comm=""sh"""
"Webshell Remote Command Execution","Ilyas Ochkov, Beyu Denis, oscd.community","Detects possible command execution by web application/web shell","attack.persistence, attack.t1505.003","Not classified","linux","auditd","Review the process command line arguments to determine the nature of the executed command 
Check for any legitimate reasons for web shell presence or activity 
Correlate with other security events to identify any signs of compromise 
Investigate the user context and permissions associated with the command execution","Admin activity may trigger the rule 
Legitimate use of web shells for authorized purposes 
Scheduled tasks or scripts running on the system 
Development or testing activities","type=""SYSCALL"" syscall=""execve"" key=""detect_execve_www"""
"DNS Query to External Service Interaction Domains","Florian Roth (Nextron Systems), Matt Kelly (list of domains)","Detects suspicious DNS queries to external service interaction domains often used for out-of-band interactions after successful RCE","attack.initial_access, attack.t1190, attack.reconnaissance, attack.t1595.002","dns","Not classified","Not classified","Review the context of the DNS query to understand the source and destination of the traffic 
Check if the DNS query is part of a known legitimate communication pattern within the environment 
Correlate the DNS query with other security events to determine if it is part of a larger attack campaign 
Investigate the reputation of the domains in the DNS query to assess their risk level","Legitimate use of services that happen to match the listed domains 
DNS queries from security tools or monitoring systems 
DNS queries to known benign services that may have similar domain patterns","query IN (""*.interact.sh*"", ""*.oast.pro*"", ""*.oast.live*"", ""*.oast.site*"", ""*.oast.online*"", ""*.oast.fun*"", ""*.oast.me*"", ""*.burpcollaborator.net*"", ""*.oastify.com*"", ""*.canarytokens.com*"", ""*.requestbin.net*"", ""*.dnslog.cn*"")"
"Cobalt Strike DNS Beaconing","Florian Roth (Nextron Systems)","Detects suspicious DNS queries known from Cobalt Strike beacons","attack.command_and_control, attack.t1071.004","dns","Not classified","Not classified","Review the context of the DNS query to determine if it is part of normal network traffic 
Check if the DNS query is triggered by a legitimate application or security tool 
Investigate the source of the DNS query to confirm if it is a false positive 
Correlate the DNS query with other security events to validate the potential threat","Legitimate use of subdomains that match the detection criteria 
DNS queries from legitimate security tools that mimic Cobalt Strike behavior 
DNS queries from development or testing environments that resemble Cobalt Strike patterns 
DNS queries from known benign applications that trigger the rule","query IN (""aaa.stage.*"", ""post.1*"") OR query=""*.stage.123456.*"""
"Monero Crypto Coin Mining Pool Lookup","Florian Roth (Nextron Systems)","Detects suspicious DNS queries to Monero mining pools","attack.impact, attack.t1496, attack.t1567","dns","Not classified","Not classified","Verify the legitimacy of the DNS queries by cross-referencing with authorized mining activities 
Check if the DNS queries are coming from known cryptocurrency mining software or tools 
Investigate the source IP address for any other suspicious activities or indicators of compromise 
Look for additional context in network traffic logs or endpoint logs to determine the intent behind the DNS queries","Legitimate crypto coin mining activities 
Legitimate use of Monero mining pools by authorized users 
DNS queries related to cryptocurrency trading platforms 
DNS queries related to blockchain technology research","query IN (""*pool.minexmr.com*"", ""*fr.minexmr.com*"", ""*de.minexmr.com*"", ""*sg.minexmr.com*"", ""*ca.minexmr.com*"", ""*us-west.minexmr.com*"", ""*pool.supportxmr.com*"", ""*mine.c3pool.com*"", ""*xmr-eu1.nanopool.org*"", ""*xmr-eu2.nanopool.org*"", ""*xmr-us-east1.nanopool.org*"", ""*xmr-us-west1.nanopool.org*"", ""*xmr-asia1.nanopool.org*"", ""*xmr-jp1.nanopool.org*"", ""*xmr-au1.nanopool.org*"", ""*xmr.2miners.com*"", ""*xmr.hashcity.org*"", ""*xmr.f2pool.com*"", ""*xmrpool.eu*"", ""*pool.hashvault.pro*"")"
"DNS TXT Answer with Possible Execution Strings","Markus Neis","Detects strings used in command execution in DNS TXT Answer","attack.command_and_control, attack.t1071.004","dns","Not classified","Not classified","Review the DNS logs for TXT records containing the specified strings 
Check if the DNS requests are coming from expected sources or if there are anomalies in the traffic 
Correlate with other security events to determine if there are any related suspicious activities 
Investigate the context in which the strings are used to determine if they are part of a legitimate operation","Legitimate use of these strings in DNS TXT records for benign purposes 
Use of these strings in a non-malicious context 
Misconfigurations or benign scripts that contain these strings 
Legitimate use of PowerShell commands in DNS TXT records","record_type=""TXT"" answer IN (""*IEX*"", ""*Invoke-Expression*"", ""*cmd.exe*"")"
"Wannacry Killswitch Domain","Mike Wade","Detects wannacry killswitch domain dns queries","attack.command_and_control, attack.t1071.001","dns","Not classified","Not classified","Review the context of the DNS query to determine if it is part of a legitimate testing activity 
Check if the DNS query is related to known security tools or research within the organization 
Correlate the DNS query with other network or endpoint logs to identify the source and intent 
Verify if the DNS query is triggered by security scanning or monitoring activities","Legitimate use of similar domain names for testing purposes 
DNS queries related to legitimate research or security tools 
Internal systems using similar naming conventions 
DNS queries from security scanners or monitoring tools","query IN (""ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.testing"", ""ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.test"", ""ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.com"", ""ayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf.com"", ""iuqssfsodp9ifjaposdfjhgosurijfaewrwergwea.com"")"
"Windows WebDAV User Agent","Florian Roth (Nextron Systems)","Detects WebDav DownloadCradle","attack.command_and_control, attack.t1071.001","proxy","Not classified","Not classified","Check if the user agent is associated with known administrative scripts 
Verify if the WebDAV activity is part of legitimate WebDAV administration 
Review the context of the WebDAV request to determine its purpose","Administrative scripts that download files from the Internet 
Administrative scripts that retrieve certain website contents 
Legitimate WebDAV administration","""c-useragent""=""Microsoft-WebDAV-MiniRedir/*"" ""cs-method""=""GET"""
"HackTool - BabyShark Agent Default URL Pattern","Florian Roth (Nextron Systems)","Detects Baby Shark C2 Framework default communication patterns","attack.command_and_control, attack.t1071.001","proxy","Not classified","Not classified","Review the content of the URLs containing 'momyshark?key=' for context 
Check if the traffic is expected and part of normal operations 
Correlate with network and endpoint logs to determine the source and destination of the traffic 
Investigate the systems involved for signs of compromise or misconfiguration","Legitimate traffic containing 'momyshark?key=' in URLs 
Non-malicious applications using similar communication patterns 
Internal tools or scripts that trigger the detection rule 
Misconfigured systems generating false positives","""c-uri""=""*momyshark?key=*"""
"HackTool - CobaltStrike Malleable Profile Patterns - Proxy","Markus Neis, Florian Roth (Nextron Systems)","Detects cobalt strike malleable profiles patterns (URI, User-Agents, Methods).","attack.defense_evasion, attack.command_and_control, attack.t1071.001","proxy","Not classified","Not classified","Verify the legitimacy of the user-agent, URI, and method in the detected pattern 
Check if the activity is part of authorized red teaming or penetration testing exercises 
Analyze the context of the traffic to determine if it aligns with typical Cobalt Strike behavior 
Cross-reference with endpoint logs or network traffic to identify the source and intent of the activity","Legitimate use of malleable profiles by authorized tools 
Customized legitimate user-agents or URIs that match the patterns 
Non-malicious activities mimicking Cobalt Strike patterns","(""c-useragent""=""Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"" ""cs-method""=""GET"" ""c-uri""=""/s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books"" ""cs-host""=""www.amazon.com"" ""cs-cookie""=""*=csm-hit=s-24KU11BB82RZSYGJ3BDK|1419899012996"") OR (""c-useragent""=""Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"" ""cs-method""=""POST"" ""c-uri""=""/N4215/adj/amzn.us.sr.aps"" ""cs-host""=""www.amazon.com"") OR ""c-useragent"" IN (""Mozilla/4.0 (compatible; MSIE 6.0;Windows NT 5.1)"", ""Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E )"", ""Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 5.2) Java/1.5.0_08"") OR ""c-useragent""=""*; MANM; MANM)"" OR (""c-uri""=""*/oscp/*"" ""cs-host""=""ocsp.verisign.com"") OR (""cs-method""=""GET"" ""c-uri""=""*?manifest=wac"" ""cs-host""=""onedrive.live.com"") NOT (""c-uri""=""http*"" ""c-uri""=""*://onedrive.live.com/*"")"
"HackTool - Empire UserAgent URI Combo","Florian Roth (Nextron Systems)","Detects user agent and URI paths used by empire agents","attack.defense_evasion, attack.command_and_control, attack.t1071.001","proxy","Not classified","Not classified","Check the server logs for additional context on the requests with the specified user agent and URI paths 
Correlate the detected activity with network traffic logs to identify the source of the requests 
Review the server configurations and known legitimate applications that may use the specified user agent and URIs 
Engage with the system or network administrators to understand any authorized tools or scripts that match the detection criteria","Internal security tools or scanners using the same user agent and URI paths 
Legitimate administrative tasks that match the defined criteria 
Custom applications or scripts mimicking the user agent and URI paths for legitimate purposes","""c-useragent""=""Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"" ""cs-uri"" IN (""/admin/get.php"", ""/news.php"", ""/login/process.php"") ""cs-method""=""POST"""
"PwnDrp Access","Florian Roth (Nextron Systems)","Detects downloads from PwnDrp web servers developed for red team testing and most likely also used for criminal activity","attack.command_and_control, attack.t1071.001, attack.t1102.001, attack.t1102.003","proxy","Not classified","Not classified","Check the ClientIP to determine if it belongs to an authorized red team member or a known researcher 
Analyze the c-useragent to identify if it matches common user agents used in red team exercises or research activities 
Investigate the c-uri to understand the context of the access to the /pwndrop/ directory 
Cross-reference the access with known misconfigurations in systems or applications that could lead to unintended access","Legitimate use of PwnDrp web servers for authorized red team exercises 
Access to /pwndrop/ directory for legitimate research purposes 
Access to /pwndrop/ due to misconfigured systems or applications","""c-uri""=""*/pwndrop/*"""
"Raw Paste Service Access","Florian Roth (Nextron Systems)","Detects direct access to raw pastes in different paste services often used by malware in their second stages to download malicious code in encrypted or encoded form","attack.command_and_control, attack.t1071.001, attack.t1102.001, attack.t1102.003, attack.defense_evasion","proxy","Not classified","Not classified","Review the user context and behavior associated with the access to raw paste links 
Check if the access to raw paste links aligns with known development or operational activities 
Correlate the raw paste access with other security events to determine the context of the access 
Investigate the content of the accessed raw paste to determine if it poses a security risk","Developers accessing raw paste links for legitimate purposes 
Automated scripts or tools accessing raw paste links for benign reasons 
Security researchers investigating malicious activities may trigger this rule 
Internal systems or services accessing raw paste links for valid reasons","""c-uri"" IN (""*.paste.ee/r/*"", ""*.pastebin.com/raw/*"", ""*.hastebin.com/raw/*"", ""*.ghostbin.co/paste/*/raw/*"", ""*pastetext.net/*"", ""*pastebin.pl/*"", ""*paste.ee/*"")"
"Flash Player Update from Suspicious Location","Florian Roth (Nextron Systems)","Detects a flashplayer update from an unofficial location","attack.initial_access, attack.t1189, attack.execution, attack.t1204.002, attack.defense_evasion, attack.t1036.005","proxy","Not classified","Not classified","Review the user agent of the request to identify the source of the download 
Check the referer header to see if the download was initiated from a suspicious website 
Inspect the destination IP address for reputation and known malicious activity 
Correlate with endpoint logs to determine if the downloaded file was executed","Legitimate use of non-standard flash download locations 
Internal testing or development environments 
Authorized third-party software distribution channels","""c-uri"" IN (""*/flash_install.php*"", ""*/install_flash_player.exe"") NOT ""cs-host""=""*.adobe.com"""
"APT User Agent","Florian Roth (Nextron Systems), Markus Neis","Detects suspicious user agent strings used in APT malware in proxy logs","attack.command_and_control, attack.t1071.001","proxy","Not classified","Not classified","Check the user agent string against known APT malware user agents 
Investigate the source IP address for any other suspicious activity 
Look for any unusual patterns in the URI or destination of the requests 
Correlate with other security events to determine the scope of potential compromise","Old browsers 
Legacy systems 
Custom user agents 
Non-malicious tools","""c-useragent"" IN (""SJZJ (compatible; MSIE 6.0; Win32)"", ""Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0"", ""User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC"", ""Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)"", ""webclient"", ""Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200"", ""Mozilla/4.0 (compatible; MSI 6.0;"", ""Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0"", ""Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/"", ""Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2"", ""Mozilla/4.0"", ""Netscape"", ""Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7"", ""Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Firefox/3.6.13 GTB7.1"", ""Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)"", ""Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NETCLR 2.0.50727)"", ""Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)"", ""Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)"", ""Mozilla/4.0 (compatible; MSIE 8.0; Win32)"", ""Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1"", ""Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)"", ""Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; InfoPath.1)"", ""Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko"", ""Mozilla v5.1 *"", ""MSIE 8.0"", ""Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)"", ""Mozilla/4.0 (compatible; RMS)"", ""Mozilla/4.0 (compatible; MSIE 6.0; DynGate)"", ""O/9.27 (W; U; Z)"", ""Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0;  Trident/5.0*"", ""Mozilla/5.0 (Windows NT 9; *"", ""hots scot"", ""Mozilla/5.0 (compatible; MSIE 10.0; Windows NT)"", ""Mozilla/5.0 (Windows NT 6.1; WOW64) Chrome/28.0.1500.95 Safari/537.36"", ""Mozilla/5.0 (Windows NT 6.2; Win32; rv:47.0)"", ""Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1;"", ""Mozilla/5.0 (X11; Linux i686; rv:22.0) Firefox/22.0"", ""Mozilla/5.0 Chrome/72.0.3626.109 Safari/537.36"", ""Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:FTS_06) Gecko/22.36.35.06 Firefox/2.0"", ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.63 Safari/537.36 Edg/100.0.1185.39"", ""Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; InfoPath.3; .NET4.0C; .NET4.0E)"", ""Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 10.0; .NET4.0C; .NET4.0E; Tablet PC 2.0)"", ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.246001"")"
"Bitsadmin to Uncommon IP Server Address","Florian Roth (Nextron Systems)","Detects Bitsadmin connections to IP addresses instead of FQDN names","attack.command_and_control, attack.t1071.001, attack.defense_evasion, attack.persistence, attack.t1197, attack.s0190","proxy","Not classified","Not classified","Check the context of the connection to determine if it is part of a known legitimate process or activity 
Review the destination IP address to see if it belongs to a trusted service or server 
Correlate the BITSadmin connection with other network or endpoint logs to look for additional suspicious behavior 
Investigate the user context to understand if the BITSadmin activity aligns with their typical behavior","Legitimate use of BITSadmin for downloading files from IP addresses due to specific network configurations 
BITSadmin used for legitimate software updates that involve IP addresses 
BITSadmin connections to IP addresses within a controlled environment for testing purposes","""c-useragent""=""Microsoft BITS/*"" ""cs-host"" IN (""*1"", ""*2"", ""*3"", ""*4"", ""*5"", ""*6"", ""*7"", ""*8"", ""*9"")"
"Crypto Miner User Agent","Florian Roth (Nextron Systems)","Detects suspicious user agent strings used by crypto miners in proxy logs","attack.command_and_control, attack.t1071.001","proxy","Not classified","Not classified","Check the reputation of the user agent string against threat intelligence feeds 
Correlate the user agent string with other suspicious activities from the same source IP 
Inspect the destination URI to see if it is related to cryptocurrency mining activities 
Verify the legitimacy of the user agent string by checking the software or application associated with it","Legitimate mining software may have similar user agent strings 
User agents can be easily spoofed by attackers 
Some legitimate applications may use similar user agent strings for other purposes","""c-useragent"" IN (""XMRig *"", ""ccminer*"")"
"Exploit Framework User Agent","Florian Roth (Nextron Systems)","Detects suspicious user agent strings used by exploit / pentest frameworks like Metasploit in proxy logs","attack.command_and_control, attack.t1071.001","proxy","Not classified","Not classified","Check if the user agent string is associated with known security tools or legitimate pentesting activities 
Correlate the user agent with the source IP address and URI to determine the context of the request 
Investigate the user agent string in the context of the specific proxy logs to understand the behavior 
Look for additional indicators of compromise or suspicious activities associated with the user agent","Legitimate use of Metasploit or other pentest frameworks within the environment 
Custom user agents that mimic exploit frameworks for legitimate purposes 
User agents used by security tools or scanners that may trigger the rule 
User agents modified by users for personal reasons that match the signatures","""c-useragent"" IN (""Internet Explorer *"", ""Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)"", ""Mozilla/4.0 (compatible; Metasploit RSPEC)"", ""Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)"", ""Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)"", ""Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)"", ""Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)"", ""Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/4.0; SIMBAR={7DB0F6DE-8DE7-4841-9084-28FA914B0F2E}; SLCC1; .N"", ""Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)"", ""Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/4.0.221.6 Safari/525.13"", ""Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MAAU)"", ""Mozilla/5.0"", ""Mozilla/4.0 (compatible; SPIPE/1.0"", ""Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0"", ""Sametime Community Agent"", ""X-FORWARDED-FOR"", ""DotDotPwn v2.1"", ""SIPDROID"", ""Mozilla/5.0 (Windows NT 10.0; Win32; x32; rv:60.0)"", ""Mozilla/6.0 (X11; Linux x86_64; rv:24.0) Gecko/20140205     Firefox/27.0 Iceweasel/25.3.0"", ""*wordpress hash grabber*"", ""*exploit*"")"
"Hack Tool User Agent","Florian Roth (Nextron Systems)","Detects suspicious user agent strings user by hack tools in proxy logs","attack.initial_access, attack.t1190, attack.credential_access, attack.t1110","proxy","Not classified","Not classified","Check if the detected user agent is associated with known security tools or legitimate software 
Correlate the user agent with other indicators of compromise to determine malicious intent 
Investigate the source IP address and URI to understand the context of the user agent string 
Look for patterns of behavior or additional suspicious activity from the same source","Legitimate security tools may have user agents that match the detection criteria 
Custom scripts or tools used by internal security teams may trigger this rule 
Some legitimate software may have similar user agent strings to hack tools 
User agents can be easily spoofed, leading to false positives","""c-useragent"" IN (""*(hydra)*"", ""* arachni/*"", ""* BFAC *"", ""* brutus *"", ""* cgichk *"", ""*core-project/1.0*"", ""* crimscanner/*"", ""*datacha0s*"", ""*dirbuster*"", ""*domino hunter*"", ""*dotdotpwn*"", ""*FHScan Core*"", ""*floodgate*"", ""*get-minimal*"", ""*gootkit auto-rooter scanner*"", ""*grendel-scan*"", ""* inspath *"", ""*internet ninja*"", ""*jaascois*"", ""* zmeu *"", ""*masscan*"", ""* metis *"", ""*morfeus fucking scanner*"", ""*n-stealth*"", ""*nsauditor*"", ""*pmafind*"", ""*security scan*"", ""*springenwerk*"", ""*teh forest lobster*"", ""*toata dragostea*"", ""* vega/*"", ""*voideye*"", ""*webshag*"", ""*webvulnscan*"", ""* whcc/*"", ""* Havij*"", ""*absinthe*"", ""*bsqlbf*"", ""*mysqloit*"", ""*pangolin*"", ""*sql power injector*"", ""*sqlmap*"", ""*sqlninja*"", ""*uil2pn*"", ""*ruler*"", ""*Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)*"")"
"Malware User Agent","Florian Roth (Nextron Systems), X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects suspicious user agent strings used by malware in proxy logs","attack.command_and_control, attack.t1071.001","proxy","Not classified","Not classified","Check the reputation of the user agent string against threat intelligence feeds 
Analyze the behavior associated with the user agent in the logs for any malicious activities 
Correlate the user agent with other indicators of compromise (IOCs) to determine the extent of the potential threat 
Investigate the source IP address and destination of the requests with suspicious user agents for additional context","Legitimate user agents that may have similar patterns to malware user agents 
User agents used by security tools or scanners 
Custom user agents set by legitimate applications 
User agents from popular browsers or common software","""c-useragent"" IN (""Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Chrome /53.0"", ""Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)"", ""Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)"", ""Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR  1.1.4322)"", ""HttpBrowser/1.0"", ""*<|>*"", ""nsis_inetc (mozilla)"", ""Wget/1.9+cvs-stable (Red Hat modified)"", ""Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)"", ""*zeroup*"", ""Mozilla/5.0 (Windows NT 5.1 ; v.*"", ""* adlib/*"", ""* tiny"", ""* BGroom *"", ""* changhuatong"", ""* CholTBAgent"", ""Mozilla/5.0 WinInet"", ""RookIE/1.0"", ""M"", ""Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)"", ""Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)"", ""backdoorbot"", ""Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30731)"", ""Opera/8.81 (Windows NT 6.0; U; en)"", ""Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30729)"", ""Opera"", ""Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)"", ""Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"", ""MSIE"", ""*(Charon; Inferno)"", ""Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)"", ""Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)"", ""Mozilla/4.0(compatible; MSIE 6.0; Windows NT 5.1)"", ""Mozilla/5.0 (Windows NT 10.0; Win64; x64)"", ""Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; Win64; x64)"", ""Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Win64; x64)"", ""Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; InfoPath.3)"", ""Mozilla/5.0 (Windows NT 6.1)"", ""AppleWebkit/587.38 (KHTML, like Gecko)"", ""Chrome/91.0.4472.77"", ""Safari/537.36"", ""Edge/91.0.864.37"", ""Firefox/89.0"", ""Gecko/20100101"", ""* pxyscand*"", ""* asd"", ""* mdms"", ""sample"", ""nocase"", ""Moxilla"", ""Win32 *"", ""*Microsoft Internet Explorer*"", ""agent *"", ""AutoIt"", ""IczelionDownLoad"", ""Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 10.0; .NET4.0C; .NET4.0E; Tablet PC 2.0)"", ""record"", ""mozzzzzzzzzzz"", ""Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0"", ""Havana/0.1"", ""antSword/v2.1"", ""rqwrwqrqwrqw"", ""qwrqrwrqwrqwr"", ""rc2.0/client"", ""TakeMyPainBack"", ""xxx"", ""20112211"", ""23591"", ""901785252112"", ""1235125521512"", ""125122112551"", ""B1D3N_RIM_MY_ASS"", ""AYAYAYAY1337"", ""iMightJustPayMySelfForAFeature"", ""ForAFeature"", ""Ares_ldr_v_*"", ""Microsoft Internet Explorer"", ""CLCTR"", ""uploader"", ""agent"", ""License"", ""vb wininet"", ""Client"", ""Lilith-Bot/3.0"", ""svc/1.0"", ""WSHRAT"", ""ZeroStresser Botnet/1.5"", ""OK"", ""Project1sqlite"", ""Project1"", ""DuckTales"", ""Zadanie"", ""GunnaWunnaBlueTips"", ""Xlmst"", ""GeekingToTheMoon"", ""SunShineMoonLight"", ""BunnyRequester"", ""BunnyTasks"", ""BunnyStealer"", ""BunnyLoader_Dropper"", ""BunnyLoader"", ""BunnyShell"", ""SPARK-COMMIT"", ""4B4DB4B3"", ""SouthSide"")"
"Suspicious User Agent","Florian Roth (Nextron Systems)","Detects suspicious malformed user agent strings in proxy logs","attack.command_and_control, attack.t1071.001","proxy","Not classified","Not classified","Review the proxy logs for entries matching the suspicious user agent patterns 
Correlate the user agent strings with other indicators of compromise (IOCs) or threat intelligence data 
Check if the user agents are associated with any known benign activity or legitimate services 
Investigate the source IP addresses and destinations associated with the suspicious user agents for further context","Legitimate user agents that may have similar patterns to the suspicious ones identified 
Internal tools or scripts that generate custom user agent strings 
User agents from known applications or services that are not malicious 
User agents from specific browser versions that may trigger the rule","""c-useragent"" IN (""user-agent*"", ""Mozilla/3.0 *"", ""Mozilla/2.0 *"", ""Mozilla/1.0 *"", ""Mozilla *"", "" Mozilla/*"", ""Mozila/*"", ""Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol*"") OR ""c-useragent"" IN (""* (compatible;MSIE *"", ""*.0;Windows NT *"", ""*loader*"") OR ""c-useragent"" IN (""_"", ""CertUtil URL Agent"", ""Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0)"", ""Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0"", ""HTTPS"", ""Erbium-UA-4ce7c27cb4be9d32e333bf032c88235a"", ""x"", ""xxx"") NOT (""c-useragent""=""Mozilla/3.0 * Acrobat *"" OR ""cs-host"" IN (""*.acrobat.com"", ""*.adobe.com"", ""*.adobe.io""))"
"Powerview Add-DomainObjectAcl DCSync AD Extend Right","Samir Bousseaden, Roberto Rodriguez @Cyb3rWard0g, oscd.community, Tim Shelton, Maxence Fossat","Backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\Add-DomainObjectAcl DCSync Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer","attack.persistence, attack.t1098","Not classified","windows","security","Verify the user SIDs within the value attribute of event 5136 to determine if they are legitimate 
Check for any recent changes to SACL settings on the domain objects 
Investigate any new Domain Controller computer accounts created around the time of the alert 
Review the permissions assigned to regular user accounts for any anomalies","New Domain Controller computer account may trigger false positive 
Regular user accounts with specific permissions may trigger false positive 
Changes to SACL settings may trigger false positive","source=""WinEventLog:Security"" EventCode=5136 AttributeLDAPDisplayName=""ntSecurityDescriptor"" AttributeValue IN (""*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*"", ""*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2*"", ""*89e95b76-444d-4c62-991a-0facbeda640c*"") NOT (ObjectClass IN (""dnsNode"", ""dnsZoneScope"", ""dnsZone""))"
"AD Privileged Users or Groups Reconnaissance","Samir Bousseaden","Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs","attack.discovery, attack.t1087.002","Not classified","windows","security","Review the details of the 4661 events to determine the source and target objects involved 
Check if the activity was performed during a maintenance window or a known authorized operation 
Correlate the event with other security logs to identify any suspicious patterns or anomalies 
Verify if the detected activity aligns with any scheduled tasks or legitimate administrative activities","Legitimate enumeration activities by authorized administrators 
Scheduled tasks or scripts that access privileged user or group information 
Replication or backup processes that trigger the detection rule 
Third-party applications or security tools that interact with privileged accounts","source=""WinEventLog:Security"" EventCode=4661 ObjectType IN (""SAM_USER"", ""SAM_GROUP"") ObjectName IN (""*-512"", ""*-502"", ""*-500"", ""*-505"", ""*-519"", ""*-520"", ""*-544"", ""*-551"", ""*-555"") OR ObjectName=""*admin*"" NOT SubjectUserName=""*$"""
"ADCS Certificate Template Configuration Vulnerability with Risky EKU","Orlinum , BlueDefenZer","Detects certificate creation with template allowing risk permission subject and risky EKU","attack.privilege_escalation, attack.credential_access","Not classified","windows","security","Check for any recent changes in certificate templates 
Review the permissions assigned to the certificate templates 
Investigate the source of the certificate creation request 
Look for any abnormal EKU values in the certificates","Administrator activity 
Proxy SSL certificate with subject modification 
Smart card enrollement","source=""WinEventLog:Security"" (EventCode=4898 TemplateContent IN (""*1.3.6.1.5.5.7.3.2*"", ""*1.3.6.1.5.2.3.4*"", ""*1.3.6.1.4.1.311.20.2.2*"", ""*2.5.29.37.0*"") TemplateContent=""*CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT*"") OR (EventCode=4899 NewTemplateContent IN (""*1.3.6.1.5.5.7.3.2*"", ""*1.3.6.1.5.2.3.4*"", ""*1.3.6.1.4.1.311.20.2.2*"", ""*2.5.29.37.0*"") NewTemplateContent=""*CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT*"")"
"AD Object WriteDAC Access","Roberto Rodriguez @Cyb3rWard0g","Detects WRITE_DAC access to a domain object","attack.defense_evasion, attack.t1222.001","Not classified","windows","security","Review the Event ID 4662 logs on the domain controller for WRITE_DAC access events 
Correlate the timestamp of the event with other security logs to identify any related suspicious activities 
Check if the WRITE_DAC access was performed by a privileged account or an unauthorized user 
Investigate the specific Object Type and Object Server to determine the target of the access","Legitimate changes made by authorized administrators may trigger this rule 
Third-party applications or scripts may also perform legitimate WRITE_DAC operations 
Replication or synchronization processes within the Active Directory environment may generate false positives","source=""WinEventLog:Security"" EventCode=4662 ObjectServer=""DS"" AccessMask=""0x40000"" ObjectType IN (""19195a5b-6da0-11d0-afd3-00c04fd930c9"", ""domainDNS"")"
"Active Directory Replication from Non Machine Account","Roberto Rodriguez @Cyb3rWard0g","Detects potential abuse of Active Directory Replication Service (ADRS) from a non machine account to request credentials.","attack.credential_access, attack.t1003.006","Not classified","windows","security","Check if the replication was part of a scheduled task or script execution 
Review the permissions and access rights of the accounts involved in the replication 
Verify if the replication was triggered by a known administrative action 
Investigate if the replication request was part of a legitimate system operation","Replication between specific legitimate accounts for administrative purposes 
Replication initiated by authorized scripts or services 
Replication for routine system maintenance tasks","source=""WinEventLog:Security"" EventCode=4662 AccessMask=""0x100"" Properties IN (""*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2*"", ""*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*"", ""*89e95b76-444d-4c62-991a-0facbeda640c*"") NOT (SubjectUserName IN (""*$"", ""MSOL_*""))"
"Enabled User Right in AD to Control User Objects","@neu5ron","Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.","attack.persistence, attack.t1098","Not classified","windows","security","Review the security event logs on the domain controller for Event ID 4704 
Check for any recent changes in Group Policy related to user rights assignments 
Analyze the PrivilegeList field in the event log to identify the user assigned the SeEnableDelegationPrivilege 
Correlate the event with other security events to determine the context of the privilege assignment","Legitimate assignment of the SeEnableDelegationPrivilege to specific administrative users for valid reasons 
Temporary assignment of the privilege for troubleshooting purposes 
Third-party applications or services that require the privilege for functionality","source=""WinEventLog:Security"" EventCode=4704 PrivilegeList=""*SeEnableDelegationPrivilege*"""
"Active Directory User Backdoors","@neu5ron","Detects scenarios where one can control another users or computers account without having to use their credentials.","attack.t1098, attack.persistence","Not classified","windows","security","Review the details of the EventID 4738 to understand the user account changes 
Check for empty or null values in the AllowedToDelegateTo field in EventID 5136 
Investigate EventID 5136 with AttributeLDAPDisplayName 'msDS-AllowedToDelegateTo' for potential unauthorized delegation 
Look for EventID 5136 with ObjectClass 'user' and AttributeLDAPDisplayName 'servicePrincipalName' for suspicious activity","Legitimate delegation scenarios where users are authorized to act on behalf of others 
Service accounts with valid delegation permissions 
Changes made by privileged administrators for legitimate purposes","source=""WinEventLog:Security"" (EventCode=4738 NOT (AllowedToDelegateTo IN ("""", ""-"") OR AllowedToDelegateTo!=*)) OR (EventCode=5136 AttributeLDAPDisplayName=""msDS-AllowedToDelegateTo"") OR (EventCode=5136 ObjectClass=""user"" AttributeLDAPDisplayName=""servicePrincipalName"") OR (EventCode=5136 AttributeLDAPDisplayName=""msDS-AllowedToActOnBehalfOfOtherIdentity"")"
"Weak Encryption Enabled and Kerberoast","@neu5ron","Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.","attack.defense_evasion, attack.t1562.001","Not classified","windows","security","Verify the context of the user account changes by checking with the user or administrator 
Review any recent software installations or updates that may have triggered the UAC value changes 
Cross-reference the UAC value changes with authorized change management records 
Investigate if there are any scheduled tasks or scripts that could have triggered the UAC value modifications","Legitimate changes to user account properties that involve UAC values 
Changes made by authorized administrators for specific purposes 
Changes related to legitimate software installations","source=""WinEventLog:Security"" EventCode=4738 (NewUacValue IN (""*8***"", ""*9***"", ""*A***"", ""*B***"", ""*C***"", ""*D***"", ""*E***"", ""*F***"") NOT (OldUacValue IN (""*8***"", ""*9***"", ""*A***"", ""*B***"", ""*C***"", ""*D***"", ""*E***"", ""*F***""))) OR (NewUacValue IN (""*1****"", ""*3****"", ""*5****"", ""*7****"", ""*9****"", ""*B****"", ""*D****"", ""*F****"") NOT (OldUacValue IN (""*1****"", ""*3****"", ""*5****"", ""*7****"", ""*9****"", ""*B****"", ""*D****"", ""*F****""))) OR (NewUacValue IN (""*8**"", ""*9**"", ""*A**"", ""*B**"", ""*C**"", ""*D**"", ""*E**"", ""*F**"") NOT (OldUacValue IN (""*8**"", ""*9**"", ""*A**"", ""*B**"", ""*C**"", ""*D**"", ""*E**"", ""*F**"")))"
"Hacktool Ruler","Florian Roth (Nextron Systems)","This events that are generated when using the hacktool Ruler by Sensepost","attack.discovery, attack.execution, attack.t1087, attack.t1114, attack.t1059, attack.t1550.002","Not classified","windows","security","Verify if the events are triggered by authorized security testing activities 
Check for any scheduled tasks or scripts named 'RULER' that could be causing the events 
Investigate if any other legitimate tools or utilities on the system could be generating similar events 
Correlate the RULER events with other security logs to determine the context and potential impact","Legitimate use of the Ruler tool by authorized personnel for security testing purposes 
Scheduled tasks or scripts named 'RULER' triggering the events 
Use of other legitimate tools or utilities that may have similar behavior to Ruler","source=""WinEventLog:Security"" (EventCode=4776 Workstation=""RULER"") OR (EventCode IN (4624, 4625) WorkstationName=""RULER"")"
"Security Eventlog Cleared","Florian Roth (Nextron Systems)","One of the Windows Eventlogs has been cleared. e.g. caused by ""wevtutil cl"" command execution","attack.defense_evasion, attack.t1070.001, car.2016-04-002","Not classified","windows","security","Check for scheduled tasks or scripts that clear event logs 
Review system logs for software updates that coincide with log clearance 
Interview system administrators to understand any recent troubleshooting activities","Scheduled maintenance tasks that involve clearing event logs 
Security software updates that require log clearance 
Legitimate troubleshooting actions by system administrators","source=""WinEventLog:Security"" (EventCode=517 Provider_Name=""Security"") OR (EventCode=1102 Provider_Name=""Microsoft-Windows-Eventlog"")"
"CobaltStrike Service Installations - Security","Florian Roth (Nextron Systems), Wojciech Lesicki","Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement","attack.execution, attack.privilege_escalation, attack.lateral_movement, attack.t1021.002, attack.t1543.003, attack.t1569.002","Not classified","windows","security","Review the command-line arguments and parameters used during the service installation 
Check the digital signature and publisher information of the installed service 
Analyze the parent process and the context in which the service installation occurred 
Correlate the service installation event with other security events or alerts for additional context","Legitimate administrative service installations that may contain similar keywords or patterns 
Installation of authorized tools or software that mimic malicious behavior 
Service installations related to legitimate security tools or monitoring agents","source=""WinEventLog:Security"" EventCode=4697 (ServiceFileName=""*ADMIN$*"" ServiceFileName=""*.exe*"") OR (ServiceFileName=""*%COMSPEC%*"" ServiceFileName=""*start*"" ServiceFileName=""*powershell*"") OR ServiceFileName=""*powershell -nop -w hidden -encodedcommand*"" OR ServiceFileName=""*SUVYIChOZXctT2JqZWN0IE5ldC5XZWJjbGllbnQpLkRvd25sb2FkU3RyaW5nKCdodHRwOi8vMTI3LjAuMC4xO*"" OR ServiceFileName=""*lFWCAoTmV3LU9iamVjdCBOZXQuV2ViY2xpZW50KS5Eb3dubG9hZFN0cmluZygnaHR0cDovLzEyNy4wLjAuMT*"" OR ServiceFileName=""*JRVggKE5ldy1PYmplY3QgTmV0LldlYmNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHA6Ly8xMjcuMC4wLjE6*"""
"DCOM InternetExplorer.Application Iertutil DLL Hijack - Security","Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR)","Detects a threat actor creating a file named `iertutil.dll` in the `C:\Program Files\Internet Explorer\` directory over the network for a DCOM InternetExplorer DLL Hijack scenario.","attack.lateral_movement, attack.t1021.002, attack.t1021.003","Not classified","windows","security","Verify the legitimacy of the file creation by checking the software installation or update history on the system. 
Interview system administrators or users to confirm if they performed any manual actions related to the iertutil.dll file. 
Check the logs of file transfer tools or backup software to see if they were responsible for creating the iertutil.dll file.","Legitimate software installation or update may create the iertutil.dll file in the specified directory. 
Manual actions by system administrators or legitimate users may trigger this detection. 
File transfer tools or backup software may also create the iertutil.dll file in the directory.","source=""WinEventLog:Security"" EventCode=5145 RelativeTargetName=""*\\Internet Explorer\\iertutil.dll"" NOT SubjectUserName=""*$"""
"Mimikatz DC Sync","Benjamin Delpy, Florian Roth (Nextron Systems), Scott Dermott, Sorina Ionescu","Detects Mimikatz DC sync security events","attack.credential_access, attack.s0002, attack.t1003.006","Not classified","windows","security","Review the process and tools used by the account triggering the event 
Check for legitimate scheduled tasks or scripts that may be causing the detection 
Investigate if any replication tools or services are running on the system 
Verify if any third-party applications have permissions to perform similar actions","Scheduled tasks or scripts legitimately accessing directory changes 
Replication tools or services that mimic DC sync behavior 
Third-party applications with legitimate reasons to perform similar actions","source=""WinEventLog:Security"" EventCode=4662 Properties IN (""*Replicating Directory Changes All*"", ""*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*"", ""*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2*"", ""*9923a32a-3607-11d2-b9be-0000f87a36b2*"", ""*89e95b76-444d-4c62-991a-0facbeda640c*"") AccessMask=""0x100"" NOT (SubjectDomainName=""Window Manager"" OR SubjectUserName IN (""NT AUT*"", ""MSOL_*"") OR SubjectUserName=""*$"")"
"Important Windows Event Auditing Disabled","Nasreddine Bencherchali (Nextron Systems)","Detects scenarios where system auditing for important events such as ""Process Creation"" or ""Logon"" events is disabled.","attack.defense_evasion, attack.t1562.002","Not classified","windows","security","Review system maintenance schedules to check for temporary auditing disablement 
Check for authorized administrator activity around the time of the event 
Verify if any third-party security software was recently installed or updated 
Review system update logs for any misconfigurations related to auditing","Temporary disabling of auditing for maintenance purposes 
Changes made by authorized administrators 
Third-party security software temporarily disabling auditing 
Misconfigurations during system updates","source=""WinEventLog:Security"" (EventCode=4719 SubcategoryGuid IN (""{0CCE9210-69AE-11D9-BED3-505054503030}"", ""{0CCE9211-69AE-11D9-BED3-505054503030}"", ""{0CCE9212-69AE-11D9-BED3-505054503030}"", ""{0CCE9215-69AE-11D9-BED3-505054503030}"", ""{0CCE921B-69AE-11D9-BED3-505054503030}"", ""{0CCE922B-69AE-11D9-BED3-505054503030}"", ""{0CCE922F-69AE-11D9-BED3-505054503030}"", ""{0CCE9230-69AE-11D9-BED3-505054503030}"", ""{0CCE9235-69AE-11D9-BED3-505054503030}"", ""{0CCE9236-69AE-11D9-BED3-505054503030}"", ""{0CCE9237-69AE-11D9-BED3-505054503030}"", ""{0CCE923F-69AE-11D9-BED3-505054503030}"", ""{0CCE9240-69AE-11D9-BED3-505054503030}"", ""{0CCE9242-69AE-11D9-BED3-505054503030}"") AuditPolicyChanges IN (""*%%8448*"", ""*%%8450*"")) OR (EventCode=4719 SubcategoryGuid=""{0CCE9217-69AE-11D9-BED3-505054503030}"" AuditPolicyChanges=""*%%8448*"")"
"ETW Logging Disabled In .NET Processes - Registry","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Potential adversaries stopping ETW providers recording loaded .NET assemblies.","attack.defense_evasion, attack.t1112, attack.t1562","Not classified","windows","security","Check for authorized changes to .NET framework configurations in the environment 
Review any legitimate changes to COMPlus configurations 
Verify if there are authorized changes to ETW configurations","Legitimate changes to .NET framework configurations 
Legitimate changes to COMPlus configurations 
Legitimate changes to ETW configurations","source=""WinEventLog:Security"" (EventCode=4657 ObjectName=""*\\SOFTWARE\\Microsoft\\.NETFramework"" ObjectValueName=""ETWEnabled"" NewValue=0) OR (EventCode=4657 ObjectName=""*\\Environment*"" ObjectValueName IN (""COMPlus_ETWEnabled"", ""COMPlus_ETWFlags"") NewValue=0)"
"DPAPI Domain Backup Key Extraction","Roberto Rodriguez @Cyb3rWard0g","Detects tools extracting LSA secret DPAPI domain backup key from Domain Controllers","attack.credential_access, attack.t1003.004","Not classified","windows","security","Review the EventID 4662 logs to understand the context of the access to the 'BCKUPKEY' object 
Check if there are any scheduled tasks or scripts running on the Domain Controller that involve the 'BCKUPKEY' object 
Verify if any authorized administrators have made changes to the 'BCKUPKEY' object recently 
Investigate if any security software or tools are known to access the 'BCKUPKEY' object and correlate with the detection","Legitimate backup operations that involve the 'BCKUPKEY' object 
Scheduled tasks or scripts that interact with the 'BCKUPKEY' object 
Changes made by authorized administrators to the 'BCKUPKEY' object 
Security software or tools that access the 'BCKUPKEY' object","source=""WinEventLog:Security"" EventCode=4662 ObjectType=""SecretObject"" AccessMask=""0x2"" ObjectName=""*BCKUPKEY*"""
"Persistence and Execution at Scale via GPO Scheduled Task","Samir Bousseaden","Detect lateral movement using GPO scheduled task, usually used to deploy ransomware at scale","attack.persistence, attack.lateral_movement, attack.t1053.005","Not classified","windows","security","Verify the source IP address and check if it is a legitimate system within the network 
Review the details of the scheduled task creation or modification to determine if it aligns with authorized activities 
Cross-reference the timestamp of the event with known maintenance schedules or software update cycles 
Investigate the processes or services that accessed the scheduled tasks folder to identify any benign activities","Legitimate changes to GPO scheduled tasks by authorized administrators may trigger this rule 
Scheduled legitimate software updates or installations may also match this detection logic 
Backup software or system processes accessing the scheduled tasks folder may generate false positives","source=""WinEventLog:Security"" EventCode=5145 ShareName=""\\\\\*\\SYSVOL"" RelativeTargetName=""*ScheduledTasks.xml"" Accesses IN (""*WriteData*"", ""*%%4417*"")"
"Hidden Local User Creation","Christian Burkard (Nextron Systems)","Detects the creation of a local hidden user account which should not happen for event ID 4720.","attack.persistence, attack.t1136.001","Not classified","windows","security","Check the system documentation or change management records for any planned creation of hidden local user accounts. 
Verify if the hidden local user account creation was triggered by a known system process or software installation. 
Review the event logs preceding and following the creation event to determine the context and potential reasons for the hidden user account creation. 
Cross-reference the creation of the hidden local user account with other security events or alerts to identify any correlated suspicious activities.","Legitimate creation of hidden local user accounts for specific system purposes. 
Creation of hidden local user accounts by authorized administrators for specific tasks. 
Creation of hidden local user accounts as part of legitimate software installations. 
Creation of hidden local user accounts during system maintenance activities.","source=""WinEventLog:Security"" EventCode=4720 TargetUserName=""*$"" NOT TargetUserName=""HomeGroupUser$"""
"HybridConnectionManager Service Installation","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Rule to detect the Hybrid Connection Manager service installation.","attack.persistence, attack.t1554","Not classified","windows","security","Check if the installation of Hybrid Connection Manager was part of a planned system change request. 
Verify if the installation was performed by authorized personnel. 
Review any documentation or change management records related to the Hybrid Connection Manager installation. 
Investigate the purpose of the Hybrid Connection Manager installation and its alignment with business requirements.","Legitimate use of Hybrid Connection Manager via Azure function apps. 
Installation of Hybrid Connection Manager as part of authorized system configuration. 
Upgrading Hybrid Connection Manager to a newer version by authorized personnel. 
Installation of Hybrid Connection Manager in a lab or testing environment.","source=""WinEventLog:Security"" EventCode=4697 ServiceName=""HybridConnectionManager"" ServiceFileName=""*HybridConnectionManager*"""
"Impacket PsExec Execution","Bhabesh Raj","Detects execution of Impacket's psexec.py.","attack.lateral_movement, attack.t1021.002","Not classified","windows","security","Check if the execution of Impacket's psexec.py was part of a scheduled or authorized task 
Review the content of the files accessed (e.g., 'RemCom_stdin', 'RemCom_stdout', 'RemCom_stderr') for any suspicious commands or data 
Correlate the event with other security logs to determine the context of the execution 
Investigate the source and destination systems involved in the event for any signs of compromise","Legitimate use of Impacket's psexec.py tool for authorized system administration tasks 
File shares with legitimate files named similarly to 'RemCom_stdin', 'RemCom_stdout', 'RemCom_stderr' 
Other tools or scripts that may have similar behavior to Impacket's psexec.py","source=""WinEventLog:Security"" EventCode=5145 ShareName=""\\\\\*\\IPC$"" RelativeTargetName IN (""*RemCom_stdin*"", ""*RemCom_stdout*"", ""*RemCom_stderr*"")"
"Possible Impacket SecretDump Remote Activity","Samir Bousseaden, wagga","Detect AD credential dumping using impacket secretdump HKTL","attack.credential_access, attack.t1003.002, attack.t1003.004, attack.t1003.003","Not classified","windows","security","Review the process and user context associated with the event 
Check if the activity is part of a scheduled task or known administrative operation 
Correlate with other security events to determine the scope of the activity 
Validate the presence of impacket tools or artifacts on the system","Legitimate administrative activities accessing the ADMIN$ share 
Backup or monitoring tools accessing SYSTEM32\ or .tmp files 
File transfers or legitimate software installations","source=""WinEventLog:Security"" EventCode=5145 ShareName=""\\\\\*\\ADMIN$"" RelativeTargetName=""*SYSTEM32\\*"" RelativeTargetName=""*.tmp*"""
"Invoke-Obfuscation CLIP+ Launcher - Security","Jonathan Cheong, oscd.community","Detects Obfuscated use of Clip.exe to execute PowerShell","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","Not classified","windows","security","Check the command line arguments of the process using Clip.exe 
Review any scheduled tasks or scripts that involve clipboard operations 
Investigate any administrative tools or scripts that interact with the clipboard 
Correlate with other security events to determine the context of the activity","Legitimate use of Clip.exe in combination with PowerShell commands 
Scheduled tasks or scripts that involve clipboard operations 
Administrative tools or scripts that interact with the clipboard","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName=""*cmd*"" ServiceFileName=""*&&*"" ServiceFileName=""*clipboard]::*"""
"Invoke-Obfuscation Obfuscated IEX Invocation - Security","Daniel Bohannon (@Mandiant/@FireEye), oscd.community","Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the code block linked in the references","attack.defense_evasion, attack.t1027","Not classified","windows","security","Review the process execution logs to understand the context of the PowerShell commands 
Check if the PowerShell commands are part of a legitimate security assessment or red team exercise 
Analyze the content of the obfuscated PowerShell code to determine its intent 
Correlate the PowerShell commands with other security events to identify any malicious behavior","Legitimate use of obfuscation techniques for security testing purposes 
Legitimate use of Invoke-Obfuscation framework by authorized red team members 
Legitimate use of similar obfuscation techniques in custom scripts 
Encoded commands used for benign purposes"
"Invoke-Obfuscation STDIN+ Launcher - Security","Jonathan Cheong, oscd.community","Detects Obfuscated use of stdin to execute PowerShell","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","Not classified","windows","security","Review the command-line arguments of the process to identify obfuscated PowerShell commands 
Check for any known administrative or security scripts that may be using obfuscation techniques 
Correlate with other security events to determine the context of the obfuscated PowerShell execution 
Investigate the source of the process and user context for any anomalies","Legitimate use of PowerShell with obfuscated code 
Administrative scripts using obfuscation techniques 
Security tools or scripts that utilize obfuscation for legitimate purposes","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName=""*cmd*"" ServiceFileName=""*powershell*"" ServiceFileName IN (""*${input}*"", ""*noexit*"") ServiceFileName IN (""* /c *"", ""* /r *"")"
"Invoke-Obfuscation VAR+ Launcher - Security","Jonathan Cheong, oscd.community","Detects Obfuscated use of Environment Variables to execute PowerShell","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","Not classified","windows","security","Review the full command line associated with the EventID 4697 to determine the context of the PowerShell execution 
Check for any whitelisted or known legitimate scripts or applications that may be using obfuscation techniques 
Correlate the event with other security events or logs to identify any related suspicious activities 
Investigate the user account associated with the event for any signs of compromise or unauthorized activity","Legitimate use of environment variables in PowerShell scripts 
Scheduled tasks or legitimate administrative scripts using similar techniques 
Third-party applications or tools that utilize obfuscation for legitimate purposes","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName=""*cmd*"" ServiceFileName=""*\""set*"" ServiceFileName=""*-f*"" ServiceFileName IN (""*/c*"", ""*/r*"")"
"Invoke-Obfuscation Via Stdin - Security","Nikita Nazarov, oscd.community","Detects Obfuscated Powershell via Stdin in Scripts","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","Not classified","windows","security","Review the context and purpose of the PowerShell script in question 
Check if the obfuscation is part of a known security tool or framework 
Analyze the behavior and actions performed by the script to determine intent 
Consult with the script author or relevant team to understand the obfuscation techniques used","Legitimate use of obfuscated PowerShell scripts for security testing purposes 
Use of legitimate tools that involve obfuscation techniques 
Scripts that are intentionally obfuscated for benign reasons","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName=""*set*"" ServiceFileName=""*&&*"" ServiceFileName IN (""*environment*"", ""*invoke*"", ""*${input)*"")"
"Invoke-Obfuscation Via Use Clip - Security","Nikita Nazarov, oscd.community","Detects Obfuscated Powershell via use Clip.exe in Scripts","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","Not classified","windows","security","Review the command line arguments of the Clip.exe process for suspicious or obfuscated PowerShell commands 
Check for any unusual or unauthorized scripts invoking Clip.exe 
Analyze the parent-child process relationship to identify the origin of the suspicious activity 
Correlate with network or endpoint logs to determine if any data exfiltration or lateral movement is associated with the detected activity","Legitimate use of Clip.exe in scripts 
Non-malicious obfuscation techniques 
Use of similar filenames or keywords in benign scripts","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName=""*(Clipboard|i*"""
"Invoke-Obfuscation Via Use MSHTA - Security","Nikita Nazarov, oscd.community","Detects Obfuscated Powershell via use MSHTA in Scripts","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","Not classified","windows","security","Review the command line arguments of the process invoking MSHTA 
Check the parent process of MSHTA for any suspicious activity 
Analyze the content of the script being executed by MSHTA 
Look for any network connections or file modifications initiated by the script","Legitimate use of MSHTA in scripts 
Updates or installations that involve MSHTA 
Scheduled tasks or system maintenance scripts","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName=""*mshta*"" ServiceFileName=""*vbscript:createobject*"" ServiceFileName=""*.run*"" ServiceFileName=""*window.close*"""
"Invoke-Obfuscation Via Use Rundll32 - Security","Nikita Nazarov, oscd.community","Detects Obfuscated Powershell via use Rundll32 in Scripts","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","Not classified","windows","security","Review the command line arguments passed to Rundll32 for suspicious or obfuscated PowerShell commands 
Check the reputation of the file paths and commands executed via Rundll32 
Correlate with other security events to determine the context of the Rundll32 execution 
Investigate the parent process that triggered the Rundll32 execution","Legitimate use of Rundll32 in scripts or applications 
Non-malicious use of PowerShell commands 
Updates or installations that involve Rundll32","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName=""*&&*"" ServiceFileName=""*rundll32*"" ServiceFileName=""*shell32.dll*"" ServiceFileName=""*shellexec_rundll*"" ServiceFileName IN (""*value*"", ""*invoke*"", ""*comspec*"", ""*iex*"")"
"Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - Security","Timur Zinniatullin, oscd.community","Detects Obfuscated Powershell via VAR++ LAUNCHER","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","Not classified","windows","security","Review the command executed to determine if it was part of a legitimate operation 
Check if the obfuscated PowerShell command is related to a known security tool or script 
Investigate the user account associated with the obfuscated command for any signs of compromise 
Analyze the context in which the obfuscated command was executed to understand its purpose","Legitimate use of obfuscation tools for security testing or development purposes 
Scheduled system tasks that involve obfuscated commands 
Legitimate software using obfuscation techniques for protection 
Custom scripts or applications designed to obfuscate commands for specific reasons","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName=""*&&set*"" ServiceFileName=""*cmd*"" ServiceFileName=""*/c*"" ServiceFileName=""*-f*"" ServiceFileName IN (""*{0}*"", ""*{1}*"", ""*{2}*"", ""*{3}*"", ""*{4}*"", ""*{5}*"")"
"First Time Seen Remote Named Pipe","Samir Bousseaden","This detection excludes known namped pipes accessible remotely and notify on newly observed ones, may help to detect lateral movement and remote exec using named pipes","attack.lateral_movement, attack.t1021.002","Not classified","windows","security","Review the processes or services associated with the named pipe to determine if they are legitimate 
Check if the named pipe activity aligns with expected behavior for the environment 
Correlate the named pipe activity with other security events to identify any suspicious patterns","Legitimate services or applications may access named pipes for normal operations 
Certain system processes may trigger false positives when accessing named pipes 
Third-party applications may also interact with named pipes, leading to false positives","source=""WinEventLog:Security"" EventCode=5145 ShareName=""\\\\\*\\IPC$"" NOT (RelativeTargetName IN (""atsvc"", ""samr"", ""lsarpc"", ""lsass"", ""winreg"", ""netlogon"", ""srvsvc"", ""protected_storage"", ""wkssvc"", ""browser"", ""netdfs"", ""svcctl"", ""spoolss"", ""ntsvcs"", ""LSM_API_service"", ""HydraLsPipe"", ""TermSrv_API_service"", ""MsFteWds"", ""sql\\query"", ""eventlog""))"
"Credential Dumping Tools Service Execution - Security","Florian Roth (Nextron Systems), Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community","Detects well-known credential dumping tools execution via service execution events","attack.credential_access, attack.execution, attack.t1003.001, attack.t1003.002, attack.t1003.004, attack.t1003.005, attack.t1003.006, attack.t1569.002, attack.s0005","Not classified","windows","security","Review the context of the service execution event to determine if it aligns with legitimate activities 
Check if the service execution is part of a scheduled task or maintenance activity 
Correlate the service execution event with other security events or logs to identify any suspicious patterns 
Investigate the user context and permissions associated with the service execution for anomalies","Legitimate Administrator performing authorized password recovery tasks 
Legitimate security software or tools that may trigger false positives 
Scheduled system maintenance tasks that involve service execution 
Known security tools that interact with system services","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName IN (""*cachedump*"", ""*dumpsvc*"", ""*fgexec*"", ""*gsecdump*"", ""*mimidrv*"", ""*pwdump*"", ""*servpw*"")"
"Malicious Service Installations","Florian Roth (Nextron Systems), Daniil Yugoslavskiy, oscd.community (update)","Detects known malicious service installs that only appear in cases of lateral movement, credential dumping, and other suspicious activities.","attack.persistence, attack.privilege_escalation, attack.t1003, car.2013-09-005, attack.t1543.003, attack.t1569.002","Not classified","windows","security","Review the service name and research if it is associated with any legitimate software or applications 
Check if the service installation is part of a known update or patch deployment 
Investigate the process that triggered the service installation for any signs of malicious activity 
Look for additional indicators of compromise on the affected system or related systems","Legitimate software installations that may use similar service names 
Updates or patches that install new services 
Custom in-house applications that create services with uncommon names","source=""WinEventLog:Security"" EventCode=4697 ServiceName=""javamtsup"""
"WCE wceaux.dll Access","Thomas Patzke","Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host","attack.credential_access, attack.t1003, attack.s0005","Not classified","windows","security","Review the process and user context associated with the access to wceaux.dll 
Check if the access to wceaux.dll is part of a known and authorized activity 
Correlate the event with other security logs to determine the full scope of the activity 
Investigate the source host for any signs of compromise or unauthorized access","Legitimate use of wceaux.dll by authorized system administrators 
Software installations or updates that involve wceaux.dll 
Legitimate security tools or monitoring systems accessing wceaux.dll","source=""WinEventLog:Security"" EventCode IN (4656, 4658, 4660, 4663) ObjectName=""*\\wceaux.dll"""
"Metasploit SMB Authentication","Chakib Gzenayi (@Chak092), Hosni Mribah","Alerts on Metasploit host's authentications on the domain.","attack.lateral_movement, attack.t1021.002","Not classified","windows","security","Verify if the source IP address is associated with authorized penetration testing activities. 
Check if there are scheduled security scans or legitimate activities that could trigger the rule. 
Investigate if there are known legitimate tools in use that might trigger similar alerts. 
Review system configurations for potential misconfigurations leading to false positives.","Legitimate use of Metasploit for authorized penetration testing. 
Scheduled security scans triggering the rule. 
Use of legitimate tools that mimic Metasploit behavior. 
Misconfigured systems generating false positives."
"Metasploit Or Impacket Service Installation Via SMB PsExec","Bartlomiej Czyz, Relativity","Detects usage of Metasploit SMB PsExec (exploit/windows/smb/psexec) and Impacket psexec.py by triggering on specific service installation","attack.lateral_movement, attack.t1021.002, attack.t1570, attack.execution, attack.t1569.002","Not classified","windows","security","Check the legitimacy of the service installation by reviewing change management records or tickets 
Verify if the service installation was part of a planned deployment or software update 
Analyze the behavior of the associated user account for any suspicious activities or anomalies 
Cross-reference the service name and file name with known legitimate services on the system","Legitimate installation of services with similar naming conventions 
Scheduled tasks or legitimate software installations may trigger similar events 
Custom scripts or automation tools that use service installations","source=""WinEventLog:Security"" EventCode=4697 ServiceStartType=3 ServiceType=""0x10"" NOT ServiceName=""PSEXESVC""\"
"Meterpreter or Cobalt Strike Getsystem Service Installation - Security","Teymur Kheirkhabarov, Ecco, Florian Roth (Nextron Systems)","Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation","attack.privilege_escalation, attack.t1134.001, attack.t1134.002","Not classified","windows","security","Review the service installation details to determine if it matches known legitimate software or system updates 
Check if the service installation was triggered by a scheduled task or script execution 
Correlate the service installation with other security events to identify any malicious behavior 
Verify the source and context of the service installation to confirm if it was performed by a system administrator","Legitimate software or system updates may trigger similar service installations 
Scripting or automation tools that perform legitimate actions may exhibit similar behavior 
Manual service installations by system administrators may trigger this detection","source=""WinEventLog:Security"" EventCode=4697 (ServiceFileName=""*/c*"" ServiceFileName=""*echo*"" ServiceFileName=""*\\pipe\\*"" ServiceFileName IN (""*cmd*"", ""*%COMSPEC%*"")) OR (ServiceFileName=""*rundll32*"" ServiceFileName=""*.dll,a*"" ServiceFileName=""*/p:*"") OR ServiceFileName=""\\\\127.0.0.1\\ADMIN$\\*"""
"NetNTLM Downgrade Attack","Florian Roth (Nextron Systems), wagga","Detects NetNTLM downgrade attack","attack.defense_evasion, attack.t1562.001, attack.t1112","Not classified","windows","security","Check if the changes to NTLM settings were authorized by reviewing change management records 
Correlate the event with other security logs to determine if the change was part of a larger attack 
Investigate the source of the change by analyzing the user account associated with the event 
Look for any additional suspicious activities on the system or network that may indicate a compromise","Legitimate changes to NTLM settings by administrators 
Software installations or updates that modify NTLM configurations 
Changes made by security tools or scripts that adjust NTLM settings","source=""WinEventLog:Security"" EventCode=4657 ObjectName=""*\\REGISTRY\\MACHINE\\SYSTEM*"" ObjectName=""*ControlSet*"" ObjectName=""*\\Control\\Lsa*"" ObjectValueName IN (""LmCompatibilityLevel"", ""NtlmMinClientSec"", ""RestrictSendingNTLMTraffic"")"
"Possible PetitPotam Coerce Authentication Attempt","Mauricio Velazco, Michael Haag","Detect PetitPotam coerced authentication activity.","attack.credential_access, attack.t1187","Not classified","windows","security","Review the ShareName and RelativeTargetName fields to determine the accessed resources. 
Correlate the EventID 5145 events with other security logs for additional context. 
Check if the ANONYMOUS LOGON access is part of a scheduled task or legitimate system activity. 
Investigate any recent changes in permissions or configurations related to the accessed shares.","Legitimate access by system services or applications using ANONYMOUS LOGON. 
Access to legitimate IPC$ shares by authorized users. 
Events triggered by administrative tasks or scripts. 
Misconfigurations leading to false positives.","source=""WinEventLog:Security"" EventCode=5145 ShareName=""\\\\*"" ShareName=""*\\IPC$"" RelativeTargetName=""lsarpc"" SubjectUserName=""ANONYMOUS LOGON"""
"PetitPotam Suspicious Kerberos TGT Request","Mauricio Velazco, Michael Haag","Detect suspicious Kerberos TGT requests.
Once an attacer obtains a computer certificate by abusing Active Directory Certificate Services in combination with PetitPotam, the next step would be to leverage the certificate for malicious purposes.
One way of doing this is to request a Kerberos Ticket Granting Ticket using a tool like Rubeus.
This request will generate a 4768 event with some unusual fields depending on the environment.
This analytic will require tuning, we recommend filtering Account_Name to the Domain Controller computer accounts.
","attack.credential_access, attack.t1187","Not classified","windows","security","Review the Account_Name field to ensure it corresponds to Domain Controller computer accounts. 
Check if the Kerberos TGT request is part of a scheduled task or script execution. 
Investigate the source of the Kerberos TGT request to determine if it is a known security tool or application. 
Analyze the context of the Kerberos TGT request to identify any unusual patterns or behaviors.","Legitimate use of certificates for authentication may trigger false positives. 
Scheduled tasks or scripts that involve Kerberos TGT requests may also trigger false positives. 
Certain security tools or applications that interact with Kerberos authentication may generate false positives.","source=""WinEventLog:Security"" EventCode=4768 TargetUserName=""*$"" CertThumbprint=""*"" NOT (IpAddress=""::1"" OR CertThumbprint="""")"
"PowerShell Scripts Installed as Services - Security","oscd.community, Natalia Shornikova","Detects powershell script installed as a Service","attack.execution, attack.t1569.002","Not classified","windows","security","Review the details of the Event ID 4697 in the Windows Security Event Log 
Check the service name and description to determine if it is a known legitimate service 
Investigate the parent process that installed the service for any suspicious activity 
Compare the service file path with a whitelist of approved PowerShell scripts","Legitimate use of PowerShell scripts installed as services by system administrators 
Installation of known and approved PowerShell services 
Third-party applications that use PowerShell scripts as services","source=""WinEventLog:Security"" EventCode=4697 ServiceFileName IN (""*powershell*"", ""*pwsh*"")"
"Protected Storage Service Access","Roberto Rodriguez @Cyb3rWard0g","Detects access to a protected_storage service over the network. Potential abuse of DPAPI to extract domain backup keys from Domain Controllers","attack.lateral_movement, attack.t1021.002","Not classified","windows","security","Review the EventID 5145 logs on the Windows Security event logs 
Correlate the access to protected_storage with user or application activity logs 
Check if the access to protected_storage aligns with any scheduled tasks or backup processes 
Verify the legitimacy of the access with the help of the IT or security team","Legitimate access to the protected storage service by authorized users or applications 
Access to protected storage service for legitimate administrative purposes 
Access to protected storage service as part of a scheduled backup process","source=""WinEventLog:Security"" EventCode=5145 ShareName=""*IPC*"" RelativeTargetName=""protected_storage"""
"RDP over Reverse SSH Tunnel WFP","Samir Bousseaden","Detects svchost hosting RDP termsvcs communicating with the loopback address","attack.defense_evasion, attack.command_and_control, attack.lateral_movement, attack.t1090.001, attack.t1090.002, attack.t1021.001, car.2013-07-002","Not classified","windows","security","Verify the process and purpose of the RDP connection to loopback address 
Check if the communication is part of a known and approved remote desktop session 
Review the application or service generating the RDP traffic for legitimacy 
Investigate if the communication is related to a specific security tool or monitoring agent","Legitimate remote desktop applications using loopback address for communication 
Legitimate services or applications using RDP for local connections 
Legitimate traffic involving AppContainer Loopback communication 
Legitimate applications ending with thor.exe or thor64.exe","source=""WinEventLog:Security"" EventCode=5156 (SourcePort=3389 DestAddress IN (""127.*"", ""::1"")) OR (DestPort=3389 SourceAddress IN (""127.*"", ""::1"")) NOT (FilterOrigin=""AppContainer Loopback"" OR Application IN (""*\\thor.exe"", ""*\\thor64.exe""))"
"Register new Logon Process by Rubeus","Roberto Rodriguez (source), Ilyas Ochkov (rule), oscd.community","Detects potential use of Rubeus via registered new trusted logon process","attack.lateral_movement, attack.privilege_escalation, attack.t1558.003","Not classified","windows","security","Review the context of the log entry to determine if the logon process is associated with legitimate activities 
Check if there are scheduled security assessments or red team exercises that involve the use of Rubeus 
Investigate the systems and applications to identify any custom logon processes that could trigger the rule 
Analyze the behavior of third-party tools or scripts that may interact with logon processes and correlate with the rule triggers","Legitimate use of Rubeus tool for authorized security testing or red teaming activities 
Custom logon processes used in the environment that may trigger the rule 
Misconfigured systems or applications that generate similar log entries 
Third-party tools or scripts that interact with logon processes","source=""WinEventLog:Security"" EventCode=4611 LogonProcessName=""User32LogonProcesss"""
"Remote PowerShell Sessions Network Connections (WinRM)","Roberto Rodriguez @Cyb3rWard0g","Detects basic PowerShell Remoting (WinRM) by monitoring for network inbound connections to ports 5985 OR 5986","attack.execution, attack.t1059.001","Not classified","windows","security","Review the source and destination IP addresses to determine if they are expected and authorized 
Check if the WinRM connection was initiated by a known system or user 
Correlate with authentication logs to verify the legitimacy of the WinRM session 
Investigate the process and command associated with the WinRM connection for any suspicious activity","Scheduled legitimate tasks using WinRM 
Administrative scripts using WinRM 
Third-party applications utilizing WinRM","source=""WinEventLog:Security"" EventCode=5156 DestPort IN (5985, 5986) LayerRTID=44"
"Replay Attack Detected","frack113","Detects possible Kerberos Replay Attack on the domain controllers when ""KRB_AP_ERR_REPEAT"" Kerberos response is sent to the client","attack.credential_access, attack.t1558","Not classified","windows","security","Review the network traffic logs to identify any anomalies or suspicious patterns related to Kerberos traffic 
Check for any misconfigurations in the Kerberos authentication setup that could lead to false positives 
Verify if there are any known issues with the domain controllers or network infrastructure that could cause legitimate retransmissions 
Cross-reference the timestamp of the detected event with other security logs to determine the scope and impact of the potential replay attack","Legitimate use of Kerberos authentication may sometimes trigger false positives 
Network issues causing retransmissions may lead to false positives 
Certain security tools or agents may interfere with Kerberos traffic and trigger false positives","source=""WinEventLog:Security"" EventCode=4649"
"SAM Registry Hive Handle Request","Roberto Rodriguez @Cyb3rWard0g","Detects handles requested to SAM registry hive","attack.discovery, attack.t1012, attack.credential_access, attack.t1552.002","Not classified","windows","security","Check if the access to the SAM registry hive was performed by authorized users or processes 
Review the process name and associated user to determine if it is expected behavior 
Correlate the event with other security events to identify any suspicious patterns 
Verify if the access to the SAM registry hive aligns with any known maintenance activities","Legitimate access to the SAM registry hive by system administrators 
Scheduled tasks or services accessing the SAM registry hive 
Backup or monitoring tools accessing the SAM registry hive","source=""WinEventLog:Security"" EventCode=4656 ObjectType=""Key"" ObjectName=""*\\SAM"""
"Service Installed By Unusual Client - Security","Tim Rauch (Nextron Systems), Elastic (idea)","Detects a service installed by a client which has PID 0 or whose parent has PID 0","attack.privilege_escalation, attack.t1543","Not classified","windows","security","Review the process tree to identify the parent process of the service installation 
Check if the service installation was triggered by a known system update or software installation 
Investigate the reputation and behavior of the client process that initiated the service installation 
Compare the service installation with known legitimate service installations on the system","Legitimate use of system tools or services that may have PID 0 
Legitimate installation of services by trusted system processes 
Known software that utilizes unusual process creation methods","source=""WinEventLog:Security"" EventCode=4697 ClientProcessId=0 OR ParentProcessId=0"
"SMB Create Remote File Admin Share","Jose Rodriguez (@Cyb3rPandaH), OTR (Open Threat Research)","Look for non-system accounts SMB accessing a file with write (0x2) access mask via administrative share (i.e C$).","attack.lateral_movement, attack.t1021.002","Not classified","windows","security","Verify the source and destination of the SMB connection 
Check if the access was part of a scheduled task or script 
Review the permissions and access controls on the file accessed 
Correlate with other security events to determine the context of the access","Legitimate administrative tasks performed by authorized users 
Backup software accessing files on administrative shares 
Scheduled tasks or scripts that write to administrative shares","source=""WinEventLog:Security"" EventCode=5145 ShareName=""*C$"" AccessMask=""0x2"" NOT SubjectUserName=""*$"""
"Win Susp Computer Name Containing Samtheadmin","elhoim","Detects suspicious computer name samtheadmin-{1..100}$ generated by hacktool","cve.2021.42278, cve.2021.42287, attack.persistence, attack.privilege_escalation, attack.t1078","Not classified","windows","security","Verify the context in which the 'SAMTHEADMIN' computer name is being used 
Check for any legitimate reasons for the presence of 'SAMTHEADMIN' in computer or user names 
Investigate the source of the computer name creation for any authorized or unauthorized activity","Legitimate use of 'SAMTHEADMIN' as part of a computer or user name 
Use of legitimate tools or scripts that create similar computer names 
Testing or development environments where such naming conventions are common","source=""WinEventLog:Security"" (SamAccountName=""SAMTHEADMIN-*"" SamAccountName=""*$"") OR (TargetUserName=""SAMTHEADMIN-*"" TargetUserName=""*$"")"
"Password Change on Directory Service Restore Mode (DSRM) Account","Thomas Patzke","The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.","attack.persistence, attack.t1098","Not classified","windows","security","Search for Event ID 4794 in the Windows Security event logs 
Look for the target account that was changed (DSRM account) 
Check the timestamp of the password change event 
Correlate with other security events to determine if the password change was part of a larger attack","Scheduled password changes for the DSRM account 
Legitimate password changes by authorized administrators 
Password changes during disaster recovery scenarios","source=""WinEventLog:Security"" EventCode=4794"
"Kerberos Manipulation","Florian Roth (Nextron Systems)","Detects failed Kerberos TGT issue operation. This can be a sign of manipulations of TGT messages by an attacker.","attack.credential_access, attack.t1212","Not classified","windows","security","Check for any recent changes in the environment that could have caused legitimate Kerberos failures 
Verify if there are known issues with legacy applications that could trigger false positives 
Review the context of the failed Kerberos TGT operations to determine if they are expected or suspicious 
Correlate with other security events to identify any potential attack patterns","Faulty legacy applications","source=""WinEventLog:Security"" EventCode IN (675, 4768, 4769, 4771) Status IN (""0x9"", ""0xA"", ""0xB"", ""0xF"", ""0x10"", ""0x11"", ""0x13"", ""0x14"", ""0x1A"", ""0x1F"", ""0x21"", ""0x22"", ""0x23"", ""0x24"", ""0x26"", ""0x27"", ""0x28"", ""0x29"", ""0x2C"", ""0x2D"", ""0x2E"", ""0x2F"", ""0x31"", ""0x32"", ""0x3E"", ""0x3F"", ""0x40"", ""0x41"", ""0x43"", ""0x44"")"
"Suspicious LDAP-Attributes Used","xknow @xknow_infosec","Detects the usage of particular AttributeLDAPDisplayNames, which are known for data exchange via LDAP by the tool LDAPFragger and are additionally not commonly used in companies.","attack.t1001.003, attack.command_and_control","Not classified","windows","security","Review LDAP attribute changes in the Windows security logs 
Check if there are legitimate reasons for the usage of the suspicious LDAP attributes 
Investigate the source and destination of LDAP traffic containing the mentioned attributes 
Analyze the behavior of the system or user account associated with the LDAP activity","Legitimate use of LDAP for specific business purposes 
Custom LDAP attribute configurations in the environment 
Third-party applications that require the mentioned LDAP attributes","source=""WinEventLog:Security"" EventCode=5136 AttributeValue=""*"" AttributeLDAPDisplayName IN (""primaryInternationalISDNNumber"", ""otherFacsimileTelephoneNumber"", ""primaryTelexNumber"")"
"Suspicious Windows ANONYMOUS LOGON Local Account Created","James Pemberton / @4A616D6573","Detects the creation of suspicious accounts similar to ANONYMOUS LOGON, such as using additional spaces. Created as an covering detection for exclusion of Logon Type 3 from ANONYMOUS LOGON accounts.","attack.persistence, attack.t1136.001, attack.t1136.002","Not classified","windows","security","Check the purpose of the account creation with the account owner or relevant team 
Review any documentation or change management records related to the account creation 
Analyze the account's activity and permissions to determine if it aligns with legitimate use cases 
Cross-reference the account creation with other security events or alerts for correlation","Legitimate creation of accounts with names containing ANONYMOUS or LOGON for specific purposes 
Creation of accounts with similar names due to misconfigurations 
Creation of accounts with ANONYMOUS or LOGON as part of a standard naming convention","source=""WinEventLog:Security"" EventCode=4720 SamAccountName=""*ANONYMOUS*"" SamAccountName=""*LOGON*"""
"Password Dumper Activity on LSASS","sigma","Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN","attack.credential_access, attack.t1003.001","Not classified","windows","security","Check if the process accessing LSASS is a known and legitimate application or tool 
Review scheduled tasks or scripts that interact with LSASS for authorized activities 
Verify if any security tools or antivirus scans coincide with the detection timeframe","Legitimate use of tools or applications that interact with LSASS process 
Scheduled tasks or scripts that access LSASS for valid reasons 
Antivirus or security tools performing scans on LSASS process","source=""WinEventLog:Security"" EventCode=4656 ProcessName=""*\\lsass.exe"" AccessMask=""0x705"" ObjectType=""SAM_DOMAIN"""
"Reconnaissance Activity","Florian Roth (Nextron Systems), Jack Croock (method), Jonhnathan Ribeiro (improvements), oscd.community","Detects activity as ""net user administrator /domain"" and ""net group domain admins /domain""","attack.discovery, attack.t1087.002, attack.t1069.002, attack.s0039","Not classified","windows","security","Review the context of the activity to determine if it aligns with scheduled tasks or known IT operations 
Check for any legitimate applications or scripts that may be responsible for the activity 
Correlate the activity with other security events to identify any suspicious patterns or anomalies 
Verify the source and intent of the activity with the system or network administrators","Scheduled administrative tasks that involve querying user or group information 
Legitimate IT operations that involve querying user or group information 
Third-party applications that interact with user or group information","source=""WinEventLog:Security"" EventCode=4661 AccessMask=""0x2d"" ObjectType IN (""SAM_USER"", ""SAM_GROUP"") ObjectName=""S-1-5-21-*"" ObjectName IN (""*-500"", ""*-512"")"
"Password Protected ZIP File Opened (Suspicious Filenames)","Florian Roth (Nextron Systems)","Detects the extraction of password protected ZIP archives with suspicious file names. See the filename variable for more details on which file has been opened.","attack.command_and_control, attack.defense_evasion, attack.t1027, attack.t1105, attack.t1036","Not classified","windows","security","Verify the user and system context when the event occurred 
Check if the file extraction was part of a routine operation or an anomaly 
Investigate the source and destination of the ZIP file 
Correlate with other security events to determine the overall risk level","Legitimate use of password-protected ZIP files for business purposes 
Archiving of sensitive information by authorized users 
Use of legitimate tools that involve extracting ZIP files with suspicious names","source=""WinEventLog:Security"" EventCode=5379 TargetName=""*Microsoft_Windows_Shell_ZipFolder:filename*"" TargetName IN (""*invoice*"", ""*new order*"", ""*rechnung*"", ""*factura*"", ""*delivery*"", ""*purchase*"", ""*order*"", ""*payment*"")"
"Password Protected ZIP File Opened (Email Attachment)","Florian Roth (Nextron Systems)","Detects the extraction of password protected ZIP archives. See the filename variable for more details on which file has been opened.","attack.defense_evasion, attack.initial_access, attack.t1027, attack.t1566.001","Not classified","windows","security","Check the user account associated with the extraction of the ZIP file 
Review the context of the extraction (e.g., email content, source) 
Correlate with other security events to determine if the action is part of a larger attack 
Inspect the contents of the ZIP file for any malicious payloads","Users extracting legitimate password-protected ZIP files 
Automated systems extracting password-protected ZIP files for updates 
Security tools scanning password-protected ZIP files for malware","source=""WinEventLog:Security"" EventCode=5379 TargetName=""*Microsoft_Windows_Shell_ZipFolder:filename*"" TargetName=""*\\Temporary Internet Files\\Content.Outlook*"""
"Suspicious Outbound Kerberos Connection - Security","Ilyas Ochkov, oscd.community","Detects suspicious outbound network activity via kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.","attack.lateral_movement, attack.t1558.003","Not classified","windows","security","Review the network traffic logs to identify the source and destination of the Kerberos connection 
Check for any legitimate services or applications that may be using Kerberos for communication 
Verify if there are any scheduled tasks or scripts triggering the Kerberos traffic 
Investigate if there are any proxy servers or security devices in the network that could be causing false positives","Legitimate use of Kerberos for authentication within the network 
Scheduled tasks or applications that use Kerberos for communication 
Proxy servers or security devices that may trigger false positives","source=""WinEventLog:Security"" EventCode=5156 DestPort=88 NOT (Application IN (""C:\\Windows\\System32\\lsass.exe"", ""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"", ""C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"", ""C:\\Program Files\\Mozilla Firefox\\firefox.exe"", ""C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe""))"
"Possible Shadow Credentials Added","Nasreddine Bencherchali (Nextron Systems), Elastic (idea)","Detects possible addition of shadow credentials to an active directory object.","attack.credential_access, attack.t1556","Not classified","windows","security","Review the details of the event to determine the source of the modification. 
Check if the modification aligns with any scheduled credential management tasks. 
Investigate the account associated with the modification to verify its legitimacy. 
Cross-reference the event with authorized changes in the environment.","Modifications in the msDS-KeyCredentialLink attribute by legitimate processes like Azure AD Connect synchronization account or ADFS service account. 
Changes made during authorized credential management operations. 
Scheduled tasks or scripts that involve updating credentials. 
Changes made during regular password resets.","source=""WinEventLog:Security"" EventCode=5136 AttributeLDAPDisplayName=""msDS-KeyCredentialLink"""
"Suspicious PsExec Execution","Samir Bousseaden","detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker uses a different psexec client other than sysinternal one","attack.lateral_movement, attack.t1021.002","Not classified","windows","security","Check if the PsExec execution was initiated by authorized system administrators 
Verify if the PsExec execution was part of a scheduled task or deployment script 
Investigate the purpose of the PsExec execution and validate its legitimacy 
Look for any additional context or logs that can provide insights into the PsExec activity","Legitimate use of PsExec for system administration purposes 
Use of legitimate tools that may trigger the rule 
Renaming of services for non-malicious reasons","source=""WinEventLog:Security"" EventCode=5145 ShareName=""\\\\\*\\IPC$"" RelativeTargetName IN (""*-stdin"", ""*-stdout"", ""*-stderr"") NOT RelativeTargetName=""PSEXESVC*"""
"Suspicious Scheduled Task Creation","Nasreddine Bencherchali (Nextron Systems)","Detects suspicious scheduled task creation events. Based on attributes such as paths, commands line flags, etc.","attack.execution, attack.privilege_escalation, attack.persistence, attack.t1053.005","Not classified","windows","security","Review the details of the scheduled task creation event in the Windows Security Event Log 
Check if the scheduled task creation aligns with any known maintenance or administrative activities 
Correlate the scheduled task creation event with other security events to determine if it is part of a larger attack campaign 
Investigate the ownership and origin of the scheduled task to identify any anomalies or suspicious actors","Legitimate scheduled task creation by system administrators or automated processes 
Scheduled tasks created by known software installations 
Scheduled tasks created as part of legitimate system maintenance activities","source=""WinEventLog:Security"" EventCode=4698 TaskContent IN (""*\\AppData\\Local\\Temp\\*"", ""*\\AppData\\Roaming\\*"", ""*\\Users\\Public\\*"", ""*\\WINDOWS\\Temp\\*"", ""*C:\\Temp\\*"", ""*\\Desktop\\*"", ""*\\Downloads\\*"", ""*\\Temporary Internet*"", ""*C:\\ProgramData\\*"", ""*C:\\Perflogs\\*"") TaskContent IN (""*regsvr32*"", ""*rundll32*"", ""*cmd.exe</Command>*"", ""*cmd</Command>*"", ""*<Arguments>/c *"", ""*<Arguments>/k *"", ""*<Arguments>/r *"", ""*powershell*"", ""*pwsh*"", ""*mshta*"", ""*wscript*"", ""*cscript*"", ""*certutil*"", ""*bitsadmin*"", ""*bash.exe*"", ""*bash *"", ""*scrcons*"", ""*wmic *"", ""*wmic.exe*"", ""*forfiles*"", ""*scriptrunner*"", ""*hh.exe*"")"
"Important Scheduled Task Deleted/Disabled","Nasreddine Bencherchali (Nextron Systems)","Detects when adversaries stop services or processes by deleting or disabling their respective scheduled tasks in order to conduct data destructive activities","attack.execution, attack.privilege_escalation, attack.persistence, attack.t1053.005","Not classified","windows","security","Review the context around the event to determine if it aligns with known maintenance activities 
Check for any automated system updates or software installations that may coincide with the task disablement 
Look for any logs or alerts indicating a system cleanup process that could explain the disabled scheduled task","Legitimate administrative actions may involve disabling scheduled tasks for maintenance purposes 
Automated system updates or software installations may temporarily disable scheduled tasks 
Scheduled tasks may be disabled as part of a system cleanup process","source=""WinEventLog:Security"" EventCode IN (4699, 4701) TaskName IN (""*\\Windows\\SystemRestore\\SR*"", ""*\\Windows\\Windows Defender\\*"", ""*\\Windows\\BitLocker*"", ""*\\Windows\\WindowsBackup\\*"", ""*\\Windows\\WindowsUpdate\\*"", ""*\\Windows\\UpdateOrchestrator\\Schedule*"", ""*\\Windows\\ExploitGuard*"") NOT (EventCode=4699 SubjectUserName=""*$"" TaskName=""*\\Windows\\Windows Defender\\*"")"
"Suspicious Scheduled Task Update","Nasreddine Bencherchali (Nextron Systems)","Detects update to a scheduled task event that contain suspicious keywords.","attack.execution, attack.privilege_escalation, attack.persistence, attack.t1053.005","Not classified","windows","security","Review the scheduled task update event in the Windows Security Event Log (Event ID 4702) 
Check if the update was initiated by a known system administrator account 
Analyze the command or script executed in the scheduled task update for legitimacy 
Correlate the scheduled task update with other security events for context","Legitimate updates to scheduled tasks by system administrators 
Updates triggered by legitimate software installations 
Scheduled task updates as part of regular system maintenance","source=""WinEventLog:Security"" EventCode=4702 TaskContentNew IN (""*\\AppData\\Local\\Temp\\*"", ""*\\AppData\\Roaming\\*"", ""*\\Users\\Public\\*"", ""*\\WINDOWS\\Temp\\*"", ""*C:\\Temp\\*"", ""*\\Desktop\\*"", ""*\\Downloads\\*"", ""*\\Temporary Internet*"", ""*C:\\ProgramData\\*"", ""*C:\\Perflogs\\*"") TaskContentNew IN (""*regsvr32*"", ""*rundll32*"", ""*cmd.exe</Command>*"", ""*cmd</Command>*"", ""*<Arguments>/c *"", ""*<Arguments>/k *"", ""*<Arguments>/r *"", ""*powershell*"", ""*pwsh*"", ""*mshta*"", ""*wscript*"", ""*cscript*"", ""*certutil*"", ""*bitsadmin*"", ""*bash.exe*"", ""*bash *"", ""*scrcons*"", ""*wmic *"", ""*wmic.exe*"", ""*forfiles*"", ""*scriptrunner*"", ""*hh.exe*"")"
"SysKey Registry Keys Access","Roberto Rodriguez @Cyb3rWard0g","Detects handle requests and access operations to specific registry keys to calculate the SysKey","attack.discovery, attack.t1012","Not classified","windows","security","Review the Event Logs on the Windows system for Event IDs 4656 and 4663 
Check if the access to the specific registry keys was performed by authorized users or system processes 
Correlate the timestamp of the access with known system activities or scheduled tasks 
Investigate if any legitimate software or tools are known to access these registry keys","Legitimate access to these registry keys by system administrators or authorized users 
Scheduled tasks or legitimate software accessing these keys 
Backup or monitoring tools accessing the registry keys 
Changes made during system updates or installations","source=""WinEventLog:Security"" EventCode IN (4656, 4663) ObjectType=""key"" ObjectName IN (""*lsa\\JD"", ""*lsa\\GBG"", ""*lsa\\Skew1"", ""*lsa\\Data"")"
"Sysmon Channel Reference Deletion","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Potential threat actor tampering with Sysmon manifest and eventually disabling it","attack.defense_evasion, attack.t1112","Not classified","windows","security","Review the event logs for additional context and correlation 
Check for any scheduled maintenance activities that may coincide with the event 
Verify if any security tools have been recently deployed or updated that could impact Sysmon configuration 
Interview relevant system administrators or security operations personnel for insights","Legitimate changes to Sysmon configuration by authorized administrators 
Temporary disabling of Sysmon for maintenance purposes 
Changes made by security tools that interact with Sysmon configuration","source=""WinEventLog:Security"" (EventCode=4657 ObjectName IN (""*WINEVT\\Publishers\\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}*"", ""*WINEVT\\Channels\\Microsoft-Windows-Sysmon/Operational*"") ObjectValueName=""Enabled"" NewValue=0) OR (EventCode=4663 ObjectName IN (""*WINEVT\\Publishers\\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}*"", ""*WINEVT\\Channels\\Microsoft-Windows-Sysmon/Operational*"") AccessMask=65536)"
"Suspicious Teams Application Related ObjectAcess Event","@SerkinValery","Detects an access to authentication tokens and accounts of Microsoft Teams desktop application.","attack.credential_access, attack.t1528","Not classified","windows","security","Review the details of the Event ID 4663 logs to determine the source and user associated with the access. 
Check if the access to Microsoft Teams application files aligns with any known maintenance or operational activities. 
Correlate the access event with user authentication logs to verify the legitimacy of the access. 
Investigate any anomalies in the access patterns or frequency to identify potential unauthorized access.","Legitimate access by authorized users to Microsoft Teams application files. 
Scheduled or automated tasks accessing Teams application files. 
Updates or patches being applied to Microsoft Teams application. 
Backup processes interacting with Teams application files.","source=""WinEventLog:Security"" EventCode=4663 ObjectName IN (""*\\Microsoft\\Teams\\Cookies*"", ""*\\Microsoft\\Teams\\Local Storage\\leveldb*"") NOT ProcessName=""*\\Microsoft\\Teams\\current\\Teams.exe*"""
"User Couldn't Call a Privileged Service 'LsaRegisterLogonProcess'","Roberto Rodriguez (source), Ilyas Ochkov (rule), oscd.community","The 'LsaRegisterLogonProcess' function verifies that the application making the function call is a logon process by checking that it has the SeTcbPrivilege privilege set. Possible Rubeus tries to get a handle to LSA.","attack.lateral_movement, attack.privilege_escalation, attack.t1558.003","Not classified","windows","security","Review the process that attempted to call 'LsaRegisterLogonProcess' to determine its legitimacy 
Check if the process has the SeTcbPrivilege privilege set 
Investigate the context in which the event occurred to understand the intent behind the action 
Look for any additional suspicious activities or related events in the system logs","Legitimate use of 'LsaRegisterLogonProcess' by authorized applications 
Scheduled tasks or services that legitimately require the SeTcbPrivilege privilege 
Third-party applications that interact with the Local Security Authority (LSA) 
Custom scripts or tools used for system administration tasks","source=""WinEventLog:Security"" EventCode=4673 Service=""LsaRegisterLogonProcess()"" Keywords=""0x8010000000000000"""
"T1047 Wmiprvse Wbemcomn DLL Hijack","Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR)","Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\Windows\System32\wbem\` directory over the network for a WMI DLL Hijack scenario.","attack.execution, attack.t1047, attack.lateral_movement, attack.t1021.002","Not classified","windows","security","Check the process that created the file to determine if it is a legitimate action. 
Review the user context and privileges of the account that triggered the event. 
Correlate with other security events to identify any suspicious behavior or related activities. 
Verify if the file creation aligns with any scheduled or known system changes or updates.","Legitimate software or system updates may also create files in the specified directory. 
Administrators performing authorized actions may trigger this detection. 
Third-party applications or tools may also create files with similar names in the directory. 
File creation by system processes during normal operations can lead to false positives.","source=""WinEventLog:Security"" EventCode=5145 RelativeTargetName=""*\\wbem\\wbemcomn.dll"" NOT SubjectUserName=""*$"""
"DiagTrackEoP Default Login Username","Nasreddine Bencherchali (Nextron Systems)","Detects the default ""UserName"" used by the DiagTrackEoP POC","attack.privilege_escalation","Not classified","windows","security","Review the context of the event to determine if the default username usage is expected or suspicious 
Check if the default username is being used by a known service account or system process 
Correlate with additional logs to identify the source and intent of the login attempt 
Investigate the system to confirm if any malicious activity has taken place after the login with the default username","Legitimate use of the default username by authorized users 
Service accounts or automated processes using the default username 
Testing or development environments where default usernames are common","source=""WinEventLog:Security"" EventCode=4624 LogonType=9 TargetOutboundUserName=""thisisnotvaliduser"""
"Successful Overpass the Hash Attempt","Roberto Rodriguez (source), Dominik Schaudel (rule)","Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.","attack.lateral_movement, attack.s0002, attack.t1550.002","Not classified","windows","security","Check the command-line arguments of the process that initiated the logon event 
Review the parent-child process relationship to identify the origin of the logon attempt 
Look for other suspicious activities on the same host or related hosts 
Correlate with network logs to determine if lateral movement or data exfiltration occurred","Runas command-line tool using /netonly parameter 
Scheduled tasks that trigger logon events with LogonType 9 
Legitimate use of tools like PsExec that may trigger similar logon events 
Logons from service accounts that use NewCredentials for legitimate purposes","source=""WinEventLog:Security"" EventCode=4624 LogonType=9 LogonProcessName=""seclogo"" AuthenticationPackageName=""Negotiate"""
"Scanner PoC for CVE-2019-0708 RDP RCE Vuln","Florian Roth (Nextron Systems), Adam Bradbury (idea)","Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable to  CVE-2019-0708 RDP RCE aka BlueKeep","attack.lateral_movement, attack.t1210, car.2013-07-002","Not classified","windows","security","Check if the scanning activity is part of a scheduled security assessment 
Verify the source of the scanning activity and ensure it is authorized 
Review the context of the RDP connections to determine if they are legitimate 
Cross-reference with network segmentation and access control lists to confirm authorized access","Legitimate use of scanning tools for vulnerability assessments 
Scheduled security scans by authorized personnel 
Use of legitimate RDP tools for remote administration","source=""WinEventLog:Security"" EventCode=4625 TargetUserName=""AAAAAAA"""
"RDP Login from Localhost","Thomas Patzke","RDP login with localhost source address may be a tunnelled login","attack.lateral_movement, car.2013-07-002, attack.t1021.001","Not classified","windows","security","Review the purpose of the RDP connection from localhost with the system owner or administrator 
Check if there is a legitimate reason for the RDP connection from localhost, such as administrative tasks 
Investigate if there are any jump hosts or proxy servers in the network that could explain the RDP connection from localhost 
Verify if the RDP connection is originating from a virtual machine or containerized environment where localhost is expected","Legitimate use of RDP from localhost for administrative purposes 
RDP connections from a jump host or proxy server 
RDP connections from a virtual machine with localhost as the source 
RDP connections from a containerized environment where localhost is used","source=""WinEventLog:Security"" EventCode=4624 LogonType=10 IpAddress IN (""::1"", ""127.0.0.1"")"
"Remote WMI ActiveScriptEventConsumers","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Detect potential adversaries leveraging WMI ActiveScriptEventConsumers remotely to move laterally in a network","attack.lateral_movement, attack.privilege_escalation, attack.persistence, attack.t1546.003","Not classified","windows","security","Review the process tree to identify the parent process of scrcons.exe 
Check for legitimate use of WMI by system administrators or management tools 
Correlate with other security events to determine the context of the WMI activity 
Investigate the network connections and communication associated with the WMI activity","Legitimate use of WMI for system management tools 
Scheduled tasks or scripts that use WMI 
Administrative scripts or tools that interact with WMI","source=""WinEventLog:Security"" EventCode=4624 LogonType=3 ProcessName=""*scrcons.exe"" NOT TargetLogonId=""0x3e7"""
"External Remote SMB Logon from Public IP","Micah Babinski (@micahbabinski), Zach Mathis (@yamatosecurity)","Detects successful logon from public IP address via SMB. This can indicate a publicly-exposed SMB port.","attack.initial_access, attack.credential_access, attack.t1133, attack.t1078, attack.t1110","Not classified","windows","security","Verify if the logon from the public IP address was authorized and expected. 
Check if there are any legitimate reasons for the SMB logon from a public IP address, such as remote workers or external services. 
Investigate if there are any ongoing security assessments or penetration tests that involve logons from public IPs. 
Correlate the SMB logon with other security events to determine if it is part of a larger attack or a standalone incident.","Legitimate or intentional inbound connections from public IP addresses on the SMB port. 
Internal users accessing resources from a public IP address due to VPN or other legitimate reasons. 
Cloud-based services or applications that utilize SMB connections from public IPs. 
Third-party services or partners accessing resources via SMB from public IPs."
"KrbRelayUp Attack Pattern","@SBousseaden, Florian Roth","Detects logon events that have characteristics of events generated during an attack with KrbRelayUp and the like","attack.privilege_escalation, attack.credential_access","Not classified","windows","security","Check for any scheduled tasks running around the time of the logon event 
Verify the legitimacy of the Kerberos authentication by cross-referencing with authentication logs 
Investigate the source of the logon event to ensure it is from a trusted system or user","Scheduled tasks triggering logon events 
Legitimate Kerberos authentication 
Logon events from trusted sources","source=""WinEventLog:Security"" EventCode=4624 LogonType=3 AuthenticationPackageName=""Kerberos"" IpAddress=""127.0.0.1"" TargetUserSid=""S-1-5-21-*"" TargetUserSid=""*-500"""
"RottenPotato Like Attack Pattern","@SBousseaden, Florian Roth","Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like","attack.privilege_escalation, attack.credential_access, attack.t1557.001","Not classified","windows","security","Review the process or service associated with the ANONYMOUS LOGON account 
Check if the logon event is triggered by a known system operation or scheduled task 
Investigate if any legitimate application or service is using the loopback IP addresses for communication 
Correlate with other security events to determine the context of the logon activity","Legitimate use of ANONYMOUS LOGON account for specific system operations 
Local system processes or services using ANONYMOUS LOGON 
Legitimate use of loopback IP addresses (127.0.0.1, ::1) 
Scheduled tasks or scripts that require ANONYMOUS LOGON authentication","source=""WinEventLog:Security"" EventCode=4624 LogonType=3 TargetUserName=""ANONYMOUS LOGON"" WorkstationName=""-"" IpAddress IN (""127.0.0.1"", ""::1"")"
"HackTool - CACTUSTORCH Remote Thread Creation","@SBousseaden (detection), Thomas Patzke (rule)","Detects remote thread creation from CACTUSTORCH as described in references.","attack.defense_evasion, attack.execution, attack.t1055.012, attack.t1059.005, attack.t1059.007, attack.t1218.005","create_remote_thread","windows","Not classified","Check the process command line arguments to determine the intent behind the remote thread creation. 
Review the parent-child process relationship to identify the origin of the suspicious activity. 
Analyze network traffic to see if there are any corresponding connections to known malicious IPs or domains. 
Inspect the registry for any changes related to the suspicious process or activity.","Legitimate use of remote thread creation tools for system administration purposes. 
Updates or installations that involve legitimate software. 
Scheduled tasks or scripts that use remote thread creation for valid reasons.","SourceImage IN (""*\\System32\\cscript.exe"", ""*\\System32\\wscript.exe"", ""*\\System32\\mshta.exe"", ""*\\winword.exe"", ""*\\excel.exe"") TargetImage=""*\\SysWOW64\\*"" StartModule!=*"
"HackTool - Potential CobaltStrike Process Injection","Olaf Hartong, Florian Roth (Nextron Systems), Aleksey Potapov, oscd.community","Detects a potential remote threat creation with certain characteristics which are typical for Cobalt Strike beacons","attack.defense_evasion, attack.t1055.001","create_remote_thread","windows","Not classified","Verify the process and its associated command-line arguments for legitimate purposes 
Check if the process is a known system process or a trusted application 
Investigate the parent-child process relationship to determine the origin and intent 
Analyze network traffic and behavior to identify any malicious communication","Legitimate use of remote thread creation for system processes 
Legitimate use of tools that mimic Cobalt Strike behavior 
Legitimate software utilizing similar memory injection techniques 
False positives due to system updates or software installations","StartAddress IN (""*0B80"", ""*0C7C"", ""*0C88"")"
"Remote Thread Created In KeePass.EXE","Timon Hackenjos","Detects remote thread creation in ""KeePass.exe"" which could indicates potential password dumping activity","attack.credential_access, attack.t1555.005","create_remote_thread","windows","Not classified","Check if the remote thread creation is associated with a known legitimate tool or process 
Review the activity timeline of the system to determine if the event coincides with any authorized actions 
Inspect the parent process of KeePass.exe to identify the source of the remote thread creation 
Conduct memory forensics on the system to gather more information about the potential threat activity","Legitimate remote administration tools may also create remote threads in KeePass.exe 
Updates or plugins for KeePass may trigger this detection 
Scheduled tasks or legitimate processes may also create remote threads in KeePass.exe","TargetImage=""*\\KeePass.exe"""
"Potential Credential Dumping Attempt Via PowerShell Remote Thread","oscd.community, Natalia Shornikova","Detects remote thread creation by PowerShell processes into ""lsass.exe""","attack.credential_access, attack.t1003.001","create_remote_thread","windows","Not classified","Review the command-line arguments of the PowerShell process to determine the intent 
Check if the remote thread creation into lsass.exe is part of a known legitimate process 
Correlate with other security events to identify any suspicious patterns or behaviors","Legitimate use of PowerShell for administrative tasks involving lsass.exe 
Scheduled tasks or scripts that interact with lsass.exe 
Security tools or monitoring agents that utilize PowerShell to access lsass.exe","SourceImage IN (""*\\powershell.exe"", ""*\\pwsh.exe"") TargetImage=""*\\lsass.exe"""
"Password Dumper Remote Thread in LSASS","Thomas Patzke","Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage.
The process in field Process is the malicious program. A single execution can lead to hundreds of events.
","attack.credential_access, attack.s0005, attack.t1003.001","create_remote_thread","windows","Not classified","Review the parent-child process relationship to identify the origin of the suspicious remote thread creation 
Analyze the command-line arguments of the process creating the remote thread for any unusual behavior 
Check for any additional indicators of compromise on the system, such as new files or registry modifications 
Correlate the event with other security events or logs to determine the scope of the potential compromise","Legitimate tools that create remote threads for valid purposes 
Scheduled tasks or system processes that create remote threads 
Updates or installations that involve lsass.exe 
Custom scripts or applications that interact with lsass.exe","TargetImage=""*\\lsass.exe"" StartModule="""""
"Remote Thread Creation Ttdinject.exe Proxy","frack113","Detects a remote thread creation of Ttdinject.exe used as proxy","attack.defense_evasion, attack.t1127","create_remote_thread","windows","Not classified","Check the parent process of Ttdinject.exe for legitimacy 
Review network connections and traffic associated with the process 
Analyze the command-line arguments and parameters used with Ttdinject.exe 
Compare the behavior with known good baselines for Ttdinject.exe","Legitimate use of Ttdinject.exe for authorized purposes 
Known system administration tools may use remote thread creation 
Updates or installations that involve Ttdinject.exe","SourceImage=""*\\ttdinject.exe"""
"Exports Registry Key To an Alternate Data Stream","Oddvar Moe, Sander Wiebing, oscd.community","Exports the target Registry key and hides it in the specified alternate data stream.","attack.defense_evasion, attack.t1564.004","create_stream_hash","windows","Not classified","Check if the registry key exported to an alternate data stream is part of a known system or application configuration. 
Verify if the activity was performed by authorized administrators during scheduled maintenance. 
Investigate if any legitimate third-party applications on the system use alternate data streams. 
Correlate the event with other security logs to determine if any malicious activities are associated.","Legitimate use of regedit.exe to export registry keys. 
Administrators performing system maintenance tasks. 
Third-party applications that utilize alternate data streams for legitimate purposes.","Image=""*\\regedit.exe"""
"Unusual File Download from Direct IP Address","Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)","Detects the download of suspicious file type from URLs with IP","attack.defense_evasion, attack.t1564.004","create_stream_hash","windows","Not classified","Review network proxy logs to determine the legitimacy of the file download 
Check endpoint logs for any corresponding execution or activity related to the downloaded file 
Investigate the reputation of the IP address using threat intelligence feeds 
Verify the business justification for accessing files from direct IP addresses","Legitimate file downloads from known IP addresses 
Internal tools or scripts accessing files from direct IP addresses 
Updates or patches being downloaded from IP addresses 
Whitelisted applications or services accessing files from specific IP addresses","TargetFilename IN (""*.ps1:Zone*"", ""*.bat:Zone*"", ""*.exe:Zone*"", ""*.vbe:Zone*"", ""*.vbs:Zone*"", ""*.dll:Zone*"", ""*.one:Zone*"", ""*.cmd:Zone*"", ""*.hta:Zone*"", ""*.xll:Zone*"", ""*.lnk:Zone*"")\"
"Potential Suspicious Winget Package Installation","Nasreddine Bencherchali (Nextron Systems)","Detects potential suspicious winget package installation from a suspicious source.","attack.defense_evasion, attack.persistence","create_stream_hash","windows","Not classified","Check the legitimacy of the software installation or update using winget 
Verify the source of the winget package for trustworthiness 
Review any scripts or automation that involve winget installations 
Look for patterns of normal behavior in the environment related to winget usage","Legitimate use of winget for software installations 
Updates or installations from trusted sources 
Scripted installations that use winget","Contents=""[ZoneTransfer]  ZoneId=3*"" Contents IN (""*://1*"", ""*://2*"", ""*://3*"", ""*://4*"", ""*://5*"", ""*://6*"", ""*://7*"", ""*://8*"", ""*://9*"") TargetFilename=""*:Zone.Identifier"" TargetFilename=""*\\AppData\\Local\\Temp\\WinGet\\*"""
"DNS Query for Anonfiles.com Domain - Sysmon","pH-T (Nextron Systems)","Detects DNS queries for ""anonfiles.com"", which is an anonymous file upload platform often used for malicious purposes","attack.exfiltration, attack.t1567.002","dns_query","windows","Not classified","Review the context of the DNS query to determine if it is part of a legitimate operation 
Check if the DNS query to anonfiles.com is initiated by a known application or service on the system 
Correlate the DNS query with other network or endpoint logs to identify any suspicious activities 
Investigate the reputation of the source IP address making the DNS query","Legitimate use of anonfiles.com for file sharing or collaboration purposes 
Use of anonfiles.com by security researchers for analysis 
Access to anonfiles.com from a known trusted source or IP address","QueryName=""*.anonfiles.com*"""
"DNS HybridConnectionManager Service Bus","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Detects Azure Hybrid Connection Manager services querying the Azure service bus service","attack.persistence, attack.t1554","dns_query","windows","Not classified","Verify the source of the DNS query to determine if it is from an authorized system or user 
Check if the query is coming from a known Azure service or resource 
Review the context of the query to see if it aligns with legitimate use of Azure Hybrid Connection Manager and Azure Service Bus 
Cross-reference the query with network logs to confirm the communication pattern","Legitimate use of Azure Hybrid Connection Manager and the Azure Service Bus service 
Queries from authorized systems or users 
Queries from known Azure services","QueryName=""*servicebus.windows.net*"" Image=""*HybridConnectionManager*"""
"Suspicious Cobalt Strike DNS Beaconing - Sysmon","Florian Roth (Nextron Systems)","Detects a program that invoked suspicious DNS queries known from Cobalt Strike beacons","attack.command_and_control, attack.t1071.004","dns_query","windows","Not classified","Review the process Image and CommandLine to determine the program responsible for the suspicious DNS queries 
Check if the DNS queries are part of a known legitimate operation within your environment 
Correlate the timestamp of the DNS queries with other security events to identify any related suspicious activities 
Investigate the reputation of the queried domains to determine if they are associated with known malicious activity","Legitimate tools or scripts that use similar DNS query patterns 
DNS queries related to legitimate software updates 
DNS queries from security tools or monitoring systems","QueryName IN (""aaa.stage.*"", ""post.1*"") OR QueryName=""*.stage.123456.*"""
"Driver Load From A Temporary Directory","Florian Roth (Nextron Systems)","Detects a driver load from a temporary directory","attack.persistence, attack.privilege_escalation, attack.t1543.003","driver_load","windows","Not classified","Review the specific driver that was loaded from the temporary directory for legitimacy 
Check if the temporary directory is commonly used by trusted applications or system processes 
Correlate the event with other security logs to determine if the action is part of a larger suspicious activity 
Investigate the process that initiated the driver load from the temporary directory","Legitimate software or drivers may load from temporary directories during normal operations 
Temporary directories used by trusted applications may trigger this detection 
Updates or installations of software may involve loading drivers from temporary locations","ImageLoaded=""*\\Temp\\*"""
"Vulnerable HackSys Extreme Vulnerable Driver Load","Nasreddine Bencherchali (Nextron Systems)","Detects the load of HackSys Extreme Vulnerable Driver which is an intentionally vulnerable Windows driver developed for security enthusiasts to learn and polish their exploitation skills at Kernel level and often abused by threat actors","attack.privilege_escalation, attack.t1543.003","driver_load","windows","Not classified","Check if the loading of the HackSys Extreme Vulnerable Driver was part of a planned security testing activity 
Verify the digital signature and source of the driver being loaded 
Investigate the process that initiated the driver load for any suspicious activity 
Look for additional indicators of compromise on the system","Legitimate use of the HackSys Extreme Vulnerable Driver for educational or testing purposes 
Loading of a different driver with a similar name 
Legitimate software using a similar technique for driver loading","ImageLoaded=""*\\HEVD.sys"" OR Hashes IN (""*IMPHASH=f26d0b110873a1c7d8c4f08fbeab89c5*"", ""*IMPHASH=c46ea2e651fd5f7f716c8867c6d13594*"") OR Imphash IN (""f26d0b110873a1c7d8c4f08fbeab89c5"", ""c46ea2e651fd5f7f716c8867c6d13594"")"
"Vulnerable WinRing0 Driver Load","Florian Roth (Nextron Systems)","Detects the load of a signed WinRing0 driver often used by threat actors, crypto miners (XMRIG) or malware for privilege escalation","attack.privilege_escalation, attack.t1543.003","driver_load","windows","Not classified","Verify the legitimacy of the process loading the WinRing0 driver 
Check if the WinRing0 driver load is part of a known software installation or update 
Investigate the context of the driver load to determine if it aligns with expected system behavior 
Cross-reference with information from authorized sources to confirm the purpose of the WinRing0 driver load","Legitimate use of WinRing0 driver by authorized tools or software 
Updates or installations of legitimate software that include WinRing0 driver 
Presence of WinRing0 driver in specific gaming or hardware monitoring applications","ImageLoaded IN (""*\\WinRing0x64.sys"", ""*\\WinRing0.sys"", ""*\\WinRing0.dll"", ""*\\WinRing0x64.dll"", ""*\\winring00x64.sys"") OR Hashes=""*IMPHASH=D41FA95D4642DC981F10DE36F4DC8CD7*"" OR Imphash=""d41fa95d4642dc981f10de36f4dc8cd7"""
"WinDivert Driver Load","Florian Roth (Nextron Systems)","Detects the load of the Windiver driver, a powerful user-mode capture/sniffing/modification/blocking/re-injection package for Windows","attack.collection, attack.defense_evasion, attack.t1599.001, attack.t1557.001","driver_load","windows","Not classified","Verify the context in which the WinDivert driver was loaded (e.g., during installation of a known security tool) 
Check if there are any legitimate reasons for the presence of WinDivert on the system 
Review any documentation or change management records related to the use of WinDivert on the network","Legitimate use of WinDivert for network monitoring or security tools 
Legitimate use of WinDivert for research purposes 
Legitimate use of WinDivert for network troubleshooting","ImageLoaded IN (""*\\WinDivert.sys*"", ""*\\WinDivert64.sys*"", ""*\\NordDivert.sys*"", ""*\\lingtiwfp.sys*"", ""*\\eswfp.sys*"") OR Hashes IN (""*IMPHASH=0604bb7cb4bb851e2168d5c7d9399087*"", ""*IMPHASH=2e5f0e649d97f32b03c09e4686d0574f*"", ""*IMPHASH=52f8aa269f69f0edad9e8fcdaedce276*"", ""*IMPHASH=c0e5d314da39dbf65a2dbff409cc2c76*"", ""*IMPHASH=58623490691babe8330adc81cd04a663*"", ""*IMPHASH=8ee39b48656e4d6b8459d7ba7da7438b*"", ""*IMPHASH=45ee545ae77e8d43fc70ede9efcd4c96*"", ""*IMPHASH=a1b2e245acd47e4a348e1a552a02859a*"", ""*IMPHASH=2a5f85fe4609461c6339637594fa9b0a*"", ""*IMPHASH=6b2c6f95233c2914d1d488ee27531acc*"", ""*IMPHASH=9f2fdd3f9ab922bbb0560a7df46f4342*"", ""*IMPHASH=d8a719865c448b1bd2ec241e46ac1c88*"", ""*IMPHASH=0ea54f8c9af4a2fe8367fa457f48ed38*"", ""*IMPHASH=9d519ae0a0864d6d6ae3f8b6c9c70af6*"", ""*IMPHASH=a74929edfc3289895e3f2885278947ae*"", ""*IMPHASH=a66b476c2d06c370f0a53b5537f2f11e*"", ""*IMPHASH=bdcd836a46bc2415773f6b5ea77a46e4*"", ""*IMPHASH=c28cd6ccd83179e79dac132a553693d9*"") OR Imphash IN (""0604bb7cb4bb851e2168d5c7d9399087"", ""2e5f0e649d97f32b03c09e4686d0574f"", ""52f8aa269f69f0edad9e8fcdaedce276"", ""c0e5d314da39dbf65a2dbff409cc2c76"", ""58623490691babe8330adc81cd04a663"", ""8ee39b48656e4d6b8459d7ba7da7438b"", ""45ee545ae77e8d43fc70ede9efcd4c96"", ""a1b2e245acd47e4a348e1a552a02859a"", ""2a5f85fe4609461c6339637594fa9b0a"", ""6b2c6f95233c2914d1d488ee27531acc"", ""9f2fdd3f9ab922bbb0560a7df46f4342"", ""d8a719865c448b1bd2ec241e46ac1c88"", ""0ea54f8c9af4a2fe8367fa457f48ed38"", ""9d519ae0a0864d6d6ae3f8b6c9c70af6"", ""a74929edfc3289895e3f2885278947ae"", ""a66b476c2d06c370f0a53b5537f2f11e"", ""bdcd836a46bc2415773f6b5ea77a46e4"", ""c28cd6ccd83179e79dac132a553693d9"")"
"DLL Loaded From Suspicious Location Via Cmspt.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects cmstp loading ""dll"" or ""ocx"" files from suspicious locations","attack.defense_evasion, attack.t1218.003","image_load","windows","Not classified","Review the process command line arguments and parent process to determine if the cmstp.exe execution is expected 
Check the digital signature of the loaded DLL or OCX file to verify its authenticity 
Investigate the reputation of the file path from which the DLL or OCX file was loaded 
Correlate the event with other security logs to identify any related suspicious activities","Legitimate software installations that load DLLs or OCX files from these locations 
Updates or patches that follow a similar behavior 
Scripted actions that are known to use cmstp.exe for legitimate purposes","Image=""*\\cmstp.exe"" ImageLoaded IN (""*\\PerfLogs\\*"", ""*\\ProgramData\\*"", ""*\\Users\\*"", ""*\\Windows\\Temp\\*"", ""*C:\\Temp\\*"") ImageLoaded IN (""*.dll"", ""*.ocx"")"
"Suspicious Renamed Comsvcs DLL Loaded By Rundll32","Nasreddine Bencherchali (Nextron Systems)","Detects rundll32 loading a renamed comsvcs.dll to dump process memory","attack.credential_access, attack.defense_evasion, attack.t1003.001","image_load","windows","Not classified","Verify the legitimacy of the process by checking the parent process and command-line arguments 
Review the system for any recent software installations or updates that may have triggered the detection 
Analyze the behavior in the context of the specific system's normal operations and known applications 
Cross-reference the detection with whitelisted processes or known good behaviors in the environment","Legitimate use of rundll32 loading comsvcs.dll for valid system operations 
Software installations or updates that involve rundll32 and comsvcs.dll 
Custom scripts or applications designed to use rundll32 with comsvcs.dll 
Known benign behavior on specific systems or environments","Image=""*\\rundll32.exe"" Hashes IN (""*IMPHASH=eed93054cb555f3de70eaa9787f32ebb*"", ""*IMPHASH=5e0dbdec1fce52daae251a110b4f309d*"", ""*IMPHASH=eadbccbb324829acb5f2bbe87e5549a8*"", ""*IMPHASH=407ca0f7b523319d758a40d7c0193699*"", ""*IMPHASH=281d618f4e6271e527e6386ea6f748de*"") NOT ImageLoaded=""*\\comsvcs.dll"""
"Suspicious Unsigned Dbghelp/Dbgcore DLL Loaded","Perez Diego (@darkquassar), oscd.community, Ecco","Detects the load of dbghelp/dbgcore DLL (used to make memory dumps) by suspicious processes.
Tools like ProcessHacker and some attacker tradecract use MiniDumpWriteDump API found in dbghelp.dll or dbgcore.dll.
As an example, SilentTrynity C2 Framework has a module that leverages this API to dump the contents of Lsass.exe and transfer it over the network back to the attacker's machine.
","attack.credential_access, attack.t1003.001","image_load","windows","Not classified","Check the process that loaded the dbghelp/dbgcore DLLs for legitimacy 
Review the context of the event to determine if it was part of a known and approved activity 
Investigate the reputation of the process and its associated behavior 
Correlate with other security events to identify any malicious patterns or activities","Legitimate debugging tools or software that use dbghelp/dbgcore DLLs 
Updates or installations of legitimate software that may trigger loading of these DLLs 
Custom scripts or applications that interact with these DLLs for valid reasons","ImageLoaded IN (""*\\dbghelp.dll"", ""*\\dbgcore.dll"") Signed=""false"""
"PCRE.NET Package Image Load","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Detects processes loading modules related to PCRE.NET package","attack.execution, attack.t1059","image_load","windows","Not classified","Verify the process loading the PCRE.NET package and its associated command-line arguments 
Check if the file path matches a known legitimate installation or usage of PCRE.NET package 
Investigate the parent-child process relationship to determine the context of the PCRE.NET package loading 
Correlate with additional logs or endpoint data to confirm the legitimacy of the activity","Legitimate use of PCRE.NET package by authorized processes 
Temporary files created during software installations 
Development or testing environments where PCRE.NET package is commonly used","ImageLoaded=""*\\AppData\\Local\\Temp\\ba9ea7344a4a5f591d6e5dc32a13494b\\*"""
"Diagnostic Library Sdiageng.DLL Loaded By Msdt.EXE","Greg (rule)","Detects both of CVE-2022-30190 (Follina) and DogWalk vulnerabilities exploiting msdt.exe binary to load the ""sdiageng.dll"" library","attack.defense_evasion, attack.t1202, cve.2022.30190","image_load","windows","Not classified","Check if the msdt.exe and sdiageng.dll processes are part of a legitimate diagnostic operation 
Verify if there are any authorized updates or installations that could trigger the loading of sdiageng.dll by msdt.exe 
Review any custom scripts or tools that are known to use msdt.exe to load sdiageng.dll","Legitimate use of msdt.exe and sdiageng.dll for diagnostic purposes 
Updates or installations that involve loading sdiageng.dll by msdt.exe 
Custom scripts or tools that use msdt.exe to load sdiageng.dll","Image=""*\\msdt.exe"" ImageLoaded=""*\\sdiageng.dll"""
"Time Travel Debugging Utility Usage - Image","Ensar amil, @sblmsrsn, @oscd_initiative","Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.","attack.defense_evasion, attack.credential_access, attack.t1218, attack.t1003.001","image_load","windows","Not classified","Check if the tttracer.exe process was executed with suspicious parameters 
Look for any abnormal behavior associated with the loaded ttdrecord.dll, ttdwriter.dll, or ttdloader.dll 
Correlate the event with other security logs to determine the context of the activity 
Investigate the parent-child process relationship to identify the origin of the Time Travel Debugging Utility usage","Legitimate usage by system administrators for debugging purposes 
Legitimate usage by authorized security tools 
Legitimate usage in a controlled testing environment","ImageLoaded IN (""*\\ttdrecord.dll"", ""*\\ttdwriter.dll"", ""*\\ttdloader.dll"")"
"Suspicious Volume Shadow Copy Vssapi.dll Load","frack113","Detects the image load of VSS DLL by uncommon executables","attack.defense_evasion, attack.impact, attack.t1490","image_load","windows","Not classified","Check if the VSS API call is related to a known legitimate process or software 
Review the timing of the VSS API call to correlate with system events or operations 
Analyze the parent process that triggered the VSS API call 
Inspect the command-line arguments or parameters used in the VSS API call","Legitimate software or system tools loading VSS DLLs 
Updates or patches triggering VSS DLL loads 
Scheduled backups or system restore operations 
Security software utilizing VSS for protection mechanisms","ImageLoaded=""*\\vssapi.dll"" NOT (Image IN (""C:\\Windows\\explorer.exe"", ""C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe"") OR Image IN (""C:\\Windows\\System32\\*"", ""C:\\Windows\\SysWOW64\\*"", ""C:\\Windows\\Temp\\{*"", ""C:\\Windows\\WinSxS\\*"") OR Image IN (""C:\\Program Files\\*"", ""C:\\Program Files (x86)\\*"") OR Image=""C:\\ProgramData\\Package Cache\\*"")"
"Suspicious Volume Shadow Copy Vsstrace.dll Load","frack113","Detects the image load of VSS DLL by uncommon executables","attack.defense_evasion, attack.impact, attack.t1490","image_load","windows","Not classified","Check if the Vsstrace.dll load was triggered by a known backup software 
Verify if the Vsstrace.dll load was part of a legitimate operation by a trusted application 
Investigate recent software updates or installations that may have involved Vsstrace.dll","Legitimate use of VSS by backup software 
Legitimate use of Vsstrace.dll by trusted applications 
Updates or installations of software that involve Vsstrace.dll","ImageLoaded=""*\\vsstrace.dll"" NOT (Image IN (""C:\\Windows\\explorer.exe"", ""C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe"") OR Image IN (""C:\\Windows\\System32\\*"", ""C:\\Windows\\SysWOW64\\*"", ""C:\\Windows\\Temp\\{*"", ""C:\\Windows\\WinSxS\\*"") OR Image IN (""C:\\Program Files\\*"", ""C:\\Program Files (x86)\\*""))"
"HackTool - SharpEvtMute DLL Load","Florian Roth (Nextron Systems)","Detects the load of EvtMuteHook.dll, a key component of SharpEvtHook, a tool that tampers with the Windows event logs","attack.defense_evasion, attack.t1562.002","image_load","windows","Not classified","Check the process that loaded the EvtMuteHook.dll for any legitimate reasons 
Verify if any authorized tools or software on the system are known to use the same DLL or Imphash 
Investigate recent software updates or installations that may have introduced the DLL 
Review any custom scripts or applications that could be loading similar DLLs","Legitimate software or tools that use the same DLL or Imphash 
Updates or patches that may trigger the detection 
Custom scripts or applications that load similar DLLs","Hashes=""*IMPHASH=330768A4F172E10ACB6287B87289D83B*"" OR Imphash=""330768a4f172e10acb6287b87289d83b"""
"HackTool - SILENTTRINITY Stager DLL Load","Aleksey Potapov, oscd.community","Detects SILENTTRINITY stager dll loading activity","attack.command_and_control, attack.t1071","image_load","windows","Not classified","Check if the DLL loading activity is associated with a known and authorized SILENTTRINITY usage 
Verify if the DLL loading is related to a legitimate software installation or update 
Analyze the context of the DLL loading to determine if it aligns with expected system behavior 
Cross-reference the activity with change management records to confirm authorized changes","Legitimate use of SILENTTRINITY tool by authorized users 
Installation of legitimate software that may trigger similar behavior 
Updates or patches that involve DLL loading activities","Description=""*st2stager*"""
"Potential DCOM InternetExplorer.Application DLL Hijack - Image Load","Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR), wagga","Detects potential DLL hijack of ""iertutil.dll"" found in the DCOM InternetExplorer.Application Class","attack.lateral_movement, attack.t1021.002, attack.t1021.003","image_load","windows","Not classified","Review the process tree to understand the context of the iexplore.exe and iertutil.dll interaction 
Check for legitimate reasons for the DLL load, such as software installations or updates 
Verify the integrity of the iertutil.dll file to ensure it has not been tampered with","Legitimate use of DCOM for Internet Explorer related activities 
Updates or patches that involve loading iertutil.dll 
Known benign software that interacts with iertutil.dll","Image=""*\\Internet Explorer\\iexplore.exe"" ImageLoaded=""*\\Internet Explorer\\iertutil.dll"""
"GAC DLL Loaded Via Office Applications","Antonlovesdnb","Detects any GAC DLL being loaded by an Office Product","attack.execution, attack.t1204.002","image_load","windows","Not classified","Check if the GAC DLL loading is related to a known legitimate process 
Verify if there were any recent updates or installations of Microsoft Office components 
Investigate if the GAC DLL loading is part of a scheduled task or script execution","Legitimate macro usage may trigger this rule 
Updates or installations of Microsoft Office components 
Legitimate use of GAC DLLs by trusted applications","Image IN (""*\\excel.exe"", ""*\\mspub.exe"", ""*\\onenote.exe"", ""*\\onenoteim.exe"", ""*\\outlook.exe"", ""*\\powerpnt.exe"", ""*\\winword.exe"") ImageLoaded=""C:\\Windows\\Microsoft.NET\\assembly\\GAC_MSIL*"""
"Microsoft VBA For Outlook Addin Loaded Via Outlook","Nasreddine Bencherchali (Nextron Systems)","Detects outlvba (Microsoft VBA for Outlook Addin) DLL being loaded by the outlook process","attack.execution, attack.t1204.002","image_load","windows","Not classified","Check if the outlvba.dll is being loaded by a known and trusted application or process 
Review the context in which the outlvba.dll is being loaded to determine if it aligns with legitimate activities 
Correlate the event with other security logs to identify any suspicious behavior or indicators of compromise 
Verify the integrity of the outlvba.dll file to ensure it has not been tampered with","Legitimate macro usage in the environment 
Scheduled tasks or applications that legitimately load the outlvba.dll 
Custom applications that interact with Outlook and load the outlvba.dll","Image=""*\\outlook.exe"" ImageLoaded=""\\outlvba.dll*"""
"VBA DLL Loaded Via Office Application","Antonlovesdnb","Detects VB DLL's loaded by an office application. Which could indicate the presence of VBA Macros.","attack.execution, attack.t1204.002","image_load","windows","Not classified","Review the process tree to understand the context of the DLL loading 
Check if the DLL loading is part of a known and approved workflow 
Analyze the behavior of the office application post DLL loading for any suspicious activities 
Compare the loaded DLLs with a whitelist of known good DLLs","Legitimate macro usage within the organization 
Updates or installations of legitimate software 
Scheduled tasks or scripts that involve VBA DLL loading","Image IN (""*\\excel.exe"", ""*\\mspub.exe"", ""*\\onenote.exe"", ""*\\onenoteim.exe"", ""*\\outlook.exe"", ""*\\powerpnt.exe"", ""*\\winword.exe"") ImageLoaded IN (""*\\VBE7.DLL"", ""*\\VBEUI.DLL"", ""*\\VBE7INTL.DLL"")"
"Aruba Network Service Potential DLL Sideloading","Nasreddine Bencherchali (Nextron Systems)","Detects potential DLL sideloading activity via the Aruba Networks Virtual Intranet Access ""arubanetsvc.exe"" process using DLL Search Order Hijacking","attack.privilege_escalation, attack.persistence, attack.t1574.001, attack.t1574.002","image_load","windows","Not classified","Verify the legitimacy of the process 'arubanetsvc.exe' and its associated DLL loading behavior 
Check for any recent software installations or updates that may have triggered the detection 
Review any custom scripts or tools used in the environment that interact with the Aruba Networks service 
Compare the behavior observed with known good patterns of DLL loading in the environment","Legitimate software or system updates may trigger this detection 
Third-party applications that legitimately load DLLs in the same manner 
Custom scripts or tools designed to interact with the Aruba Networks service","Image=""*\\arubanetsvc.exe"" ImageLoaded IN (""*\\wtsapi32.dll"", ""*\\msvcr100.dll"", ""*\\msvcp100.dll"", ""*\\dbghelp.dll"", ""*\\dbgcore.dll"", ""*\\wininet.dll"", ""*\\iphlpapi.dll"", ""*\\version.dll"", ""*\\cryptsp.dll"", ""*\\cryptbase.dll"", ""*\\wldp.dll"", ""*\\profapi.dll"", ""*\\sspicli.dll"", ""*\\winsta.dll"", ""*\\dpapi.dll"") NOT (ImageLoaded IN (""C:\\Windows\\System32\\*"", ""C:\\Windows\\SysWOW64\\*"", ""C:\\Windows\\WinSxS\\*""))"
"Potential DLL Sideloading Via comctl32.dll","Nasreddine Bencherchali (Nextron Systems), Subhash Popuri (@pbssubhash)","Detects potential DLL sideloading using comctl32.dll to obtain system privileges","attack.defense_evasion, attack.persistence, attack.privilege_escalation, attack.t1574.001, attack.t1574.002","image_load","windows","Not classified","Verify the legitimacy of the process loading comctl32.dll 
Check if the file paths and names match known legitimate software 
Investigate the reputation and purpose of the process in question 
Analyze the behavior of the process for any malicious activities","Legitimate software or system updates may trigger this detection 
Custom applications that load comctl32.dll for legitimate purposes 
DLL preloading by trusted applications","ImageLoaded IN (""C:\\Windows\\System32\\logonUI.exe.local\\*"", ""C:\\Windows\\System32\\werFault.exe.local\\*"", ""C:\\Windows\\System32\\consent.exe.local\\*"", ""C:\\Windows\\System32\\narrator.exe.local\\*"", ""C:\\windows\\system32\\wermgr.exe.local\\*"") ImageLoaded=""*\\comctl32.dll"""
"Potential Iviewers.DLL Sideloading","X__Junior (Nextron Systems)","Detects potential DLL sideloading of ""iviewers.dll"" (OLE/COM Object Interface Viewer)","attack.defense_evasion, attack.privilege_escalation, attack.t1574.001, attack.t1574.002","image_load","windows","Not classified","Check the process that loaded iviewers.dll for any suspicious activity 
Verify if the file path matches known legitimate software installations 
Investigate the parent-child process relationship to determine the origin of the DLL loading 
Look for any additional indicators of compromise on the system","Legitimate use of iviewers.dll by trusted applications 
Updates or installations of legitimate software 
Custom scripts or tools that load iviewers.dll for valid reasons","ImageLoaded=""*\\iviewers.dll"" NOT (ImageLoaded IN (""C:\\Program Files (x86)\\Windows Kits\\*"", ""C:\\Program Files\\Windows Kits\\*""))"
"Potential DLL Sideloading Of Non-Existent DLLs From System Folders","Nasreddine Bencherchali (Nextron Systems), SBousseaden","Detects DLL sideloading of system DLLs that are not present on the system by default (at least not in system directories).
Usually this technique is used to achieve UAC bypass or privilege escalation.
","attack.defense_evasion, attack.persistence, attack.privilege_escalation, attack.t1574.001, attack.t1574.002","image_load","windows","Not classified","Review the process that triggered the DLL loading event for legitimacy 
Check if the DLL loading event is part of a known software installation or update process 
Investigate the reputation and purpose of the DLL being loaded 
Monitor for any additional suspicious behavior or subsequent events","Legitimate software installation or updates may trigger this detection 
Custom applications or scripts that load DLLs from non-standard locations 
DLL preloading by trusted applications 
DLLs loaded by system processes during normal operation","ImageLoaded IN (""*:\\Windows\\System32\\TSMSISrv.dll"", ""*:\\Windows\\System32\\TSVIPSrv.dll"", ""*:\\Windows\\System32\\wbem\\wbemcomn.dll"", ""*:\\Windows\\System32\\WLBSCTRL.dll"", ""*:\\Windows\\System32\\wow64log.dll"", ""*:\\Windows\\System32\\WptsExtensions.dll"") NOT (Signed=""true"" SignatureStatus=""Valid"" Signature=""Microsoft Windows"")"
"Microsoft Office DLL Sideload","Nasreddine Bencherchali (Nextron Systems), Wietze Beukema (project and research)","Detects DLL sideloading of DLLs that are part of Microsoft Office from non standard location","attack.defense_evasion, attack.persistence, attack.privilege_escalation, attack.t1574.001, attack.t1574.002","image_load","windows","Not classified","Review the process execution logs to understand the context of the DLL loading event 
Check for any recent software installations or updates related to Microsoft Office that might explain the DLL loading behavior 
Verify the legitimacy of the process and the DLL loading activity by correlating with system and application logs 
Investigate the digital signatures of the DLLs to determine if they are from trusted sources","Legitimate software installations or updates that involve Microsoft Office DLLs being loaded from non-standard locations 
Custom scripts or applications that interact with Microsoft Office DLLs in a similar manner 
Legitimate use of Microsoft Office DLLs by specific applications that require non-standard loading paths","ImageLoaded=""*\\outllib.dll"" NOT (ImageLoaded IN (""C:\\Program Files\\Microsoft Office\\OFFICE*"", ""C:\\Program Files (x86)\\Microsoft Office\\OFFICE*"", ""C:\\Program Files\\Microsoft Office\\Root\\OFFICE*"", ""C:\\Program Files (x86)\\Microsoft Office\\Root\\OFFICE*""))"
"Potential Rcdll.DLL Sideloading","X__Junior (Nextron Systems)","Detects potential DLL sideloading of rcdll.dll","attack.defense_evasion, attack.privilege_escalation, attack.t1574.001, attack.t1574.002","image_load","windows","Not classified","Check the parent process that loaded rcdll.dll for any suspicious activity 
Verify the digital signature of the file to determine its authenticity 
Review the file path and compare it against known legitimate locations for rcdll.dll 
Investigate the command-line arguments used to load rcdll.dll for any anomalies","Legitimate use of rcdll.dll by trusted applications 
Updates or installations from Microsoft Visual Studio or Windows Kits 
Known system processes loading rcdll.dll","ImageLoaded=""*\\rcdll.dll"" NOT (ImageLoaded IN (""C:\\Program Files (x86)\\Microsoft Visual Studio\\*"", ""C:\\Program Files (x86)\\Windows Kits\\*""))"
"DLL Sideloading Of ShellChromeAPI.DLL","Nasreddine Bencherchali (Nextron Systems)","Detects processes loading the non-existent DLL ""ShellChromeAPI"". One known example is the ""DeviceEnroller"" binary in combination with the ""PhoneDeepLink"" flag tries to load this DLL.
Adversaries can drop their own renamed DLL and execute it via DeviceEnroller.exe using this parameter
","attack.defense_evasion, attack.persistence, attack.privilege_escalation, attack.t1574.001, attack.t1574.002","image_load","windows","Not classified","Review the process that loaded the DLL to determine if it is a known and trusted application 
Check if the DLL is part of a legitimate software installation or update 
Investigate the context in which the DLL was loaded to understand the behavior of the process","Legitimate software or system updates may also load DLLs in a similar manner 
DLLs may be legitimately loaded by certain applications during normal operation 
DLLs may be loaded by trusted scripts or tools for legitimate purposes","ImageLoaded=""*\\ShellChromeAPI.dll"""
"Fax Service DLL Search Order Hijack","NVISO","The Fax service attempts to load ualapi.dll, which is non-existent. An attacker can then (side)load their own malicious DLL using this service.","attack.persistence, attack.defense_evasion, attack.t1574.001, attack.t1574.002","image_load","windows","Not classified","Verify the legitimacy of the process attempting to load ualapi.dll 
Check for any recent legitimate software installations or updates that may have triggered this behavior 
Review the system for any known security tools or monitoring agents that could be causing the detection 
Correlate with other security events to determine if this is part of a larger attack chain","Legitimate software or system updates may also attempt to load ualapi.dll 
Other benign processes may trigger the same behavior 
Certain security tools or monitoring agents may also exhibit similar behavior","Image=""*\\fxssvc.exe"" ImageLoaded=""*ualapi.dll"" NOT ImageLoaded=""C:\\Windows\\WinSxS\\*"""
"Potential DLL Sideloading Via VMware Xfer","Nasreddine Bencherchali (Nextron Systems)","Detects loading of a DLL by the VMware Xfer utility from the non-default directory which may be an attempt to sideload arbitrary DLL","attack.defense_evasion, attack.t1574.002","image_load","windows","Not classified","Check if the DLL loading by VMware Xfer is part of a legitimate software installation or update process 
Verify if the activity is expected based on the organization's software usage policies 
Review any recent changes or configurations related to VMware Xfer utility on the system 
Compare the observed behavior with known benign behaviors of VMware Xfer utility","Legitimate use of VMware Xfer utility for authorized purposes 
Updates or installations of VMware components 
Known software that loads DLLs in a similar manner as VMware Xfer","Image=""*\\VMwareXferlogs.exe"" ImageLoaded=""*\\glib-2.0.dll"" NOT ImageLoaded=""C:\\Program Files\\VMware\\*"""
"DotNet CLR DLL Loaded By Scripting Applications","omkar72, oscd.community","Detects .NET CLR DLLs being loaded by scripting applications such as wscript or cscript. This could be an indication of potential suspicious execution.","attack.execution, attack.privilege_escalation, attack.t1055","image_load","windows","Not classified","Verify the legitimacy of the process loading the .NET CLR DLLs 
Check if the behavior is part of a scheduled or expected activity 
Review the parent-child process relationship to understand the context 
Compare the loaded DLLs with known good DLLs to identify anomalies","Legitimate use of .NET CLR DLLs by scripting applications 
Updates or installations of legitimate software 
Known system processes loading .NET CLR DLLs 
Development or testing environments where such behavior is expected","Image IN (""*\\cmstp.exe"", ""*\\cscript.exe"", ""*\\mshta.exe"", ""*\\msxsl.exe"", ""*\\regsvr32.exe"", ""*\\wmic.exe"", ""*\\wscript.exe"") ImageLoaded IN (""*\\clr.dll"", ""*\\mscoree.dll"", ""*\\mscorlib.dll"")"
"Suspicious Unsigned Thor Scanner Execution","Nasreddine Bencherchali (Nextron Systems)","Detects loading and execution of an unsigned thor scanner binary.","attack.defense_evasion, attack.t1574.002","image_load","windows","Not classified","Check the digital signature of the binary to verify its authenticity 
Review the context of the execution to determine if it aligns with expected system activities 
Correlate with system maintenance schedules to see if the execution coincides with planned activities 
Investigate the file path and origin of the binary to confirm its legitimacy","Legitimate use of the Thor scanner binary by Nextron Systems 
Temporary unsigned execution during system maintenance activities 
Customized legitimate binaries named similarly to thor.exe for specific applications","Image IN (""*\\thor.exe"", ""*\\thor64.exe"") ImageLoaded IN (""*\\thor.exe"", ""*\\thor64.exe"") NOT (Signed=""true"" SignatureStatus=""valid"" Signature=""Nextron Systems GmbH"")"
"UAC Bypass Using Iscsicpl - ImageLoad","Nasreddine Bencherchali (Nextron Systems)","Detects the ""iscsicpl.exe"" UAC bypass technique that leverages a DLL Search Order hijacking technique to load a custom DLL's from temp or a any user controlled location in the users %PATH%","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","image_load","windows","Not classified","Check the digital signature of the iscsicpl.exe and the associated DLLs to verify their authenticity 
Review the process execution context to determine if the DLL loading behavior is part of a known and legitimate operation 
Analyze the parent-child process relationship to identify the origin and intent of the iscsicpl.exe execution 
Monitor for any unusual file or registry modifications associated with the iscsicpl.exe process","Legitimate software or system updates may also load DLLs in a similar manner 
Third-party applications that legitimately interact with iscsicpl.exe 
Custom scripts or tools designed to load DLLs for specific purposes","Image=""C:\\Windows\\SysWOW64\\iscsicpl.exe"" ImageLoaded=""*\\iscsiexe.dll"" NOT (ImageLoaded=""*C:\\Windows\\*"" ImageLoaded=""*iscsiexe.dll*"")"
"UAC Bypass With Fake DLL","oscd.community, Dmitry Uchakin","Attempts to load dismcore.dll after dropping it","attack.persistence, attack.defense_evasion, attack.privilege_escalation, attack.t1548.002, attack.t1574.002","image_load","windows","Not classified","Check the process that triggered the loading of dismcore.dll for any signs of suspicious activity 
Review the parent-child process relationship to identify the origin of the DLL loading 
Analyze the behavior of the system before and after the DLL loading event to determine impact 
Look for any additional indicators of compromise such as file modifications or network connections","Legitimate software installations that involve loading DLLs 
Updates to system components that require loading DLLs 
Scripting or automation tools that load DLLs as part of their normal operation","Image=""*\\dism.exe"" ImageLoaded=""*\\dismcore.dll"" NOT ImageLoaded=""C:\\Windows\\System32\\Dism\\dismcore.dll"""
"Wmiprvse Wbemcomn DLL Hijack","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\Windows\System32\wbem\` directory over the network and loading it for a WMI DLL Hijack scenario.","attack.execution, attack.t1047, attack.lateral_movement, attack.t1021.002","image_load","windows","Not classified","Verify the legitimacy of the file creation by checking the source and context of the activity. 
Review system documentation or change management records to confirm authorized changes. 
Conduct interviews with system administrators or developers to understand any planned or ongoing activities that may involve DLL loading. 
Cross-reference the activity with known software installations or updates to rule out false positives.","Legitimate software or system updates may also create files in the specified directory. 
Development or testing activities may involve similar file creations for benign purposes. 
Third-party applications or tools may legitimately interact with WMI and load DLLs in a similar manner.","Image=""*\\wmiprvse.exe"" ImageLoaded=""*\\wbem\\wbemcomn.dll"""
"WMI Persistence - Command Line Event Consumer","Thomas Patzke","Detects WMI command line event consumers","attack.t1546.003, attack.persistence","image_load","windows","Not classified","Check if the WMI activity is associated with a known system administrator or a scheduled task 
Verify if the WMI activity coincides with authorized software installations or updates 
Review the purpose and configuration of security tools or monitoring agents that interact with WMI","Legitimate use of WMI command line event consumers by system administrators 
Updates or software installations that involve WMI operations 
Security tools or monitoring agents that utilize WMI for legitimate purposes","Image=""C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"" ImageLoaded=""*\\wbemcons.dll"""
"Connection Initiated Via Certutil.EXE","frack113, Florian Roth (Nextron Systems)","Detects a network connection initiated by the certutil.exe utility.
Attackers can abuse the utility in order to download malware or additional payloads.
","attack.command_and_control, attack.t1105","network_connection","windows","Not classified","Review the command-line arguments passed to certutil.exe for suspicious activity 
Check the destination IP address and port for known malicious indicators 
Look for any unusual patterns or spikes in network traffic associated with certutil.exe connections 
Correlate the network connection with other security events or logs to determine the context of the activity","Legitimate use of certutil.exe for valid administrative purposes 
Updates or software installations that involve certutil.exe 
Internal tools or scripts that leverage certutil.exe for legitimate operations","Image=""*\\certutil.exe"" Initiated=""true"" DestinationPort IN (80, 135, 443, 445)"
"Process Initiated Network  Connection To Ngrok Domain","Florian Roth (Nextron Systems)","Detects an executable initiating a network connection to ""ngrok"" domains.
Attackers were seen using this ""ngrok"" in order to store their second stage payloads and malware.
While communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.
","attack.exfiltration, attack.t1567.001","network_connection","windows","Not classified","Review the process that initiated the network connection to ngrok domains for any legitimate purposes. 
Check if there are any authorized or expected use cases for ngrok within the environment. 
Correlate the network connection with other security events to determine if it is part of a larger attack. 
Investigate the reputation and behavior of the destination ngrok domain to assess the risk level.","Development or testing environments where ngrok is legitimately used. 
Third-party applications or services that rely on ngrok for legitimate purposes. 
Cloud-based services that utilize ngrok for tunneling and testing. 
Automated scripts or tools that interact with ngrok for valid reasons.","Initiated=""true"" DestinationHostname IN (""*.ngrok-free.app"", ""*.ngrok-free.dev"", ""*.ngrok.app"", ""*.ngrok.dev"", ""*.ngrok.io"")"
"Communication To Ngrok Tunneling Service Initiated","Florian Roth (Nextron Systems)","Detects an executable initiating a network connection to ""ngrok"" tunneling domains.
Attackers were seen using this ""ngrok"" in order to store their second stage payloads and malware.
While communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.
","attack.exfiltration, attack.command_and_control, attack.t1567, attack.t1568.002, attack.t1572, attack.t1090, attack.t1102, attack.s0508","network_connection","windows","Not classified","Review the process that initiated the network connection to ngrok tunneling domains. 
Check if there are any legitimate reasons within the organization for using ngrok. 
Correlate the network connection with other security events to determine if it is part of a malicious activity. 
Investigate the destination IP address and domain reputation to identify any malicious behavior.","Development or testing environments where ngrok is legitimately used for secure tunnels. 
Authorized use of ngrok for legitimate purposes within the organization. 
Third-party services or applications that utilize ngrok for valid reasons.","DestinationHostname IN (""*tunnel.us.ngrok.com*"", ""*tunnel.eu.ngrok.com*"", ""*tunnel.ap.ngrok.com*"", ""*tunnel.au.ngrok.com*"", ""*tunnel.sa.ngrok.com*"", ""*tunnel.jp.ngrok.com*"", ""*tunnel.in.ngrok.com*"")"
"Equation Editor Network Connection","Max Altgelt (Nextron Systems)","Detects network connections from Equation Editor","attack.execution, attack.t1203","network_connection","windows","Not classified","Check the process command line arguments to determine the nature of the network connection 
Verify if the Equation Editor process is being used in a legitimate context 
Correlate network connection events with other security logs to identify any suspicious activities 
Investigate the destination IP address and domain for reputation and known malicious indicators","Legitimate use of Equation Editor for valid purposes 
Updates or patches for Equation Editor 
Network connections related to authorized Equation Editor usage","Image=""*\\eqnedt32.exe"""
"Network Connection Initiated By IMEWDBLD.EXE","frack113","Detects a network connection initiated by IMEWDBLD.EXE. This might indicate potential abuse of the utility as a LOLBIN in order to download arbitrary files or additional payloads.
","attack.command_and_control, attack.t1105","network_connection","windows","Not classified","Review the process command line arguments to determine the intent of the network connection 
Check the reputation of the destination IP address and domain for any known malicious activity 
Analyze the network traffic for any suspicious patterns or communication with known malicious servers 
Correlate the network connection with other security events or logs to identify any related suspicious activities","Legitimate use of IMEWDBLD.EXE for authorized network connections 
IM related tools or utilities that may have similar behavior 
Network connections initiated by trusted applications or services","Initiated=""true"" Image=""*\\IMEWDBLD.exe"""
"Msiexec.EXE Initiated Network Connection Over HTTP","frack113","Detects an initiated network connection by ""Msiexec.exe"" over port 80 or 443.
Adversaries might abuse ""msiexec.exe"" to install and execute remotely hosted packages.
","attack.defense_evasion, attack.t1218.007","network_connection","windows","Not classified","Check the command-line arguments used with msiexec.exe to determine the nature of the network connection. 
Review the process tree to identify the parent process that initiated the msiexec.exe network connection. 
Inspect the destination IP address and domain to determine if it is associated with known legitimate services or if it is suspicious. 
Analyze the network traffic for any anomalies or indicators of compromise during the msiexec.exe network connection.","Legitimate software updates or installations may use msiexec.exe to communicate over HTTP for legitimate purposes. 
Some security tools may trigger false positives when monitoring msiexec.exe network connections. 
Certain applications may have legitimate reasons to download resources over HTTP using msiexec.exe.","Initiated=""true"" Image=""*\\msiexec.exe"" DestinationPort IN (80, 443)"
"Network Connection Initiated Via Notepad.EXE","EagleEye Team","Detects a network connection that is initiated by the ""notepad.exe"" process.
This might be a sign of process injection from a beacon process or something similar.
Notepad rarely initiates a network communication except when printing documents for example.
","attack.command_and_control, attack.execution, attack.defense_evasion, attack.t1055","network_connection","windows","Not classified","Verify the destination IP address and port to determine if it is associated with a known command and control server. 
Check the process tree to see if notepad.exe is a child process of another suspicious process. 
Analyze the network traffic for any unusual patterns or data exfiltration. 
Review the command-line arguments and parameters passed to notepad.exe for any anomalies.","Legitimate network communication by notepad.exe when printing documents. 
Use of notepad.exe in legitimate software development environments. 
Communication with known and trusted network resources by notepad.exe. 
Notepad.exe used in conjunction with authorized network tools or services.","Image=""*\\notepad.exe"" NOT DestinationPort=9100"
"Outbound RDP Connections Over Non-Standard Tools","Markus Neis","Detects Non-Standard tools initiating a connection over port 3389 indicating possible lateral movement.
An initial baseline is required before using this utility to exclude third party RDP tooling that you might use.
","attack.lateral_movement, attack.t1021.001, car.2013-07-002","network_connection","windows","Not classified","Review the process tree to identify the parent process of the RDP connection 
Check for any scheduled tasks or scripts that may explain the RDP connection 
Verify if the RDP connection was initiated by a legitimate remote management tool 
Analyze the network traffic for any indicators of compromise or suspicious behavior","Legitimate use of third-party RDP tools by authorized users 
Scheduled tasks or automated processes using RDP connections 
RDP connections initiated by remote management tools","DestinationPort=3389 Initiated=""true"" NOT (Image IN (""C:\\Windows\\System32\\mstsc.exe"", ""C:\\Windows\\SysWOW64\\mstsc.exe"")) NOT ((Image=""C:\\Windows\\System32\\dns.exe"" SourcePort=53 Protocol=""udp"") OR Image IN (""*\\Avast Software\\Avast\\AvastSvc.exe"", ""*\\Avast\\AvastSvc.exe"") OR Image=""*\\RDCMan.exe"" OR Image=""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"" OR Image IN (""*\\FSAssessment.exe"", ""*\\FSDiscovery.exe"", ""*\\MobaRTE.exe"", ""*\\mRemote.exe"", ""*\\mRemoteNG.exe"", ""*\\Passwordstate.exe"", ""*\\RemoteDesktopManager.exe"", ""*\\RemoteDesktopManager64.exe"", ""*\\RemoteDesktopManagerFree.exe"", ""*\\RSSensor.exe"", ""*\\RTS2App.exe"", ""*\\RTSApp.exe"", ""*\\spiceworks-finder.exe"", ""*\\Terminals.exe"", ""*\\ws_TunnelService.exe"") OR Image IN (""*\\thor.exe"", ""*\\thor64.exe"") OR Image=""C:\\Program Files\\SplunkUniversalForwarder\\bin\\*"" OR Image=""*\\Ranger\\SentinelRanger.exe"" OR Image=""C:\\Program Files\\Mozilla Firefox\\firefox.exe"" OR Image IN (""C:\\Program Files\\TSplus\\Java\\bin\\HTML5service.exe"", ""C:\\Program Files (x86)\\TSplus\\Java\\bin\\HTML5service.exe"") OR Image!=* OR Image="""" OR Image=""<unknown process>"")"
"RDP Over Reverse SSH Tunnel","Samir Bousseaden","Detects svchost hosting RDP termsvcs communicating with the loopback address and on TCP port 3389","attack.command_and_control, attack.t1572, attack.lateral_movement, attack.t1021.001, car.2013-07-002","network_connection","windows","Not classified","Check for legitimate RDP connections to the loopback address from svchost processes 
Verify if any authorized services are using port 3389 for communication 
Investigate if there are any legitimate svchost processes communicating with the loopback address","Legitimate RDP connections to the loopback address 
Legitimate services using port 3389 
Legitimate svchost processes communicating with loopback address","Image=""*\\svchost.exe"" Initiated=""true"" SourcePort=3389 DestinationIp IN (""127.*"", ""::1"")"
"RDP to HTTP or HTTPS Target Ports","Florian Roth (Nextron Systems)","Detects svchost hosting RDP termsvcs communicating to target systems on TCP port 80 or 443","attack.command_and_control, attack.t1572, attack.lateral_movement, attack.t1021.001, car.2013-07-002","network_connection","windows","Not classified","Review network traffic logs for RDP connections from svchost.exe to target systems on port 80 or 443 
Check for legitimate reasons for RDP traffic to web servers on port 80 or 443 
Verify if svchost.exe is being used for other authorized purposes on the network 
Investigate network devices for misconfigurations that may trigger false positives","Legitimate RDP traffic to web servers on port 80 or 443 
Legitimate use of svchost.exe for other purposes 
Misconfigured network devices causing false positives","Image=""*\\svchost.exe"" Initiated=""true"" SourcePort=3389 DestinationPort IN (80, 443)"
"Script Initiated Connection to Non-Local Network","frack113, Florian Roth (Nextron Systems)","Detects a script interpreter wscript/cscript opening a network connection to a non-local network. Adversaries may use script to download malicious payloads.","attack.command_and_control, attack.t1105","network_connection","windows","Not classified","Review the script content and purpose to determine if it is expected behavior 
Check for any scheduled tasks or automation scripts that may explain the network connection 
Analyze the destination IP address and domain to see if it is associated with known services or legitimate operations 
Correlate the network connection with other security events to identify any malicious behavior","Scheduled legitimate scripts initiating network connections 
Updates or installations that involve scripts connecting to external servers 
Scripts used for legitimate remote administration purposes"
"Silenttrinity Stager Msbuild Activity","Kiran kumar s, oscd.community","Detects a possible remote connections to Silenttrinity c2","attack.execution, attack.t1127.001","network_connection","windows","Not classified","Check the process command line arguments for msbuild.exe to determine if it is being used maliciously 
Review network traffic logs to identify the destination and nature of the connections on ports 80 and 443 
Correlate the network connection with other security events or indicators of compromise on the system 
Investigate the reputation of the source and destination IPs involved in the connection","Legitimate use of msbuild.exe for software development or build processes 
Legitimate connections to common ports 80 and 443 
Use of similar tools or techniques for benign purposes","Image=""*\\msbuild.exe"" DestinationPort IN (80, 443) Initiated=""true"""
"Suspicious Network Connection Binary No CommandLine","Florian Roth (Nextron Systems)","Detects suspicious network connections made by a well-known Windows binary run with no command line parameters","attack.defense_evasion","network_connection","windows","Not classified","Review the process tree to understand the parent process and context of the suspicious network connection 
Check the reputation of the binary making the network connection 
Analyze the destination of the network connection for any known malicious indicators 
Compare the behavior with historical data to identify anomalies","Legitimate network connections made by system binaries without command line parameters 
Network connections made by trusted applications that do not require command line arguments 
Network connections made by system services that use default configurations","Initiated=""true"" Image IN (""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\dllhost.exe"") CommandLine IN (""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\dllhost.exe"") NOT (CommandLine="""" OR CommandLine!=*)"
"Cmstp Making Network Connection","Nasreddine Bencherchali (Nextron Systems)","Detects suspicious network connection by Cmstp","attack.defense_evasion, attack.t1218.003","network_connection","windows","Not classified","Review the process command-line arguments and parameters to determine the nature of the network connection 
Check if the network connection is to a known and trusted destination 
Correlate the Cmstp network connection with other security events to identify any malicious behavior 
Investigate the parent process that initiated Cmstp to understand the context of the network connection","Legitimate use of Cmstp for network-related activities 
Updates or installations that involve Cmstp 
Scheduled tasks or scripts leveraging Cmstp for legitimate purposes 
Cmstp used by system administrators for authorized configurations","Image=""*\\cmstp.exe"" Initiated=""true"""
"Network Communication With Crypto Mining Pool","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects initiated network connections to crypto mining pools","attack.impact, attack.t1496","network_connection","windows","Not classified","Review the process and user context initiating the network connection 
Check if the connection is part of legitimate mining activities within the organization 
Verify if the connection is related to authorized mining software or services 
Investigate any recent changes or installations related to mining software on the system","Legitimate connections to known crypto mining pools 
Legitimate connections to mining software update servers 
Legitimate connections to mining pool management interfaces","DestinationHostname IN (""alimabi.cn"", ""ap.luckpool.net"", ""bcn.pool.minergate.com"", ""bcn.vip.pool.minergate.com"", ""bohemianpool.com"", ""ca-aipg.miningocean.org"", ""ca-dynex.miningocean.org"", ""ca-neurai.miningocean.org"", ""ca-qrl.miningocean.org"", ""ca-upx.miningocean.org"", ""ca-zephyr.miningocean.org"", ""ca.minexmr.com"", ""ca.monero.herominers.com"", ""cbd.monerpool.org"", ""cbdv2.monerpool.org"", ""cryptmonero.com"", ""crypto-pool.fr"", ""crypto-pool.info"", ""cryptonight-hub.miningpoolhub.com"", ""d1pool.ddns.net"", ""d5pool.us"", ""daili01.monerpool.org"", ""de-aipg.miningocean.org"", ""de-dynex.miningocean.org"", ""de-zephyr.miningocean.org"", ""de.minexmr.com"", ""dl.nbminer.com"", ""donate.graef.in"", ""donate.ssl.xmrig.com"", ""donate.v2.xmrig.com"", ""donate.xmrig.com"", ""donate2.graef.in"", ""drill.moneroworld.com"", ""dwarfpool.com"", ""emercoin.com"", ""emercoin.net"", ""emergate.net"", ""ethereumpool.co"", ""eu.luckpool.net"", ""eu.minerpool.pw"", ""fcn-xmr.pool.minergate.com"", ""fee.xmrig.com"", ""fr-aipg.miningocean.org"", ""fr-dynex.miningocean.org"", ""fr-neurai.miningocean.org"", ""fr-qrl.miningocean.org"", ""fr-upx.miningocean.org"", ""fr-zephyr.miningocean.org"", ""fr.minexmr.com"", ""hellominer.com"", ""herominers.com"", ""hk-aipg.miningocean.org"", ""hk-dynex.miningocean.org"", ""hk-neurai.miningocean.org"", ""hk-qrl.miningocean.org"", ""hk-upx.miningocean.org"", ""hk-zephyr.miningocean.org"", ""huadong1-aeon.ppxxmr.com"", ""iwanttoearn.money"", ""jw-js1.ppxxmr.com"", ""koto-pool.work"", ""lhr.nbminer.com"", ""lhr3.nbminer.com"", ""linux.monerpool.org"", ""lokiturtle.herominers.com"", ""luckpool.net"", ""masari.miner.rocks"", ""mine.c3pool.com"", ""mine.moneropool.com"", ""mine.ppxxmr.com"", ""mine.zpool.ca"", ""mine1.ppxxmr.com"", ""minemonero.gq"", ""miner.ppxxmr.com"", ""miner.rocks"", ""minercircle.com"", ""minergate.com"", ""minerpool.pw"", ""minerrocks.com"", ""miners.pro"", ""minerxmr.ru"", ""minexmr.cn"", ""minexmr.com"", ""mining-help.ru"", ""miningpoolhub.com"", ""mixpools.org"", ""moner.monerpool.org"", ""moner1min.monerpool.org"", ""monero-master.crypto-pool.fr"", ""monero.crypto-pool.fr"", ""monero.hashvault.pro"", ""monero.herominers.com"", ""monero.lindon-pool.win"", ""monero.miners.pro"", ""monero.riefly.id"", ""monero.us.to"", ""monerocean.stream"", ""monerogb.com"", ""monerohash.com"", ""moneroocean.stream"", ""moneropool.com"", ""moneropool.nl"", ""monerorx.com"", ""monerpool.org"", ""moriaxmr.com"", ""mro.pool.minergate.com"", ""multipool.us"", ""myxmr.pw"", ""na.luckpool.net"", ""nanopool.org"", ""nbminer.com"", ""node3.luckpool.net"", ""noobxmr.com"", ""pangolinminer.comgandalph3000.com"", ""pool.4i7i.com"", ""pool.armornetwork.org"", ""pool.cortins.tk"", ""pool.gntl.co.uk"", ""pool.hashvault.pro"", ""pool.minergate.com"", ""pool.minexmr.com"", ""pool.monero.hashvault.pro"", ""pool.ppxxmr.com"", ""pool.somec.cc"", ""pool.support"", ""pool.supportxmr.com"", ""pool.usa-138.com"", ""pool.xmr.pt"", ""pool.xmrfast.com"", ""pool2.armornetwork.org"", ""poolchange.ppxxmr.com"", ""pooldd.com"", ""poolmining.org"", ""poolto.be"", ""ppxvip1.ppxxmr.com"", ""ppxxmr.com"", ""prohash.net"", ""r.twotouchauthentication.online"", ""randomx.xmrig.com"", ""ratchetmining.com"", ""seed.emercoin.com"", ""seed.emercoin.net"", ""seed.emergate.net"", ""seed1.joulecoin.org"", ""seed2.joulecoin.org"", ""seed3.joulecoin.org"", ""seed4.joulecoin.org"", ""seed5.joulecoin.org"", ""seed6.joulecoin.org"", ""seed7.joulecoin.org"", ""seed8.joulecoin.org"", ""sg-aipg.miningocean.org"", ""sg-dynex.miningocean.org"", ""sg-neurai.miningocean.org"", ""sg-qrl.miningocean.org"", ""sg-upx.miningocean.org"", ""sg-zephyr.miningocean.org"", ""sg.minexmr.com"", ""sheepman.mine.bz"", ""siamining.com"", ""sumokoin.minerrocks.com"", ""supportxmr.com"", ""suprnova.cc"", ""teracycle.net"", ""trtl.cnpool.cc"", ""trtl.pool.mine2gether.com"", ""turtle.miner.rocks"", ""us-aipg.miningocean.org"", ""us-dynex.miningocean.org"", ""us-neurai.miningocean.org"", ""us-west.minexmr.com"", ""us-zephyr.miningocean.org"", ""usxmrpool.com"", ""viaxmr.com"", ""webservicepag.webhop.net"", ""xiazai.monerpool.org"", ""xiazai1.monerpool.org"", ""xmc.pool.minergate.com"", ""xmo.pool.minergate.com"", ""xmr-asia1.nanopool.org"", ""xmr-au1.nanopool.org"", ""xmr-eu1.nanopool.org"", ""xmr-eu2.nanopool.org"", ""xmr-jp1.nanopool.org"", ""xmr-us-east1.nanopool.org"", ""xmr-us-west1.nanopool.org"", ""xmr-us.suprnova.cc"", ""xmr-usa.dwarfpool.com"", ""xmr.2miners.com"", ""xmr.5b6b7b.ru"", ""xmr.alimabi.cn"", ""xmr.bohemianpool.com"", ""xmr.crypto-pool.fr"", ""xmr.crypto-pool.info"", ""xmr.f2pool.com"", ""xmr.hashcity.org"", ""xmr.hex7e4.ru"", ""xmr.ip28.net"", ""xmr.monerpool.org"", ""xmr.mypool.online"", ""xmr.nanopool.org"", ""xmr.pool.gntl.co.uk"", ""xmr.pool.minergate.com"", ""xmr.poolto.be"", ""xmr.ppxxmr.com"", ""xmr.prohash.net"", ""xmr.simka.pw"", ""xmr.somec.cc"", ""xmr.suprnova.cc"", ""xmr.usa-138.com"", ""xmr.vip.pool.minergate.com"", ""xmr1min.monerpool.org"", ""xmrf.520fjh.org"", ""xmrf.fjhan.club"", ""xmrfast.com"", ""xmrigcc.graef.in"", ""xmrminer.cc"", ""xmrpool.de"", ""xmrpool.eu"", ""xmrpool.me"", ""xmrpool.net"", ""xmrpool.xyz"", ""xx11m.monerpool.org"", ""xx11mv2.monerpool.org"", ""xxx.hex7e4.ru"", ""zarabotaibitok.ru"", ""zer0day.ru"")"
"Potential Dead Drop Resolvers","Sorina Ionescu, X__Junior (Nextron Systems)","Detects an executable, which is not an internet browser or known application, initiating network connections to legit popular websites, which were seen to be used as dead drop resolvers in previous attacks.
In this context attackers leverage known websites such as ""facebook"", ""youtube"", etc. In order to pass through undetected.
","attack.command_and_control, attack.t1102, attack.t1102.001","network_connection","windows","Not classified","Review the process image path and destination hostname to determine if the connection is suspicious. 
Check the reputation of the process and destination hostname using threat intelligence feeds. 
Analyze the frequency and volume of connections to these popular websites for anomalies. 
Correlate network connection events with other security events to identify potential malicious behavior.","Legitimate applications accessing the listed popular websites for normal operations. 
Automated update mechanisms of known applications may trigger connections to these websites. 
Cloud-based services or legitimate tools using these websites for communication. 
Whitelisted tools or scripts that have a legitimate reason to connect to these websites.","Initiated=""true"" DestinationHostname IN (""*.t.me"", ""*4shared.com"", ""*anonfiles.com"", ""*cdn.discordapp.com"", ""*cloudflare.com"", ""*ddns.net"", ""*discord.com"", ""*docs.google.com"", ""*drive.google.com"", ""*dropbox.com"", ""*dropmefiles.com"", ""*facebook.com"", ""*feeds.rapidfeeds.com"", ""*fotolog.com"", ""*ghostbin.co/"", ""*githubusercontent.com"", ""*gofile.io"", ""*hastebin.com"", ""*imgur.com"", ""*livejournal.com"", ""*mediafire.com"", ""*mega.co.nz"", ""*mega.nz"", ""*onedrive.com"", ""*paste.ee"", ""*pastebin.com"", ""*pastebin.pl"", ""*pastetext.net"", ""*privatlab.com"", ""*privatlab.net"", ""*reddit.com"", ""*send.exploit.in"", ""*sendspace.com"", ""*steamcommunity.com"", ""*storage.googleapis.com"", ""*technet.microsoft.com"", ""*temp.sh"", ""*transfer.sh"", ""*twitter.com"", ""*ufile.io"", ""*abuse.ch"", ""*vimeo.com"", ""*wetransfer.com"", ""*youtube.com"") NOT (Image IN (""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"", ""C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"") OR (Image=""C:\\Users\\*"" Image=""*\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe"") OR Image IN (""C:\\Program Files\\Mozilla Firefox\\firefox.exe"", ""C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"") OR (Image=""C:\\Users\\*"" Image=""*\\AppData\\Local\\Mozilla Firefox\\firefox.exe"") OR Image IN (""C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe"", ""C:\\Program Files\\Internet Explorer\\iexplore.exe"") OR Image=""C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\*"" OR Image=""*\\WindowsApps\\MicrosoftEdge.exe"" OR Image IN (""C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"", ""C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"") OR (Image IN (""C:\\Program Files (x86)\\Microsoft\\EdgeCore\\*"", ""C:\\Program Files\\Microsoft\\EdgeCore\\*"") Image IN (""*\\msedge.exe"", ""*\\msedgewebview2.exe"")) OR (Image IN (""*C:\\Program Files (x86)\\Safari\\*"", ""*C:\\Program Files\\Safari\\*"") Image=""*\\safari.exe"") OR (Image IN (""*C:\\Program Files\\Windows Defender Advanced Threat Protection\\*"", ""*C:\\Program Files\\Windows Defender\\*"", ""*C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\*"") Image IN (""*\\MsMpEng.exe"", ""*\\MsSense.exe"")) OR Image IN (""*C:\\Program Files (x86)\\PRTG Network Monitor\\PRTG Probe.exe"", ""*C:\\Program Files\\PRTG Network Monitor\\PRTG Probe.exe"") OR (Image=""C:\\Program Files\\BraveSoftware\\*"" Image=""*\\brave.exe"") OR (Image=""*\\AppData\\Local\\Maxthon\\*"" Image=""*\\maxthon.exe"") OR (Image=""*\\AppData\\Local\\Programs\\Opera\\*"" Image=""*\\opera.exe"") OR (Image IN (""C:\\Program Files\\SeaMonkey\\*"", ""C:\\Program Files (x86)\\SeaMonkey\\*"") Image=""*\\seamonkey.exe"") OR (Image=""*\\AppData\\Local\\Vivaldi\\*"" Image=""*\\vivaldi.exe"") OR (Image IN (""C:\\Program Files\\Naver\\Naver Whale\\*"", ""C:\\Program Files (x86)\\Naver\\Naver Whale\\*"") Image=""*\\whale.exe"") OR (Image IN (""C:\\Program Files\\Waterfox\\*"", ""C:\\Program Files (x86)\\Waterfox\\*"") Image=""*\\Waterfox.exe"") OR (Image=""*\\AppData\\Local\\Programs\\midori-ng\\*"" Image=""*\\Midori Next Generation.exe"") OR (Image IN (""C:\\Program Files\\SlimBrowser\\*"", ""C:\\Program Files (x86)\\SlimBrowser\\*"") Image=""*\\slimbrowser.exe"") OR (Image=""*\\AppData\\Local\\Flock\\*"" Image=""*\\Flock.exe"") OR (Image=""*\\AppData\\Local\\Phoebe\\*"" Image=""*\\Phoebe.exe"") OR (Image IN (""C:\\Program Files\\Falkon\\*"", ""C:\\Program Files (x86)\\Falkon\\*"") Image=""*\\falkon.exe"") OR (Image IN (""C:\\Program Files (x86)\\QtWeb\\*"", ""C:\\Program Files\\QtWeb\\*"") Image=""*\\QtWeb.exe"") OR (Image IN (""C:\\Program Files (x86)\\Avant Browser\\*"", ""C:\\Program Files\\Avant Browser\\*"") Image=""*\\avant.exe"") OR (Image IN (""C:\\Program Files (x86)\\WindowsApps\\*"", ""C:\\Program Files\\WindowsApps\\*"") Image=""*\\WhatsApp.exe"" DestinationHostname=""*facebook.com"") OR (Image=""*\\AppData\\Roaming\\Telegram Desktop\\*"" Image=""*\\Telegram.exe"" DestinationHostname=""*.t.me"") OR (Image=""*\\AppData\\Local\\Microsoft\\OneDrive\\*"" Image=""*\\OneDrive.exe"" DestinationHostname=""*onedrive.com"") OR (Image IN (""C:\\Program Files (x86)\\Dropbox\\Client\\*"", ""C:\\Program Files\\Dropbox\\Client\\*"") Image IN (""*\\Dropbox.exe"", ""*\\DropboxInstaller.exe"") DestinationHostname=""*dropbox.com"") OR (Image IN (""*\\MEGAsync.exe"", ""*\\MEGAsyncSetup32_*RC.exe"", ""*\\MEGAsyncSetup32.exe"", ""*\\MEGAsyncSetup64.exe"", ""*\\MEGAupdater.exe"") DestinationHostname IN (""*mega.co.nz"", ""*mega.nz"")) OR (Image IN (""*C:\\Program Files\\Google\\Drive File Stream\\*"", ""*C:\\Program Files (x86)\\Google\\Drive File Stream\\*"") Image=""*GoogleDriveFS.exe"" DestinationHostname=""*drive.google.com"") OR (Image=""*\\AppData\\Local\\Discord\\*"" Image=""*\\Discord.exe"" DestinationHostname IN (""*discord.com"", ""*cdn.discordapp.com"")))"
"Suspicious Dropbox API Usage","Florian Roth (Nextron Systems)","Detects an executable that isn't dropbox but communicates with the Dropbox API","attack.command_and_control, attack.t1105","network_connection","windows","Not classified","Check the process reputation and known behavior of the executable communicating with Dropbox API 
Verify if the communication with Dropbox API is part of a sanctioned activity within the organization 
Analyze the network traffic to understand the nature of data being exchanged with Dropbox API 
Cross-reference the executable with threat intelligence feeds to identify any malicious indicators","Legitimate use of Dropbox API by authorized applications 
Use of legitimate Dropbox-related tools 
Use of Dropbox API by known security tools","Initiated=""true"" DestinationHostname IN (""*api.dropboxapi.com"", ""*content.dropboxapi.com"") NOT Image=""*\\Dropbox*"""
"Microsoft Binary Suspicious Communication Endpoint","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects executables located in potentially suspicious directories initiating network connections towards file sharing domains.","attack.command_and_control, attack.t1105","network_connection","windows","Not classified","Review the process and parent process to determine if the communication is initiated by a legitimate executable. 
Check if the communication is part of a known software update or installation process. 
Investigate the reputation and purpose of the destination domain to assess the legitimacy of the communication. 
Correlate the network connection with other security events to identify any malicious behavior or indicators of compromise.","Legitimate software updates or installations that use temporary directories to communicate with file sharing domains. 
Scheduled tasks or system processes that interact with the listed domains for legitimate purposes. 
Development tools or scripts that may trigger false positives due to their nature of communication with these domains. 
Cloud-based applications or services that utilize the mentioned file sharing domains for legitimate data transfer.","Image IN (""*:\\PerfLogs\\*"", ""*:\\Temp\\*"", ""*:\\Users\\Public\\*"", ""*:\\Windows\\System32\\Tasks\\*"", ""*:\\Windows\\Tasks\\*"", ""*:\\Windows\\Temp\\*"", ""*\\AppData\\Temp\\*"") Initiated=""true"" DestinationHostname IN (""*.githubusercontent.com"", ""*anonfiles.com"", ""*cdn.discordapp.com"", ""*cdn.discordapp.com/attachments/"", ""*ddns.net"", ""*dl.dropboxusercontent.com"", ""*ghostbin.co"", ""*glitch.me"", ""*gofile.io"", ""*hastebin.com"", ""*mediafire.com"", ""*mega.co.nz"", ""*mega.nz"", ""*onrender.com"", ""*paste.ee"", ""*pastebin.com"", ""*pastebin.pl"", ""*pastetext.net"", ""*privatlab.com"", ""*privatlab.net"", ""*send.exploit.in"", ""*sendspace.com"", ""*storage.googleapis.com"", ""*storjshare.io"", ""*supabase.co"", ""*temp.sh"", ""*transfer.sh"", ""*ufile.io"")"
"Potentially Suspicious Malware Callback Communication","Florian Roth (Nextron Systems)","Detects programs that connect to known malware callback ports based on statistical analysis from two different sandbox system databases
","attack.persistence, attack.command_and_control, attack.t1571","network_connection","windows","Not classified","Verify the process initiating the connection to determine if it is a known legitimate software 
Check if the destination IP address is within the internal network range 
Review the process image path to confirm if it belongs to a trusted system directory 
Cross-reference the destination port with known business applications to rule out false positives","Legitimate software using non-standard ports may trigger false positives 
Internal security tools or monitoring systems may trigger alerts 
Legitimate connections to specific ports for business purposes may be flagged incorrectly"
"Suspicious Outbound Kerberos Connection","Ilyas Ochkov, oscd.community","Detects suspicious outbound network activity via kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.","attack.credential_access, attack.t1558, attack.lateral_movement, attack.t1550.003","network_connection","windows","Not classified","Review the network traffic logs to identify the source and destination of the Kerberos connection 
Check if the Kerberos traffic is part of a known legitimate operation or communication 
Correlate the Kerberos connection with other security events or logs to determine the context of the activity 
Inspect the processes running on the systems involved in the suspicious Kerberos connection","Legitimate Kerberos traffic within the network 
Scheduled tasks or legitimate applications using Kerberos authentication 
Network devices or services that rely on Kerberos for authentication","DestinationPort=88 Initiated=""true"" NOT (Image IN (""C:\\Windows\\System32\\lsass.exe"", ""C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"", ""C:\\Program Files\\Mozilla Firefox\\firefox.exe""))"
"Suspicious Program Location with Network Connections","Florian Roth (Nextron Systems), Tim Shelton","Detects programs with network connections running in suspicious files system locations","attack.command_and_control, attack.t1105","network_connection","windows","Not classified","Check if the program in the suspicious location is a known legitimate software 
Analyze the network connections made by the program for any malicious activity 
Verify if the files in the suspicious location are related to system processes or user activity 
Investigate if there are any scheduled tasks or scripts triggering the program in the suspicious location","Legitimate software installed in system folders 
Temporary files created by system processes 
Updates or installations from trusted sources","Image IN (""*:\\$Recycle.bin*"", ""*:\\Perflogs\\*"", ""*:\\Users\\Default\\*"", ""*:\\Users\\Public\\*"", ""*:\\Windows\\Fonts\\*"", ""*:\\Windows\\IME\\*"", ""*\\config\\systemprofile\\*"", ""*\\Windows\\addins\\*"") NOT Image=""*:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\*"""
"Potential Remote PowerShell Session Initiated","Roberto Rodriguez @Cyb3rWard0g","Detects a process that initiated a network connection over ports 5985 or 5986 from a non-network service account.
This could potentially indicates a remote PowerShell connection.
","attack.execution, attack.t1059.001, attack.lateral_movement, attack.t1021.006","network_connection","windows","Not classified","Review the process command line arguments and parent process to determine the intent of the remote PowerShell session 
Check for any scheduled tasks or scripts that may be triggering the detection 
Investigate the network traffic to understand the nature of the connection and validate if it aligns with legitimate use cases 
Correlate the event with other security logs to identify any suspicious activities or indicators of compromise","Scheduled tasks or scripts legitimately using remote PowerShell 
Third-party applications or services that utilize remote PowerShell for management 
Network monitoring tools that establish remote PowerShell connections","DestinationPort IN (5985, 5986) Initiated=""true"" SourceIsIpv6=""false"" NOT (User IN (""*NETWORK SERVICE*"", ""*NETZWERKDIENST*"", ""*SERVICIO DE RED*"", ""*SERVIZIO DI RETE*"") OR (User=""*SERVICE R*"" User=""*SEAU*"") OR (SourceIp IN (""::1"", ""127.0.0.1"") DestinationIp IN (""::1"", ""127.0.0.1""))) NOT (Image IN (""C:\\Program Files\\Avast Software\\Avast\\AvastSvc.exe"", ""C:\\Program Files (x86)\\Avast Software\\Avast\\AvastSvc.exe""))"
"CobaltStrike Named Pipe","Florian Roth (Nextron Systems), Wojciech Lesicki","Detects the creation of a named pipe as used by CobaltStrike","attack.defense_evasion, attack.privilege_escalation, attack.t1055","pipe_created","windows","Not classified","Verify the legitimacy of the named pipe creation by correlating with authorized activities or known applications 
Check for any administrative scripts or tools that may be responsible for creating the named pipe 
Review security tool logs to identify any interactions with named pipes that could have triggered the alert 
Compare the named pipe creation with baseline data to determine if it deviates from normal behavior","Legitimate use of named pipes by other applications 
Legitimate administrative activities 
False alarms triggered by security tools interacting with named pipes","(PipeName=""*\\MSSE-*"" PipeName=""*-server*"") OR PipeName=""\\postex_*"" OR PipeName=""\\status_*"" OR PipeName=""\\msagent_*"" OR PipeName=""\\mojo_*"" OR PipeName=""\\interprocess_*"" OR PipeName=""\\samr_*"" OR PipeName=""\\netlogon_*"" OR PipeName=""\\srvsvc_*"" OR PipeName=""\\lsarpc_*"" OR PipeName=""\\wkssvc_*"""
"CobaltStrike Named Pipe Pattern Regex","Florian Roth (Nextron Systems)","Detects the creation of a named pipe matching a pattern used by CobaltStrike Malleable C2 profiles","attack.defense_evasion, attack.privilege_escalation, attack.t1055","pipe_created","windows","Not classified","Verify the process that created the named pipe to determine if it is a legitimate action 
Check if the named pipe creation aligns with any known software installations or updates 
Investigate the system for signs of CobaltStrike activity beyond just the named pipe creation 
Compare the named pipe pattern with historical data to identify any recurring false positives","Legitimate software or system processes may create named pipes that match the pattern 
Development or testing environments may trigger false positives 
Third-party applications or security tools may generate similar named pipes 
Legacy systems or applications might use naming conventions that trigger the rule"
"CobaltStrike Named Pipe Patterns","Florian Roth (Nextron Systems), Christian Burkard (Nextron Systems)","Detects the creation of a named pipe with a pattern found in CobaltStrike malleable C2 profiles","attack.defense_evasion, attack.privilege_escalation, attack.t1055, stp.1k","pipe_created","windows","Not classified","Review the process creating the named pipe to determine if it is a known legitimate process or a suspicious one 
Check if the named pipe is associated with any known applications or services in the environment 
Analyze the network traffic associated with the named pipe for any anomalous behavior or communication patterns 
Correlate the creation of the named pipe with other security events or indicators of compromise to assess the potential threat level","Legitimate applications or services using pipe names similar to CobaltStrike patterns 
Development or testing environments creating named pipes resembling CobaltStrike patterns 
Third-party security tools or monitoring agents generating false positives due to pipe naming conventions","PipeName IN (""\\DserNamePipe*"", ""\\f4c3*"", ""\\f53f*"", ""\\fullduplex_*"", ""\\mojo.5688.8052.183894939787088877*"", ""\\mojo.5688.8052.35780273329370473*"", ""\\MsFteWds*"", ""\\msrpc_*"", ""\\mypipe-f*"", ""\\mypipe-h*"", ""\\ntsvcs*"", ""\\PGMessagePipe*"", ""\\rpc_*"", ""\\scerpc*"", ""\\SearchTextHarvester*"", ""\\spoolss*"", ""\\win_svc*"", ""\\win\\msrpc_*"", ""\\windows.update.manager*"", ""\\wkssvc*"") OR PipeName IN (""\\demoagent_11"", ""\\demoagent_22"") OR (PipeName=""\\Winsock2\\CatalogChangeListener-*"" PipeName=""*-0,"") NOT (PipeName IN (""\\wkssvc"", ""\\spoolss"", ""\\scerpc"", ""\\ntsvcs"", ""\\SearchTextHarvester"", ""\\PGMessagePipe"", ""\\MsFteWds"")) NOT (Image IN (""*:\\Program Files\\Websense\\*"", ""*:\\Program Files (x86)\\Websense\\*"") PipeName IN (""\\DserNamePipeR*"", ""\\DserNamePipeW*""))"
"HackTool - Credential Dumping Tools Named Pipe Created","Teymur Kheirkhabarov, oscd.community","Detects well-known credential dumping tools execution via specific named pipe creation","attack.credential_access, attack.t1003.001, attack.t1003.002, attack.t1003.004, attack.t1003.005","pipe_created","windows","Not classified","Check if the named pipe creation was triggered by a known legitimate tool or process 
Review the activity of the user associated with the named pipe creation 
Correlate with other security events to determine if there are signs of malicious activity 
Verify the purpose of the named pipe creation with the system or network administrators","Legitimate Administrator using password recovery tools 
Legitimate system administration activities 
Backup software creating named pipes 
Legitimate software using named pipes for communication","PipeName IN (""*\\cachedump*"", ""*\\lsadump*"", ""*\\wceservicepipe*"")"
"Malicious Named Pipe Created","Florian Roth (Nextron Systems), blueteam0ps, elhoim","Detects the creation of a named pipe seen used by known APTs or malware.","attack.defense_evasion, attack.privilege_escalation, attack.t1055","pipe_created","windows","Not classified","Verify the process that created the named pipe to determine if it is a known legitimate process 
Check if the named pipe creation aligns with any scheduled tasks or known system activities 
Analyze the network traffic associated with the named pipe for any suspicious behavior 
Cross-reference the named pipe creation with endpoint and network logs for additional context","Legitimate software or system processes may create named pipes that match the detection criteria 
Development or testing environments may use named pipes that trigger the detection 
Certain security tools or monitoring agents may also create named pipes that could be flagged","PipeName IN (""\\46a676ab7f179e511e30dd2dc41bd388"", ""\\583da945-62af-10e8-4902-a8f205c72b2e"", ""\\6e7645c4-32c5-4fe3-aabf-e94c2f4370e7"", ""\\9f81f59bc58452127884ce513865ed20"", ""\\adschemerpc"", ""\\ahexec"", ""\\AnonymousPipe"", ""\\bc31a7"", ""\\bc367"", ""\\bizkaz"", ""\\csexecsvc"", ""\\dce_3d"", ""\\e710f28d59aa529d6792ca6ff0ca1b34"", ""\\gruntsvc"", ""\\isapi_dg"", ""\\isapi_dg2"", ""\\isapi_http"", ""\\jaccdpqnvbrrxlaf"", ""\\lsassw"", ""\\NamePipe_MoreWindows"", ""\\pcheap_reuse"", ""\\Posh*"", ""\\rpchlp_3"", ""\\sdlrpc"", ""\\svcctl"", ""\\testPipe"", ""\\winsession"")"
"CMSTP Execution Process Access","Nik Seetharaman","Detects various indicators of Microsoft Connection Manager Profile Installer execution","attack.defense_evasion, attack.t1218.003, attack.execution, attack.t1559.001, attack.g0069, attack.g0080, car.2019-04-001","process_access","windows","Not classified","Check if the CMSTP execution was part of a legitimate software installation process 
Review the context of the cmlua.dll call to determine if it was triggered by a known application or script 
Verify if the CMSTP execution was authorized and expected in the environment 
Investigate if there are any documented procedures or tickets related to the CMSTP activity","Legitimate use of CMSTP in specific enterprise environments where it is a sanctioned tool 
Use of cmlua.dll in non-malicious activities 
Known software or scripts that may trigger cmlua.dll calls 
Legitimate software installation processes that involve CMSTP","CallTrace=""*cmlua.dll*"""
"HackTool - CobaltStrike BOF Injection Pattern","Christian Burkard (Nextron Systems)","Detects a typical pattern of a CobaltStrike BOF which inject into other processes","attack.execution, attack.t1106, attack.defense_evasion, attack.t1562.001","process_access","windows","Not classified","Verify the activity with authorized red teaming or penetration testing teams to confirm the use of CobaltStrike 
Check if the behavior is associated with known legitimate software or system processes 
Review the regular expression used in the detection to understand its complexity and potential for false positives 
Correlate the alert with other security events or logs to determine the context of the activity","Legitimate use of process injection tools like CobaltStrike for authorized red teaming or penetration testing activities 
Legitimate software or system processes that may exhibit similar behavior 
False positives may occur due to the complexity of the regular expression used in the detection","GrantedAccess IN (""0x1028"", ""0x1fffff"")\"
"HackTool - HandleKatz Duplicating LSASS Handle","Bhabesh Raj (rule), @thefLinkk","Detects HandleKatz opening LSASS to duplicate its handle to later dump the memory without opening any new handles","attack.execution, attack.t1106, attack.defense_evasion, attack.t1003.001","process_access","windows","Not classified","Check for legitimate tools or applications that may trigger the detection 
Review recent software installations or updates that involve LSASS 
Correlate the detection with scheduled maintenance tasks or known system activities involving LSASS","Legitimate use of tools or applications that mimic the behavior of HandleKatz 
Upgrades or installations of software that interact with LSASS 
Scheduled system maintenance tasks that involve LSASS","TargetImage=""*\\lsass.exe"" GrantedAccess=""0x1440"" CallTrace=""C:\\Windows\\System32\\ntdll.dll+*"" CallTrace=""*|UNKNOWN(*"" CallTrace=""*)"""
"HackTool - LittleCorporal Generated Maldoc Injection","Christian Burkard (Nextron Systems)","Detects the process injection of a LittleCorporal generated Maldoc.","attack.execution, attack.t1204.002, attack.t1055.003","process_access","windows","Not classified","Review the process tree to understand the parent-child relationships and identify any suspicious behavior 
Analyze the network traffic originating from the affected host to detect any communication with malicious domains or IPs 
Inspect the registry for any changes related to the injected process or associated malware artifacts 
Check for any unusual file modifications or creations in critical system directories","Legitimate use of process injection tools for authorized activities 
Upgrades or installations of software that mimic malicious behavior 
Use of legitimate tools that may trigger similar process injection patterns","SourceImage=""*\\winword.exe"" CallTrace=""*:\\Windows\\Microsoft.NET\\Framework64\\v2.*"" CallTrace=""*UNKNOWN*"""
"HackTool - SysmonEnte Execution","Florian Roth (Nextron Systems)","Detects the use of SysmonEnte, a tool to attack the integrity of Sysmon","attack.defense_evasion, attack.t1562.002","process_access","windows","Not classified","Review the process execution logs to determine the context of SysmonEnte activity 
Check for legitimate use of Sysmon or similar tools in the environment 
Verify the integrity of Sysmon binaries and configurations 
Investigate any security tools or scripts that may be interacting with Sysmon","Legitimate use of Sysmon for system monitoring and security purposes 
Legitimate software with similar behavior to SysmonEnte 
Misconfigured or non-standard system configurations 
Security tools or scripts that interact with Sysmon","(TargetImage IN (""*:\\Windows\\Sysmon.exe*"", ""*:\\Windows\\Sysmon64.exe*"") GrantedAccess=""0x1400"" NOT (SourceImage IN (""*:\\Program Files (x86)\\*"", ""*:\\Program Files\\*"", ""*:\\Windows\\System32\\*"", ""*:\\Windows\\SysWOW64\\*"") OR (SourceImage=""*:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\*"" SourceImage=""*\\MsMpEng.exe""))) OR CallTrace=""Ente"""
"Lsass Memory Dump via Comsvcs DLL","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Detects adversaries leveraging the MiniDump export function from comsvcs.dll via rundll32 to perform a memory dump from lsass.","attack.credential_access, attack.t1003.001","process_access","windows","Not classified","Review the command-line arguments of rundll32.exe to identify the specific function being called 
Check the process tree to understand the parent process of rundll32.exe and its relationship with comsvcs.dll 
Analyze the memory dump files created to determine if they contain sensitive information or if they are related to legitimate operations 
Correlate the activity with other security events or logs to establish a broader context of the potential threat","Legitimate use of rundll32.exe to access comsvcs.dll for valid system operations 
Legitimate memory dump operations initiated by system administrators or security tools 
Software installations or updates that involve comsvcs.dll and rundll32.exe 
Scheduled tasks or scripts that interact with lsass.exe for authorized purposes","TargetImage=""*\\lsass.exe"" SourceImage=""*\\rundll32.exe"" CallTrace=""*comsvcs.dll*"""
"LSASS Memory Access by Tool With Dump Keyword In Name","Florian Roth (Nextron Systems)","Detects LSASS process access requests from a source process with the ""dump"" keyword in its image name.","attack.credential_access, attack.t1003.001, attack.s0002","process_access","windows","Not classified","Check the source process to determine if it is a known legitimate tool or software 
Review the access permissions requested to understand the potential impact 
Correlate with other security events to identify any suspicious behavior or patterns 
Investigate the context of the access request to LSASS for further insights","Legitimate system administration tools that have 'dump' in their name 
Backup software that interacts with LSASS 
Security tools that perform memory analysis and have 'dump' in their name","TargetImage=""*\\lsass.exe"" SourceImage=""*dump*"" GrantedAccess IN (""*10"", ""*30"", ""*50"", ""*70"", ""*90"", ""*B0"", ""*D0"", ""*F0"", ""*18"", ""*38"", ""*58"", ""*78"", ""*98"", ""*B8"", ""*D8"", ""*F8"", ""*1A"", ""*3A"", ""*5A"", ""*7A"", ""*9A"", ""*BA"", ""*DA"", ""*FA"", ""*0x14C2"", ""*FF"")"
"Credential Dumping Activity By Python Based Tool","Bhabesh Raj, Jonhnathan Ribeiro","Detects LSASS process access for potential credential dumping by a Python-like tool such as LaZagne or Pypykatz.","attack.credential_access, attack.t1003.001, attack.s0349","process_access","windows","Not classified","Review the process command line arguments and parent process to determine the context of LSASS access 
Check if the Python-like tool being used is part of authorized security operations or red team exercises 
Correlate with other security events to identify any suspicious behavior or indicators of compromise 
Verify the integrity of the LSASS process and investigate any anomalies in its behavior","Legitimate use of Python scripts accessing LSASS for authorized purposes 
Legitimate use of tools like LaZagne or Pypykatz for security testing or forensic analysis 
False positives due to Python development environments interacting with LSASS","TargetImage=""*\\lsass.exe"" CallTrace=""*_ctypes.pyd+*"" CallTrace=""*:\\Windows\\System32\\KERNELBASE.dll+*"" CallTrace=""*:\\Windows\\SYSTEM32\\ntdll.dll+*"" CallTrace IN (""*python27.dll+*"", ""*python3*.dll+*"") GrantedAccess=""0x1FFFFF"""
"Remote LSASS Process Access Through Windows Remote Management","Patryk Prauze - ING Tech","Detects remote access to the LSASS process via WinRM. This could be a sign of credential dumping from tools like mimikatz.","attack.credential_access, attack.execution, attack.t1003.001, attack.t1059.001, attack.lateral_movement, attack.t1021.006, attack.s0002","process_access","windows","Not classified","Check if the remote access to LSASS was part of a scheduled administrative task 
Review the activity of the source and target systems for any legitimate reasons for the remote LSASS access 
Verify if any security tools or agents were responsible for the remote LSASS access 
Correlate the event with other security events to determine the context of the access","Legitimate use of WinRM for administrative purposes 
Scheduled tasks or scripts accessing LSASS remotely 
Antivirus or EDR tools performing scans on LSASS remotely","TargetImage=""*\\lsass.exe"" SourceImage=""*:\\Windows\\system32\\wsmprovhost.exe"" NOT GrantedAccess=""0x80000000"""
"Suspicious LSASS Access Via MalSecLogon","Samir Bousseaden (original elastic rule), Nasreddine Bencherchali (Nextron Systems)","Detects suspicious access to LSASS handle via a call trace to ""seclogon.dll"" with a suspicious access right.","attack.credential_access, attack.t1003.001","process_access","windows","Not classified","Verify the legitimacy of the process accessing LSASS and the access rights granted 
Check if the call trace to seclogon.dll is part of a known system operation or software installation 
Investigate if any custom applications or scripts are interacting with LSASS and triggering this detection 
Correlate with other security events to determine the context of the suspicious access","Legitimate use of seclogon.dll by trusted system processes 
Upgrades or installations of certain software may trigger this detection 
Custom applications or scripts that interact with LSASS may also trigger this rule","TargetImage=""*\\lsass.exe"" SourceImage=""*\\svchost.exe"" GrantedAccess=""0x14c0"" CallTrace=""*seclogon.dll*"""
"Credential Dumping Attempt Via WerFault","Florian Roth (Nextron Systems)","Detects process LSASS memory dump using Mimikatz, NanoDump, Invoke-Mimikatz, Procdump or Taskmgr based on the CallTrace pointing to ntdll.dll, dbghelp.dll or dbgcore.dll for win10, server2016 and up.","attack.credential_access, attack.t1003.001, attack.s0002","process_access","windows","Not classified","Check if the lsass.exe process is actually being targeted for memory dumping by a malicious tool like Mimikatz 
Investigate the source of the WerFault.exe process and its behavior towards lsass.exe 
Look for any abnormal access permissions granted to WerFault.exe on lsass.exe 
Correlate the event with other suspicious activities on the system for a broader context","Legitimate crash dumps triggered by system failures 
Legitimate WerFault activity on lsass.exe during system updates","SourceImage=""*\\WerFault.exe"" TargetImage=""*\\lsass.exe"" GrantedAccess=""0x1FFFFF"""
"LSASS Access From Potentially White-Listed Processes","Florian Roth (Nextron Systems)","Detects a possible process memory dump that uses a white-listed filename like TrolleyExpress.exe as a way to dump the LSASS process memory without Microsoft Defender interference
","attack.credential_access, attack.t1003.001, attack.s0002","process_access","windows","Not classified","Review the context of the event to determine if the process behavior is part of a known and approved activity 
Check if the process accessing LSASS memory is a legitimate system process or a known whitelisted application 
Correlate the event with additional data sources such as endpoint logs, network logs, or threat intelligence feeds to identify any malicious indicators 
Conduct a memory analysis or forensic investigation on the affected system to validate the presence of any malicious activity","Legitimate system administration tools or processes may use similar techniques for valid purposes 
Security tools or EDR solutions may trigger similar events during authorized activities 
Certain software installations or updates may exhibit behavior similar to LSASS memory dump without malicious intent 
Custom scripts or applications developed internally may trigger false positives","TargetImage=""*\\lsass.exe"" SourceImage IN (""*\\TrolleyExpress.exe"", ""*\\ProcessDump.exe"", ""*\\dump64.exe"") GrantedAccess IN (""*10"", ""*30"", ""*50"", ""*70"", ""*90"", ""*B0"", ""*D0"", ""*F0"", ""*18"", ""*38"", ""*58"", ""*78"", ""*98"", ""*B8"", ""*D8"", ""*F8"", ""*1A"", ""*3A"", ""*5A"", ""*7A"", ""*9A"", ""*BA"", ""*DA"", ""*FA"", ""*0x14C2"", ""*FF"")"
"Potential Shellcode Injection","Bhabesh Raj","Detects potential shellcode injection used by tools such as Metasploit's migrate and Empire's psinject","attack.defense_evasion, attack.privilege_escalation, attack.t1055","process_access","windows","Not classified","Verify if the detected activity corresponds to a known legitimate use of Metasploit or Empire tools 
Check if the process access patterns align with expected behavior for software installations 
Investigate if the activity is related to legitimate privilege escalation activities 
Analyze if the process access patterns are consistent with known legitimate activities","Legitimate use of Metasploit or Empire tools 
Legitimate software installations that match the filter criteria 
Legitimate privilege escalation activities 
Legitimate process access patterns","GrantedAccess IN (""0x147a"", ""0x1f3fff"") CallTrace=""*UNKNOWN*"" NOT ((SourceImage IN (""*:\\Program Files\\Dell\\*"", ""*:\\Program Files (x86)\\Dell\\*"") TargetImage IN (""*:\\Program Files\\Dell\\*"", ""*:\\Program Files (x86)\\Dell\\*"") GrantedAccess=""0x1F3FFF"" CallTrace=""*:\\Windows\\System32\\ntdll.dll*"") OR (SourceImage=""*:\\Program Files (x86)\\Dell\\UpdateService\\ServiceShell.exe"" TargetImage=""*:\\Windows\\Explorer.EXE"" GrantedAccess=""0x1F3FFF"" CallTrace=""*:\\Windows\\System32\\ntdll.dll*"") OR (SourceImage IN (""*:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\PerfWatson2.exe"", ""*:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\PerfWatson2.exe"") TargetImage IN (""*:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\devenv.exe"", ""*:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\devenv.exe"") CallTrace=""*:\\Windows\\System32\\ntdll.dll*"") OR (SourceImage=""*:\\Program Files\\Microsoft Visual Studio\\*"" SourceImage=""*\\MSBuild\\Current\\Bin\\MSBuild.exe"" TargetImage=""*:\\Program Files\\Dell\\DellDataVault\\DDVDataCollector.exe"") OR (SourceImage=""*:\\Windows\\System32\\Wbem\\Wmiprvse.exe"" TargetImage=""*:\\Windows\\system32\\lsass.exe"" CallTrace=""*:\\Windows\\SYSTEM32\\ntdll.dll*""))"
"Credential Dumping Attempt Via Svchost","Florent Labouyrie","Detects when a process tries to access the memory of svchost to potentially dump credentials.","attack.t1548","process_access","windows","Not classified","Review the process tree to understand the parent process of the svchost access 
Check the command line arguments of the process accessing svchost 
Analyze the network connections or file system activity of the process for any suspicious behavior 
Correlate the event with other security events on the system for context","Legitimate tools or scripts accessing svchost for valid reasons 
Updates or patches being applied to the system 
Scheduled tasks or system services interacting with svchost","TargetImage=""*\\svchost.exe"" GrantedAccess=""0x143a"" NOT (SourceImage IN (""*\\services.exe"", ""*\\msiexec.exe""))"
"Suspicious Svchost Process Access","Tim Burrell","Detects suspicious access to the ""svchost"" process such as that used by Invoke-Phantom to kill the thread of the Windows event logging service.","attack.defense_evasion, attack.t1562.002","process_access","windows","Not classified","Check if the access to svchost.exe was triggered by a known administrative action 
Review system logs for legitimate software installations or updates that may have accessed svchost.exe 
Analyze scheduled tasks or scripts that interact with svchost.exe for any authorized activity","Legitimate administrative or system processes accessing svchost.exe 
Updates or patches triggering access to svchost.exe 
Scheduled tasks or scripts interacting with svchost.exe","TargetImage=""*:\\Windows\\System32\\svchost.exe"" GrantedAccess=""0x1F3FFF"" CallTrace=""*UNKNOWN*"" NOT (SourceImage=""*:\\Program Files\\Microsoft Visual Studio\\*"" SourceImage=""*\\MSBuild\\Current\\Bin\\MSBuild.exe"" CallTrace IN (""*Microsoft.Build.ni.dll*"", ""*System.ni.dll*""))"
"UAC Bypass Using WOW64 Logger DLL Hijack","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using a WoW64 logger DLL hijack (UACMe 30)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_access","windows","Not classified","Review the process details to determine the purpose of accessing SysWOW64 directory 
Check if the process accessing SysWOW64 is a known and trusted application 
Investigate the context of the access and any associated system changes 
Correlate with other security events to determine the overall impact","Legitimate use of WOW64 subsystem 
Software installations that involve SysWOW64 directory 
Updates or patches that access SysWOW64 directory","SourceImage=""*:\\Windows\\SysWOW64\\*"" GrantedAccess=""0x1fffff"" CallTrace=""UNKNOWN(0000000000000000)|UNKNOWN(0000000000000000)|*"""
"Suspicious AgentExecutor PowerShell Execution","Nasreddine Bencherchali (Nextron Systems), memory-shards","Detects execution of the AgentExecutor.exe binary. Which can be abused as a LOLBIN to execute powershell scripts with the ExecutionPolicy ""Bypass"" or any binary named ""powershell.exe"" located in the path provided by 6th positional argument","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Review the parent process of AgentExecutor.exe to determine if it was launched from a legitimate source 
Check if the execution of AgentExecutor.exe is part of a scheduled task or a known administrative script 
Analyze the command-line arguments passed to AgentExecutor.exe to understand the intent of the execution 
Correlate the execution of AgentExecutor.exe with network or file activity to identify any suspicious behavior","Legitimate use of AgentExecutor.exe for authorized administrative tasks 
Scheduled tasks or scripts leveraging AgentExecutor.exe 
Use of AgentExecutor.exe by security tools or EDR solutions 
AgentExecutor.exe used in a known application whitelisted by the organization","Image=""*\\AgentExecutor.exe"" OR OriginalFileName=""AgentExecutor.exe"" CommandLine IN (""* -powershell*"", ""* -remediationScript*"") NOT (CommandLine IN (""*C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\*"", ""*C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\*""))"
"Set Suspicious Files as System Files Using Attrib.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects the usage of attrib with the ""+s"" option to set scripts or executables located in suspicious locations as system files to hide them from users and make them unable to be deleted with simple rights. The rule limits the search to specific extensions and directories to avoid FPs
","attack.defense_evasion, attack.t1564.001","process_creation","windows","Not classified","Check the command-line arguments of attrib.exe processes for the +s option 
Review the file paths where the attrib.exe command is being used 
Inspect the file extensions being targeted by the attrib.exe command 
Correlate with other security events to determine the context of the attrib.exe command","Legitimate use of attrib.exe with the +s option for system files 
Administrative scripts or tools setting files as system files 
File management utilities that use similar techniques","Image=""*\\attrib.exe"" OR OriginalFileName=""ATTRIB.EXE"" CommandLine=""* +s*"" CommandLine IN (""* %*"", ""*\\Users\\Public\\*"", ""*\\AppData\\Local\\*"", ""*\\ProgramData\\*"", ""*\\Downloads\\*"", ""*\\Windows\\Temp\\*"") CommandLine IN (""*.bat*"", ""*.dll*"", ""*.exe*"", ""*.hta*"", ""*.ps1*"", ""*.vbe*"", ""*.vbs*"") NOT (CommandLine=""*\\Windows\\TEMP\\*"" CommandLine=""*.exe*"")"
"Interactive AT Job","E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community","Detects an interactive AT job, which may be used as a form of privilege escalation.","attack.privilege_escalation, attack.t1053.002","process_creation","windows","Not classified","Review the command line arguments of the process to determine the nature of the interactive AT job 
Check the scheduled tasks on the system to verify if the AT job is legitimate 
Correlate with other security events to identify any suspicious activities associated with the interactive AT job 
Investigate the user context and permissions of the process to understand the potential impact of the job","Scheduled legitimate interactive AT jobs 
Legitimate use of at.exe for system maintenance tasks 
Interactive tasks initiated by system administrators","Image=""*\\at.exe"" CommandLine=""*interactive*"""
"Audit Policy Tampering Via NT Resource Kit Auditpol","Nasreddine Bencherchali (Nextron Systems)","Threat actors can use an older version of the auditpol binary available inside the NT resource kit to change audit policy configuration to impair detection capability.
This can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.
","attack.defense_evasion, attack.t1562.002","process_creation","windows","Not classified","Verify the legitimacy of the process that triggered the detection by checking the user context and the source of the command-line execution. 
Review any recent changes to audit policies to determine if they were authorized and expected. 
Cross-reference the command-line arguments with known administrative tools or software that may use similar arguments. 
Investigate if there were any scheduled maintenance or troubleshooting activities that could explain the audit policy changes.","Legitimate administrative changes to audit policies using authorized tools or scripts may trigger this detection. 
Upgrades or installations of legitimate software that use similar command-line arguments may also trigger this detection. 
Temporary disabling of audit policies for troubleshooting or maintenance purposes can lead to false positives. 
Changes made by security tools or EDR solutions that modify audit policies may trigger this detection.","CommandLine IN (""*/logon:none*"", ""*/system:none*"", ""*/sam:none*"", ""*/privilege:none*"", ""*/object:none*"", ""*/process:none*"", ""*/policy:none*"")"
"Audit Policy Tampering Via Auditpol","Janantha Marasinghe (https://github.com/blueteam0ps)","Threat actors can use auditpol binary to change audit policy configuration to impair detection capability.
This can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.
","attack.defense_evasion, attack.t1562.002","process_creation","windows","Not classified","Review the command-line arguments passed to auditpol.exe to determine the specific action taken. 
Check for any legitimate changes made by authorized personnel or scripts that align with the detected activity. 
Correlate the audit policy changes with other security events to identify any potential malicious activity. 
Verify if the changes to audit policies were part of a scheduled maintenance or known system update.","Legitimate system administrators may use auditpol to modify audit policies for valid reasons. 
Security tools or scripts may also interact with auditpol for authorized configurations. 
Updates or installations of software may trigger actions similar to those monitored by this rule.","Image=""*\\auditpol.exe"" OR OriginalFileName=""AUDITPOL.EXE"" CommandLine IN (""*disable*"", ""*clear*"", ""*remove*"", ""*restore*"")"
"Boot Configuration Tampering Via Bcdedit.EXE","E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community","Detects the use of the bcdedit command to tamper with the boot configuration data. This technique is often times used by malware or attackers as a destructive way before launching ransomware.","attack.impact, attack.t1490","process_creation","windows","Not classified","Review the context of the command execution to determine if it aligns with known legitimate activities 
Check for any authorized change management records related to boot configuration modifications 
Correlate with system or application updates/installations to ensure the changes are expected 
Investigate if the command execution is part of a scheduled or scripted task","Legitimate system administrators making authorized changes to the boot configuration 
Updates or installations that require changes to the boot configuration 
Scripted or automated processes that interact with boot configuration","Image=""*\\bcdedit.exe"" OR OriginalFileName=""bcdedit.exe"" CommandLine=""*set*"" (CommandLine=""*bootstatuspolicy*"" CommandLine=""*ignoreallfailures*"") OR (CommandLine=""*recoveryenabled*"" CommandLine=""*no*"")"
"Suspicious Download From Direct IP Via Bitsadmin","Florian Roth (Nextron Systems)","Detects usage of bitsadmin downloading a file using an URL that contains an IP","attack.defense_evasion, attack.persistence, attack.t1197, attack.s0190, attack.t1036.003","process_creation","windows","Not classified","Review the command line arguments to understand the context of the bitsadmin usage 
Check the reputation of the IP address in question to determine if it is associated with malicious activity 
Correlate the event with other security logs to look for indicators of compromise 
Investigate the parent process to see if it is a known and trusted application or script","Legitimate use of bitsadmin for authorized file downloads 
Updates or installations from trusted sources that happen to use direct IPs 
Scripts or applications that have a valid reason to download files using bitsadmin and direct IPs","Image=""*\\bitsadmin.exe"" OR OriginalFileName=""bitsadmin.exe"" CommandLine IN (""* /transfer *"", ""* /create *"", ""* /addfile *"") CommandLine IN (""*://1*"", ""*://2*"", ""*://3*"", ""*://4*"", ""*://5*"", ""*://6*"", ""*://7*"", ""*://8*"", ""*://9*"") NOT CommandLine=""*://7-*"""
"Potential Data Stealing Via Chromium Headless Debugging","Nasreddine Bencherchali (Nextron Systems)","Detects chromium based browsers starting in headless and debugging mode and pointing to a user profile. This could be a sign of data stealing or remote control","attack.credential_access, attack.t1185","process_creation","windows","Not classified","Check if the process is part of a known automated testing framework or web scraping tool 
Verify if the system is used for development purposes and debugging is expected 
Review the business processes and workflows to confirm legitimate use of headless Chromium browsers","Legitimate use of headless mode for automated testing or web scraping 
Development environments where debugging is required 
Legitimate use of Chromium-based browsers in headless mode for specific business processes","CommandLine=""*--remote-debugging-*"" CommandLine=""*--user-data-dir*"" CommandLine=""*--headless*"""
"File Download with Headless Browser","Sreeman, Florian Roth (Nextron Systems)","Detects execution of chromium based browser in headless mode using the ""dump-dom"" command line to download files","attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Review the process execution context to determine if it aligns with legitimate use cases of headless browsers 
Check if the file downloaded is expected and part of regular operations 
Correlate the activity with authorized automated tasks or scheduled jobs that involve web interactions 
Investigate the source of the command to ensure it is from an authorized user or system","Legitimate use of headless browsers for automated testing or web scraping 
Downloading files using legitimate tools that may trigger similar command line parameters 
Use of headless browsers in virtual environments for research or development purposes","Image IN (""*\\brave.exe"", ""*\\chrome.exe"", ""*\\msedge.exe"", ""*\\opera.exe"", ""*\\vivaldi.exe"") CommandLine=""*--headless*"" CommandLine=""*dump-dom*"" CommandLine=""*http*"""
"Tor Client/Browser Execution","frack113","Detects the use of Tor or Tor-Browser to connect to onion routing networks","attack.command_and_control, attack.t1090.003","process_creation","windows","Not classified","Check if the process execution is associated with authorized users or systems 
Verify if the Tor or Tor Browser activity is part of a scheduled update or installation 
Investigate the purpose of Tor-related tools present on the system","Legitimate use of Tor or Tor Browser by authorized users 
Updates or installations of Tor or Tor Browser 
Presence of Tor-related tools for research or security purposes","Image IN (""*\\tor.exe"", ""*\\Tor Browser\\Browser\\firefox.exe"")"
"Suspicious Calculator Usage","Florian Roth (Nextron Systems)","Detects suspicious use of 'calc.exe' with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion.
","attack.defense_evasion, attack.t1036","process_creation","windows","Not classified","Check the command line parameters used with 'calc.exe' to determine if they are legitimate. 
Review the parent process of 'calc.exe' to understand the context of its execution. 
Verify the directory path where 'calc.exe' is executed to see if it aligns with expected locations. 
Correlate 'calc.exe' execution with other security events or logs for additional context.","Legitimate use of 'calc.exe' by system administrators or users for calculations. 
Use of 'calc.exe' in specific legitimate applications or scripts. 
Use of 'calc.exe' in virtual environments for testing or educational purposes.","CommandLine=""*\\calc.exe *"" OR (Image=""*\\calc.exe"" NOT (Image IN (""*:\\Windows\\System32\\*"", ""*:\\Windows\\SysWOW64\\*"", ""*:\\Windows\\WinSxS\\*"")))"
"Suspicious DLL Loaded via CertOC.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects when a user installs certificates by using CertOC.exe to load the target DLL file.","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Check if the CertOC.exe execution is part of a known software installation or update process. 
Verify if the loaded DLL file is a legitimate component used by the system or an authorized application. 
Review the command-line parameters passed to CertOC.exe to determine the intent behind loading the DLL file. 
Correlate the CertOC.exe activity with other security events to identify any malicious behavior or patterns.","Legitimate use of CertOC.exe to load DLL files during normal system operations. 
Installation of certificates using CertOC.exe as part of authorized activities. 
Use of CertOC.exe for legitimate software installation or updates.","Image=""*\\certoc.exe"" OR OriginalFileName=""CertOC.exe"" CommandLine=""* -LoadDLL *"" OR CommandLine=""* /LoadDLL *"" CommandLine IN (""*\\Appdata\\Local\\Temp\\*"", ""*\\Desktop\\*"", ""*\\Downloads\\*"", ""*\\Users\\Public\\*"", ""*C:\\Windows\\Tasks\\*"", ""*C:\\Windows\\Temp\\*"")"
"Suspicious File Downloaded From Direct IP Via Certutil.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of certutil with certain flags that allow the utility to download files from direct IPs.","attack.defense_evasion, attack.t1027","process_creation","windows","Not classified","Review the command-line arguments of certutil.exe to understand the context of the file download. 
Check if the file downloaded is expected and part of a legitimate operation. 
Correlate the certutil activity with other security events to determine if it is part of a larger attack. 
Investigate the source and destination IPs to identify any suspicious patterns or known malicious entities.","Legitimate use of certutil for file downloads from direct IPs in authorized scenarios. 
Updates or installations from trusted sources that involve certutil. 
Scripts or applications that use certutil for legitimate purposes. 
Downloads from internal servers or known repositories using certutil.","Image=""*\\certutil.exe"" OR OriginalFileName=""CertUtil.exe"" CommandLine IN (""*urlcache *"", ""*verifyctl *"") CommandLine IN (""*://1*"", ""*://2*"", ""*://3*"", ""*://4*"", ""*://5*"", ""*://6*"", ""*://7*"", ""*://8*"", ""*://9*"") NOT CommandLine=""*://7-*"""
"Potential NTLM Coercion Via Certutil.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects possible NTLM coercion via certutil using the 'syncwithWU' flag","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Review the command-line arguments and parent processes to determine the context of certutil.exe execution 
Check if the use of 'syncwithWU' flag is part of a known system or application behavior 
Correlate with additional logs or endpoint data to identify any malicious activities associated with the certutil.exe execution 
Investigate the reputation and integrity of the file path and digital signature of certutil.exe","Legitimate use of certutil.exe with the 'syncwithWU' flag for valid system administration tasks 
Use of certutil.exe with 'syncwithWU' flag by trusted scripts or applications 
Presence of third-party tools or security products that may trigger this detection","Image=""*\\certutil.exe"" OR OriginalFileName=""CertUtil.exe"" CommandLine=""* -syncwithWU *"" CommandLine=""* \\\\*"""
"Process Access via TrolleyExpress Exclusion","Florian Roth (Nextron Systems)","Detects a possible process memory dump that uses the white-listed Citrix TrolleyExpress.exe filename as a way to dump the lsass process memory","attack.defense_evasion, attack.t1218.011, attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Verify the legitimacy of the process accessing memory using TrolleyExpress.exe 
Check for authorized upgrades or installations involving Citrix components 
Review any scripting or automation tools that could trigger the detection 
Investigate custom applications or tools that may have similarities to TrolleyExpress.exe","Legitimate use of TrolleyExpress.exe by Citrix for authorized processes 
Upgrades or installations involving Citrix components 
Scripting or automation tools that may use similar command lines 
Custom applications or tools that mimic TrolleyExpress.exe behavior","CommandLine IN (""*\\TrolleyExpress 7*"", ""*\\TrolleyExpress 8*"", ""*\\TrolleyExpress 9*"", ""*\\TrolleyExpress.exe 7*"", ""*\\TrolleyExpress.exe 8*"", ""*\\TrolleyExpress.exe 9*"", ""*\\TrolleyExpress.exe -ma *"") OR (Image=""*\\TrolleyExpress.exe"" NOT (OriginalFileName=""*CtxInstall*"" OR OriginalFileName!=*))"
"Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE","jmallette, Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects usage of cmdkey to look for cached credentials on the system","attack.credential_access, attack.t1003.005","process_creation","windows","Not classified","Check the parent process of cmdkey.exe to determine if it was initiated by a scheduled task or script 
Review the command line arguments passed to cmdkey.exe to identify the context of its usage 
Correlate the cmdkey.exe execution with other security events to determine if it is part of a larger attack chain 
Analyze the user context in which cmdkey.exe was executed to understand if it aligns with normal behavior","Scheduled tasks or scripts legitimately using cmdkey for system administration 
Third-party applications that interact with credentials 
User-initiated credential management operations","Image=""*\\cmdkey.exe"" OR OriginalFileName=""cmdkey.exe"" CommandLine=""* -l*"" OR CommandLine=""* /l*"""
"Change Default File Association To Executable Via Assoc","Nasreddine Bencherchali (Nextron Systems)","Detects when a program changes the default file association of any extension to an executable.
When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.
","attack.persistence, attack.t1546.001","process_creation","windows","Not classified","Check the command-line arguments of the process that triggered the detection to understand the context of the file association change 
Review the process tree to identify the parent process that initiated the change 
Inspect the Windows Registry for changes related to file associations 
Correlate the event with other security events to determine if the change is part of a larger attack pattern","Legitimate changes to file associations by system administrators or users 
Updates or installations of software that require changing file associations 
Scripting or automation tools that modify file associations as part of their legitimate operations","Image=""*\\cmd.exe"" OR OriginalFileName=""Cmd.Exe"" CommandLine=""*assoc *"" CommandLine=""*exefile*"" NOT CommandLine=""*.exe=exefile*"""
"Curl Download And Execute Combination","Sreeman, Nasreddine Bencherchali (Nextron Systems)","Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.","attack.defense_evasion, attack.t1218, attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the presence of 'curl', 'http', '-o', and '&' as described in the detection logic. 
Check for any unusual or unauthorized network connections initiated by the process. 
Analyze the content downloaded by curl to determine if it is malicious. 
Correlate the process creation event with other security events to understand the context of the activity.","Legitimate use of curl for system administration tasks. 
Updates or installations that involve downloading files using curl. 
Scripts or applications that use curl for legitimate purposes. 
Automated processes that involve curl for benign activities.","CommandLine=""* -c *"" OR CommandLine=""* /c *"" CommandLine=""*curl *"" CommandLine=""*http*"" CommandLine=""*-o*"" CommandLine=""*&*"""
"Potential Privilege Escalation Using Symlink Between Osk and Cmd","frack113","Detects the creation of a symbolic link between ""cmd.exe"" and the accessibility on-screen keyboard binary (osk.exe) using ""mklink"". This technique provides an elevated command prompt to the user from the login screen without the need to log in.","attack.privilege_escalation, attack.persistence, attack.t1546.008","process_creation","windows","Not classified","Review process creation logs for instances where 'mklink' is used to create a symbolic link between 'osk.exe' and 'cmd.exe' 
Check for any abnormal elevation of privileges associated with the 'cmd.exe' process 
Look for patterns of this activity occurring at unusual times or from unexpected user accounts 
Correlate with other security events to determine if this is part of a larger attack or a standalone incident","Legitimate use of symbolic links for system administration purposes 
Legitimate software installations that involve creating symbolic links 
Scripting or automation tools that use symbolic links 
Updates or patches that may involve symbolic links","Image=""*\\cmd.exe"" OR OriginalFileName=""Cmd.Exe"" CommandLine=""*mklink*"" CommandLine=""*\\osk.exe*"" CommandLine=""*\\cmd.exe*"""
"VolumeShadowCopy Symlink Creation Via Mklink","Teymur Kheirkhabarov, oscd.community","Shadow Copies storage symbolic link creation using operating systems utilities","attack.credential_access, attack.t1003.002, attack.t1003.003","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to understand the context of the 'mklink' and 'HarddiskVolumeShadowCopy' usage 
Check if the process execution is part of a known and approved administrative task related to shadow copies 
Correlate with backup logs or system maintenance schedules to verify the legitimacy of the symlink creation","Scheduled backup tasks that involve shadow copies 
Legitimate software installations that use symbolic links 
System maintenance operations that involve shadow copies","CommandLine=""*mklink*"" CommandLine=""*HarddiskVolumeShadowCopy*"""
"Suspicious File Execution From Internet Hosted WebDav Share","pH-T (Nextron Systems)","Detects the execution of the ""net use"" command to mount a WebDAV server and then immediately execute some content in it. As seen being used in malicious LNK files","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the command-line arguments of the process to determine the intent and origin of the net use command 
Check if the file execution from the WebDAV share is part of a known and approved workflow within the organization 
Analyze the reputation and trustworthiness of the files being executed from the WebDAV share 
Correlate the process execution with other security events to identify any signs of malicious activity","Legitimate use of net use command to mount WebDAV shares for authorized purposes 
Legitimate execution of files from WebDAV shares by trusted applications 
Use of similar commands in legitimate scripts or administrative tasks","Image=""*\\cmd.exe*"" OR OriginalFileName=""Cmd.EXE"" CommandLine=""* net use http*"" CommandLine=""*& start /b *"" CommandLine=""*\\DavWWWRoot\\*"" CommandLine IN (""*.exe *"", ""*.dll *"", ""*.bat *"", ""*.vbs *"", ""*.ps1 *"")"
"Cmd.EXE Missing Space Characters Execution Anomaly","Florian Roth (Nextron Systems)","Detects Windows command lines that miss a space before or after the /c flag when running a command using the cmd.exe.
This could be a sign of obfuscation of a fat finger problem (typo by the developer).
","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line arguments to understand the context of the command execution 
Check the reputation of the process and associated command line arguments 
Correlate with other security events to determine if the command execution is part of a larger attack chain 
Verify the legitimacy of the command and the user context in which it was executed","Legitimate use of cmd.exe without space characters around /c flag 
Scripting languages that do not require spaces around flags 
Commands executed by trusted system administrators","CommandLine IN (""*cmd.exe/c*"", ""*\\cmd/c*"", ""*\""cmd/c*"", ""*cmd.exe/k*"", ""*\\cmd/k*"", ""*\""cmd/k*"", ""*cmd.exe/r*"", ""*\\cmd/r*"", ""*\""cmd/r*"") OR CommandLine IN (""*/cwhoami*"", ""*/cpowershell*"", ""*/cschtasks*"", ""*/cbitsadmin*"", ""*/ccertutil*"", ""*/kwhoami*"", ""*/kpowershell*"", ""*/kschtasks*"", ""*/kbitsadmin*"", ""*/kcertutil*"") OR CommandLine IN (""*cmd.exe /c*"", ""*cmd /c*"", ""*cmd.exe /k*"", ""*cmd /k*"", ""*cmd.exe /r*"", ""*cmd /r*"") NOT (CommandLine IN (""*cmd.exe /c *"", ""*cmd /c *"", ""*cmd.exe /k *"", ""*cmd /k *"", ""*cmd.exe /r *"", ""*cmd /r *"") OR CommandLine IN (""*AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\node_modules*"", ""*cmd.exe/c ."", ""cmd.exe /c""))"
"NtdllPipe Like Activity Execution","Florian Roth (Nextron Systems)","Detects command that type the content of ntdll.dll to a different file or a pipe in order to evade AV / EDR detection. As seen being used in the POC NtdllPipe","attack.defense_evasion","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to understand the context of the 'type' command on ntdll.dll 
Check if the process creating the named pipe has a legitimate purpose for inter-process communication 
Correlate the event with other security events to determine if the activity is part of a larger attack chain 
Investigate the reputation and behavior of the process involved in the suspicious activity","Legitimate use of 'type' command on ntdll.dll for troubleshooting purposes 
Legitimate use of named pipes for inter-process communication 
Legitimate use of similar commands for system administration tasks","CommandLine IN (""*type %windir%\\system32\\ntdll.dll*"", ""*type %systemroot%\\system32\\ntdll.dll*"", ""*type c:\\windows\\system32\\ntdll.dll*"", ""*\\ntdll.dll > \\\\.\\pipe\\*"")"
"Potential CommandLine Path Traversal Via Cmd.EXE","xknow @xknow_infosec, Tim Shelton","Detects potential path traversal attempt via cmd.exe. Could indicate possible command/argument confusion/hijacking","attack.execution, attack.t1059.003","process_creation","windows","Not classified","Review the parent and child processes to understand the context of the command execution 
Check if the command is part of a known script or application that uses relative paths 
Analyze the frequency and pattern of similar events to identify potential false positives 
Correlate with other security events or logs to determine if the activity is part of a larger attack","Legitimate use of relative paths in scripts or applications 
Upgrading or installing software that may trigger similar patterns 
Automated system tasks that involve changing directories","ParentImage=""*\\cmd.exe"" OR Image=""*\\cmd.exe"" OR OriginalFileName=""cmd.exe"" ParentCommandLine IN (""*/c*"", ""*/k*"", ""*/r*"") OR CommandLine IN (""*/c*"", ""*/k*"", ""*/r*"") ParentCommandLine=""/../../"" OR CommandLine=""*/../../*"" NOT CommandLine=""*\\Tasktop\\keycloak\\bin\\/../../jre\\bin\\java*"""
"Suspicious Ping/Del Command Combination","Ilya Krestinichev","Detects a method often used by ransomware. Which combines the ""ping"" to wait a couple of seconds and then ""del"" to delete the file in question. Its used to hide the file responsible for the initial infection for example","attack.defense_evasion, attack.t1070.004","process_creation","windows","Not classified","Review the full command line arguments and context surrounding the ping and del commands 
Check for any legitimate scripts or applications that may be using ping and del commands 
Correlate with other security events or indicators of compromise to determine the context of the suspicious activity 
Investigate the file or process being targeted by the del command for any signs of malicious activity","Legitimate use of ping and del commands in scripts or administrative tasks 
Software installations or updates that involve ping and del commands 
Scheduled tasks or system maintenance routines that use ping and del commands","CommandLine=""* -n *"" OR CommandLine=""* /n *"" CommandLine=""*Nul*"" CommandLine=""* -f *"" OR CommandLine=""* /f *"" OR CommandLine=""* -q *"" OR CommandLine=""* /q *"" CommandLine=""*ping*"" CommandLine=""*del *"""
"Copy From VolumeShadowCopy Via Cmd.EXE","Max Altgelt (Nextron Systems), Tobias Michalski (Nextron Systems)","Detects the execution of the builtin ""copy"" command that targets a shadow copy (sometimes used to copy registry hives that are in use)","attack.impact, attack.t1490","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of the 'copy' command execution 
Check if the process execution is part of a scheduled backup job or a known administrative task 
Correlate with other security events to determine if the action is part of a larger malicious operation 
Inspect the destination of the 'copy' operation to identify any suspicious files or locations","Legitimate backup software performing shadow copy operations 
Administrators copying files from shadow copies for recovery purposes 
Scripted processes that involve copying files from shadow copies","CommandLine=""*copy *"" CommandLine=""*\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy*"""
"Persistence Via Sticky Key Backdoor","Sreeman","By replacing the sticky keys executable with the local admins CMD executable, an attacker is able to access a privileged windows console session without authenticating to the system.
When the sticky keys are ""activated"" the privilleged shell is launched.
","attack.t1546.008, attack.privilege_escalation","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the 'copy' command followed by the replacement of sethc.exe with cmd.exe 
Check for any unusual or unauthorized modifications to the sethc.exe file 
Correlate the process creation event with other security events to determine if there are signs of privilege escalation or unauthorized access 
Investigate the user context and permissions associated with the process creation to identify any anomalies or suspicious activities","Legitimate system administrator activity involving copying files 
Software installations that involve copying files 
Updates or patches that involve replacing system files 
Scripting or automation tasks that copy files","CommandLine=""*copy *"" CommandLine=""*/y *"" CommandLine=""*C:\\windows\\system32\\cmd.exe C:\\windows\\system32\\sethc.exe*"""
"Sticky Key Like Backdoor Execution","Florian Roth (Nextron Systems), @twjackomo, Jonhnathan Ribeiro, oscd.community","Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen","attack.privilege_escalation, attack.persistence, attack.t1546.008, car.2014-11-003, car.2014-11-008","process_creation","windows","Not classified","Review the command-line arguments of the suspicious process to determine the intent 
Check for any unusual persistence mechanisms associated with the identified process 
Correlate the process execution with other security events to identify potential malicious behavior 
Verify the integrity of the system binaries involved in the suspicious activity","Legitimate use of accessibility tools during system administration 
Legitimate debugging activities by system administrators 
Legitimate use of command-line tools by authorized users","ParentImage=""*\\winlogon.exe"" Image IN (""*\\cmd.exe"", ""*\\cscript.exe"", ""*\\mshta.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\wscript.exe"", ""*\\wt.exe"") CommandLine IN (""*sethc.exe*"", ""*utilman.exe*"", ""*osk.exe*"", ""*Magnify.exe*"", ""*Narrator.exe*"", ""*DisplaySwitch.exe*"")"
"CMSTP Execution Process Creation","Nik Seetharaman","Detects various indicators of Microsoft Connection Manager Profile Installer execution","attack.defense_evasion, attack.execution, attack.t1218.003, attack.g0069, car.2019-04-001","process_creation","windows","Not classified","Check the ParentImage field to determine the origin of the cmstp.exe process 
Analyze the CommandLine field for any suspicious parameters or arguments 
Review the Details field for additional context or indicators of malicious activity 
Correlate the CMSTP execution with other events or logs for a broader understanding of the activity","Legitimate use of CMSTP in specific enterprise environments 
Updates or installations that involve CMSTP 
Scripts or tools that leverage CMSTP for legitimate purposes","ParentImage=""*\\cmstp.exe"""
"Conhost.exe CommandLine Path Traversal","Nasreddine Bencherchali (Nextron Systems)","detects the usage of path traversal in conhost.exe indicating possible command/argument confusion/hijacking","attack.execution, attack.t1059.003","process_creation","windows","Not classified","Review the ParentCommandLine and CommandLine fields for conhost.exe processes with path traversal 
Check the context of the process creation event to understand the intent behind the path traversal 
Correlate with other security events to determine if the path traversal is part of a larger attack chain 
Investigate the user context and privileges of the process for any anomalies","Legitimate use of relative paths by system processes 
Development or testing environments where path traversal is intentional 
Scripting or automation tools that use path manipulation","ParentCommandLine=""*conhost*"" CommandLine=""*/../../*"""
"Control Panel Items","Kyaw Min Thein, Furkan Caliskan (@caliskanfurkan_)","Detects the malicious use of a control panel item","attack.execution, attack.defense_evasion, attack.t1218.002, attack.persistence, attack.t1546","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of the control panel item interaction 
Check for any associated parent processes or subsequent actions that may provide more insight into the activity 
Correlate the event with other security logs to determine if the activity is part of a larger attack chain 
Compare the observed behavior with known good patterns of control panel item usage in the environment","Legitimate use of control panel items during system maintenance or configuration changes 
Updates or installations of legitimate software that involve control panel items 
Scripted actions that interact with control panel items for authorized purposes","(Image=""*\\reg.exe"" OR OriginalFileName=""reg.exe"" CommandLine=""*add*"" CommandLine=""*CurrentVersion\\Control Panel\\CPLs*"") OR (CommandLine=""*.cpl"" NOT (CommandLine IN (""*\\System32\\*"", ""*%System%*"", ""*|C:\\Windows\\system32|*"") OR (CommandLine=""*regsvr32 *"" CommandLine=""* /s *"" CommandLine=""*igfxCPL.cpl*"")))"
"CreateDump Process Dump","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects uses of the createdump.exe LOLOBIN utility to dump process memory","attack.defense_evasion, attack.t1036, attack.t1003.001","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the flags and parameters used 
Check if the process execution is part of a known and approved operation or task 
Correlate the process creation event with other security events to determine the context of the activity 
Investigate the parent process and the user context to understand the origin of the process dump","Legitimate system administration tasks that involve dumping process memory 
Software installations that use similar flags and parameters 
Backup processes that create dump files","Image=""*\\createdump.exe"" OR OriginalFileName=""FX_VER_INTERNALNAME_STR"" CommandLine IN (""* -u *"", ""* --full *"", ""* -f *"", ""* --name *"", ""*.dmp *"")"
"Csc.EXE Execution Form Potentially Suspicious Parent","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)","Detects a potentially suspicious parent of ""csc.exe"", which could be a sign of payload delivery.","attack.execution, attack.t1059.005, attack.t1059.007, attack.defense_evasion, attack.t1218.005, attack.t1027.004","process_creation","windows","Not classified","Check if the csc.exe execution is part of a legitimate software development process 
Review scheduled tasks or scripts that may be invoking csc.exe 
Verify if the activity is related to authorized system administration tasks","Legitimate use of csc.exe by development tools 
Scheduled tasks or legitimate scripts launching csc.exe 
Known system administration activities involving csc.exe"
"Suspicious Use of CSharp Interactive Console","Michael R. (@nahamike01)","Detects the execution of CSharp interactive console by PowerShell","attack.execution, attack.t1127","process_creation","windows","Not classified","Check the command-line arguments passed to the csi.exe process for any suspicious or unauthorized activity 
Review the network connections established by the csi.exe process for any signs of data exfiltration 
Correlate the process execution with other security events to determine the context of the activity 
Investigate the parent process to understand how the CSharp interactive console was invoked","Legitimate use of CSharp interactive console by authorized users for development purposes 
Use of legitimate tools that may trigger the detection 
Scheduled tasks or scripts that involve the CSharp interactive console 
Third-party applications that utilize the CSharp interactive console","Image=""*\\csi.exe"" ParentImage IN (""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\powershell_ise.exe"") OriginalFileName=""csi.exe"""
"Suspicious Curl.EXE Download","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects a suspicious curl process start on Windows and outputs the requested document to a local file","attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Review the command-line arguments of the curl.exe process to determine the requested document and destination 
Check the reputation of the requested document URL for any known malicious indicators 
Analyze the parent process of curl.exe to identify the origin and context of the download 
Correlate the curl.exe activity with other security events or logs to establish a broader understanding of the potential threat","Legitimate use of curl.exe for authorized downloads 
Development or testing scenarios involving curl.exe 
Automated scripts or scheduled tasks utilizing curl.exe 
Third-party software installations that leverage curl.exe","Image=""*\\curl.exe"" OR Product=""The curl executable"" CommandLine IN (""*%AppData%*"", ""*%Public%*"", ""*%Temp%*"", ""*%tmp%*"", ""*\\AppData\\*"", ""*\\Desktop\\*"", ""*\\Temp\\*"", ""*\\Users\\Public\\*"", ""*C:\\PerfLogs\\*"", ""*C:\\ProgramData\\*"", ""*C:\\Windows\\Temp\\*"") OR CommandLine IN (""*.dll"", ""*.gif"", ""*.jpeg"", ""*.jpg"", ""*.png"", ""*.temp"", ""*.tmp"", ""*.txt"", ""*.vbe"", ""*.vbs"") NOT (ParentImage=""C:\\Program Files\\Git\\usr\\bin\\sh.exe"" Image=""C:\\Program Files\\Git\\mingw64\\bin\\curl.exe"" CommandLine=""*--silent --show-error --output *"" CommandLine=""*gfw-httpget-*"" CommandLine=""*AppData*"")"
"Suspicious Desktopimgdownldr Command","Florian Roth (Nextron Systems)","Detects a suspicious Microsoft desktopimgdownldr execution with parameters used to download files from the Internet","attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Review the ParentCommandLine to understand the context of the suspicious command execution 
Check if the file extensions in the command line are part of normal operations in the environment 
Correlate the event with other security logs to determine if the activity is part of a larger attack chain 
Verify if the 'reg delete' command is part of a known administrative process","Legitimate use of desktopimgdownldr for authorized file downloads 
Administrative tasks involving changes to lock screen settings 
Usage of legitimate tools that mimic the suspicious behavior","(CommandLine=""* /lockscreenurl:*"" NOT (CommandLine IN (""*.jpg*"", ""*.jpeg*"", ""*.png*""))) OR (CommandLine=""*reg delete*"" CommandLine=""*\\PersonalizationCSP*"")"
"DLL Sideloading by VMware Xfer Utility","Nasreddine Bencherchali (Nextron Systems)","Detects execution of VMware Xfer utility (VMwareXferlogs.exe) from the non-default directory which may be an attempt to sideload arbitrary DLL","attack.defense_evasion, attack.t1574.002","process_creation","windows","Not classified","Review the process command line arguments for any suspicious parameters 
Check the parent process of VMware Xfer utility for any anomalies 
Verify the integrity of the DLLs loaded by VMware Xfer utility 
Correlate the event with other security logs to determine the context of the execution","Legitimate use of VMware Xfer utility from non-default directory 
Upgrades or installations of VMware Xfer utility 
Authorized testing or troubleshooting scenarios","Image=""*\\VMwareXferlogs.exe"" NOT Image=""C:\\Program Files\\VMware\\*"""
"New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE","Florian Roth (Nextron Systems)","Detects the installation of a DNS plugin DLL via ServerLevelPluginDll parameter in registry, which can be used to execute code in context of the DNS server (restart required)","attack.defense_evasion, attack.t1574.002, attack.t1112","process_creation","windows","Not classified","Review the command-line arguments used with dnscmd.exe to identify the specific plugin DLL being installed 
Check the registry entries related to ServerLevelPluginDll to determine the legitimacy of the installation 
Verify the source and integrity of the DNS plugin DLL to confirm if it is a known and trusted component 
Correlate the event with other security logs to look for any suspicious activities or additional indicators of compromise","Legitimate installation of DNS plugins via dnscmd.exe for authorized purposes 
Updates or patches that involve changes to DNS server configurations 
Third-party applications that interact with DNS server settings","Image=""*\\dnscmd.exe"" CommandLine=""*/config*"" CommandLine=""*/serverlevelplugindll*"""
"DNS Exfiltration and Tunneling Tools Execution","Daniil Yugoslavskiy, oscd.community","Well-known DNS Exfiltration tools execution","attack.exfiltration, attack.t1048.001, attack.command_and_control, attack.t1071.004, attack.t1132.001","process_creation","windows","Not classified","Check if the execution of iodine.exe or dnscat2 is part of a scheduled security assessment or penetration testing activity 
Review documentation or change management records for authorized installations of iodine or dnscat2 
Verify if the activity occurred in a controlled environment like a sandbox or research network 
Investigate network traffic for signs of DNS exfiltration or tunneling to confirm malicious intent","Legitimate use of DNS tunneling tools for authorized network testing or research purposes 
Legitimate installation of iodine or dnscat2 for security tooling or monitoring purposes 
Presence of these tools in a sandbox or isolated environment for analysis","Image IN (""*\\iodine.exe"", ""*\\dnscat2*"")"
"Unusual Child Process of dns.exe","Tim Rauch, Elastic (idea)","Detects an unexpected process spawning from dns.exe which may indicate activity related to remote code execution or other forms of exploitation as seen in CVE-2020-1350 (SigRed)","attack.initial_access, attack.t1133","process_creation","windows","Not classified","Review the command line arguments of the child process to determine its purpose 
Check the reputation of the child process executable using threat intelligence feeds 
Investigate the network connections established by the child process for any suspicious activity 
Correlate the event with other security logs to identify any related indicators of compromise","Legitimate software installations that spawn child processes from dns.exe 
Scheduled tasks or scripts that interact with dns.exe 
Updates or patches that trigger processes from dns.exe","ParentImage=""*\\dns.exe"" NOT Image=""*\\conhost.exe"""
"Suspicious Kernel Dump Using Dtrace","Florian Roth (Nextron Systems)","Detects suspicious way to dump the kernel on Windows systems using dtrace.exe, which is available on Windows systems since Windows 10 19H1","attack.discovery, attack.t1082","process_creation","windows","Not classified","Review the command-line arguments and context of the process execution 
Check if the use of dtrace.exe aligns with any scheduled system activities 
Correlate the process execution with other security events or logs for additional context","Legitimate use of dtrace.exe for authorized system troubleshooting 
Use of dtrace.exe in a controlled testing environment 
Known system maintenance activities involving dtrace.exe","(Image=""*\\dtrace.exe"" CommandLine=""*lkd(0)*"") OR (CommandLine=""*syscall:::return*"" CommandLine=""*lkd(*"")"
"Suspicious DumpMinitool Execution","Florian Roth (Nextron Systems)","Detects suspicious ways to use the ""DumpMinitool.exe"" binary","attack.defense_evasion, attack.t1036, attack.t1003.001","process_creation","windows","Not classified","Review the command-line arguments passed to DumpMinitool.exe for legitimate flags or parameters 
Check if the execution of DumpMinitool.exe is part of a scheduled task or known system process 
Verify if the parent process spawning DumpMinitool.exe is a trusted application or service 
Investigate if there are any documented exceptions or approvals for the use of DumpMinitool.exe in the environment","Legitimate use of DumpMinitool.exe during authorized system maintenance activities 
DumpMinitool.exe used by system administrators for troubleshooting purposes 
DumpMinitool.exe executed as part of a known whitelisted application 
DumpMinitool.exe used in a sandbox or controlled environment for testing","Image IN (""*\\DumpMinitool.exe"", ""*\\DumpMinitool.x86.exe"", ""*\\DumpMinitool.arm64.exe"") OR OriginalFileName IN (""DumpMinitool.exe"", ""DumpMinitool.x86.exe"", ""DumpMinitool.arm64.exe"") NOT (Image IN (""*\\Microsoft Visual Studio\\*"", ""*\\Extensions\\*"")) OR CommandLine=""*.txt*"" OR (CommandLine IN (""* Full*"", ""* Mini*"", ""* WithHeap*"") NOT CommandLine=""*--dumpType*"")"
"Copying Sensitive Files with Credential Data","Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community","Files with well-known filenames (sensitive files with credential data) copying","attack.credential_access, attack.t1003.002, attack.t1003.003, car.2013-07-001, attack.s0404","process_creation","windows","Not classified","Check if the file copy operation is part of a known backup process 
Verify if the access to sensitive files is initiated by a legitimate forensic tool 
Review scheduled tasks or system processes that may be interacting with the files 
Investigate if a file synchronization application is responsible for copying the sensitive files","Legitimate backup processes copying sensitive files 
Forensic tools accessing sensitive files for investigation 
Scheduled tasks or system processes interacting with sensitive files 
File synchronization applications copying sensitive files","(Image=""*\\esentutl.exe"" OR OriginalFileName=""\\esentutl.exe"" CommandLine IN (""*vss*"", ""* /m *"", ""* /y *"")) OR CommandLine IN (""*\\windows\\ntds\\ntds.dit*"", ""*\\config\\sam*"", ""*\\config\\security*"", ""*\\config\\system *"", ""*\\repair\\sam*"", ""*\\repair\\system*"", ""*\\repair\\security*"", ""*\\config\\RegBack\\sam*"", ""*\\config\\RegBack\\system*"", ""*\\config\\RegBack\\security*"")"
"Potentially Suspicious Event Viewer Child Process","Florian Roth (Nextron Systems)","Detects uncommon or suspicious child processes of ""eventvwr.exe"" which might indicate a UAC bypass attempt","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002, car.2019-04-001","process_creation","windows","Not classified","Review the command-line arguments of the child process for any suspicious or unexpected parameters 
Check the reputation of the child process executable using threat intelligence feeds 
Correlate the event with other security events to determine the context and potential impact 
Investigate the parent-child process relationship to understand the chain of execution","Legitimate administrative or monitoring tools launching child processes 
Updates or installations triggering child processes 
Scheduled tasks or scripts that are expected to run child processes","ParentImage=""*\\eventvwr.exe"" NOT (Image IN (""*:\\Windows\\System32\\mmc.exe"", ""*:\\Windows\\System32\\WerFault.exe"", ""*:\\Windows\\SysWOW64\\WerFault.exe""))"
"Explorer NOUACCHECK Flag","Florian Roth (Nextron Systems)","Detects suspicious starts of explorer.exe that use the /NOUACCHECK flag that allows to run all sub processes of that newly started explorer.exe without any UAC checks","attack.defense_evasion, attack.t1548.002","process_creation","windows","Not classified","Review the parent process of explorer.exe to determine if it is a known legitimate process or tool 
Check if the use of /NOUACCHECK is part of a scheduled task or script execution 
Investigate the context in which explorer.exe with /NOUACCHECK flag was executed to understand the purpose and legitimacy of the action 
Compare the command line arguments with known good baselines to identify anomalies","Legitimate software products that use the /NOUACCHECK flag 
Scheduled tasks or scripts that utilize the /NOUACCHECK flag 
Administrative tools or scripts that require bypassing UAC checks","Image=""*\\explorer.exe"" CommandLine=""*/NOUACCHECK*"" NOT (ParentCommandLine=""C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule"" OR ParentImage=""C:\\Windows\\System32\\svchost.exe"")"
"Findstr GPP Passwords","frack113","Look for the encrypted cpassword value within Group Policy Preference files on the Domain Controller. This value can be decrypted with gpp-decrypt.","attack.credential_access, attack.t1552.006","process_creation","windows","Not classified","Check the context of the process execution to determine if it is related to GPP files 
Verify if the cpassword value is within a GPP file in the specified directories 
Analyze the command line arguments to understand the intent of the process 
Cross-reference with known legitimate use cases of findstr.exe or find.exe","Legitimate use of findstr.exe or find.exe for other purposes 
Presence of cpassword in non-GPP files 
Use of cpassword in legitimate scripts or configurations","Image IN (""*\\find.exe"", ""*\\findstr.exe"") OR OriginalFileName IN (""FIND.EXE"", ""FINDSTR.EXE"") CommandLine=""*cpassword*"" CommandLine=""*\\sysvol\\*"" CommandLine=""*.xml*"""
"Sysmon Discovery Via Default Driver Altitude Using Findstr.EXE","frack113","Detects usage of ""findstr"" with the argument ""385201"". Which could indicate potential discovery of an installed Sysinternals Sysmon service using the default driver altitude (even if the name is changed).","attack.discovery, attack.t1518.001","process_creation","windows","Not classified","Review the command-line arguments passed to findstr.exe to determine the context of its usage 
Check if the findstr.exe process is being executed as part of a known and approved script or tool 
Correlate the process creation event with other security events to identify any malicious behavior or patterns 
Investigate the parent process that spawned findstr.exe to understand the chain of execution","Legitimate use of findstr.exe with the argument '385201' for non-malicious purposes 
Usage of findstr.exe with '385201' in a legitimate script or tool 
Findstr.exe used in a benign manner for system administration tasks","Image IN (""*\\find.exe"", ""*\\findstr.exe"") OR OriginalFileName IN (""FIND.EXE"", ""FINDSTR.EXE"") CommandLine=""* 385201*"""
"Finger.exe Suspicious Invocation","Florian Roth (Nextron Systems), omkar72, oscd.community","Detects suspicious aged finger.exe tool execution often used in malware attacks nowadays","attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Check the command-line arguments used with finger.exe to determine if they are suspicious 
Review the parent process of finger.exe to understand the context of its execution 
Correlate the timestamp of finger.exe execution with other security events to identify any related suspicious activities 
Verify the reputation of the file path from which finger.exe was executed","Legitimate use of finger.exe by system administrators for troubleshooting purposes 
Scheduled tasks or scripts that involve finger.exe 
Development or testing environments where finger.exe is used for legitimate purposes","OriginalFileName=""finger.exe"" OR Image=""*\\finger.exe"""
"Filter Driver Unloaded Via Fltmc.EXE","Nasreddine Bencherchali","Detect filter driver unloading activity via fltmc.exe","attack.defense_evasion, attack.t1070, attack.t1562, attack.t1562.002","process_creation","windows","Not classified","Check for legitimate system updates or software installations that may have triggered the filter driver unloading 
Review scheduled tasks or scripts that involve filter driver unloading for known operations 
Verify if any security software was temporarily disabled around the time of the filter driver unloading event 
Correlate with system logs to identify any authorized actions related to filter driver unloading","Legitimate filter driver unloading operations initiated by system updates or software installations 
Scheduled tasks or scripts that involve filter driver unloading 
Temporary disabling of security software that unloads filter drivers","Image=""*\\fltMC.exe"" OR OriginalFileName=""fltMC.exe"" CommandLine=""*unload*"" NOT CommandLine=""*unload rtp_filesystem_filter"""
"Sysmon Driver Unloaded Via Fltmc.EXE","Kirill Kiryanov, oscd.community","Detects possible Sysmon filter driver unloaded via fltmc.exe","attack.defense_evasion, attack.t1070, attack.t1562, attack.t1562.002","process_creation","windows","Not classified","Check if the unloading of the Sysmon filter driver was part of a scheduled maintenance window. 
Verify if other non-Sysmon filter drivers were also unloaded around the same time. 
Review the command-line arguments of fltmc.exe to determine if the operation was related to Sysmon or not. 
Correlate the event with other security logs to identify any suspicious activities before or after the unloading.","Legitimate unloading of Sysmon filter driver during authorized system maintenance. 
Unloading of other non-Sysmon filter drivers via fltmc.exe. 
Use of fltmc.exe for legitimate system operations unrelated to Sysmon.","Image=""*\\fltMC.exe"" OR OriginalFileName=""fltMC.exe"" CommandLine=""*unload*"" CommandLine=""*sysmon*"""
"Fsutil Suspicious Invocation","Ecco, E.M. Anhaus, oscd.community","Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size, etc).
Might be used by ransomwares during the attack (seen by NotPetya and others).
","attack.defense_evasion, attack.impact, attack.t1070, attack.t1485","process_creation","windows","Not classified","Review the user context associated with the process execution to determine if it aligns with expected administrative or system maintenance activities 
Cross-reference the executed fsutil command with change management records or scheduled maintenance tasks 
Check if the process execution is part of a known backup or disk cleanup operation","Legitimate system maintenance tasks 
Backup software operations 
Disk cleanup utilities","Image=""*\\fsutil.exe"" OR OriginalFileName=""fsutil.exe"" CommandLine IN (""*deletejournal*"", ""*createjournal*"", ""*setZeroData*"")"
"File Download Using Notepad++ GUP Utility","Nasreddine Bencherchali (Nextron Systems)","Detects execution of the Notepad++ updater (gup) from a process other than Notepad++ to download files.","attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Check the parent process of the GUP utility to verify if it is a legitimate process or not 
Review the command-line arguments used with the GUP utility to understand the purpose of the download 
Correlate the timestamp of the GUP execution with other security events to determine if it is part of a larger attack 
Investigate the network traffic generated by the download to identify the source and destination of the downloaded files","Legitimate use of Notepad++ updater (gup) from other trusted processes 
Scheduled tasks or automation scripts triggering the Notepad++ updater 
Updates initiated by system management tools that use the Notepad++ updater 
Manual execution of the Notepad++ updater by an authorized user","Image=""*\\GUP.exe"" OR OriginalFileName=""gup.exe"" CommandLine=""* -unzipTo *"" CommandLine=""*http*"" NOT ParentImage=""*\\notepad++.exe"""
"Suspicious GUP Usage","Florian Roth (Nextron Systems)","Detects execution of the Notepad++ updater in a suspicious directory, which is often used in DLL side-loading attacks","attack.defense_evasion, attack.t1574.002","process_creation","windows","Not classified","Check the command-line arguments used when GUP.exe is executed 
Verify the parent process that triggered the execution of GUP.exe 
Review the file creation and modification timestamps of GUP.exe and related files in the suspicious directories 
Look for any network connections or unusual outbound traffic associated with the GUP.exe execution","Legitimate use of Notepad++ updater in the specified directories 
Other software using a similar naming convention for their updaters 
Scheduled tasks or scripts that involve GUP.exe in the mentioned directories","Image=""*\\GUP.exe"" NOT (Image IN (""*\\Program Files\\Notepad++\\updater\\GUP.exe"", ""*\\Program Files (x86)\\Notepad++\\updater\\GUP.exe"") OR (Image=""*\\Users\\*"" Image IN (""*\\AppData\\Local\\Notepad++\\updater\\GUP.exe"", ""*\\AppData\\Roaming\\Notepad++\\updater\\GUP.exe"")))"
"HTML Help HH.EXE Suspicious Child Process","Maxim Pavlunin, Nasreddine Bencherchali (Nextron Systems)","Detects a suspicious child process of a Microsoft HTML Help (HH.exe)","attack.defense_evasion, attack.execution, attack.initial_access, attack.t1047, attack.t1059.001, attack.t1059.003, attack.t1059.005, attack.t1059.007, attack.t1218, attack.t1218.001, attack.t1218.010, attack.t1218.011, attack.t1566, attack.t1566.001","process_creation","windows","Not classified","Review the parent process and its context to determine if the child process is expected 
Check for scheduled tasks or scripts that may explain the observed behavior 
Verify if the listed processes are part of a known software installation or update 
Consult with the system owner or user to understand any legitimate activities involving the listed processes","Legitimate use of HH.exe spawning one of the listed processes for normal operations 
Scheduled legitimate tasks that involve the listed processes 
Known software installations that trigger the rule 
Development or administrative activities that involve the listed processes","ParentImage=""*\\hh.exe"" Image IN (""*\\CertReq.exe"", ""*\\CertUtil.exe"", ""*\\cmd.exe"", ""*\\cscript.exe"", ""*\\installutil.exe"", ""*\\MSbuild.exe"", ""*\\MSHTA.EXE"", ""*\\msiexec.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\schtasks.exe"", ""*\\wmic.exe"", ""*\\wscript.exe"")"
"Suspicious HH.EXE Execution","Maxim Pavlunin","Detects a suspicious execution of a Microsoft HTML Help (HH.exe)","attack.defense_evasion, attack.execution, attack.initial_access, attack.t1047, attack.t1059.001, attack.t1059.003, attack.t1059.005, attack.t1059.007, attack.t1218, attack.t1218.001, attack.t1218.010, attack.t1218.011, attack.t1566, attack.t1566.001","process_creation","windows","Not classified","Review the parent process that initiated the HH.exe execution 
Check if the HH.exe execution is part of a scheduled task or legitimate system process 
Analyze the command-line arguments passed to HH.exe for any suspicious parameters 
Correlate the HH.exe execution with other security events or alerts for context","Legitimate use of HH.exe for valid system operations 
HH.exe executed by trusted applications 
HH.exe used in a known whitelisted process 
HH.exe executed as part of a legitimate software installation","OriginalFileName=""HH.exe"" OR Image=""*\\hh.exe"" CommandLine IN (""*.application*"", ""*\\AppData\\Local\\Temp\\*"", ""*\\Content.Outlook\\*"", ""*\\Downloads\\*"", ""*\\Users\\Public\\*"", ""*\\Windows\\Temp\\*"")"
"HackTool - ADCSPwn Execution","Florian Roth (Nextron Systems)","Detects command line parameters used by ADCSPwn, a tool to escalate privileges in an active directory network by coercing authenticate from machine accounts and relaying to the certificate service","attack.credential_access, attack.t1557.001","process_creation","windows","Not classified","Review the process creation logs on the Windows system where the detection occurred 
Check if the command line parameters '--adcs' and '--port' were used in conjunction with any suspicious or unauthorized tools 
Correlate the process creation event with network logs to identify any communication to certificate services or unusual authentication attempts 
Investigate the user context and privileges of the process to determine if escalation of privileges is attempted","Legitimate use of ADCS-related tools or scripts 
Administrative tasks involving similar command line parameters 
Development or testing environments where ADCSPwn is intentionally used 
Updates or installations of legitimate software that may trigger similar command line patterns","CommandLine=""* --adcs *"" CommandLine=""* --port *"""
"HackTool - Bloodhound/Sharphound Execution","Florian Roth (Nextron Systems)","Detects command line parameters used by Bloodhound and Sharphound hack tools","attack.discovery, attack.t1087.001, attack.t1087.002, attack.t1482, attack.t1069.001, attack.t1069.002, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Check the process command line arguments for any of the specific strings mentioned in the detection section 
Review the parent-child process relationship to understand the context of the execution 
Look for any associated network activity or file modifications that align with Bloodhound/Sharphound behavior 
Correlate the process execution with other security events to determine the impact and scope of the activity","Legitimate security tools that have similar command line parameters 
Administrative scripts that use similar syntax 
Custom applications with innocent use of these parameters","Product=""*SharpHound*"" OR Description=""*SharpHound*"" OR Company IN (""*SpecterOps*"", ""*evil corp*"") OR Image IN (""*\\Bloodhound.exe*"", ""*\\SharpHound.exe*"") OR CommandLine IN (""* -CollectionMethod All *"", ""* --CollectionMethods Session *"", ""* --Loop --Loopduration *"", ""* --PortScanTimeout *"", ""*.exe -c All -d *"", ""*Invoke-Bloodhound*"", ""*Get-BloodHoundData*"") OR (CommandLine=""* -JsonFolder *"" CommandLine=""* -ZipFileName *"") OR (CommandLine=""* DCOnly *"" CommandLine=""* --NoSaveCache *"")"
"HackTool - F-Secure C3 Load by Rundll32","Alfie Champion (ajpc500)","F-Secure C3 produces DLLs with a default exported StartNodeRelay function.","attack.defense_evasion, attack.t1218.011","process_creation","windows","Not classified","Check the parent process of rundll32.exe to determine if it is initiated by a legitimate application 
Analyze the content of the DLL being loaded to verify if it is related to F-Secure C3 or known software 
Look for additional suspicious activities or indicators of compromise on the system","Legitimate use of rundll32.exe to load DLLs 
Legitimate software using StartNodeRelay function 
False positives due to similar command line arguments","CommandLine=""*rundll32.exe*"" CommandLine=""*.dll*"" CommandLine=""*StartNodeRelay*"""
"HackTool - Certify Execution","pH-T (Nextron Systems)","Detects Certify a tool for Active Directory certificate abuse based on PE metadata characteristics and common command line arguments.","attack.discovery, attack.credential_access, attack.t1649","process_creation","windows","Not classified","Check if the Certify tool execution was part of a scheduled or authorized task within the organization 
Analyze the parent-child process relationship to determine the origin of the Certify tool execution 
Inspect the network connections or file system activities associated with the Certify tool execution for any suspicious behavior 
Verify the digital signature and hash of the Certify.exe file to confirm its integrity and authenticity","Legitimate use of Certify tool for authorized Active Directory management tasks 
Other tools or scripts with similar PE metadata characteristics and command line arguments 
Temporary files or artifacts named Certify.exe created by legitimate software installations","Image=""*\\Certify.exe"" OR OriginalFileName=""Certify.exe"" OR Description=""*Certify*"" OR (CommandLine IN (""*.exe cas *"", ""*.exe find *"", ""*.exe pkiobjects *"", ""*.exe request *"", ""*.exe download *"") CommandLine IN (""* /vulnerable*"", ""* /template:*"", ""* /altname:*"", ""* /domain:*"", ""* /path:*"", ""* /ca:*""))"
"HackTool - Certipy Execution","pH-T (Nextron Systems)","Detects Certipy a tool for Active Directory Certificate Services enumeration and abuse based on PE metadata characteristics and common command line arguments.","attack.discovery, attack.credential_access, attack.t1649","process_creation","windows","Not classified","Check if the Certipy tool was legitimately used by authorized security personnel for testing purposes 
Verify the context in which the Certipy tool was executed to determine if it aligns with security testing activities 
Investigate the system for any signs of unauthorized access or malicious activity in conjunction with Certipy execution 
Analyze the command-line arguments and flags used during the Certipy execution to understand the intent and potential risk","Legitimate use of Certipy tool by authorized personnel for security testing purposes 
Presence of similarly named files or processes that are not related to Certipy 
Updates or installations of legitimate software that may trigger similar detection criteria","Image=""*\\Certipy.exe"" OR OriginalFileName=""Certipy.exe"" OR Description=""*Certipy*"" OR (CommandLine IN (""* auth *"", ""* find *"", ""* forge *"", ""* relay *"", ""* req *"", ""* shadow *"") CommandLine IN (""* -bloodhound*"", ""* -ca-pfx *"", ""* -dc-ip *"", ""* -kirbi*"", ""* -old-bloodhound*"", ""* -pfx *"", ""* -target*"", ""* -username *"", ""* -vulnerable*"", ""*auth -pfx*"", ""*shadow auto*"", ""*shadow list*""))"
"Operator Bloopers Cobalt Strike Commands","_pete_0, TheDFIRReport","Detects use of Cobalt Strike commands accidentally entered in the CMD shell","attack.execution, attack.t1059.003, stp.1u","process_creation","windows","Not classified","Review the command-line arguments of the process to determine if they match known Cobalt Strike commands 
Check if the process execution is part of a legitimate red teaming exercise or security assessment 
Correlate the process execution with other security events to identify any malicious behavior 
Investigate the user context and permissions associated with the process for any anomalies","Legitimate use of Cobalt Strike commands in a controlled environment 
Use of similar command-line arguments by legitimate tools 
Manual testing or troubleshooting by authorized personnel 
Scripting or automation that mimics Cobalt Strike commands","OriginalFileName=""Cmd.Exe"" OR Image=""*\\cmd.exe"" CommandLine IN (""cmd *"", ""cmd.exe*"", ""c:\\windows\\system32\\cmd.exe*"") CommandLine IN (""*psinject*"", ""*spawnas*"", ""*make_token*"", ""*remote-exec*"", ""*rev2self*"", ""*dcsync*"", ""*logonpasswords*"", ""*execute-assembly*"", ""*getsystem*"")"
"Operator Bloopers Cobalt Strike Modules","_pete_0, TheDFIRReport","Detects Cobalt Strike module/commands accidentally entered in CMD shell","attack.execution, attack.t1059.003","process_creation","windows","Not classified","Check if the commands were executed by authorized users or security tools 
Review any ongoing red teaming or penetration testing activities 
Correlate the activity with other security events to determine the context of the commands entered 
Verify if the commands were part of a known legitimate operation or exercise","Legitimate use of Cobalt Strike modules by authorized personnel 
Legitimate use of similar commands by security tools or scripts 
Commands entered as part of authorized red teaming exercises","OriginalFileName=""Cmd.Exe"" OR Image=""*\\cmd.exe"" CommandLine IN (""*Invoke-UserHunter*"", ""*Invoke-ShareFinder*"", ""*Invoke-Kerberoast*"", ""*Invoke-SMBAutoBrute*"", ""*Invoke-Nightmare*"", ""*zerologon*"", ""*av_query*"")"
"CobaltStrike Load by Rundll32","Wojciech Lesicki","Rundll32 can be use by Cobalt Strike with StartW function to load DLLs from the command line.","attack.defense_evasion, attack.t1218.011","process_creation","windows","Not classified","Review the command line arguments of rundll32.exe processes to identify the DLL being loaded and the StartW function 
Check the parent process of rundll32.exe to determine if it is a known and trusted application 
Look for any additional suspicious behavior or network connections associated with the rundll32.exe process 
Compare the rundll32.exe process against known good baselines for the system to identify anomalies","Legitimate use of rundll32.exe to load DLLs during normal system operation 
Software installations that use rundll32.exe to load legitimate DLLs 
Scripts or tools that utilize rundll32.exe for benign purposes","Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" OR CommandLine IN (""*rundll32.exe*"", ""*rundll32 *"") CommandLine=""*.dll*"" CommandLine IN (""* StartW"", ""*,StartW"")"
"Potential CobaltStrike Process Patterns","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects potential process patterns related to Cobalt Strike beacon activity","attack.execution, attack.t1059","process_creation","windows","Not classified","Review the parent-child process relationship to determine if the activity is part of a known administrative task 
Check if the observed behavior aligns with any scheduled system maintenance activities 
Verify if the detected patterns are related to authorized security tools or scripts in the environment 
Investigate if the process patterns are triggered by custom scripts or applications used within the organization","Legitimate administrative or system maintenance tasks may trigger these patterns 
Development or testing environments may exhibit similar behavior 
Certain security tools or scripts may generate similar process patterns 
Customized or legitimate scripts used by the organization may match the detection criteria","(CommandLine=""*cmd.exe /C whoami"" ParentImage=""C:\\Temp\\*"") OR (ParentImage IN (""*\\runonce.exe"", ""*\\dllhost.exe"") CommandLine=""*cmd.exe /c echo*"" CommandLine=""*> \\\\.\\pipe*"") OR (ParentCommandLine=""*cmd.exe /C echo*"" ParentCommandLine=""* > \\\\.\\pipe*"" CommandLine=""*conhost.exe 0xffffffff -ForceV1"") OR (ParentCommandLine=""*/C whoami"" CommandLine=""*conhost.exe 0xffffffff -ForceV1"")"
"HackTool - Covenant PowerShell Launcher","Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community","Detects suspicious command lines used in Covenant luanchers","attack.execution, attack.defense_evasion, attack.t1059.001, attack.t1564.003","process_creation","windows","Not classified","Check if the process execution is associated with authorized users or systems 
Review the context of the command line execution to determine if it aligns with legitimate activities 
Correlate the event with additional logs or data sources to identify the full scope of the activity 
Conduct interviews with relevant personnel to confirm the purpose of Covenant tool usage","Legitimate use of Covenant tool by authorized users 
Use of similar command lines by system administration tools 
Development or testing environments where Covenant is legitimately used 
Scripting or automation tools that may trigger similar patterns","(CommandLine=""*-Sta*"" CommandLine=""*-Nop*"" CommandLine=""*-Window*"" CommandLine=""*Hidden*"" CommandLine IN (""*-Command*"", ""*-EncodedCommand*"")) OR CommandLine IN (""*sv o (New-Object IO.MemorySteam);sv d *"", ""*mshta file.hta*"", ""*GruntHTTP*"", ""*-EncodedCommand cwB2ACAAbwAgA*"")"
"HackTool - CrackMapExec Execution","Florian Roth (Nextron Systems)","This rule detect common flag combinations used by CrackMapExec in order to detect its use even if the binary has been replaced.","attack.execution, attack.persistence, attack.privilege_escalation, attack.credential_access, attack.discovery, attack.t1047, attack.t1053, attack.t1059.003, attack.t1059.001, attack.t1110, attack.t1201","process_creation","windows","Not classified","Check if the CrackMapExec execution was part of a scheduled security assessment 
Verify if the flags used align with known red teaming activities 
Correlate the event with other security controls to determine if it was part of a legitimate exercise 
Investigate the user context and intent behind the CrackMapExec execution","Legitimate use of CrackMapExec for authorized security assessments 
Legitimate use of similar tools with overlapping flags 
Use of CrackMapExec in a controlled lab environment 
Use of CrackMapExec by red teamers during authorized exercises","Image=""*\\crackmapexec.exe"" OR CommandLine=""* -M pe_inject *"" OR (CommandLine=""* --local-auth*"" CommandLine=""* -u *"" CommandLine=""* -x *"") OR (CommandLine=""* --local-auth*"" CommandLine=""* -u *"" CommandLine=""* -p *"" CommandLine=""* -H 'NTHASH'*"") OR (CommandLine=""* mssql *"" CommandLine=""* -u *"" CommandLine=""* -p *"" CommandLine=""* -M *"" CommandLine=""* -d *"") OR (CommandLine=""* smb *"" CommandLine=""* -u *"" CommandLine=""* -H *"" CommandLine=""* -M *"" CommandLine=""* -o *"") OR (CommandLine=""* smb *"" CommandLine=""* -u *"" CommandLine=""* -p *"" CommandLine=""* --local-auth*"") OR (CommandLine=""* --local-auth*"" CommandLine=""* -u *"" CommandLine=""* -p *"" CommandLine=""* 10.*"" CommandLine=""* 192.168.*"" CommandLine=""*/24 *"")"
"HackTool - CrackMapExec Execution Patterns","Thomas Patzke","Detects various execution patterns of the CrackMapExec pentesting framework","attack.execution, attack.t1047, attack.t1053, attack.t1059.003, attack.t1059.001, attack.s0106","process_creation","windows","Not classified","Check if the activity was performed by authorized personnel during a scheduled pentesting exercise 
Review system logs to identify any legitimate system maintenance tasks or scripts that may have triggered the detection 
Correlate the detected activity with any known system administration scripts or automation processes","Legitimate use of pentesting tools by authorized personnel 
Scheduled system maintenance tasks 
Automated scripts used for system administration","CommandLine IN (""*cmd.exe /Q /c * 1> \\\\*\\*\\* 2>&1*"", ""*cmd.exe /C * > \\\\*\\*\\* 2>&1*"", ""*cmd.exe /C * > *\\Temp\\* 2>&1*"", ""*powershell.exe -exec bypass -noni -nop -w 1 -C \""*"", ""*powershell.exe -noni -nop -w 1 -enc *"")"
"HackTool - CrackMapExec Process Patterns","Florian Roth (Nextron Systems)","Detects suspicious process patterns found in logs when CrackMapExec is used","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Check if the activity was performed by authorized users or during scheduled maintenance windows 
Review any change management tickets or approvals related to the observed activity 
Correlate with network and endpoint logs to determine the scope of the suspicious activity 
Conduct memory forensics analysis on the affected system to identify any signs of compromise","Legitimate use of CrackMapExec tool by authorized personnel 
Legitimate administrative tasks involving lsass.exe 
Legitimate use of process dumping tools for system troubleshooting","(CommandLine=""*tasklist /fi *"" CommandLine=""*Imagename eq lsass.exe*"" CommandLine IN (""*cmd.exe /c *"", ""*cmd.exe /r *"", ""*cmd.exe /k *"", ""*cmd /c *"", ""*cmd /r *"", ""*cmd /k *"") User IN (""*AUTHORI*"", ""*AUTORI*"")) OR (CommandLine=""*do rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump*"" CommandLine=""*\\Windows\\Temp\\*"" CommandLine=""* full*"" CommandLine=""*%%B*"") OR (CommandLine=""*tasklist /v /fo csv*"" CommandLine=""*findstr /i \""lsass\""*"")"
"HackTool - CrackMapExec PowerShell Obfuscation","Thomas Patzke","The CrachMapExec pentesting framework implements a PowerShell obfuscation with some static strings detected by this rule.","attack.execution, attack.t1059.001, attack.defense_evasion, attack.t1027.005","process_creation","windows","Not classified","Check if the PowerShell obfuscation is part of a known red team or penetration testing exercise. 
Verify if the obfuscated PowerShell commands are triggered by authorized security tools or scripts. 
Review scheduled tasks or scripts to determine if the obfuscation is used for legitimate administrative purposes. 
Analyze the context of the PowerShell commands to identify any indicators of compromise or malicious intent.","Legitimate use of PowerShell obfuscation techniques by authorized red team or penetration testing activities. 
Use of similar obfuscation techniques by security tools or scripts. 
Scheduled tasks or scripts that utilize obfuscated PowerShell commands for legitimate purposes.","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") CommandLine IN (""*join*split*"", ""*( $ShellId[1]+$ShellId[13]+'x')*"", ""*( $PSHome[*]+$PSHOME[*]+*"", ""*( $env:Public[13]+$env:Public[5]+'x')*"", ""*( $env:ComSpec[4,*,25]-Join'')*"", ""*[1,3]+'x'-Join'')*"")"
"HackTool - CreateMiniDump Execution","Florian Roth (Nextron Systems)","Detects the use of CreateMiniDump hack tool used to dump the LSASS process memory for credential extraction on the attacker's machine","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Check the process command line arguments for any suspicious parameters 
Review the parent process and look for any unusual behavior or suspicious processes 
Analyze network connections or file modifications associated with the process 
Compare the process behavior with known good baselines or legitimate use cases","Legitimate use of CreateMiniDump tool for troubleshooting purposes 
Use of legitimate software with similar behavior 
False positives due to software updates or installations","Image=""*\\CreateMiniDump.exe"" OR Imphash=""4a07f944a83e8a7c2525efa35dd30e2f"" OR Hashes=""*IMPHASH=4a07f944a83e8a7c2525efa35dd30e2f*"""
"HackTool - DInjector PowerShell Cradle Execution","Florian Roth (Nextron Systems)","Detects the use of the Dinject PowerShell cradle based on the specific flags","attack.defense_evasion, attack.t1055","process_creation","windows","Not classified","Review the process command line arguments for the presence of '/am51' and '/password' 
Check the reputation of the process and associated files with threat intelligence feeds 
Analyze the parent-child process relationship to identify the origin of the suspicious activity 
Correlate the event with other security events to determine the scope of potential impact","Legitimate use of tools or scripts that contain similar flags 
Development or testing environments where such tools are authorized 
Scripting or automation tasks that involve similar command line parameters","CommandLine=""* /am51*"" CommandLine=""* /password*"""
"HackTool - Dumpert Process Dumper Execution","Florian Roth (Nextron Systems)","Detects the use of Dumpert process dumper, which dumps the lsass.exe process memory","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Check if the Dumpert tool was used as part of a legitimate system administration activity 
Verify if the Dumpert activity was authorized and documented 
Review any security incidents or investigations where Dumpert was used for memory dumping 
Cross-reference with change management records to confirm authorized use of Dumpert","Legitimate use of Dumpert tool for system troubleshooting or analysis 
Use of Dumpert in a controlled testing environment 
Dumpert used by authorized security personnel for incident response purposes","Hashes=""*09D278F9DE118EF09163C6140255C690*"" OR CommandLine=""*Dumpert.dll*"""
"HackTool - Empire PowerShell Launch Parameters","Florian Roth (Nextron Systems)","Detects suspicious powershell command line parameters used in Empire","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the parent process of the PowerShell execution to determine if it is a known and trusted application 
Analyze the content of the encoded command to identify its purpose and legitimacy 
Check if the PowerShell execution is part of a scheduled task or a legitimate administrative operation 
Compare the observed PowerShell command line parameters with known benign scripts or tools","Legitimate PowerShell scripts or tools that use similar launch parameters 
Scheduled tasks or system processes that use encoded commands 
Administrative scripts or automation tools that employ encoded commands","CommandLine IN (""* -NoP -sta -NonI -W Hidden -Enc *"", ""* -noP -sta -w 1 -enc *"", ""* -NoP -NonI -W Hidden -enc *"", ""* -noP -sta -w 1 -enc*"", ""* -enc  SQB*"", ""* -nop -exec bypass -EncodedCommand *"")"
"HackTool - Empire PowerShell UAC Bypass","Ecco","Detects some Empire PowerShell UAC bypass methods","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002, car.2019-04-001","process_creation","windows","Not classified","Check the context in which the suspicious PowerShell command was executed. 
Verify if the command was executed by a known system administrator or security tool. 
Investigate the parent process to determine if it is part of a legitimate operation. 
Review any recent software installations or updates that may have triggered the detection.","Legitimate administrative or system maintenance tasks may use similar PowerShell commands. 
Security tools or scripts performing authorized actions may trigger this detection. 
Upgrades or installations of software may involve similar command lines. 
Scheduled tasks or scripts may contain these commands for legitimate purposes.","CommandLine IN (""* -NoP -NonI -w Hidden -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update)*"", ""* -NoP -NonI -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update);*"")"
"Hacktool Execution - Imphash","Florian Roth (Nextron Systems)","Detects the execution of different Windows based hacktools via their import hash (imphash) even if the files have been renamed","attack.credential_access, attack.t1588.002, attack.t1003","process_creation","windows","Not classified","Investigate the process creation logs in Windows Event Viewer or security tools like Sysinternals Process Explorer for unusual activity patterns or command-line arguments that match the execution of known hacktools 
Look for unusual outbound network traffic from the suspected host to identify C2 communication or data exfiltration attempts. Tools like Wireshark or built-in Windows performance monitor can be utilized 
Hacktools are often executed from uncommon locations. Check the execution path of flagged processes for non-standard directories 
If available, use EDR solutions to get more context about the execution, such as related file modifications, registry changes, or other suspicious behaviors linked to the detected imphash values","Some of the hash values may correspond to legitimate administrative tools that share similar import hashes due to common functionalities or libraries used 
Developers might use certain utilities for legitimate purposes, which could trigger these imphash signatures 
 Security researchers or incident response teams may execute these tools in a controlled environment for analysis or testing defenses","Imphash IN (""bcca3c247b619dcd13c8cdff5f123932"", ""3a19059bd7688cb88e70005f18efc439"", ""bf6223a49e45d99094406777eb6004ba"", ""23867a89c2b8fc733be6cf5ef902f2d1"", ""a37ff327f8d48e8a4d2f757e1b6e70bc"", ""f9a28c458284584a93b14216308d31bd"", ""6118619783fc175bc7ebecff0769b46e"", ""959a83047e80ab68b368fdb3f4c6e4ea"", ""563233bfa169acc7892451f71ad5850a"", ""87575cb7a0e0700eb37f2e3668671a08"", ""13f08707f759af6003837a150a371ba1"", ""1781f06048a7e58b323f0b9259be798b"", ""233f85f2d4bc9d6521a6caae11a1e7f5"", ""24af2584cbf4d60bbe5c6d1b31b3be6d"", ""632969ddf6dbf4e0f53424b75e4b91f2"", ""713c29b396b907ed71a72482759ed757"", ""749a7bb1f0b4c4455949c0b2bf7f9e9f"", ""8628b2608957a6b0c6330ac3de28ce2e"", ""8b114550386e31895dfab371e741123d"", ""94cb940a1a6b65bed4d5a8f849ce9793"", ""9d68781980370e00e0bd939ee5e6c141"", ""b18a1401ff8f444056d29450fbc0a6ce"", ""cb567f9498452721d77a451374955f5f"", ""730073214094cd328547bf1f72289752"", ""17b461a082950fc6332228572138b80c"", ""dc25ee78e2ef4d36faa0badf1e7461c9"", ""819b19d53ca6736448f9325a85736792"", ""829da329ce140d873b4a8bde2cbfaa7e"", ""c547f2e66061a8dffb6f5a3ff63c0a74"", ""0588081ab0e63ba785938467e1b10cca"", ""0d9ec08bac6c07d9987dfd0f1506587c"", ""bc129092b71c89b4d4c8cdf8ea590b29"", ""4da924cf622d039d58bce71cdf05d242"", ""e7a3a5c377e2d29324093377d7db1c66"", ""9a9dbec5c62f0380b4fa5fd31deffedf"", ""af8a3976ad71e5d5fdfb67ddb8dadfce"", ""0c477898bbf137bbd6f2a54e3b805ff4"", ""0ca9f02b537bcea20d4ea5eb1a9fe338"", ""3ab3655e5a14d4eefc547f4781bf7f9e"", ""e6f9d5152da699934b30daab206471f6"", ""3ad59991ccf1d67339b319b15a41b35d"", ""ffdd59e0318b85a3e480874d9796d872"", ""0cf479628d7cc1ea25ec7998a92f5051"", ""07a2d4dcbd6cb2c6a45e6b101f0b6d51"", ""d6d0f80386e1380d05cb78e871bc72b1"", ""38d9e015591bbfd4929e0d0f47fa0055"", ""0e2216679ca6e1094d63322e3412d650"", ""ada161bf41b8e5e9132858cb54cab5fb"", ""2a1bc4913cd5ecb0434df07cb675b798"", ""11083e75553baae21dc89ce8f9a195e4"", ""a23d29c9e566f2fa8ffbb79267f5df80"", ""4a07f944a83e8a7c2525efa35dd30e2f"", ""767637c23bb42cd5d7397cf58b0be688"", ""14c4e4c72ba075e9069ee67f39188ad8"", ""3c782813d4afce07bbfc5a9772acdbdc"", ""7d010c6bb6a3726f327f7e239166d127"", ""89159ba4dd04e4ce5559f132a9964eb3"", ""6f33f4a5fc42b8cec7314947bd13f30f"", ""5834ed4291bdeb928270428ebbaf7604"", ""5a8a8a43f25485e7ee1b201edcbc7a38"", ""dc7d30b90b2d8abf664fbed2b1b59894"", ""41923ea1f824fe63ea5beb84db7a3e74"", ""3de09703c8e79ed2ca3f01074719906b"", ""a53a02b997935fd8eedcb5f7abab9b9f"", ""e96a73c7bf33a464c510ede582318bf2"", ""32089b8851bbf8bc2d014e9f37288c83"", ""09D278F9DE118EF09163C6140255C690"", ""03866661686829d806989e2fc5a72606"", ""e57401fbdadcd4571ff385ab82bd5d6d"", ""84B763C45C0E4A3E7CA5548C710DB4EE"", ""19584675d94829987952432e018d5056"", ""330768a4f172e10acb6287b87289d83b"", ""885c99ccfbe77d1cbfcb9c4e7c1a3313"", ""22a22bc9e4e0d2f189f1ea01748816ac"", ""7fa30e6bb7e8e8a69155636e50bf1b28"", ""96df3a3731912449521f6f8d183279b1"", ""7e6cf3ff4576581271ac8a313b2aab46"", ""51791678f351c03a0eb4e2a7b05c6e17"", ""25ce42b079282632708fc846129e98a5"", ""021bcca20ba3381b11bdde26b4e62f20"", ""59223b5f52d8799d38e0754855cbdf42"", ""81e75d8f1d276c156653d3d8813e4a43"", ""17244e8b6b8227e57fe709ccad421420"", ""5b76da3acdedc8a5cdf23a798b5936b4"", ""cb2b65bb77d995cc1c0e5df1c860133c"", ""40445337761d80cf465136fafb1f63e6"", ""8a790f401b29fa87bc1e56f7272b3aa6"", ""b50199e952c875241b9ce06c971ce3c1"") OR Hashes IN (""*IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932*"", ""*IMPHASH=3A19059BD7688CB88E70005F18EFC439*"", ""*IMPHASH=bf6223a49e45d99094406777eb6004ba*"", ""*IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1*"", ""*IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC*"", ""*IMPHASH=F9A28C458284584A93B14216308D31BD*"", ""*IMPHASH=6118619783FC175BC7EBECFF0769B46E*"", ""*IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA*"", ""*IMPHASH=563233BFA169ACC7892451F71AD5850A*"", ""*IMPHASH=87575CB7A0E0700EB37F2E3668671A08*"", ""*IMPHASH=13F08707F759AF6003837A150A371BA1*"", ""*IMPHASH=1781F06048A7E58B323F0B9259BE798B*"", ""*IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5*"", ""*IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D*"", ""*IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2*"", ""*IMPHASH=713C29B396B907ED71A72482759ED757*"", ""*IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F*"", ""*IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E*"", ""*IMPHASH=8B114550386E31895DFAB371E741123D*"", ""*IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793*"", ""*IMPHASH=9D68781980370E00E0BD939EE5E6C141*"", ""*IMPHASH=B18A1401FF8F444056D29450FBC0A6CE*"", ""*IMPHASH=CB567F9498452721D77A451374955F5F*"", ""*IMPHASH=730073214094CD328547BF1F72289752*"", ""*IMPHASH=17B461A082950FC6332228572138B80C*"", ""*IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9*"", ""*IMPHASH=819B19D53CA6736448F9325A85736792*"", ""*IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E*"", ""*IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74*"", ""*IMPHASH=0588081AB0E63BA785938467E1B10CCA*"", ""*IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C*"", ""*IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29*"", ""*IMPHASH=4DA924CF622D039D58BCE71CDF05D242*"", ""*IMPHASH=E7A3A5C377E2D29324093377D7DB1C66*"", ""*IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF*"", ""*IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE*"", ""*IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4*"", ""*IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338*"", ""*IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E*"", ""*IMPHASH=E6F9D5152DA699934B30DAAB206471F6*"", ""*IMPHASH=3AD59991CCF1D67339B319B15A41B35D*"", ""*IMPHASH=FFDD59E0318B85A3E480874D9796D872*"", ""*IMPHASH=0CF479628D7CC1EA25EC7998A92F5051*"", ""*IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51*"", ""*IMPHASH=D6D0F80386E1380D05CB78E871BC72B1*"", ""*IMPHASH=38D9E015591BBFD4929E0D0F47FA0055*"", ""*IMPHASH=0E2216679CA6E1094D63322E3412D650*"", ""*IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB*"", ""*IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798*"", ""*IMPHASH=11083E75553BAAE21DC89CE8F9A195E4*"", ""*IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80*"", ""*IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F*"", ""*IMPHASH=767637C23BB42CD5D7397CF58B0BE688*"", ""*IMPHASH=14C4E4C72BA075E9069EE67F39188AD8*"", ""*IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC*"", ""*IMPHASH=7D010C6BB6A3726F327F7E239166D127*"", ""*IMPHASH=89159BA4DD04E4CE5559F132A9964EB3*"", ""*IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F*"", ""*IMPHASH=5834ED4291BDEB928270428EBBAF7604*"", ""*IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38*"", ""*IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894*"", ""*IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74*"", ""*IMPHASH=3DE09703C8E79ED2CA3F01074719906B*"", ""*IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F*"", ""*IMPHASH=E96A73C7BF33A464C510EDE582318BF2*"", ""*IMPHASH=32089B8851BBF8BC2D014E9F37288C83*"", ""*IMPHASH=09D278F9DE118EF09163C6140255C690*"", ""*IMPHASH=03866661686829d806989e2fc5a72606*"", ""*IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d*"", ""*IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE*"", ""*IMPHASH=19584675D94829987952432E018D5056*"", ""*IMPHASH=330768A4F172E10ACB6287B87289D83B*"", ""*IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313*"", ""*IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC*"", ""*IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28*"", ""*IMPHASH=96DF3A3731912449521F6F8D183279B1*"", ""*IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46*"", ""*IMPHASH=51791678F351C03A0EB4E2A7B05C6E17*"", ""*IMPHASH=25CE42B079282632708FC846129E98A5*"", ""*IMPHASH=021BCCA20BA3381B11BDDE26B4E62F20*"", ""*IMPHASH=59223B5F52D8799D38E0754855CBDF42*"", ""*IMPHASH=81E75D8F1D276C156653D3D8813E4A43*"", ""*IMPHASH=17244E8B6B8227E57FE709CCAD421420*"", ""*IMPHASH=5B76DA3ACDEDC8A5CDF23A798B5936B4*"", ""*IMPHASH=CB2B65BB77D995CC1C0E5DF1C860133C*"", ""*IMPHASH=40445337761D80CF465136FAFB1F63E6*"", ""*IMPHASH=8A790F401B29FA87BC1E56F7272B3AA6*"", ""*IMPHASH=B50199E952C875241B9CE06C971CE3C1*"")"
"Hacktool Execution - PE Metadata","Florian Roth (Nextron Systems)","Detects the execution of different Windows based hacktools via PE metadata (company, product, etc.) even if the files have been renamed","attack.credential_access, attack.t1588.002, attack.t1003","process_creation","windows","Not classified","Check the process command line for the executed file with Cube0x0 metadata 
Verify the file's digital signature and reputation using threat intelligence sources 
Analyze the behavior of the process for any malicious activities 
Investigate the source and purpose of the file with Cube0x0 metadata","Legitimate tools or software from Cube0x0 may trigger this rule 
Files with Cube0x0 metadata that are not hacktools 
Files with Cube0x0 metadata used for legitimate purposes","Company=""Cube0x0"""
"HackTool - GMER Rootkit Detector and Remover Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the execution GMER tool based on image and hash fields.","attack.defense_evasion","process_creation","windows","Not classified","Verify the legitimacy of the GMER tool execution by checking the purpose and context of its usage 
Review the file path and parent process of gmer.exe to determine if it aligns with expected behavior 
Cross-reference the hash values with known good software to rule out false positives 
Check if the GMER tool execution is part of a security assessment or incident response activity","Legitimate use of GMER tool for system analysis and troubleshooting 
File named gmer.exe used for non-malicious purposes 
Hash collisions with legitimate software 
GMER tool used by security professionals for rootkit detection","Image=""*\\gmer.exe"" OR Hashes IN (""*MD5=E9DC058440D321AA17D0600B3CA0AB04*"", ""*SHA1=539C228B6B332F5AA523E5CE358C16647D8BBE57*"", ""*SHA256=E8A3E804A96C716A3E9B69195DB6FFB0D33E2433AF871E4D4E1EAB3097237173*"") OR md5=""e9dc058440d321aa17d0600b3ca0ab04"" OR sha1=""539c228b6b332f5aa523e5ce358c16647d8bbe57"" OR sha256=""e8a3e804a96c716a3e9b69195db6ffb0d33e2433af871e4d4e1eab3097237173"""
"HackTool - HandleKatz LSASS Dumper Execution","Florian Roth (Nextron Systems)","Detects the use of HandleKatz, a tool that demonstrates the usage of cloned handles to Lsass in order to create an obfuscated memory dump of the same","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Check for legitimate use cases of tools that interact with LSASS or create memory dumps 
Verify if the activity is part of authorized penetration testing or red teaming exercises 
Review the context of the process creation to determine if it aligns with known security tools or offensive security practices 
Correlate the suspicious activity with other security events or logs to identify any malicious behavior","Legitimate use of tools that have similar behavior to HandleKatz 
Development or testing environments where such tools are used 
Security tools or scripts that interact with LSASS for legitimate purposes","(Image=""*\\loader.exe"" CommandLine=""*--pid:*"") OR Imphash IN (""38d9e015591bbfd4929e0d0f47fa0055"", ""0e2216679ca6e1094d63322e3412d650"") OR Hashes IN (""IMPHASH=38D9E015591BBFD4929E0D0F47FA0055"", ""IMPHASH=0E2216679CA6E1094D63322E3412D650"") OR (CommandLine=""*--pid:*"" CommandLine=""*--outfile:*"" CommandLine IN (""*.dmp*"", ""*lsass*"", ""*.obf*"", ""*dump*""))"
"HackTool - Hashcat Password Cracker Execution","frack113","Execute Hashcat.exe with provided SAM file from registry of Windows and Password list to crack against","attack.credential_access, attack.t1110.002","process_creation","windows","Not classified","Check if the Hashcat.exe execution was performed by authorized personnel or security testing tools 
Review the context around the Hashcat.exe execution to determine if it was part of a legitimate security assessment 
Correlate the Hashcat.exe execution with other security events to identify any malicious behavior 
Verify the source and integrity of the SAM file and password list used in the cracking attempt","Legitimate password cracking tools used by authorized personnel 
Security tools that simulate password cracking for testing purposes 
Tools used in penetration testing engagements","Image=""*\\hashcat.exe"" OR (CommandLine=""*-a *"" CommandLine=""*-m 1000 *"" CommandLine=""*-r *"")"
"HackTool - Htran/NATBypass Execution","Florian Roth (Nextron Systems)","Detects executable names or flags used by Htran or Htran-like tools (e.g. NATBypass)","attack.command_and_control, attack.t1090, attack.s0040","process_creation","windows","Not classified","Review the command-line arguments of the process to determine if it matches the known flags used by Htran or NATBypass 
Check the reputation of the executable and its associated behavior in the environment 
Correlate process execution with other security events to identify any malicious patterns or behaviors 
Investigate the process' parent-child relationship to understand the context of its execution","Legitimate use of tools with similar executable names or flags 
Development or testing environments where these tools are legitimately used 
Tools or scripts that have similar behavior but are not malicious","Image IN (""*\\htran.exe"", ""*\\lcx.exe"") OR CommandLine IN (""*.exe -tran *"", ""*.exe -slave *"")"
"HackTool - Hydra Password Bruteforce Execution","Vasiliy Burov","Detects command line parameters used by Hydra password guessing hack tool","attack.credential_access, attack.t1110, attack.t1110.001","process_creation","windows","Not classified","Check the process command line arguments for the presence of '-u' and '-p' flags 
Review the context in which the process was executed to determine if it aligns with legitimate use cases 
Correlate the process execution with other security events to identify any malicious behavior 
Verify the source and integrity of the software that triggered the detection","Legitimate password management tools that use similar command line parameters 
Development or testing tools that mimic Hydra's command line structure 
Administrative scripts or utilities that contain '-u' and '-p' flags","CommandLine=""*-u *"" CommandLine=""*-p *"" CommandLine IN (""*^USER^*"", ""*^PASS^*"")"
"HackTool - Potential Impacket Lateral Movement Activity","Ecco, oscd.community, Jonhnathan Ribeiro, Tim Rauch","Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework","attack.execution, attack.t1047, attack.lateral_movement, attack.t1021.003","process_creation","windows","Not classified","Review the process execution context to determine if it aligns with authorized activities 
Check for any scheduled tasks or scripts that may be triggering the detection 
Verify if the Impacket framework is being used for legitimate security assessments 
Investigate if system administration tools are utilizing similar command-line arguments","Legitimate use of Impacket framework for authorized security testing 
Scheduled legitimate tasks that match the detection criteria 
Use of similar command-line arguments by system administration tools","(ParentImage IN (""*\\wmiprvse.exe"", ""*\\mmc.exe"", ""*\\explorer.exe"", ""*\\services.exe"") CommandLine=""*cmd.exe*"" CommandLine=""*/Q*"" CommandLine=""*/c*"" CommandLine=""*\\\\127.0.0.1\\*"" CommandLine=""*&1*"") OR (ParentCommandLine IN (""*svchost.exe -k netsvcs*"", ""*taskeng.exe*"") CommandLine=""*cmd.exe*"" CommandLine=""*/C*"" CommandLine=""*Windows\\Temp\\*"" CommandLine=""*&1*"")"
"HackTool - Impacket Tools Execution","Florian Roth (Nextron Systems)","Detects the execution of different compiled Windows binaries of the impacket toolset (based on names or part of their names - could lead to false positives)","attack.execution, attack.t1557.001","process_creation","windows","Not classified","Check if the execution of the Impacket tools was part of a scheduled security assessment or penetration testing activity 
Verify if the Impacket tools were executed by authorized personnel for legitimate network management tasks 
Review documentation or change management records to confirm the purpose of using Impacket tools in the environment 
Analyze network traffic or other logs to determine if the Impacket tools were used maliciously or for unauthorized activities","Legitimate use of the Impacket tools for authorized security testing 
Legitimate use of the Impacket tools by system administrators for network management 
Legitimate use of the Impacket tools in a lab environment for research purposes","Image IN (""*\\goldenPac*"", ""*\\karmaSMB*"", ""*\\kintercept*"", ""*\\ntlmrelayx*"", ""*\\rpcdump*"", ""*\\samrdump*"", ""*\\secretsdump*"", ""*\\smbexec*"", ""*\\smbrelayx*"", ""*\\wmiexec*"", ""*\\wmipersist*"") OR Image IN (""*\\atexec_windows.exe"", ""*\\dcomexec_windows.exe"", ""*\\dpapi_windows.exe"", ""*\\findDelegation_windows.exe"", ""*\\GetADUsers_windows.exe"", ""*\\GetNPUsers_windows.exe"", ""*\\getPac_windows.exe"", ""*\\getST_windows.exe"", ""*\\getTGT_windows.exe"", ""*\\GetUserSPNs_windows.exe"", ""*\\ifmap_windows.exe"", ""*\\mimikatz_windows.exe"", ""*\\netview_windows.exe"", ""*\\nmapAnswerMachine_windows.exe"", ""*\\opdump_windows.exe"", ""*\\psexec_windows.exe"", ""*\\rdp_check_windows.exe"", ""*\\sambaPipe_windows.exe"", ""*\\smbclient_windows.exe"", ""*\\smbserver_windows.exe"", ""*\\sniff_windows.exe"", ""*\\sniffer_windows.exe"", ""*\\split_windows.exe"", ""*\\ticketer_windows.exe"")"
"HackTool - Inveigh Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the use of Inveigh a cross-platform .NET IPv4/IPv6 machine-in-the-middle tool","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Check if the use of Inveigh was part of a planned security assessment or penetration testing activity 
Verify if the tool was executed by authorized personnel for legitimate network monitoring or troubleshooting 
Review any documentation or change control records related to the use of Inveigh in the environment 
Correlate the Inveigh activity with other security tools or logs to determine the context of its usage","Legitimate use of Inveigh for authorized security testing purposes 
Inveigh used by system administrators for network troubleshooting 
Inveigh used in a controlled lab environment for research purposes","Image=""*\\Inveigh.exe"" OR OriginalFileName IN (""\\Inveigh.exe"", ""\\Inveigh.dll"") OR Description=""Inveigh"" OR CommandLine IN (""* -SpooferIP*"", ""* -ReplyToIPs *"", ""* -ReplyToDomains *"", ""* -ReplyToMACs *"", ""* -SnifferIP*"")"
"Invoke-Obfuscation CLIP+ Launcher","Jonathan Cheong, oscd.community","Detects Obfuscated use of Clip.exe to execute PowerShell","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line arguments of the process creation event to understand the context of Clip.exe usage 
Check if the PowerShell execution involving clipboard operations is part of a known and approved script or activity 
Correlate with additional logs to determine if the 'cmd' and '&&' usage is part of a legitimate administrative task 
Investigate the reputation and source of the process to identify any trusted applications utilizing similar techniques","Legitimate use of Clip.exe in a benign context 
Non-malicious PowerShell scripts utilizing clipboard functionality 
Use of 'cmd' and '&&' in non-malicious scenarios","CommandLine=""*cmd*"" CommandLine=""*&&*"" CommandLine=""*clipboard]::*"" CommandLine=""*-f*"" CommandLine IN (""*/c*"", ""*/r*"")"
"Invoke-Obfuscation Obfuscated IEX Invocation","Daniel Bohannon (@Mandiant/@FireEye), oscd.community","Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line of the process creation event to understand the context of the PowerShell invocation 
Check for any legitimate administrative or security tools that may use similar obfuscation techniques 
Correlate with network or file activity logs to determine if any malicious actions were taken 
Investigate the reputation of the process and its associated files or network connections","Legitimate use of PowerShell scripts that involve similar obfuscation techniques 
Upgrades or installations of legitimate software that may trigger similar patterns 
Custom scripts or tools used by the organization that employ obfuscation for security purposes 
Development or testing environments where obfuscation techniques are commonly used"
"Invoke-Obfuscation STDIN+ Launcher","Jonathan Cheong, oscd.community","Detects Obfuscated use of stdin to execute PowerShell","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line arguments of the process execution to understand the context 
Check if the PowerShell execution with stdin is part of a known administrative task or script 
Analyze the parent-child process relationship to determine if the activity is part of a legitimate operation 
Cross-reference with whitelisted scripts or tools that may use similar obfuscation techniques","Legitimate use of PowerShell with stdin for script execution 
Administrative scripts utilizing similar obfuscation techniques 
Security tools or scripts that employ obfuscation for benign purposes","CommandLine=""*cmd*"" CommandLine=""*powershell*"" CommandLine IN (""*/c*"", ""*/r*"") CommandLine=""*noexit*"" OR (CommandLine=""*input*"" CommandLine=""*$*"")"
"Invoke-Obfuscation VAR+ Launcher","Jonathan Cheong, oscd.community","Detects Obfuscated use of Environment Variables to execute PowerShell","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Check the parent process of the PowerShell execution to determine if it is suspicious 
Analyze the content of the PowerShell script for any malicious commands or obfuscation techniques 
Look for additional indicators of compromise on the system, such as new files or registry changes 
Correlate the event with other security events to determine the scope of the potential attack","Legitimate use of environment variables in PowerShell scripts 
Legitimate use of cmd with specific parameters 
Use of similar obfuscation techniques for benign purposes","CommandLine=""*cmd*"" CommandLine=""*\""set*"" CommandLine=""*-f*"" CommandLine IN (""*/c*"", ""*/r*"")"
"Invoke-Obfuscation Via Stdin","Nikita Nazarov, oscd.community","Detects Obfuscated Powershell via Stdin in Scripts","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line of the process creation event to understand the context of the execution 
Check if the process execution is part of a known and approved script or task 
Analyze the content of the script or task to determine if the use of obfuscation is intentional 
Correlate with other security events or logs to identify any related suspicious activities","Legitimate use of obfuscation tools for security testing purposes 
Scripts using similar keywords for benign operations 
Scheduled tasks or scripts that involve setting environment variables","CommandLine=""*set*"" CommandLine=""*&&*"" CommandLine IN (""*environment*"", ""*invoke*"", ""*input*"")"
"Invoke-Obfuscation Via Use Clip","Nikita Nazarov, oscd.community","Detects Obfuscated Powershell via use Clip.exe in Scripts","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line arguments to understand the context of the execution 
Check the reputation of the script or process involved 
Analyze the behavior of the process in question to determine if it is malicious 
Correlate with other security events to identify any related suspicious activities","Legitimate use of Clip.exe in scripts 
Legitimate use of obfuscated PowerShell commands 
Non-malicious activities involving 'echo', 'clip', '&&', 'clipboard', 'invoke', etc.","CommandLine=""*echo*"" CommandLine=""*clip*"" CommandLine=""*&&*"" CommandLine IN (""*clipboard*"", ""*invoke*"", ""*i`*"", ""*n`*"", ""*v`*"", ""*o`*"", ""*k`*"", ""*e`*"")"
"Invoke-Obfuscation Via Use MSHTA","Nikita Nazarov, oscd.community","Detects Obfuscated Powershell via use MSHTA in Scripts","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line of the process creation event to understand the context of the execution 
Check if the script is part of a known and approved deployment or administrative activity 
Analyze the content of the script to determine if the obfuscation is intentional or malicious 
Correlate the process creation event with other security events to identify any related suspicious activities","Legitimate use of MSHTA in scripts for benign purposes 
Use of similar command line arguments in non-malicious scripts 
Scripts that involve legitimate use of obfuscation techniques 
Scripts used by security tools or administrators for testing purposes","CommandLine=""*set*"" CommandLine=""*&&*"" CommandLine=""*mshta*"" CommandLine=""*vbscript:createobject*"" CommandLine=""*.run*"" CommandLine=""*(window.close)*"""
"Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION","Timur Zinniatullin, oscd.community","Detects Obfuscated Powershell via VAR++ LAUNCHER","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Check if the PowerShell script is part of a known security testing activity 
Verify if the obfuscation is being used for legitimate system administration tasks 
Investigate the purpose of the obfuscated script and its source to determine if it is a false positive 
Analyze the context in which the obfuscated PowerShell is being executed for any indicators of legitimate use","Legitimate use of obfuscated PowerShell scripts for security testing tools 
Legitimate use of obfuscation techniques by system administrators for security purposes 
Legitimate use of obfuscated scripts by developers for protection of intellectual property","CommandLine=""*&&set*"" CommandLine=""*cmd*"" CommandLine=""*/c*"" CommandLine=""*-f*"" CommandLine IN (""*{0}*"", ""*{1}*"", ""*{2}*"", ""*{3}*"", ""*{4}*"", ""*{5}*"")"
"HackTool - Koadic Execution","wagga, Jonhnathan Ribeiro, oscd.community","Detects command line parameters used by Koadic hack tool","attack.execution, attack.t1059.003, attack.t1059.005, attack.t1059.007","process_creation","windows","Not classified","Review the Parent Process to determine if the cmd.exe execution is part of a legitimate operation 
Check if the command line parameters are commonly used in your environment for authorized purposes 
Investigate the reputation and purpose of the process and associated files to determine legitimacy 
Correlate with network or endpoint logs to identify any suspicious behavior or additional indicators of compromise","Legitimate use of cmd.exe with similar command line parameters for system administration tasks 
Other legitimate tools or scripts using similar command line parameters 
Development or testing environments where Koadic is intentionally used","Image=""*\\cmd.exe"" OR OriginalFileName=""Cmd.Exe"" CommandLine=""*/q*"" CommandLine=""*/c*"" CommandLine=""*chcp*"""
"HackTool - KrbRelay Execution","Florian Roth (Nextron Systems)","Detects the use of KrbRelay, a Kerberos relaying tool","attack.credential_access, attack.t1558.003","process_creation","windows","Not classified","Check if the KrbRelay tool was used as part of authorized penetration testing activities 
Verify if the Kerberos relaying activity was triggered by a legitimate security tool 
Investigate if the KrbRelay.exe file is part of a known security software installation 
Confirm if the KrbRelay activity occurred in a controlled testing environment","Legitimate use of KrbRelay tool for authorized security testing purposes 
Use of similar tool or legitimate Kerberos-related activities 
Presence of KrbRelay.exe as part of a security tool suite 
Use of KrbRelay in a controlled lab environment","Image=""*\\KrbRelay.exe"" OR OriginalFileName=""KrbRelay.exe"" OR (CommandLine=""* -spn *"" CommandLine=""* -clsid *"" CommandLine=""* -rbcd *"") OR (CommandLine=""*shadowcred*"" CommandLine=""*clsid*"" CommandLine=""*spn*"") OR (CommandLine=""*spn *"" CommandLine=""*session *"" CommandLine=""*clsid *"")"
"HackTool - KrbRelayUp Execution","Florian Roth (Nextron Systems)","Detects KrbRelayUp used to perform a universal no-fix local privilege escalation in Windows domain environments where LDAP signing is not enforced","attack.credential_access, attack.t1558.003, attack.lateral_movement, attack.t1550.003","process_creation","windows","Not classified","Review the command-line arguments of the process to determine the intent and context of the execution 
Check the process execution against a whitelist of approved tools or scripts in the environment 
Correlate the process execution with other security events to identify any related suspicious activities 
Investigate the source of the KrbRelayUp.exe binary for any signs of compromise or unauthorized presence","Legitimate use of tools or scripts that have similar command-line parameters 
Development or testing environments where such tools are authorized 
Known security tools that may trigger similar patterns","Image=""*\\KrbRelayUp.exe"" OR OriginalFileName=""KrbRelayUp.exe"" OR (CommandLine=""* relay *"" CommandLine=""* -Domain *"" CommandLine=""* -ComputerName *"") OR (CommandLine=""* krbscm *"" CommandLine=""* -sc *"") OR (CommandLine=""* spawn *"" CommandLine=""* -d *"" CommandLine=""* -cn *"" CommandLine=""* -cp *"")"
"HackTool - LocalPotato Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of the LocalPotato POC based on basic PE metadata information and default CLI examples","attack.defense_evasion, attack.privilege_escalation, cve.2023.21746","process_creation","windows","Not classified","Check if the LocalPotato tool was legitimately used for authorized security testing 
Verify if LocalPotato.exe is present in a known testing environment 
Review if LocalPotato.exe execution was performed by system administrators for valid reasons 
Correlate with network and other endpoint logs to determine the scope of activity","Legitimate use of LocalPotato tool for authorized security testing 
Legitimate presence of LocalPotato.exe in a testing environment 
LocalPotato.exe used by system administrators for legitimate purposes","Image=""*\\LocalPotato.exe"" OR (CommandLine=""*.exe -i C:\\*"" CommandLine=""*-o Windows\\*"") OR Hashes IN (""*IMPHASH=E1742EE971D6549E8D4D81115F88F1FC*"", ""*IMPHASH=DD82066EFBA94D7556EF582F247C8BB5*"") OR Imphash IN (""E1742EE971D6549E8D4D81115F88F1FC"", ""DD82066EFBA94D7556EF582F247C8BB5"")"
"Potential Meterpreter/CobaltStrike Activity","Teymur Kheirkhabarov, Ecco, Florian Roth","Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting","attack.privilege_escalation, attack.t1134.001, attack.t1134.002","process_creation","windows","Not classified","Check if the activity was part of a scheduled penetration testing exercise 
Review system maintenance logs to confirm the 'rundll32' activity 
Verify if the 'cmd' usage was authorized by checking change management records","Legitimate use of 'getsytem' command in authorized penetration testing activities 
Legitimate use of 'rundll32' for system maintenance tasks 
Legitimate use of 'cmd' for administrative purposes","ParentImage=""*\\services.exe"" (CommandLine=""*/c*"" CommandLine=""*echo*"" CommandLine=""*\\pipe\\*"" CommandLine IN (""*cmd*"", ""*%COMSPEC%*"")) OR (CommandLine=""*rundll32*"" CommandLine=""*.dll,a*"" CommandLine=""*/p:*"") NOT CommandLine=""*MpCmdRun*"""
"HackTool - Mimikatz Execution","Teymur Kheirkhabarov, oscd.community, David ANDRE (additional keywords), Tim Shelton","Detection well-known mimikatz command line arguments","attack.credential_access, attack.t1003.001, attack.t1003.002, attack.t1003.004, attack.t1003.005, attack.t1003.006","process_creation","windows","Not classified","Check if the process execution is part of a legitimate security tool or operation 
Review the context of the process execution to determine if it aligns with expected behavior 
Correlate the process execution with other security events to identify any malicious patterns 
Investigate the user context and privileges associated with the process execution","Legitimate use of tools or functions that mimic mimikatz behavior 
Development or testing environments where mimikatz-like tools are used 
Administrative scripts or tools that trigger similar command line arguments","CommandLine IN (""*DumpCreds*"", ""*mimikatz*"") OR CommandLine IN (""*::aadcookie*"", ""*::detours*"", ""*::memssp*"", ""*::mflt*"", ""*::ncroutemon*"", ""*::ngcsign*"", ""*::printnightmare*"", ""*::skeleton*"", ""*::preshutdown*"", ""*::mstsc*"", ""*::multirdp*"") OR CommandLine IN (""*rpc::*"", ""*token::*"", ""*crypto::*"", ""*dpapi::*"", ""*sekurlsa::*"", ""*kerberos::*"", ""*lsadump::*"", ""*privilege::*"", ""*process::*"", ""*vault::*"")"
"HackTool - PCHunter Execution","Florian Roth (Nextron Systems), Nasreddine Bencherchali","Detects suspicious use of PCHunter, a tool like Process Hacker to view and manipulate processes, kernel options and other low level stuff","attack.execution, attack.discovery, attack.t1082, attack.t1057, attack.t1012, attack.t1083, attack.t1007","process_creation","windows","Not classified","Verify the context in which PCHunter.exe is being executed 
Check if the tool is being used for legitimate system administration tasks 
Investigate the processes and kernel options being manipulated for any malicious activity 
Look for additional indicators of compromise in conjunction with PCHunter execution","Legitimate use of PCHunter tool for system administration tasks 
Presence of Epoolsoft Windows Information View Tools 
False positives may occur due to software development or testing environments","Image IN (""*\\PCHunter64.exe"", ""*\\PCHunter32.exe"") OR OriginalFileName=""PCHunter.exe"" OR Description=""Epoolsoft Windows Information View Tools"" OR Hashes IN (""*SHA1=5F1CBC3D99558307BC1250D084FA968521482025*"", ""*MD5=987B65CD9B9F4E9A1AFD8F8B48CF64A7*"", ""*SHA256=2B214BDDAAB130C274DE6204AF6DBA5AEEC7433DA99AA950022FA306421A6D32*"", ""*IMPHASH=444D210CEA1FF8112F256A4997EED7FF*"", ""*SHA1=3FB89787CB97D902780DA080545584D97FB1C2EB*"", ""*MD5=228DD0C2E6287547E26FFBD973A40F14*"", ""*SHA256=55F041BF4E78E9BFA6D4EE68BE40E496CE3A1353E1CA4306598589E19802522C*"", ""*IMPHASH=0479F44DF47CFA2EF1CCC4416A538663*"") OR md5 IN (""228dd0c2e6287547e26ffbd973a40f14"", ""987b65cd9b9f4e9a1afd8f8b48cf64a7"") OR sha1 IN (""5f1cbc3d99558307bc1250d084fa968521482025"", ""3fb89787cb97d902780da080545584d97fb1c2eb"") OR sha256 IN (""2b214bddaab130c274de6204af6dba5aeec7433da99aa950022fa306421a6d32"", ""55f041bf4e78e9bfa6d4ee68be40e496ce3a1353e1ca4306598589e19802522c"") OR Imphash IN (""444d210cea1ff8112f256a4997eed7ff"", ""0479f44df47cfa2ef1ccc4416a538663"")"
"HackTool - Default PowerSploit/Empire Scheduled Task Creation","Markus Neis, @Karneades","Detects the creation of a schtask via PowerSploit or Empire Default Configuration.","attack.execution, attack.persistence, attack.privilege_escalation, attack.s0111, attack.g0022, attack.g0060, car.2013-08-001, attack.t1053.005, attack.t1059.001","process_creation","windows","Not classified","Check the details of the scheduled task creation to determine if it matches known legitimate activities 
Review the parent process to understand the context of the scheduled task creation 
Correlate the scheduled task creation with other security events to identify any malicious behavior 
Investigate the source of the PowerShell command to identify the actor behind the activity","Legitimate scheduled task creation by system administrators 
Scheduled task creation by legitimate software installations 
Scheduled task creation as part of system maintenance activities","ParentImage IN (""*\\powershell.exe"", ""*\\pwsh.exe"") Image=""*\\schtasks.exe"" CommandLine=""*/Create*"" CommandLine=""*powershell.exe -NonI*"" CommandLine=""*/TN Updater /TR*"" CommandLine IN (""*/SC ONLOGON*"", ""*/SC DAILY /ST*"", ""*/SC ONIDLE*"", ""*/SC HOURLY*"")"
"HackTool - PowerTool Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of the tool PowerTool which has the ability to kill a process, delete its process file, unload drivers, and delete the driver files","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Check if the PowerTool execution was triggered by a scheduled task or a legitimate system process 
Review the command-line arguments passed to PowerTool for any suspicious or unauthorized actions 
Correlate PowerTool execution with other security events to determine the context and potential impact 
Investigate the reputation and source of the PowerTool executable for any signs of compromise","Legitimate use of PowerTool for authorized system administration tasks 
PowerTool used by security researchers for testing and analysis 
PowerTool executed as part of a legitimate software installation process","Image IN (""*\\PowerTool.exe"", ""*\\PowerTool64.exe"") OR OriginalFileName=""PowerTool.exe"""
"HackTool - PurpleSharp Execution","Florian Roth (Nextron Systems)","Detects the execution of the PurpleSharp adversary simulation tool","attack.t1587, attack.resource_development","process_creation","windows","Not classified","Check if the PurpleSharp execution was part of a scheduled red teaming exercise 
Verify if the PurpleSharp tool is used by authorized security personnel for testing purposes 
Review any documentation or change management records related to PurpleSharp usage 
Correlate the PurpleSharp execution with other security tool activities or testing","Legitimate use of PurpleSharp for authorized red teaming or adversary simulation exercises 
Legitimate PurpleSharp binaries used in a controlled environment 
Legitimate PurpleSharp execution as part of security tool testing","Image=""*\\purplesharp*"" OR OriginalFileName=""PurpleSharp.exe"" OR CommandLine IN (""*xyz123456.exe*"", ""*PurpleSharp*"")"
"HackTool - Pypykatz Credentials Dumping Activity","frack113","Detects the usage of ""pypykatz"" to obtain stored credentials. Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database through Windows registry where the SAM database is stored","attack.credential_access, attack.t1003.002","process_creation","windows","Not classified","Check if the pypykatz or python process was executed by a legitimate user or system account 
Review the command-line arguments passed to the process for any suspicious patterns 
Correlate the process creation event with other security events to determine the context of the activity 
Inspect the target system for any unauthorized changes or access to credential stores","Legitimate use of pypykatz for system administration purposes 
Legitimate use of Python for scripting or development 
False positives due to similar process names or command-line arguments","Image IN (""*\\pypykatz.exe"", ""*\\python.exe"") CommandLine=""*live*"" CommandLine=""*registry*"""
"HackTool - Quarks PwDump Execution","Nasreddine Bencherchali (Nextron Systems)","Detects usage of the Quarks PwDump tool via commandline arguments","attack.credential_access, attack.t1003.002","process_creation","windows","Not classified","Check the context in which Quarks PwDump tool is being used (e.g., system administration tasks) 
Verify if the command-line arguments match known legitimate use cases 
Cross-reference with authorized user activity logs to confirm the legitimacy of the tool usage 
Investigate the origin and purpose of QuarksPwDump.exe on the system","Legitimate use of Quarks PwDump tool for system administration purposes 
Use of similar command-line arguments by authorized users 
Presence of QuarksPwDump.exe in legitimate software installations","Image=""*\\QuarksPwDump.exe"" OR CommandLine IN ("" -dhl"", "" --dump-hash-local"", "" -dhdc"", "" --dump-hash-domain-cached"", "" --dump-bitlocker"", "" -dhd "", "" --dump-hash-domain "", ""--ntds-file"")"
"HackTool - RedMimicry Winnti Playbook Execution","Alexander Rausch","Detects actions caused by the RedMimicry Winnti playbook a automated breach emulations utility","attack.execution, attack.defense_evasion, attack.t1106, attack.t1059.003, attack.t1218.011","process_creation","windows","Not classified","Review the command-line arguments of rundll32.exe and cmd.exe processes to determine the context of the execution 
Check the reputation of the DLLs and batch files mentioned in the command line for any legitimate use 
Correlate the process creation events with other security logs to identify any related activities or behaviors","Legitimate use of rundll32.exe or cmd.exe with the specified DLLs or batch files 
Authorized scripts or tools using the specified DLLs or batch files 
Known software installations that trigger the rule","Image IN (""*\\rundll32.exe"", ""*\\cmd.exe"") CommandLine IN (""*gthread-3.6.dll*"", ""*\\Windows\\Temp\\tmp.bat*"", ""*sigcmm-2.4.dll*"")"
"Potential SMB Relay Attack Tool Execution","Florian Roth (Nextron Systems)","Detects different hacktools used for relay attacks on Windows for privilege escalation","attack.execution, attack.t1557.001","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of tool execution 
Check the reputation of the file hash or process against threat intelligence sources 
Correlate the process execution with other security events to determine if it is part of a larger attack campaign 
Conduct memory or disk forensics to gather more evidence of malicious activity","Legitimate files with similar names to hacktools 
Legitimate use of tools for testing or security research 
Files used by authorized red team exercises","Image IN (""*PetitPotam*"", ""*RottenPotato*"", ""*HotPotato*"", ""*JuicyPotato*"", ""*\\just_dce_*"", ""*Juicy Potato*"", ""*\\temp\\rot.exe*"", ""*\\Potato.exe*"", ""*\\SpoolSample.exe*"", ""*\\Responder.exe*"", ""*\\smbrelayx*"", ""*\\ntlmrelayx*"", ""*\\LocalPotato*"") OR CommandLine IN (""*Invoke-Tater*"", ""* smbrelay*"", ""* ntlmrelay*"", ""*cme smb *"", ""* /ntlm:NTLMhash *"", ""*Invoke-PetitPotam*"", ""*.exe -t * -p *"") OR (CommandLine=""*.exe -c \""{*"" CommandLine=""*}\"" -z"") NOT (Image IN (""*HotPotatoes6*"", ""*HotPotatoes7*"", ""*HotPotatoes *""))"
"HackTool - Rubeus Execution","Florian Roth (Nextron Systems)","Detects the execution of the hacktool Rubeus via PE information of command line parameters","attack.credential_access, attack.t1003, attack.t1558.003, attack.lateral_movement, attack.t1550.003","process_creation","windows","Not classified","Check if the Rubeus execution was part of a scheduled security assessment 
Analyze the context of the Rubeus execution to determine if it aligns with authorized activities 
Correlate the Rubeus execution with other security events to identify any suspicious behavior","Legitimate use of Rubeus for authorized security testing 
Rubeus used by security tools or scripts 
Rubeus executed as part of a red team exercise","Image=""*\\Rubeus.exe"" OR OriginalFileName=""Rubeus.exe"" OR Description=""Rubeus"" OR CommandLine IN (""*asreproast *"", ""*dump /service:krbtgt *"", ""*dump /luid:0x*"", ""*kerberoast *"", ""*createnetonly /program:*"", ""*ptt /ticket:*"", ""*/impersonateuser:*"", ""*renew /ticket:*"", ""*asktgt /user:*"", ""*harvest /interval:*"", ""*s4u /user:*"", ""*s4u /ticket:*"", ""*hash /password:*"", ""*golden /aes256:*"", ""*silver /user:*"")"
"HackTool - SafetyKatz Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of the hacktool SafetyKatz via PE information and default Image name","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Check the command-line arguments used during the execution of SafetyKatz 
Verify the user context in which SafetyKatz was executed 
Correlate with other security events to determine the context of SafetyKatz execution 
Inspect the parent processes leading to the execution of SafetyKatz","Legitimate use of SafetyKatz by authorized users for security testing purposes 
Renaming of the SafetyKatz executable to a different name 
Presence of a file or process named SafetyKatz unrelated to the hacktool","Image=""*\\SafetyKatz.exe"" OR OriginalFileName=""SafetyKatz.exe"" OR Description=""SafetyKatz"""
"HackTool - SecurityXploded Execution","Florian Roth (Nextron Systems)","Detects the execution of SecurityXploded Tools","attack.credential_access, attack.t1555","process_creation","windows","Not classified","Check if the SecurityXploded tool execution was initiated by authorized users or processes 
Verify if the SecurityXploded tool execution was part of a sanctioned security assessment or penetration testing activity 
Review the context of the SecurityXploded tool execution to determine if it aligns with known research or testing activities 
Correlate the SecurityXploded tool execution with other security events to assess the overall impact and intent","Legitimate use of SecurityXploded tools by authorized personnel 
SecurityXploded tools used for legitimate security testing purposes 
SecurityXploded tools used in a controlled environment for research purposes","Company=""SecurityXploded"" OR Image=""*PasswordDump.exe"" OR OriginalFileName=""*PasswordDump.exe"""
"HackTool - PPID Spoofing SelectMyParent Tool Execution","Florian Roth (Nextron Systems)","Detects the use of parent process ID spoofing tools like Didier Stevens tool SelectMyParent","attack.defense_evasion, attack.t1134.004","process_creation","windows","Not classified","Verify the legitimacy of the process and its parent-child relationship 
Check if the process execution aligns with expected behavior in the environment 
Review the purpose and context of the tool or process in question 
Investigate the reputation and history of the file or tool being flagged","Legitimate use of tools that may have similar behavior to SelectMyParent 
Development or testing environments where such tools are legitimately used 
Known system processes or software that may trigger false positives 
Scripting or automation tools that mimic spoofing behavior","Image=""*\\SelectMyParent.exe"" OR CommandLine IN (""*PPID-spoof*"", ""*ppid_spoof*"", ""*spoof-ppid*"", ""*spoof_ppid*"", ""*ppidspoof*"", ""*spoofppid*"", ""*spoofedppid*"", ""* -spawnto *"") OR OriginalFileName IN (""*PPID-spoof*"", ""*ppid_spoof*"", ""*spoof-ppid*"", ""*spoof_ppid*"", ""*ppidspoof*"", ""*spoofppid*"", ""*spoofedppid*"") OR Description=""SelectMyParent"" OR Imphash IN (""04d974875bd225f00902b4cad9af3fbc"", ""a782af154c9e743ddf3f3eb2b8f3d16e"", ""89059503d7fbf470e68f7e63313da3ad"", ""ca28337632625c8281ab8a130b3d6bad"") OR Hashes IN (""*IMPHASH=04D974875BD225F00902B4CAD9AF3FBC*"", ""*IMPHASH=A782AF154C9E743DDF3F3EB2B8F3D16E*"", ""*IMPHASH=89059503D7FBF470E68F7E63313DA3AD*"", ""*IMPHASH=CA28337632625C8281AB8A130B3D6BAD*"")"
"HackTool - SharPersist Execution","Florian Roth (Nextron Systems)","Detects the execution of the hacktool SharPersist - used to deploy various different kinds of persistence mechanisms","attack.persistence, attack.t1053","process_creation","windows","Not classified","Review the command-line arguments of the process to determine the intent behind the SharPersist execution 
Check if the SharPersist execution is part of a known and authorized system administration activity 
Investigate the parent-child process relationship to understand the context of the SharPersist execution 
Correlate the SharPersist execution with other security events or logs to identify any malicious behavior","Legitimate use of SharPersist for authorized system administration tasks 
Installation of legitimate software that includes SharPersist as part of its functionality 
Development or testing environments where SharPersist is intentionally used 
Scheduled tasks or services that legitimately use SharPersist for persistence","Image=""*\\SharPersist.exe"" OR Product=""SharPersist"" OR CommandLine IN (""* -t schtask -c *"", ""* -t startupfolder -c *"") OR (CommandLine=""* -t reg -c *"" CommandLine=""* -m add*"") OR (CommandLine=""* -t service -c *"" CommandLine=""* -m add*"") OR (CommandLine=""* -t schtask -c *"" CommandLine=""* -m add*"")"
"HackTool - SharpEvtMute Execution","Florian Roth (Nextron Systems)","Detects the use of SharpEvtHook, a tool that tampers with the Windows event logs","attack.defense_evasion, attack.t1562.002","process_creation","windows","Not classified","Check if the execution of SharpEvtMute was part of a scheduled task or a legitimate administrative action 
Review the command-line arguments passed to SharpEvtMute for any suspicious or unauthorized activity 
Correlate the execution of SharpEvtMute with other security events to determine the context of the activity 
Investigate the user context under which SharpEvtMute was executed for any anomalies or unauthorized access","Legitimate use of SharpEvtMute for authorized system administration tasks 
Use of similar tools that are not SharpEvtMute 
Development or testing environments where such tools are commonly used","Image=""*\\SharpEvtMute.exe"" OR Description=""SharpEvtMute"" OR CommandLine IN (""*--Filter \""rule *"", ""*--Encoded --Filter \\\""*"")"
"HackTool - SharpLdapWhoami Execution","Florian Roth (Nextron Systems)","Detects SharpLdapWhoami, a whoami alternative that queries the LDAP service on a domain controller","attack.discovery, attack.t1033, car.2016-03-001","process_creation","windows","Not classified","Review the command line arguments of the process to determine the context of the LDAP query 
Check the process parent-child relationship to identify the origin of the SharpLdapWhoami execution 
Correlate the SharpLdapWhoami execution with other security events to understand the full scope of the activity 
Investigate the user context and privileges of the process to assess potential risks or anomalies","Legitimate administration tools that use similar LDAP queries 
Scheduled tasks or scripts that perform LDAP queries 
Custom applications that interact with LDAP services","Image=""*\\SharpLdapWhoami.exe"" OR OriginalFileName=""*SharpLdapWhoami*"" OR Product=""SharpLdapWhoami"" OR CommandLine IN (""* /method:ntlm"", ""* /method:kerb"", ""* /method:nego"", ""* /m:nego"", ""* /m:ntlm"", ""* /m:kerb"")"
"HackTool - SharpUp PrivEsc Tool Execution","Florian Roth (Nextron Systems)","Detects the use of SharpUp, a tool for local privilege escalation","attack.privilege_escalation, attack.t1615, attack.t1569.002, attack.t1574.005","process_creation","windows","Not classified","Check the context in which SharpUp was executed (e.g., authorized security assessment, system administration tasks) 
Verify if the tool execution was part of a scheduled security scan or testing activity 
Review any documentation or change management records related to the use of SharpUp 
Correlate with other security tools or logs to confirm the legitimacy of the activity","Legitimate use of SharpUp during authorized security assessments 
Legitimate use by system administrators for testing and hardening 
Legitimate use in a controlled environment for research purposes","Image=""*\\SharpUp.exe"" OR Description=""SharpUp"" OR CommandLine IN (""*HijackablePaths*"", ""*UnquotedServicePath*"", ""*ProcessDLLHijack*"", ""*ModifiableServiceBinaries*"", ""*ModifiableScheduledTask*"", ""*DomainGPPPassword*"", ""*CachedGPPPassword*"")"
"HackTool - SharpView Execution","frack113","Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems","attack.discovery, attack.t1049, attack.t1069.002, attack.t1482, attack.t1135, attack.t1033","process_creation","windows","Not classified","Check if the SharpView.exe execution was initiated by a scheduled task or script 
Verify if the SharpView.exe execution is part of a legitimate administrative activity 
Review the command-line arguments passed to SharpView.exe for any suspicious or unauthorized commands 
Investigate the process creation event in conjunction with other security events for correlation","Legitimate use of SharpView tool by authorized system administrators for network configuration and settings 
Scheduled tasks or scripts that use SharpView for legitimate purposes 
Development or testing environments where SharpView is used for authorized activities","OriginalFileName=""SharpView.exe"" OR Image=""*\\SharpView.exe"" OR CommandLine IN (""*Add-RemoteConnection*"", ""*Convert-ADName*"", ""*ConvertFrom-SID*"", ""*ConvertFrom-UACValue*"", ""*Convert-SidToName*"", ""*Export-PowerViewCSV*"", ""*Find-DomainObjectPropertyOutlier*"", ""*Find-DomainProcess*"", ""*Find-DomainShare*"", ""*Find-DomainUserEvent*"", ""*Find-DomainUserLocation*"", ""*Find-ForeignGroup*"", ""*Find-ForeignUser*"", ""*Find-GPOComputerAdmin*"", ""*Find-GPOLocation*"", ""*Find-Interesting*"", ""*Find-LocalAdminAccess*"", ""*Find-ManagedSecurityGroups*"", ""*Get-CachedRDPConnection*"", ""*Get-DFSshare*"", ""*Get-DomainComputer*"", ""*Get-DomainController*"", ""*Get-DomainDFSShare*"", ""*Get-DomainDNSRecord*"", ""*Get-DomainFileServer*"", ""*Get-DomainForeign*"", ""*Get-DomainGPO*"", ""*Get-DomainGroup*"", ""*Get-DomainGUIDMap*"", ""*Get-DomainManagedSecurityGroup*"", ""*Get-DomainObject*"", ""*Get-DomainOU*"", ""*Get-DomainPolicy*"", ""*Get-DomainSID*"", ""*Get-DomainSite*"", ""*Get-DomainSPNTicket*"", ""*Get-DomainSubnet*"", ""*Get-DomainTrust*"", ""*Get-DomainUserEvent*"", ""*Get-ForestDomain*"", ""*Get-ForestGlobalCatalog*"", ""*Get-ForestTrust*"", ""*Get-GptTmpl*"", ""*Get-GroupsXML*"", ""*Get-LastLoggedOn*"", ""*Get-LoggedOnLocal*"", ""*Get-NetComputer*"", ""*Get-NetDomain*"", ""*Get-NetFileServer*"", ""*Get-NetForest*"", ""*Get-NetGPO*"", ""*Get-NetGroupMember*"", ""*Get-NetLocalGroup*"", ""*Get-NetLoggedon*"", ""*Get-NetOU*"", ""*Get-NetProcess*"", ""*Get-NetRDPSession*"", ""*Get-NetSession*"", ""*Get-NetShare*"", ""*Get-NetSite*"", ""*Get-NetSubnet*"", ""*Get-NetUser*"", ""*Get-PathAcl*"", ""*Get-PrincipalContext*"", ""*Get-RegistryMountedDrive*"", ""*Get-RegLoggedOn*"", ""*Get-WMIRegCachedRDPConnection*"", ""*Get-WMIRegLastLoggedOn*"", ""*Get-WMIRegMountedDrive*"", ""*Get-WMIRegProxy*"", ""*Invoke-ACLScanner*"", ""*Invoke-CheckLocalAdminAccess*"", ""*Invoke-Kerberoast*"", ""*Invoke-MapDomainTrust*"", ""*Invoke-RevertToSelf*"", ""*Invoke-Sharefinder*"", ""*Invoke-UserImpersonation*"", ""*Remove-DomainObjectAcl*"", ""*Remove-RemoteConnection*"", ""*Request-SPNTicket*"", ""*Set-DomainObject*"", ""*Test-AdminAccess*"")"
"HackTool - SharpChisel Execution","Nasreddine Bencherchali (Nextron Systems)","Detects usage of the Sharp Chisel via the commandline arguments","attack.command_and_control, attack.t1090.001","process_creation","windows","Not classified","Check if the SharpChisel tool execution was part of a scheduled security assessment or penetration testing activity 
Verify the presence of SharpChisel in authorized security tool directories or repositories 
Review change management records to confirm authorized usage of SharpChisel 
Cross-reference with threat intelligence reports to identify any known legitimate use cases of SharpChisel","Legitimate use of SharpChisel tool by authorized users for security testing purposes 
Presence of the SharpChisel tool in a legitimate security tool directory 
Scheduled legitimate use of SharpChisel tool documented in change management logs","Image=""*\\SharpChisel.exe"" OR Product=""SharpChisel"""
"HackTool - SharpImpersonation Execution","Sai Prashanth Pulisetti @pulisettis, Nasreddine Bencherchali (Nextron Systems)","Detects execution of the SharpImpersonation tool. Which can be used to manipulate tokens on a Windows computers remotely (PsExec/WmiExec) or interactively","attack.privilege_escalation, attack.defense_evasion, attack.t1134.001, attack.t1134.003","process_creation","windows","Not classified","Check if the SharpImpersonation tool was executed as part of a scheduled system task 
Verify if the tool was executed by authorized system administrators 
Analyze the context of the execution to determine if it was part of a red team exercise or security assessment 
Investigate if there are any legitimate reasons for the tool's execution in the environment","Legitimate use of SharpImpersonation tool for authorized system administration tasks 
Execution of legitimate software with similar behavior to SharpImpersonation 
Use of tools or scripts that mimic SharpImpersonation behavior 
Execution of custom scripts or applications that interact with user tokens","Image=""*\\SharpImpersonation.exe"" OR OriginalFileName=""SharpImpersonation.exe"" OR (CommandLine=""* user:*"" CommandLine=""* binary:*"") OR (CommandLine=""* user:*"" CommandLine=""* shellcode:*"") OR CommandLine IN (""* technique:CreateProcessAsUserW*"", ""* technique:ImpersonateLoggedOnuser*"")"
"HackTool - SILENTTRINITY Stager Execution","Aleksey Potapov, oscd.community","Detects SILENTTRINITY stager use via PE metadata","attack.command_and_control, attack.t1071","process_creation","windows","Not classified","Review the process creation logs for the specific stager indicator 'st2stager' 
Correlate the process creation event with network traffic logs to identify any suspicious communication 
Check if the SILENTTRINITY tool is authorized for use within the organization 
Analyze the behavior of the process to determine if it aligns with legitimate activities","Legitimate use of SILENTTRINITY for authorized red teaming or penetration testing activities 
Use of tools with similar PE metadata that are not malicious 
Presence of stager-like behavior in legitimate software","Description=""*st2stager*"""
"HackTool - Sliver C2 Implant Activity Pattern","Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)","Detects process activity patterns as seen being used by Sliver C2 framework implants","attack.execution, attack.t1059","process_creation","windows","Not classified","Review the process command line arguments to understand the context of the execution 
Check for any legitimate reasons for the observed command line pattern 
Correlate with other security events to determine if there are indicators of compromise 
Investigate the reputation and purpose of the process or tool in question","Legitimate administrative or scripting activities may trigger this rule 
Development or testing environments where similar commands are used 
Tools or utilities that utilize similar command line parameters","CommandLine=""*-NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8*"""
"HackTool - Stracciatella Execution","pH-T (Nextron Systems)","Detects Stracciatella which executes a Powershell runspace from within C# (aka SharpPick technique) with AMSI, ETW and Script Block Logging disabled based on PE metadata characteristics.","attack.execution, attack.defense_evasion, attack.t1059, attack.t1562.001","process_creation","windows","Not classified","Check if the Stracciatella.exe process was initiated by an authorized user or system administrator 
Verify the legitimacy of the file by comparing its hash with known good hashes or checking digital signatures 
Investigate the parent-child process relationship to determine the origin of the Stracciatella execution 
Review any relevant documentation or change management records to confirm if the activity was expected or planned","Legitimate use of Stracciatella tool by authorized users for testing or development purposes 
Presence of similarly named files or processes that are not related to Stracciatella 
Third-party applications or security tools that may exhibit behavior similar to Stracciatella 
Updates or patches being applied to the system that trigger similar process creation events","Image=""*\\Stracciatella.exe"" OR OriginalFileName=""Stracciatella.exe"" OR Description=""Stracciatella"" OR Hashes IN (""*SHA256=9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956*"", ""*SHA256=fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a*"") OR sha256 IN (""9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956"", ""fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a"")"
"HackTool - SysmonEOP Execution","Florian Roth (Nextron Systems)","Detects the execution of the PoC that can be used to exploit Sysmon CVE-2022-41120","cve.2022.41120, attack.t1068, attack.privilege_escalation","process_creation","windows","Not classified","Review the process command line and parent process to determine the context of execution 
Check the file path and digital signature of SysmonEOP.exe for legitimacy 
Correlate with network or other endpoint logs to identify any related suspicious activities 
Verify the reputation of the file hashes or imphashes against threat intelligence sources","Legitimate use of SysmonEOP.exe for testing or research purposes 
Presence of similar file names or hashes in legitimate software 
Use of tools or scripts that mimic the behavior of SysmonEOP.exe 
Known exclusions or whitelisted applications that include SysmonEOP.exe","Image=""*\\SysmonEOP.exe"" OR Hashes IN (""IMPHASH=22F4089EB8ABA31E1BB162C6D9BF72E5"", ""IMPHASH=5123FA4C4384D431CD0D893EEB49BBEC"") OR Imphash IN (""22f4089eb8aba31e1bb162c6d9bf72e5"", ""5123fa4c4384d431cd0d893eeb49bbec"")"
"HackTool - TruffleSnout Execution","frack113","Detects the use of TruffleSnout.exe an iterative AD discovery toolkit for offensive operators, situational awareness and targeted low noise enumeration.","attack.discovery, attack.t1482","process_creation","windows","Not classified","Check if the execution of TruffleSnout.exe was part of a planned security operation 
Review documentation or change management records for authorized use of TruffleSnout.exe 
Correlate the TruffleSnout.exe execution with other security events or alerts 
Investigate the source and context of the TruffleSnout.exe execution to determine legitimacy","Legitimate use of TruffleSnout.exe by authorized security personnel for defensive purposes 
TruffleSnout.exe used in a lab environment for research or testing 
TruffleSnout.exe executed as part of a scheduled security scan 
TruffleSnout.exe executed by a security tool or framework","OriginalFileName=""TruffleSnout.exe"" OR Image=""*\\TruffleSnout.exe"""
"HackTool - UACMe Akagi Execution","Christian Burkard (Nextron Systems), Florian Roth (Nextron Systems)","Detects the execution of UACMe, a tool used for UAC bypasses, via default PE metadata","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Verify the context in which UACMe is being used (authorized security testing vs. malicious activity) 
Check if the execution of UACMe is part of a sanctioned red team exercise 
Review documentation or authorization for the use of UACMe in the environment 
Correlate with threat intelligence to determine if the tool is associated with known threat actors","Legitimate use of UACMe tool for authorized security testing 
Presence of Akagi.exe or Akagi64.exe in a legitimate pentesting environment 
Use of UACMe by authorized red team or penetration testing teams","Product=""UACMe"" OR Company IN (""REvol Corp"", ""APT 92"", ""UG North"", ""Hazardous Environments"", ""CD Project Rekt"") OR Description IN (""UACMe main module"", ""Pentesting utility"") OR OriginalFileName IN (""Akagi.exe"", ""Akagi64.exe"") OR Image IN (""*\\Akagi64.exe"", ""*\\Akagi.exe"") OR Hashes IN (""*IMPHASH=767637C23BB42CD5D7397CF58B0BE688*"", ""*IMPHASH=14C4E4C72BA075E9069EE67F39188AD8*"", ""*IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC*"", ""*IMPHASH=7D010C6BB6A3726F327F7E239166D127*"", ""*IMPHASH=89159BA4DD04E4CE5559F132A9964EB3*"", ""*IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F*"", ""*IMPHASH=5834ED4291BDEB928270428EBBAF7604*"", ""*IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38*"", ""*IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894*"", ""*IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74*"", ""*IMPHASH=3DE09703C8E79ED2CA3F01074719906B*"") OR Imphash IN (""767637c23bb42cd5d7397cf58b0be688"", ""14c4e4c72ba075e9069ee67f39188ad8"", ""3c782813d4afce07bbfc5a9772acdbdc"", ""7d010c6bb6a3726f327f7e239166d127"", ""89159ba4dd04e4ce5559f132a9964eb3"", ""6f33f4a5fc42b8cec7314947bd13f30f"", ""5834ed4291bdeb928270428ebbaf7604"", ""5a8a8a43f25485e7ee1b201edcbc7a38"", ""dc7d30b90b2d8abf664fbed2b1b59894"", ""41923ea1f824fe63ea5beb84db7a3e74"", ""3de09703c8e79ed2ca3f01074719906b"")"
"HackTool - Windows Credential Editor (WCE) Execution","Florian Roth (Nextron Systems)","Detects the use of Windows Credential Editor (WCE)","attack.credential_access, attack.t1003.001, attack.s0005","process_creation","windows","Not classified","Check the command line arguments of the process to determine if it matches the WCE execution pattern 
Verify the parent process to see if it is a known system service or a suspicious process 
Investigate the process image file to confirm if it is related to WCE or a false positive 
Correlate the process execution with other security events to identify any malicious behavior","Legitimate tools or services that have similar command line parameters 
Scheduled tasks or scripts that may trigger similar behavior 
Updates or installations that involve legitimate processes","Imphash IN (""a53a02b997935fd8eedcb5f7abab9b9f"", ""e96a73c7bf33a464c510ede582318bf2"") OR Hashes IN (""*IMPHASH=a53a02b997935fd8eedcb5f7abab9b9f*"", ""*IMPHASH=e96a73c7bf33a464c510ede582318bf2*"") OR (CommandLine=""*.exe -S"" ParentImage=""*\\services.exe"") NOT Image=""*\\clussvc.exe"""
"HackTool - winPEAS Execution","Georg Lauenstein (sure[secure])","WinPEAS is a script that search for possible paths to escalate privileges on Windows hosts. The checks are explained on book.hacktricks.xyz","attack.privilege_escalation, attack.t1082, attack.t1087, attack.t1046","process_creation","windows","Not classified","Check if the execution of winPEAS was part of a scheduled security assessment or penetration testing activity 
Review the parent process and command line arguments to determine if the tool was used for legitimate purposes 
Correlate the execution of winPEAS with other security events or logs to identify any suspicious behavior 
Verify the source and integrity of the winPEAS tool to ensure it has not been tampered with","Legitimate use of winPEAS tool by authorized security personnel for security assessments 
Scheduled or authorized system maintenance tasks 
Use of similar legitimate tools for system administration purposes","OriginalFileName=""winPEAS.exe"" OR Image IN (""*\\winPEASany_ofs.exe"", ""*\\winPEASany.exe"", ""*\\winPEASx64_ofs.exe"", ""*\\winPEASx64.exe"", ""*\\winPEASx86_ofs.exe"", ""*\\winPEASx86.exe"") OR CommandLine IN (""* applicationsinfo*"", ""* browserinfo*"", ""* eventsinfo*"", ""* fileanalysis*"", ""* filesinfo*"", ""* processinfo*"", ""* servicesinfo*"", ""* windowscreds*"") OR CommandLine=""*https://github.com/carlospolop/PEASS-ng/releases/latest/download/*"" OR ParentCommandLine=""* -linpeas"" OR CommandLine=""* -linpeas"""
"HackTool - Wmiexec Default Powershell Command","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of PowerShell with a specific flag sequence that is used by the Wmiexec script","attack.defense_evasion, attack.lateral_movement","process_creation","windows","Not classified","Review the command-line arguments of the process to determine the context of PowerShell execution 
Check if the PowerShell execution is part of a known and approved script or tool 
Correlate with additional logs to verify the legitimacy of the activity 
Investigate the parent process and user context for more insights","Legitimate use of Wmiexec script 
Scheduled tasks or scripts using similar PowerShell flags 
Administrative scripts or tools that use these flags 
Development or testing environments","CommandLine=""*-NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc*"""
"HackTool - XORDump Execution","Florian Roth (Nextron Systems)","Detects suspicious use of XORDump process memory dumping utility","attack.defense_evasion, attack.t1036, attack.t1003.001","process_creation","windows","Not classified","Check the reputation of the process and its associated command line switches 
Verify the context in which XORDump is being used (e.g., authorized security assessments) 
Correlate the XORDump activity with other security events to determine if it is part of a larger attack 
Review the parent processes and user context to identify any anomalies or suspicious behavior","Legitimate use of XORDump utility for authorized memory analysis 
Use of legitimate tools that have similar command line switches to XORDump 
Development or testing environments where XORDump is used for valid purposes","Image=""*\\xordump.exe"" OR CommandLine IN (""* -process lsass.exe *"", ""* -m comsvcs *"", ""* -m dbghelp *"", ""* -m dbgcore *"")"
"Suspicious HWP Sub Processes","Florian Roth (Nextron Systems)","Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation","attack.initial_access, attack.t1566.001, attack.execution, attack.t1203, attack.t1059.003, attack.g0032","process_creation","windows","Not classified","Verify the legitimacy of the parent process (Hwp.exe) and the sub process (gbb.exe) 
Check for any recent updates or patches applied to the Hangul Word Processor (Hanword) 
Review any authorized scripts or tools that may interact with the Hangul Word Processor (Hanword) 
Correlate the process creation events with other security logs to determine the context of the activity","Legitimate sub processes of Hangul Word Processor (Hanword) 
Updates or patches to the Hangul Word Processor (Hanword) 
Authorized scripts or tools interacting with Hangul Word Processor (Hanword)","ParentImage=""*\\Hwp.exe"" Image=""*\\gbb.exe"""
"File Download And Execution Via IEExec.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects execution of the IEExec utility to download and execute files","attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Review the command-line arguments of the process to identify the URLs being accessed 
Check the reputation of the URLs accessed for any signs of malicious activity 
Correlate the process execution with other security events to determine the context of the activity 
Investigate the parent process and user context to understand the origin of the IEExec.exe execution","Legitimate use of IEExec.exe for authorized file downloads 
Updates or installations initiated by trusted software 
Scripted or automated processes that involve downloading files 
Known system administration tasks that leverage IEExec.exe","Image=""*\\IEExec.exe"" OR OriginalFileName=""IEExec.exe"" CommandLine IN (""*http://*"", ""*https://*"")"
"Disable Windows IIS HTTP Logging","frack113","Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union)","attack.defense_evasion, attack.t1562.002","process_creation","windows","Not classified","Review IIS logs to check for any suspicious activities or gaps in logging 
Check for any unauthorized changes in the IIS configuration settings 
Verify the integrity of the appcmd.exe binary to ensure it has not been tampered with 
Correlate the event with other security events or alerts to identify any potential malicious activities","Legitimate changes to IIS configuration by authorized administrators 
Scheduled maintenance tasks that involve IIS configuration changes 
Third-party applications that modify IIS settings 
Automated scripts or tools used for IIS management","Image=""*\\appcmd.exe"" OR OriginalFileName=""appcmd.exe"" CommandLine=""*set*"" CommandLine=""*config*"" CommandLine=""*section:httplogging*"" CommandLine=""*dontLog:true*"""
"Microsoft IIS Service Account Password Dumped","Tim Rauch, Janantha Marasinghe, Elastic (original idea)","Detects the Internet Information Services (IIS) command-line tool, AppCmd, being used to list passwords","attack.credential_access, attack.t1003","process_creation","windows","Not classified","Check if the AppCmd.exe process was executed as part of a legitimate administrative task 
Review the command-line arguments passed to AppCmd.exe for any authorized operations 
Correlate the event with other security logs to determine the context of the activity 
Verify if the passwords listed are part of a known testing or red teaming exercise","Legitimate use of AppCmd to manage IIS configurations 
Scripting or automation tools that use similar commands 
Password management tools that interact with IIS configurations","Image=""*\\appcmd.exe"" OR OriginalFileName=""appcmd.exe"" CommandLine=""*list *"" CommandLine IN (""* /config*"", ""* /xml*"", ""* -config*"", ""* -xml*"") OR (CommandLine IN (""* /@t*"", ""* /text*"", ""* /show*"", ""* -@t*"", ""* -text*"", ""* -show*"") CommandLine IN (""*:\**"", ""*password*""))"
"Microsoft IIS Connection Strings Decryption","Tim Rauch, Elastic (idea)","Detects use of aspnet_regiis to decrypt Microsoft IIS connection strings. An attacker with Microsoft IIS web server access via a webshell or alike can decrypt and dump any hardcoded connection strings, such as the MSSQL service account password using aspnet_regiis command.","attack.credential_access, attack.t1003","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the use of aspnet_regiis.exe with 'connectionStrings' and '-pdf' parameters 
Check for any legitimate reasons within the organization for decrypting connection strings using aspnet_regiis.exe 
Correlate the process creation event with other security events to determine if the activity is part of a larger attack chain 
Investigate the source and context of the process creation, including user account and originating host, for any signs of unauthorized access","Legitimate use of aspnet_regiis.exe for authorized decryption operations 
Development or administrative tasks involving decryption of connection strings 
Third-party tools or applications that utilize aspnet_regiis.exe for legitimate purposes","Image=""*\\aspnet_regiis.exe"" OR OriginalFileName=""aspnet_regiis.exe"" CommandLine=""*connectionStrings*"" CommandLine=""* -pdf*"""
"Suspicious IIS Module Registration","Florian Roth (Nextron Systems), Microsoft (idea)","Detects a suspicious IIS module registration as described in Microsoft threat report on IIS backdoors","attack.persistence, attack.t1505.004","process_creation","windows","Not classified","Verify the activity with the system administrator or relevant team 
Check if the IIS module registration aligns with any scheduled changes or updates 
Review documentation or change management records for planned IIS configuration modifications 
Investigate the purpose and origin of the module registration to determine its legitimacy","Legitimate IIS module registration by administrators 
Updates or installations of legitimate software 
Scripting or automation tasks involving IIS configuration 
Third-party applications that interact with IIS","ParentImage=""*\\w3wp.exe"" CommandLine=""*appcmd.exe add module*"" OR (CommandLine=""* system.enterpriseservices.internal.publish*"" Image=""*\\powershell.exe"") OR (CommandLine=""*gacutil*"" CommandLine=""* /I*"")"
"ImagingDevices Unusual Parent/Child Processes","Nasreddine Bencherchali (Nextron Systems)","Detects unusual parent or children of the ImagingDevices.exe (Windows Contacts) process as seen being used with Bumblebee activity","attack.defense_evasion, attack.execution","process_creation","windows","Not classified","Review the process tree to understand the context of ImagingDevices.exe activity 
Check for any recent legitimate software installations or updates that involve ImagingDevices.exe 
Correlate the detection with other security events to determine the root cause 
Investigate if any security tools or monitoring software are configured to interact with ImagingDevices.exe","Legitimate software using ImagingDevices.exe as a parent process 
Scheduled system tasks triggering the detection 
Updates or installations involving ImagingDevices.exe 
Security tools or monitoring software interacting with ImagingDevices.exe","(ParentImage IN (""*\\WmiPrvSE.exe"", ""*\\svchost.exe"", ""*\\dllhost.exe"") Image=""*\\ImagingDevices.exe"") OR ParentImage=""*\\ImagingDevices.exe"""
"Suspicious Shells Spawn by Java Utility Keytool","Andreas Hunkeler (@Karneades)","Detects suspicious shell spawn from Java utility keytool process (e.g. adselfservice plus exploitation)","attack.initial_access, attack.persistence, attack.privilege_escalation","process_creation","windows","Not classified","Review the command-line arguments of the keytool.exe process to understand the context of the shell spawn 
Check the reputation of the parent process and child shell processes for any known legitimate use cases 
Correlate with other security events or logs to determine if the activity is part of a larger attack chain 
Investigate the user context and privileges associated with the keytool.exe process and spawned shells","Legitimate use of keytool.exe spawning shells for administrative tasks 
Development or testing environments where such behavior is expected 
Scripting or automation tools legitimately spawning shells","ParentImage=""*\\keytool.exe"" Image IN (""*\\cmd.exe"", ""*\\sh.exe"", ""*\\bash.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\schtasks.exe"", ""*\\certutil.exe"", ""*\\whoami.exe"", ""*\\bitsadmin.exe"", ""*\\wscript.exe"", ""*\\cscript.exe"", ""*\\scrcons.exe"", ""*\\regsvr32.exe"", ""*\\hh.exe"", ""*\\wmic.exe"", ""*\\mshta.exe"", ""*\\rundll32.exe"", ""*\\forfiles.exe"", ""*\\scriptrunner.exe"", ""*\\mftrace.exe"", ""*\\AppVLP.exe"", ""*\\systeminfo.exe"", ""*\\reg.exe"", ""*\\query.exe"")"
"Suspicious Windows Trace ETW Session Tamper Via Logman.EXE","Florian Roth (Nextron Systems)","Detects the execution of ""logman"" utility in order to disable or delete Windows trace sessions","attack.defense_evasion, attack.t1562.001, attack.t1070.001","process_creation","windows","Not classified","Check if the action was performed during a maintenance window or by authorized personnel 
Review scheduled tasks or scripts that may have triggered the logman command 
Investigate if any third-party applications or security tools are configured to interact with Windows trace sessions 
Look for any correlation with other security events or alerts on the system","Legitimate deactivation by system administrators for maintenance purposes 
Scheduled tasks or scripts that involve stopping or deleting trace sessions 
Third-party applications that interact with Windows trace sessions","Image=""*\\logman.exe"" OR OriginalFileName=""Logman.exe"" CommandLine IN (""*stop *"", ""*delete *"") CommandLine IN (""*Circular Kernel Context Logger*"", ""*EventLog-*"", ""*SYSMON TRACE*"", ""*SysmonDnsEtwSession*"")"
"ZOHO Dctask64 Process Injection","Florian Roth (Nextron Systems)","Detects suspicious process injection using ZOHO's dctask64.exe","attack.defense_evasion, attack.t1055.001","process_creation","windows","Not classified","Check if the process injection is part of a legitimate operation or software update involving ZOHO 
Review any scheduled tasks or scripts that leverage dctask64.exe 
Correlate with change management records to verify authorized activities","Legitimate use of ZOHO's dctask64.exe for authorized purposes 
Upgrades or installations of ZOHO software 
Scheduled legitimate tasks involving dctask64.exe","Image=""*\\dctask64.exe"" NOT CommandLine=""*DesktopCentral_Agent\\agent*"""
"Devtoolslauncher.exe Executes Specified Binary","Beyu Denis, oscd.community (rule), @_felamos (idea)","The Devtoolslauncher.exe executes other binary","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Review the command line arguments passed to devtoolslauncher.exe for any suspicious parameters 
Check the parent process of devtoolslauncher.exe to determine if it was launched from a legitimate source 
Correlate the execution of devtoolslauncher.exe with other security events to identify any malicious behavior 
Verify the digital signature of the executed binary to determine its legitimacy","Scheduled legitimate tasks triggering devtoolslauncher.exe 
Authorized software deployment tools utilizing devtoolslauncher.exe 
Development or testing environments where devtoolslauncher.exe is commonly used","Image=""*\\devtoolslauncher.exe"" CommandLine=""*LaunchForDeploy*"""
"Xwizard DLL Sideloading","Christian Burkard (Nextron Systems)","Detects the execution of Xwizard tool from the non-default directory which can be used to sideload a custom xwizards.dll","attack.defense_evasion, attack.t1574.002","process_creation","windows","Not classified","Check the command-line arguments used when Xwizard is executed 
Review the parent process of Xwizard to identify the source of execution 
Inspect the file system and registry for any persistence mechanisms related to Xwizard 
Correlate the Xwizard execution with other security events to determine the context of the activity","Legitimate use of Xwizard tool from a non-default directory 
Scheduled tasks or scripts that use Xwizard from a different location 
Third-party applications that leverage Xwizard in a non-standard way","Image=""*\\xwizard.exe"" NOT Image=""C:\\Windows\\System32\\*"""
"Suspicious Dump64.exe Execution","Austin Songer @austinsonger, Florian Roth","Detects when a user bypasses Defender by renaming a tool to dump64.exe and placing it in a Visual Studio folder","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Check the parent process of dump64.exe to understand how it was invoked 
Review the command-line arguments passed to dump64.exe for any suspicious flags 
Investigate the user context and permissions of the process executing dump64.exe 
Look for any network connections or file modifications associated with dump64.exe","Legitimate use of dump64.exe in Visual Studio development environment 
Dump64.exe used by authorized security tools 
Dump64.exe renamed for benign purposes","(Image=""*\\dump64.exe"" NOT Image=""*\\Installer\\Feedback\\dump64.exe*"") OR (Image=""*\\dump64.exe"" CommandLine IN (""* -ma *"", ""*accepteula*""))"
"Format.com FileSystem LOLBIN","Florian Roth (Nextron Systems)","Detects the execution of format.com with a suspicious filesystem selection that could indicate a defense evasion activity in which format.com is used to load malicious DLL files or other programs","attack.defense_evasion","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of the format.com execution 
Check if the format.com execution was part of a known and approved operation or task 
Correlate the process execution with other security events to determine if any malicious activities are associated","Legitimate use of format.com with specific filesystem selection for valid reasons 
Administrative tasks requiring formatting with specific filesystems 
Software installations that legitimately use format.com with specified filesystems","Image=""*\\format.com"" CommandLine=""*/fs:*"" NOT (CommandLine IN (""*/fs:FAT*"", ""*/fs:exFAT*"", ""*/fs:NTFS*"", ""*/fs:UDF*"", ""*/fs:ReFS*""))"
"Kavremover Dropped Binary LOLBIN Usage","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of a signed binary dropped by Kaspersky Lab Products Remover (kavremover) which can be abused as a LOLBIN to execute arbitrary commands and binaries.","attack.defense_evasion, attack.t1127","process_creation","windows","Not classified","Verify the legitimacy of the process by checking the parent-child process relationship. 
Review the command line arguments and parameters passed to the process for any suspicious or unauthorized actions. 
Check the digital signature of the dropped binary to confirm its origin and integrity. 
Correlate the process execution with other security events or logs to determine the context and potential impact.","Legitimate use of Kaspersky Lab Products Remover (kavremover) for its intended purpose. 
Legitimate use of similar LOLBINs by authorized users. 
Execution of scripts or binaries that contain the specific command string but are not abusing kavremover. 
Upgrades or installations of Kaspersky Lab products that trigger similar process creation patterns.","CommandLine=""* run run-cmd *"" NOT (ParentImage IN (""*\\kavremover.exe"", ""*\\cleanapi.exe""))"
"Potential Manage-bde.wsf Abuse To Proxy Execution","oscd.community, Natalia Shornikova, Nasreddine Bencherchali (Nextron Systems)","Detects potential abuse of the ""manage-bde.wsf"" script as a LOLBIN to proxy execution","attack.defense_evasion, attack.t1216","process_creation","windows","Not classified","Review the command-line arguments of the process invoking manage-bde.wsf 
Check for any scheduled tasks or scripts that use manage-bde.wsf 
Verify if manage-bde.wsf is being used by a known security tool or framework 
Consult with system administrators to confirm if manage-bde.wsf is part of a documented administrative process","Legitimate use of manage-bde.wsf script for disk encryption operations 
Scheduled tasks or legitimate scripts invoking manage-bde.wsf 
Use of manage-bde.wsf in a known security tool or framework 
Manage-bde.wsf used in a documented administrative process","(Image=""*\\wscript.exe"" OR OriginalFileName=""wscript.exe"" CommandLine=""*manage-bde.wsf*"") OR (ParentImage IN (""*\\cscript.exe"", ""*\\wscript.exe"") ParentCommandLine=""*manage-bde.wsf*"" NOT Image=""*\\cmd.exe"")"
"Mavinject Inject DLL Into Running Process","frack113, Florian Roth","Detects process injection using the signed Windows tool ""Mavinject"" via the ""INJECTRUNNING"" flag","attack.defense_evasion, attack.privilege_escalation, attack.t1055.001, attack.t1218.013","process_creation","windows","Not classified","Check the parent-child process relationship to identify the origin of the Mavinject execution 
Review the command-line arguments of the process to understand the context of the injection 
Inspect the loaded DLLs to determine if any unauthorized or suspicious DLLs were injected 
Correlate with network or endpoint logs to identify any unusual network connections or file modifications","Legitimate use of Mavinject for authorized processes 
Upgrades or installations of legitimate software 
Scripting or automation tools that may trigger similar behavior","CommandLine=""* /INJECTRUNNING *"" NOT ParentImage=""C:\\Windows\\System32\\AppVClient.exe"""
"MpiExec Lolbin","Florian Roth (Nextron Systems)","Detects a certain command line flag combination used by mpiexec.exe LOLBIN from HPC pack that can be used to execute any other binary","attack.execution, attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Review the parent-child process relationship to understand the context of mpiexec.exe execution 
Check for whitelisted applications or scripts that are known to use mpiexec.exe with the specified flags 
Analyze the network connections established by the process for any suspicious communication 
Inspect the file system activities related to mpiexec.exe to identify any unauthorized file operations","Legitimate use of mpiexec.exe with similar command line flags for authorized parallel processing tasks 
Legitimate software that uses similar command line flags for its operations 
Custom scripts or applications that mimic the behavior of mpiexec.exe with the flagged command line options","Image=""*\\mpiexec.exe"" OR Imphash=""d8b52ef6aaa3a81501bdfff9dbb96217"" OR Hashes=""*IMPHASH=d8b52ef6aaa3a81501bdfff9dbb96217*"" CommandLine IN (""* /n 1 *"", ""* -n 1 *"")"
"Execute MSDT Via Answer File","Nasreddine Bencherchali (Nextron Systems)","Detects execution of ""msdt.exe"" using an answer file which is simulating the legitimate way of calling msdt via ""pcwrun.exe"" (For example from the compatibility tab)","attack.defense_evasion, attack.t1218, attack.execution","process_creation","windows","Not classified","Check the parent-child relationship between msdt.exe and pcwrun.exe 
Review the command line arguments of msdt.exe to identify the presence of answer file parameters 
Look for any scheduled tasks or scripts that involve msdt.exe with answer files 
Investigate any third-party applications known to use msdt.exe with answer files","Legitimate use of msdt.exe with answer files in specific environments 
Scheduled tasks or scripts that use msdt.exe with answer files 
Third-party applications that invoke msdt.exe with answer files","Image=""*\\msdt.exe"" CommandLine=""*\\WINDOWS\\diagnostics\\index\\PCWDiagnostic.xml*"" CommandLine IN (""* -af *"", ""* /af *"") NOT ParentImage=""*\\pcwrun.exe"""
"OpenWith.exe Executes Specified Binary","Beyu Denis, oscd.community (rule), @harr0ey (idea)","The OpenWith.exe executes other binary","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Review the parent process of OpenWith.exe to determine the context of its execution 
Analyze the command line arguments passed to OpenWith.exe for any suspicious or unexpected values 
Check for any unusual or unauthorized binaries being executed by OpenWith.exe 
Correlate the OpenWith.exe execution with other security events to identify any potential malicious activity","Legitimate use of OpenWith.exe to open files with specified binaries 
Scripting or automation tools legitimately using OpenWith.exe 
Updates or installations that involve OpenWith.exe 
Custom configurations or applications that leverage OpenWith.exe","Image=""*\\OpenWith.exe"" CommandLine=""*/c*"""
"Execute Pcwrun.EXE To Leverage Follina","Nasreddine Bencherchali (Nextron Systems)","Detects indirect command execution via Program Compatibility Assistant ""pcwrun.exe"" leveraging the follina (CVE-2022-30190) vulnerability","attack.defense_evasion, attack.t1218, attack.execution","process_creation","windows","Not classified","Review the command line arguments of the process creation event to understand the context of the execution 
Check if the execution of pcwrun.exe is part of a known legitimate process or operation 
Correlate with other security events to determine if the activity is part of a larger attack chain 
Investigate the parent process and user context to identify any suspicious behavior","Legitimate use of pcwrun.exe for compatibility purposes 
Scripting or automation tools that use similar command structures 
Updates or installations that involve directory traversal","Image=""*\\pcwrun.exe"" CommandLine=""*../*"""
"PrintBrm ZIP Creation of Extraction","frack113","Detects the execution of the LOLBIN PrintBrm.exe, which can be used to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.","attack.command_and_control, attack.t1105, attack.defense_evasion, attack.t1564.004","process_creation","windows","Not classified","Check if the PrintBrm.exe execution was initiated by a scheduled task or a legitimate script. 
Verify if the ZIP file creation or extraction was part of a known and authorized operation. 
Review the command-line arguments used with PrintBrm.exe to determine the intent of the operation. 
Correlate the PrintBrm.exe activity with other security events to identify any malicious behavior.","Legitimate use of PrintBrm.exe for authorized ZIP operations. 
Use of legitimate tools that have similar behavior to PrintBrm.exe. 
ZIP extraction or creation by authorized users for valid purposes. 
ZIP files created or extracted by backup software.","Image=""*\\PrintBrm.exe"" CommandLine=""* -f*"" CommandLine=""*.zip*"""
"Using SettingSyncHost.exe as LOLBin","Anton Kutepov, oscd.community","Detects using SettingSyncHost.exe to run hijacked binary","attack.execution, attack.defense_evasion, attack.t1574.008","process_creation","windows","Not classified","Review the ParentCommandLine to understand the context of SettingSyncHost.exe execution 
Check the TargetFilename to identify the potentially hijacked binary 
Look for any unusual or suspicious behavior associated with SettingSyncHost.exe execution 
Correlate with other security events to determine the impact of the activity","Legitimate use of SettingSyncHost.exe for its intended purpose 
Scheduled tasks or legitimate scripts invoking SettingSyncHost.exe 
Updates or patches triggering SettingSyncHost.exe","NOT (Image IN (""C:\\Windows\\System32\\*"", ""C:\\Windows\\SysWOW64\\*"")) ParentCommandLine=""*cmd.exe /c*"" ParentCommandLine=""*RoamDiag.cmd*"" ParentCommandLine=""*-outputpath*"""
"Suspicious LOLBIN AccCheckConsole","Florian Roth (Nextron Systems)","Detects suspicious LOLBIN AccCheckConsole execution with parameters as used to load an arbitrary DLL","attack.execution","process_creation","windows","Not classified","Check the parent process of AccCheckConsole to determine if it is part of a legitimate chain of execution 
Analyze the command-line parameters passed to AccCheckConsole for any unusual or unexpected values 
Correlate the AccCheckConsole execution with other security events to identify any related suspicious activities 
Verify the reputation and digital signature of the AccCheckConsole executable","Legitimate use of AccCheckConsole for its intended purpose 
Scheduled tasks or scripts that involve AccCheckConsole 
Updates or installations that trigger AccCheckConsole","Image=""*\\AccCheckConsole.exe"" OR OriginalFileName=""AccCheckConsole.exe"" CommandLine=""* -window *"" CommandLine=""*.dll*"""
"Suspicious Certreq Command to Download","Christian Burkard (Nextron Systems)","Detects a suspicious certreq execution taken from the LOLBAS examples, which can be abused to download (small) files","attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Check the parent process of certreq to understand the context of its execution 
Review the command line arguments passed to certreq for any suspicious URLs or file paths 
Correlate certreq execution with network logs to identify any outbound connections 
Compare the certreq activity with baseline or historical data to spot anomalies","Legitimate use of certreq for valid administrative purposes 
Scheduled tasks or scripts that involve certreq 
Use of certreq by security tools or monitoring systems 
Development or testing environments where certreq is used","Image=""*\\certreq.exe"" OR OriginalFileName=""CertReq.exe"" CommandLine=""* -Post *"" CommandLine=""* -config *"" CommandLine=""* http*"" CommandLine=""* C:\\windows\\win.ini *"""
"Suspicious GrpConv Execution","Florian Roth (Nextron Systems)","Detects the suspicious execution of a utility to convert Windows 3.x .grp files or for persistence purposes by malicious software or actors","attack.persistence, attack.t1547","process_creation","windows","Not classified","Check the parent process of grpconv.exe to determine if it is initiated by a suspicious or legitimate process 
Review the command-line arguments passed to grpconv.exe for any unusual parameters or patterns 
Correlate the timestamp of the grpconv.exe execution with other security events to identify any related suspicious activities 
Investigate the user context under which grpconv.exe is executed for any anomalies or unauthorized access","Legitimate use of grpconv.exe utility for valid system operations 
Scheduled tasks or scripts that involve grpconv.exe 
Use of grpconv.exe by system administrators for maintenance tasks","CommandLine IN (""*grpconv.exe -o*"", ""*grpconv -o*"")"
"Time Travel Debugging Utility Usage","Ensar amil, @sblmsrsn, @oscd_initiative","Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.","attack.defense_evasion, attack.credential_access, attack.t1218, attack.t1003.001","process_creation","windows","Not classified","Check the command-line arguments passed to tttracer.exe for any suspicious activity. 
Review the parent process of tttracer.exe to understand the context of its execution. 
Look for any unusual network connections or file activities associated with the process. 
Correlate the tttracer.exe execution with other security events or logs for a broader context.","Legitimate usage by software developers/testers is a common false positive. 
Some security tools or scripts may trigger this detection during legitimate operations. 
Updates or installations of certain software may involve the use of tttracer.exe.","ParentImage=""*\\tttracer.exe"""
"Visual Basic Command Line Compiler Usage","Ensar amil, @sblmsrsn, @oscd_initiative","Detects successful code compilation via Visual Basic Command Line Compiler that utilizes Windows Resource to Object Converter.","attack.defense_evasion, attack.t1027.004","process_creation","windows","Not classified","Check the command-line arguments used with vbc.exe and cvtres.exe for any suspicious or unauthorized activity 
Review the parent process of vbc.exe to determine if it is initiated from an expected source 
Correlate the compilation activity with other security events to identify any anomalies or signs of malicious intent 
Verify the legitimacy of the compiled output and the source code being compiled","Legitimate use of Visual Basic Command Line Compiler for development purposes 
Scheduled or automated compilation tasks 
Compilation of authorized scripts or applications","ParentImage=""*\\vbc.exe"" Image=""*\\cvtres.exe"""
"Potential Credential Dumping Via LSASS Process Clone","Florian Roth (Nextron Systems), Samir Bousseaden","Detects a suspicious LSASS process process clone that could be a sign of credential dumping activity","attack.credential_access, attack.t1003, attack.t1003.001","process_creation","windows","Not classified","Review the process command line arguments for the cloned LSASS process 
Check the parent process of the cloned LSASS process for any suspicious activity 
Correlate with other security events to determine if any actual credential dumping activity is occurring 
Verify if the LSASS process clone is related to a known administrative or security operation","Legitimate use of LSASS process cloning for specific applications 
Legitimate LSASS process restarts 
Legitimate LSASS process behavior in certain security tools","ParentImage=""*\\Windows\\System32\\lsass.exe"" Image=""*\\Windows\\System32\\lsass.exe"""
"MMC20 Lateral Movement","@2xxeformyshirt (Security Risk Advisors) - rule; Teymur Kheirkhabarov (idea)","Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of ""-Embedding"" as a child of svchost.exe","attack.execution, attack.t1021.003","process_creation","windows","Not classified","Review the parent-child process relationship to determine if the MMC.exe with -Embedding as a child of svchost.exe is part of a known legitimate operation 
Check for any recent software installations or updates that may have triggered the detection 
Investigate scheduled tasks or scripts that involve MMC.exe and svchost.exe to confirm if they are expected behavior","Legitimate use of MMC.exe with -Embedding as a child of svchost.exe during normal system operation 
Software installations or updates that involve MMC.exe and svchost.exe 
Scheduled tasks or scripts that use MMC.exe with -Embedding as a child of svchost.exe","ParentImage=""*\\svchost.exe"" Image=""*\\mmc.exe"" CommandLine=""*-Embedding*"""
"MMC Spawning Windows Shell","Karneades, Swisscom CSIRT","Detects a Windows command line executable started from MMC","attack.lateral_movement, attack.t1021.003","process_creation","windows","Not classified","Review the ParentImage to determine if the MMC process is legitimate or suspicious. 
Analyze the CommandLine and Image fields to understand the nature of the spawned shell. 
Check if the activity aligns with any known administrative tasks or scheduled operations. 
Correlate the event with other security logs to identify any related suspicious behavior.","Legitimate administrative tasks may involve spawning shells from MMC. 
Development or testing activities might trigger this detection. 
Certain applications may use MMC for legitimate purposes. 
Scheduled tasks or scripts may run from MMC.","ParentImage=""*\\mmc.exe"" Image IN (""*\\cmd.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\wscript.exe"", ""*\\cscript.exe"", ""*\\sh.exe"", ""*\\bash.exe"", ""*\\reg.exe"", ""*\\regsvr32.exe"") OR Image=""*\\BITSADMIN*"""
"Potential Suspicious Mofcomp Execution","Nasreddine Bencherchali (Nextron Systems)","Detects execution of the ""mofcomp"" utility as a child of a suspicious shell or script running utility or by having a suspicious path in the commandline.
The ""mofcomp"" utility parses a file containing MOF statements and adds the classes and class instances defined in the file to the WMI repository.
Attackers abuse this utility to install malicious MOF scripts
","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Verify the legitimacy of the process by checking the parent process and the command line arguments 
Review the file being processed by mofcomp for any signs of malicious content 
Check if the execution aligns with any scheduled maintenance or known administrative tasks 
Investigate the user context and privileges under which the mofcomp execution occurred","Legitimate use of mofcomp utility during system maintenance or software installation 
Legitimate scripts or tools running from temporary directories 
Legitimate administrative tasks involving WMI 
Legitimate use of PowerShell or Command Prompt for system operations","Image=""*\\mofcomp.exe"" OR OriginalFileName=""mofcomp.exe"" ParentImage IN (""*\\cmd.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\wsl.exe"", ""*\\wscript.exe"", ""*\\cscript.exe"") OR CommandLine IN (""*\\AppData\\Local\\Temp*"", ""*\\Users\\Public\\*"", ""*\\WINDOWS\\Temp\\*"", ""*%temp%*"", ""*%tmp%*"", ""*%appdata%*"") NOT (ParentImage=""C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"" CommandLine=""*C:\\Windows\\TEMP\\*"" CommandLine=""*.mof"") NOT (CommandLine=""*C:\\Windows\\TEMP\\*"" CommandLine=""*.mof"")"
"File Download Via Windows Defender MpCmpRun.EXE","Matthew Matchen","Detects the use of Windows Defender MpCmdRun.EXE to download files","attack.defense_evasion, attack.t1218, attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Verify the legitimacy of the file download by Windows Defender MpCmdRun.exe 
Check if the download was part of a scheduled task or automated process 
Review Windows Defender logs for related activities 
Investigate if the download was triggered by a known script or application","Legitimate use of Windows Defender MpCmdRun.exe for file downloads 
Scheduled or automated tasks that involve downloading files 
Updates or installations initiated by Windows Defender 
Scripts or applications that use MpCmdRun.exe for legitimate purposes","OriginalFileName=""MpCmdRun.exe"" OR Image=""*\\MpCmdRun.exe"" OR CommandLine=""*MpCmdRun.exe*"" OR Description=""Microsoft Malware Protection Command Line Utility"" CommandLine=""*DownloadFile*"" CommandLine=""*url*"""
"Windows Defender Definition Files Removed","frack113","Adversaries may disable security tools to avoid possible detection of their tools and activities by removing Windows Defender Definition Files","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Check for legitimate use of MpCmdRun.exe for updating definitions 
Review scheduled tasks or scripts that involve removing definition files 
Analyze logs for interactions between third-party security software and Windows Defender","Legitimate use of MpCmdRun.exe for updating definitions 
Scheduled tasks or scripts that legitimately remove definition files 
Third-party security software that may interact with Windows Defender","Image=""*\\MpCmdRun.exe"" OR OriginalFileName=""MpCmdRun.exe"" CommandLine=""* -RemoveDefinitions*"" CommandLine=""* -All*"""
"Potential Arbitrary Command Execution Using Msdt.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects processes leveraging the ""ms-msdt"" handler or the ""msdt.exe"" binary to execute arbitrary commands as seen in the follina (CVE-2022-30190) vulnerability","attack.defense_evasion, attack.t1202","process_creation","windows","Not classified","Check if the msdt.exe process was initiated by a trusted user account 
Review the command line arguments passed to msdt.exe for any suspicious patterns 
Correlate the msdt.exe process execution with other security events for context","Legitimate use of msdt.exe for system troubleshooting 
Use of msdt.exe by authorized IT personnel 
Use of msdt.exe as part of legitimate software installation","Image=""*\\msdt.exe"" OR OriginalFileName=""msdt.exe"" CommandLine=""*IT_BrowseForFile=*"" OR (CommandLine=""* PCWDiagnostic*"" CommandLine IN (""* /af *"", ""* -af *""))"
"Suspicious MSDT Parent Process","Nextron Systems","Detects msdt.exe executed by a suspicious parent as seen in CVE-2022-30190 / Follina exploitation","attack.defense_evasion, attack.t1036, attack.t1218","process_creation","windows","Not classified","Review the command-line arguments passed to msdt.exe for any suspicious parameters 
Check the integrity of the parent process to ensure it is not compromised 
Correlate the process execution with other security events to determine the context of the activity 
Investigate the network connections or file modifications associated with the msdt.exe execution","Legitimate use of msdt.exe by trusted system administration tools 
Scheduled tasks or scripts legitimately invoking msdt.exe 
Use of msdt.exe by authorized IT personnel for troubleshooting purposes","ParentImage IN (""*\\cmd.exe"", ""*\\cscript.exe"", ""*\\mshta.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\schtasks.exe"", ""*\\wmic.exe"", ""*\\wscript.exe"", ""*\\wsl.exe"") Image=""*\\msdt.exe"" OR OriginalFileName=""msdt.exe"""
"Remotely Hosted HTA File Executed Via Mshta.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects execution of the ""mshta"" utility with an argument containing the ""http"" keyword, which could indicate that an attacker is executing a remotely hosted malicious hta file","attack.defense_evasion, attack.execution, attack.t1218.005","process_creation","windows","Not classified","Review the command-line arguments of the mshta.exe process to determine the URL being accessed 
Check the reputation of the accessed URL to identify known legitimate sources 
Analyze the content of the remotely hosted HTA file for any malicious scripts or payloads 
Correlate the mshta.exe execution with other security events to determine the context of the activity","Legitimate use of mshta.exe to access legitimate remote HTA files 
Updates or installations that involve downloading files from the internet 
Scripts or applications that legitimately interact with remote servers 
Internal tools or processes that use mshta.exe with remote URLs","Image=""*\\mshta.exe"" OR OriginalFileName=""MSHTA.EXE"" CommandLine IN (""*http://*"", ""*https://*"", ""*ftp://*"")"
"Suspicious JavaScript Execution Via Mshta.EXE","E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community","Detects execution of javascript code using ""mshta.exe"".","attack.defense_evasion, attack.t1218.005","process_creation","windows","Not classified","Review the command-line arguments of mshta.exe processes to identify the specific JavaScript code being executed. 
Check if the mshta.exe process is spawned by a legitimate parent process or if it is launched in an unusual manner. 
Analyze the context of the activity to determine if it aligns with typical user or system behavior. 
Correlate the mshta.exe execution with other events or logs to understand the full scope of the activity.","Legitimate use of mshta.exe for running scripts or applications. 
Development or administrative tasks that involve running JavaScript via mshta.exe. 
Scripts or applications explicitly allowed by organizational policies. 
Known benign scripts or applications that leverage mshta.exe.","Image=""*\\mshta.exe"" OR OriginalFileName=""MSHTA.EXE"" CommandLine=""*javascript*"""
"Potential LethalHTA Technique Execution","Markus Neis","Detects potential LethalHTA technique where the ""mshta.exe"" is spawned by an ""svchost.exe"" process","attack.defense_evasion, attack.t1218.005","process_creation","windows","Not classified","Check the command line arguments of the mshta.exe process to determine the nature of the execution 
Review the parent-child process relationship to identify the origin of the mshta.exe process 
Inspect the process creation timestamp to see if it aligns with any known legitimate activities 
Correlate with network or file activity to understand the impact of the mshta.exe execution","Legitimate use of mshta.exe by svchost.exe during normal system operation 
Script execution that involves mshta.exe and svchost.exe 
Third-party applications or tools that use mshta.exe and svchost.exe 
Scheduled tasks or system processes that trigger mshta.exe via svchost.exe","ParentImage=""*\\svchost.exe"" Image=""*\\mshta.exe"""
"Suspicious MSHTA Child Process","Michael Haag","Detects a suspicious process spawning from an ""mshta.exe"" process, which could be indicative of a malicious HTA script execution","attack.defense_evasion, attack.t1218.005, car.2013-02-003, car.2013-03-001, car.2014-04-003","process_creation","windows","Not classified","Check the command-line arguments of the child process for any suspicious activity 
Analyze the network connections established by the child process 
Inspect the file system activity of the child process for any malicious behavior 
Verify the reputation of the parent and child processes in a threat intelligence platform","Printer software / driver installations may trigger false positives 
Legitimate software installations that use similar child processes 
Updates or installations of trusted applications","ParentImage=""*\\mshta.exe"" Image IN (""*\\cmd.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\wscript.exe"", ""*\\cscript.exe"", ""*\\sh.exe"", ""*\\bash.exe"", ""*\\reg.exe"", ""*\\regsvr32.exe"", ""*\\bitsadmin.exe"") OR OriginalFileName IN (""Cmd.Exe"", ""PowerShell.EXE"", ""pwsh.dll"", ""wscript.exe"", ""cscript.exe"", ""Bash.exe"", ""reg.exe"", ""REGSVR32.EXE"", ""bitsadmin.exe"")"
"MSHTA Suspicious Execution 01","Diego Perez (@darkquassar), Markus Neis, Swisscom (Improve Rule)","Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism","attack.defense_evasion, attack.t1140, attack.t1218.005, attack.execution, attack.t1059.007, cve.2020.1599","process_creation","windows","Not classified","Review the command line arguments of the mshta.exe process to understand the context of the execution 
Check the parent process of mshta.exe to identify the origin of the suspicious execution 
Analyze the file types involved in the command line to determine if they are expected in the environment 
Correlate the mshta.exe execution with other security events to identify any related suspicious activities","Scheduled legitimate tasks or scripts that use mshta.exe 
Administrative tools that trigger the detection criteria 
Custom applications that have legitimate reasons to interact with the specified file types","Image=""*\\mshta.exe"" CommandLine IN (""*vbscript*"", ""*.jpg*"", ""*.png*"", ""*.lnk*"", ""*.xls*"", ""*.doc*"", ""*.zip*"", ""*.dll*"")"
"Suspicious Mshta.EXE Execution Patterns","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects suspicious mshta process execution patterns","attack.execution, attack.t1106","process_creation","windows","Not classified","Review the command line arguments of the mshta.exe process to identify the source and purpose of the execution 
Check the parent process of mshta.exe to determine if it is launched from a legitimate application or script 
Investigate the file paths accessed by mshta.exe to understand the context of the execution 
Correlate the mshta.exe execution with other security events or logs to determine if it is part of a larger attack chain","Legitimate use of mshta.exe in specific environments 
Scheduled tasks or scripts that leverage mshta.exe 
Updates or installations that involve mshta.exe 
Custom applications or tools that use mshta.exe","(Image=""*\\mshta.exe"" OR OriginalFileName=""MSHTA.EXE"" ParentImage IN (""*\\cmd.exe"", ""*\\cscript.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\wscript.exe"") CommandLine IN (""*\\AppData\\Local\\*"", ""*C:\\ProgramData\\*"", ""*C:\\Users\\Public\\*"", ""*C:\\Windows\\Temp\\*"")) OR (Image=""*\\mshta.exe"" OR OriginalFileName=""MSHTA.EXE"" NOT (Image IN (""C:\\Windows\\System32\\*"", ""C:\\Windows\\SysWOW64\\*"") OR CommandLine IN (""*.htm*"", ""*.hta*"") OR CommandLine IN (""*mshta.exe"", ""*mshta"")))"
"Potential MsiExec Masquerading","Florian Roth (Nextron Systems)","Detects the execution of msiexec.exe from an uncommon directory","attack.defense_evasion, attack.t1036.005","process_creation","windows","Not classified","Check the command-line arguments used with msiexec.exe for any suspicious parameters 
Verify the parent process that initiated msiexec.exe for any anomalies 
Review the file path of the msiexec.exe to determine if it is a known legitimate location 
Correlate the msiexec.exe execution with other security events to identify any related suspicious activities","Legitimate use of msiexec.exe from a non-standard directory 
Software installations that legitimately use msiexec.exe 
Scheduled tasks or scripts that use msiexec.exe 
Upgrades or patches that involve msiexec.exe","Image=""*\\msiexec.exe"" OR OriginalFileName=""\\msiexec.exe"" NOT (Image IN (""C:\\Windows\\System32\\*"", ""C:\\Windows\\SysWOW64\\*"", ""C:\\Windows\\WinSxS\\*""))"
"Potential Process Injection Via Msra.EXE","Alexander McDonald","Detects potential process injection via Microsoft Remote Asssistance (Msra.exe) by looking at suspicious child processes spawned from the aforementioned process. It has been a target used by many threat actors and used for discovery and persistence tactics","attack.defense_evasion, attack.t1055","process_creation","windows","Not classified","Review the process command line arguments to determine the purpose of the spawned processes 
Check if the processes spawned from Msra.exe are part of a known whitelisted application or script 
Correlate the process creation events with network or file activity to identify any malicious behavior 
Verify the legitimacy of the parent-child process relationship by analyzing the process tree","Legitimate use of remote assistance tools in the environment 
Scheduled legitimate tasks spawning from Msra.exe 
Authorized administrative actions triggering the monitored processes","ParentImage=""*\\msra.exe"" ParentCommandLine=""*msra.exe"" Image IN (""*\\arp.exe"", ""*\\cmd.exe"", ""*\\net.exe"", ""*\\netstat.exe"", ""*\\nslookup.exe"", ""*\\route.exe"", ""*\\schtasks.exe"", ""*\\whoami.exe"")"
"Suspicious Child Process Of SQL Server","FPT.EagleEye Team, wagga","Detects suspicious child processes of the SQLServer process. This could indicate potential RCE or SQL Injection.","attack.t1505.003, attack.t1190, attack.initial_access, attack.persistence, attack.privilege_escalation","process_creation","windows","Not classified","Review the command line arguments of the suspicious child process to determine its intent. 
Check the reputation of the process and its associated parent process. 
Correlate the process creation with other security events to identify any patterns of malicious behavior. 
Investigate the network connections and file system activity of the suspicious process for further insights.","Legitimate administrative tasks may spawn these processes. 
Third-party applications may also trigger these processes. 
Scheduled tasks or scripts could be the cause of these processes. 
Development or testing environments may exhibit similar behavior.","ParentImage=""*\\sqlservr.exe"" Image IN (""*\\bash.exe"", ""*\\bitsadmin.exe"", ""*\\cmd.exe"", ""*\\netstat.exe"", ""*\\nltest.exe"", ""*\\ping.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\sh.exe"", ""*\\systeminfo.exe"", ""*\\tasklist.exe"", ""*\\wsl.exe"") NOT (ParentImage=""C:\\Program Files\\Microsoft SQL Server\\*"" ParentImage=""*DATEV_DBENGINE\\MSSQL\\Binn\\sqlservr.exe"" Image=""C:\\Windows\\System32\\cmd.exe"" CommandLine=""\""C:\\Windows\\system32\\cmd.exe\"" *"")"
"Suspicious Child Process Of Veeam Dabatase","Nasreddine Bencherchali (Nextron Systems)","Detects suspicious child processes of the Veeam service process. This could indicate potential RCE or SQL Injection.","attack.initial_access, attack.persistence, attack.privilege_escalation","process_creation","windows","Not classified","Verify the legitimacy of the parent process (Veeam service) and its associated command line. 
Check if the child processes are triggered by authorized actions or known maintenance tasks. 
Review any recent software installations or updates that could explain the presence of these child processes. 
Investigate scheduled tasks or scripts that may be running on the system to determine if they are the cause of the detected behavior.","Legitimate administrative or maintenance tasks may trigger these child processes. 
Upgrades or installations of software may also spawn these child processes. 
Scheduled tasks or scripts that are part of normal operations can exhibit similar behavior.","ParentImage=""*\\sqlservr.exe"" ParentCommandLine=""*VEEAMSQL*"" (Image IN (""*\\cmd.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\wsl.exe"", ""*\\wt.exe"") CommandLine IN (""*-ex *"", ""*bypass*"", ""*cscript*"", ""*DownloadString*"", ""*http://*"", ""*https://*"", ""*mshta*"", ""*regsvr32*"", ""*rundll32*"", ""*wscript*"", ""*copy *"")) OR Image IN (""*\\net.exe"", ""*\\net1.exe"", ""*\\netstat.exe"", ""*\\nltest.exe"", ""*\\ping.exe"", ""*\\tasklist.exe"", ""*\\whoami.exe"")"
"Potential MSTSC Shadowing Activity","Florian Roth (Nextron Systems)","Detects RDP session hijacking by using MSTSC shadowing","attack.lateral_movement, attack.t1563.002","process_creation","windows","Not classified","Review the command-line arguments of the process to determine the context of the 'shadow:' parameter 
Check if the activity is expected and authorized within the environment 
Correlate with user authentication logs to verify the legitimacy of the session 
Investigate the source and destination systems involved in the potential shadowing activity","Legitimate use of MSTSC shadowing for administrative purposes 
Third-party remote access tools that use similar syntax 
Scripting or automation tools that utilize shadowing commands","CommandLine=""*noconsentprompt*"" CommandLine=""*shadow:*"""
"Suspicious Mstsc.EXE Execution With Local RDP File","Nasreddine Bencherchali (Nextron Systems)","Detects potential RDP connection via Mstsc using a local "".rdp"" file located in suspicious locations.","attack.command_and_control, attack.t1219","process_creation","windows","Not classified","Review the command-line arguments of the Mstsc.exe process to understand the context of the RDP connection 
Check the user context and privileges under which the Mstsc.exe process was executed 
Correlate the Mstsc.exe execution with other security events to determine if it is part of a larger attack chain 
Verify the integrity of the .rdp file and its contents for any malicious modifications","Legitimate use of Mstsc.exe with .rdp files in the specified paths for authorized purposes 
Scheduled tasks or scripts that use Mstsc.exe with .rdp files in the specified paths 
Common administrative activities that involve Mstsc.exe and .rdp files in the specified paths 
Third-party applications that interact with Mstsc.exe and .rdp files in the specified paths","Image=""*\\mstsc.exe"" OR OriginalFileName=""mstsc.exe"" CommandLine IN (""*.rdp"", ""*.rdp\"""") CommandLine IN (""*:\\Users\\Public\\*"", ""*:\\Windows\\System32\\spool\\drivers\\color*"", ""*:\\Windows\\System32\\Tasks_Migrated *"", ""*:\\Windows\\Tasks\\*"", ""*:\\Windows\\Temp\\*"", ""*:\\Windows\\Tracing\\*"", ""*\\AppData\\Local\\Temp\\*"", ""*\\Downloads\\*"")"
"Mstsc.EXE Execution From Uncommon Parent","Nasreddine Bencherchali (Nextron Systems)","Detects potential RDP connection via Mstsc using a local "".rdp"" file located in suspicious locations.","attack.lateral_movement","process_creation","windows","Not classified","Review the parent process to determine if it is a legitimate application or script 
Check for scheduled tasks or automation scripts that may explain the behavior 
Investigate the purpose of the RDP connection and verify its legitimacy 
Analyze the context of the Mstsc.EXE execution to understand the full chain of events","Legitimate use of RDP connections from uncommon parent processes 
Scheduled tasks or legitimate scripts triggering RDP connections 
Use of legitimate tools that may spawn Mstsc.EXE from uncommon parents 
Custom applications or configurations that trigger this behavior","ParentImage IN (""*\\brave.exe"", ""*\\CCleanerBrowser.exe"", ""*\\chrome.exe"", ""*\\chromium.exe"", ""*\\firefox.exe"", ""*\\iexplore.exe"", ""*\\microsoftedge.exe"", ""*\\msedge.exe"", ""*\\opera.exe"", ""*\\vivaldi.exe"", ""*\\whale.exe"", ""*\\outlook.exe"") Image=""*\\mstsc.exe"" OR OriginalFileName=""mstsc.exe"""
"Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE","Sander Wiebing, Jonhnathan Ribeiro, Daniil Yugoslavskiy, oscd.community","Detects Netsh command execution that whitelists a program located in a suspicious location in the Windows Firewall","attack.defense_evasion, attack.t1562.004","process_creation","windows","Not classified","Check if the whitelisted program is a known safe application 
Verify if the firewall rule change was authorized through change management processes 
Review the command-line arguments used with netsh.exe for any suspicious parameters","Legitimate changes to firewall rules by authorized administrators 
Whitelisting known safe programs in the firewall 
Legitimate use of netsh.exe for firewall configuration","Image=""*\\netsh.exe"" OR OriginalFileName=""netsh.exe"" (CommandLine=""*firewall*"" CommandLine=""*add*"" CommandLine=""*allowedprogram*"") OR (CommandLine=""*advfirewall*"" CommandLine=""*firewall*"" CommandLine=""*add*"" CommandLine=""*rule*"" CommandLine=""*action=allow*"" CommandLine=""*program=*"") CommandLine IN (""*:\\$Recycle.bin\\*"", ""*:\\RECYCLER.BIN\\*"", ""*:\\RECYCLERS.BIN\\*"", ""*:\\SystemVolumeInformation\\*"", ""*:\\Temp\\*"", ""*:\\Users\\Default\\*"", ""*:\\Users\\Desktop\\*"", ""*:\\Users\\Public\\*"", ""*:\\Windows\\addins\\*"", ""*:\\Windows\\cursors\\*"", ""*:\\Windows\\debug\\*"", ""*:\\Windows\\drivers\\*"", ""*:\\Windows\\fonts\\*"", ""*:\\Windows\\help\\*"", ""*:\\Windows\\system32\\tasks\\*"", ""*:\\Windows\\Tasks\\*"", ""*:\\Windows\\Temp\\*"", ""*\\Downloads\\*"", ""*\\Local Settings\\Temporary Internet Files\\*"", ""*\\Temporary Internet Files\\Content.Outlook\\*"", ""*%Public%\\*"", ""*%TEMP%*"", ""*%TMP%*"")"
"RDP Connection Allowed Via Netsh.EXE","Sander Wiebing","Detects usage of the netsh command to open and allow connections to port 3389 (RDP). As seen used by Sarwent Malware","attack.defense_evasion, attack.t1562.004","process_creation","windows","Not classified","Check if the netsh command was executed by a privileged user account 
Review the context around the netsh command execution to determine if it was part of a legitimate operation 
Correlate the netsh command with other security events to look for signs of malicious activity 
Verify if the RDP port opening was authorized and documented in change management records","Legitimate system administration tasks may involve opening RDP ports using netsh 
Software installations or updates may require opening RDP ports 
Scheduled maintenance tasks may trigger this detection 
Network configuration changes by authorized personnel","Image=""*\\netsh.exe"" OR OriginalFileName=""netsh.exe"" CommandLine=""*firewall *"" CommandLine=""*add *"" CommandLine=""*tcp *"" CommandLine=""*3389*"" CommandLine IN (""*portopening*"", ""*allow*"")"
"RDP Port Forwarding Rule Added Via Netsh.EXE","Florian Roth (Nextron Systems), oscd.community","Detects the execution of netsh to configure a port forwarding of port 3389 (RDP) rule","attack.lateral_movement, attack.defense_evasion, attack.command_and_control, attack.t1090","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the specific netsh command executed 
Check for any associated network traffic on port 3389 to determine if the port forwarding rule is actively being used 
Correlate the process execution with other security events to identify any malicious behavior or context 
Verify the legitimacy of the activity with the system or network administrators","Legitimate administration activity involving port forwarding 
Scheduled tasks or scripts that use netsh for valid purposes 
Third-party applications that utilize netsh for configuration","Image=""*\\netsh.exe"" OR OriginalFileName=""netsh.exe"" CommandLine=""* i*"" CommandLine=""* p*"" CommandLine=""*=3389*"" CommandLine=""* c*"""
"New User Created Via Net.EXE With Never Expire Option","Nasreddine Bencherchali (Nextron Systems)","Detects creation of local users via the net.exe command with the option ""never expire""","attack.persistence, attack.t1136.001","process_creation","windows","Not classified","Check the context of the user creation to determine if it was performed by an authorized user or system process 
Review scheduled tasks and scripts that run on the system to identify any legitimate processes creating users with 'never expire' option 
Investigate any third-party applications or tools that are known to create users with 'never expire' option 
Correlate user creation events with system logs to identify any suspicious activities or anomalies","Legitimate user creation with 'never expire' option by system administrators 
Scheduled tasks or scripts that create users with 'never expire' option 
Third-party applications that create users with 'never expire' option","Image IN (""*\\net.exe"", ""*\\net1.exe"") OR OriginalFileName IN (""net.exe"", ""net1.exe"") CommandLine=""*user*"" CommandLine=""*add*"" CommandLine=""*expires:never*"""
"Suspicious Manipulation Of Default Accounts Via Net.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects suspicious manipulations of default accounts such as 'administrator' and 'guest'. For example 'enable' or 'disable' accounts or change the password...etc","attack.collection, attack.t1560.001","process_creation","windows","Not classified","Verify the legitimacy of the user account manipulation by checking with the responsible system administrators 
Review any scheduled tasks or scripts that involve user account management for potential triggers 
Cross-reference the activity with authorized change management records to confirm if the action was expected 
Investigate the context of the account manipulation to determine if it aligns with normal administrative activities","Legitimate administrative actions may trigger this rule, especially if scripts are used to manage user accounts 
Changes made by authorized personnel to default accounts may trigger this rule 
Third-party applications or system tools that interact with user accounts may also trigger this rule 
Scheduled tasks or scripts that involve user account management may lead to false positives","Image IN (""*\\net.exe"", ""*\\net1.exe"") OR OriginalFileName IN (""net.exe"", ""net1.exe"") CommandLine=""* user *"" CommandLine IN (""* Jrjestelmnvalvoja *"", ""* Rendszergazda *"", ""*  *"", ""* Administrateur *"", ""* Administrador *"", ""* Administratr *"", ""* Administrator *"", ""* guest *"", ""* DefaultAccount *"", ""* \""Jrjestelmnvalvoja\"" *"", ""* \""Rendszergazda\"" *"", ""* \""\"" *"", ""* \""Administrateur\"" *"", ""* \""Administrador\"" *"", ""* \""Administratr\"" *"", ""* \""Administrator\"" *"", ""* \""guest\"" *"", ""* \""DefaultAccount\"" *"", ""* 'Jrjestelmnvalvoja' *"", ""* 'Rendszergazda' *"", ""* '' *"", ""* 'Administrateur' *"", ""* 'Administrador' *"", ""* 'Administratr' *"", ""* 'Administrator' *"", ""* 'guest' *"", ""* 'DefaultAccount' *"") NOT (CommandLine=""*guest*"" CommandLine=""*/active no*"")"
"Potential Arbitrary Code Execution Via Node.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects the execution node.exe which is shipped with multiple software such as VMware, Adobe...etc. In order to execute arbitrary code. For example to establish reverse shell as seen in Log4j attacks...etc","attack.defense_evasion, attack.t1127","process_creation","windows","Not classified","Review the command-line arguments of the node.exe process to determine if any suspicious or unauthorized commands are being executed 
Check the parent process of the node.exe to understand the context in which it was launched 
Correlate the node.exe execution with other security events or logs to identify any related suspicious activities 
Conduct memory or disk forensics on the system to gather more information about the node.exe execution and its potential impact","Legitimate use of node.exe for authorized scripting or development purposes 
Use of node.exe by system administrators for legitimate system management tasks 
Node.exe executed as part of a known and approved software installation process","Image=""*\\node.exe"" CommandLine IN (""* -e *"", ""* --eval *"") CommandLine=""*.exec(*"" CommandLine=""*net.socket*"" CommandLine=""*.connect*"" CommandLine=""*child_process*"""
"Network Reconnaissance Activity","Florian Roth (Nextron Systems)","Detects a set of suspicious network related commands often used in recon stages","attack.discovery, attack.t1087, attack.t1082, car.2016-03-001","process_creation","windows","Not classified","Review the command line arguments of the process that triggered the alert 
Check the reputation of the process and its associated command line arguments 
Correlate the network activity with other security events to determine the context of the activity 
Investigate the user context and privileges of the process to identify any anomalies","Legitimate use of nslookup for DNS troubleshooting purposes 
Administrative tools that use similar commands for network configuration 
Scheduled tasks or scripts that involve network-related commands","CommandLine=""*nslookup*"" CommandLine=""*_ldap._tcp.dc._msdcs.*"""
"Suspicious Microsoft OneNote Child Process","Tim Rauch (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), Elastic (idea)","Detects suspicious child processes of the Microsoft OneNote application. This may indicate an attempt to execute malicious embedded objects from a .one file.","attack.t1566, attack.t1566.001, attack.initial_access","process_creation","windows","Not classified","Review the command-line arguments of the suspicious child process to identify any unusual or malicious behavior 
Analyze the network connections established by the child process for any communication with malicious domains or IPs 
Check the file system activity of the child process to determine if it is accessing or modifying sensitive files or directories 
Correlate the timestamps of the suspicious child process with other security events to understand the context of the activity","Legitimate child processes spawned by Microsoft OneNote during normal operation 
Updates or patches to Microsoft OneNote triggering child processes 
Third-party applications interacting with Microsoft OneNote leading to child processes","ParentImage=""*\\onenote.exe"" OriginalFileName IN (""bitsadmin.exe"", ""CertOC.exe"", ""CertUtil.exe"", ""Cmd.Exe"", ""CMSTP.EXE"", ""cscript.exe"", ""curl.exe"", ""HH.exe"", ""IEExec.exe"", ""InstallUtil.exe"", ""javaw.exe"", ""Microsoft.Workflow.Compiler.exe"", ""msdt.exe"", ""MSHTA.EXE"", ""msiexec.exe"", ""Msxsl.exe"", ""odbcconf.exe"", ""pcalua.exe"", ""PowerShell.EXE"", ""RegAsm.exe"", ""RegSvcs.exe"", ""REGSVR32.exe"", ""RUNDLL32.exe"", ""schtasks.exe"", ""ScriptRunner.exe"", ""wmic.exe"", ""WorkFolders.exe"", ""wscript.exe"") OR Image IN (""*\\AppVLP.exe"", ""*\\bash.exe"", ""*\\bitsadmin.exe"", ""*\\certoc.exe"", ""*\\certutil.exe"", ""*\\cmd.exe"", ""*\\cmstp.exe"", ""*\\control.exe"", ""*\\cscript.exe"", ""*\\curl.exe"", ""*\\forfiles.exe"", ""*\\hh.exe"", ""*\\ieexec.exe"", ""*\\installutil.exe"", ""*\\javaw.exe"", ""*\\mftrace.exe"", ""*\\Microsoft.Workflow.Compiler.exe"", ""*\\msbuild.exe"", ""*\\msdt.exe"", ""*\\mshta.exe"", ""*\\msidb.exe"", ""*\\msiexec.exe"", ""*\\msxsl.exe"", ""*\\odbcconf.exe"", ""*\\pcalua.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\regasm.exe"", ""*\\regsvcs.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\schtasks.exe"", ""*\\scrcons.exe"", ""*\\scriptrunner.exe"", ""*\\sh.exe"", ""*\\svchost.exe"", ""*\\verclsid.exe"", ""*\\wmic.exe"", ""*\\workfolders.exe"", ""*\\wscript.exe"") OR (Image=""*\\explorer.exe"" CommandLine IN (""*.hta*"", ""*.vb*"", ""*.wsh*"", ""*.js*"", ""*.ps*"", ""*.scr*"", ""*.pif*"", ""*.bat*"", ""*.cmd*"")) OR Image IN (""*\\AppData\\*"", ""*\\Users\\Public\\*"", ""*\\ProgramData\\*"", ""*\\Windows\\Tasks\\*"", ""*\\Windows\\Temp\\*"", ""*\\Windows\\System32\\Tasks\\*"") NOT ((Image=""*\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe"" CommandLine=""*-Embedding"") OR (Image=""*\\AppData\\Local\\Microsoft\\OneDrive\\*"" Image=""*\\FileCoAuth.exe"" CommandLine=""*-Embedding""))"
"Outlook EnableUnsafeClientMailRules Setting Enabled","Markus Neis, Nasreddine Bencherchali (Nextron Systems)","Detects an attacker trying to enable the outlook security setting ""EnableUnsafeClientMailRules"" which allows outlook to run applications or execute macros","attack.execution, attack.t1059, attack.t1202","process_creation","windows","Not classified","Review the command line arguments of the process creation event to identify the specific action related to enabling the 'EnableUnsafeClientMailRules' setting in Outlook 
Check for any legitimate reasons or authorized activities that may have triggered the detection 
Correlate the event with other security logs to determine if there are any additional suspicious activities or indicators of compromise 
Verify the user context and permissions of the process to see if it aligns with expected behavior","Legitimate system administrators making changes to Outlook settings 
Updates or installations that require changes to Outlook security settings 
Configuration changes by authorized users for legitimate purposes","CommandLine=""*\\Outlook\\Security\\EnableUnsafeClientMailRules*"""
"Suspicious Execution From Outlook Temporary Folder","Florian Roth (Nextron Systems)","Detects a suspicious program execution in Outlook temp folder","attack.initial_access, attack.t1566.001","process_creation","windows","Not classified","Review the process command line arguments to determine the nature of the program being executed 
Check the parent process to see if it is a known and trusted application 
Investigate the reputation of the file hash or path using threat intelligence feeds 
Analyze network connections or file modifications associated with the suspicious execution","Legitimate software installations that use the Outlook temporary folder 
Scheduled tasks or scripts that interact with the Outlook temporary folder 
Updates or patches that utilize the Outlook temporary folder","Image=""*\\Temporary Internet Files\\Content.Outlook\\*"""
"Suspicious Outlook Child Process","Michael Haag, Florian Roth (Nextron Systems), Markus Neis, Elastic, FPT.EagleEye Team","Detects a suspicious process spawning from an Outlook process.","attack.execution, attack.t1204.002","process_creation","windows","Not classified","Review the command line arguments of the suspicious child process to determine its intent 
Check if the process is part of a legitimate software installation or update 
Correlate with other security events to identify any malicious behavior associated with the process","Legitimate use of tools like PowerShell or Command Prompt by users for legitimate purposes 
Updates or installations triggered by scheduled tasks 
Use of scripting languages like VBScript or JScript for authorized tasks","ParentImage=""*\\OUTLOOK.EXE"" Image IN (""*\\AppVLP.exe"", ""*\\bash.exe"", ""*\\cmd.exe"", ""*\\cscript.exe"", ""*\\forfiles.exe"", ""*\\hh.exe"", ""*\\mftrace.exe"", ""*\\msbuild.exe"", ""*\\msdt.exe"", ""*\\mshta.exe"", ""*\\msiexec.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\regsvr32.exe"", ""*\\schtasks.exe"", ""*\\scrcons.exe"", ""*\\scriptrunner.exe"", ""*\\sh.exe"", ""*\\svchost.exe"", ""*\\wmic.exe"", ""*\\wscript.exe"")"
"Suspicious Remote Child Process From Outlook","Markus Neis, Nasreddine Bencherchali (Nextron Systems)","Detects a suspicious child process spawning from Outlook where the image is located in a remote location (SMB/WebDav shares).","attack.execution, attack.t1059, attack.t1202","process_creation","windows","Not classified","Review the process tree to understand the context of the suspicious child process. 
Check if the remote location is a known and authorized share within the organization. 
Analyze the behavior of the process to determine if it aligns with legitimate activities. 
Correlate the event with other security logs to identify any related suspicious activities.","Legitimate use of remote shares by authorized users for legitimate purposes. 
Scheduled tasks or applications that are designed to run from remote locations. 
Third-party applications that interact with Outlook and may spawn child processes from remote locations.","ParentImage=""*\\outlook.exe"" Image=""\\\\*"""
"Suspicious Binary In User Directory Spawned From Office Application","Jason Lynch","Detects an executable in the users directory started from one of the Microsoft Office suite applications (Word, Excel, PowerPoint, Publisher, Visio)","attack.execution, attack.t1204.002, attack.g0046, car.2013-05-002","process_creation","windows","Not classified","Check the reputation of the executable using threat intelligence sources 
Analyze the behavior of the process for any malicious activities 
Review the parent process and command line for context 
Verify the legitimacy of the executable with the user or IT department","Legitimate use of portable applications by users 
Legitimate software installations in user directories 
Scripting or automation tools used by users","ParentImage IN (""*\\WINWORD.EXE"", ""*\\EXCEL.EXE"", ""*\\POWERPNT.exe"", ""*\\MSPUB.exe"", ""*\\VISIO.exe"", ""*\\MSACCESS.exe"", ""*\\EQNEDT32.exe"") Image=""C:\\users\\*"" Image=""*.exe"" NOT Image=""*\\Teams.exe"""
"Suspicious Microsoft Office Child Process","Florian Roth (Nextron Systems), Markus Neis, FPT.EagleEye Team, Vadim Khrykov, Cyb3rEng, Michael Haag, Christopher Peacock @securepeacock, @scythe_io","Detects a suspicious process spawning from one of the Microsoft Office suite products (Word, Excel, PowerPoint, Publisher, Visio, etc.)","attack.defense_evasion, attack.execution, attack.t1047, attack.t1204.002, attack.t1218.010","process_creation","windows","Not classified","Review the parent-child process relationship to determine if the behavior is expected or suspicious 
Check the reputation and purpose of the child processes spawned by Microsoft Office applications 
Analyze the paths of the child processes to identify any unusual or unauthorized locations 
Correlate the activity with other security events or threat intelligence to validate the suspicion","Legitimate use of Microsoft Office applications spawning child processes for normal operations 
Updates or installations triggered by Microsoft Office applications 
Scripting or automation tasks initiated by Microsoft Office applications","ParentImage IN (""*\\EQNEDT32.EXE"", ""*\\EXCEL.EXE"", ""*\\MSACCESS.EXE"", ""*\\MSPUB.exe"", ""*\\ONENOTE.EXE"", ""*\\POWERPNT.exe"", ""*\\VISIO.exe"", ""*\\WINWORD.EXE"", ""*\\wordpad.exe"", ""*\\wordview.exe"") OriginalFileName IN (""bitsadmin.exe"", ""CertOC.exe"", ""CertUtil.exe"", ""Cmd.Exe"", ""CMSTP.EXE"", ""cscript.exe"", ""curl.exe"", ""HH.exe"", ""IEExec.exe"", ""InstallUtil.exe"", ""javaw.exe"", ""Microsoft.Workflow.Compiler.exe"", ""msdt.exe"", ""MSHTA.EXE"", ""msiexec.exe"", ""Msxsl.exe"", ""odbcconf.exe"", ""pcalua.exe"", ""PowerShell.EXE"", ""RegAsm.exe"", ""RegSvcs.exe"", ""REGSVR32.exe"", ""RUNDLL32.exe"", ""schtasks.exe"", ""ScriptRunner.exe"", ""wmic.exe"", ""WorkFolders.exe"", ""wscript.exe"") OR Image IN (""*\\AppVLP.exe"", ""*\\bash.exe"", ""*\\bitsadmin.exe"", ""*\\certoc.exe"", ""*\\certutil.exe"", ""*\\cmd.exe"", ""*\\cmstp.exe"", ""*\\control.exe"", ""*\\cscript.exe"", ""*\\curl.exe"", ""*\\forfiles.exe"", ""*\\hh.exe"", ""*\\ieexec.exe"", ""*\\installutil.exe"", ""*\\javaw.exe"", ""*\\mftrace.exe"", ""*\\Microsoft.Workflow.Compiler.exe"", ""*\\msbuild.exe"", ""*\\msdt.exe"", ""*\\mshta.exe"", ""*\\msidb.exe"", ""*\\msiexec.exe"", ""*\\msxsl.exe"", ""*\\odbcconf.exe"", ""*\\pcalua.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\regasm.exe"", ""*\\regsvcs.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\schtasks.exe"", ""*\\scrcons.exe"", ""*\\scriptrunner.exe"", ""*\\sh.exe"", ""*\\svchost.exe"", ""*\\verclsid.exe"", ""*\\wmic.exe"", ""*\\workfolders.exe"", ""*\\wscript.exe"") OR Image IN (""*\\AppData\\*"", ""*\\Users\\Public\\*"", ""*\\ProgramData\\*"", ""*\\Windows\\Tasks\\*"", ""*\\Windows\\Temp\\*"", ""*\\Windows\\System32\\Tasks\\*"")"
"Ping Hex IP","Florian Roth (Nextron Systems)","Detects a ping command that uses a hex encoded IP address","attack.defense_evasion, attack.t1140, attack.t1027","process_creation","windows","Not classified","Review the Parent Process and investigate if it is a known system tool or a suspicious process 
Check if the hex-encoded IP address is associated with any authorized or unauthorized activity 
Correlate the event with network logs to determine if there are any related network connections to the hex IP address 
Verify if there are any legitimate reasons for using hex-encoded IP addresses in the environment","Legitimate use of hex-encoded IP addresses in specialized environments 
Tools or scripts that use hex-encoded IP addresses for legitimate purposes 
Network devices or applications that communicate using hex-encoded IP addresses","Image=""*\\ping.exe"" CommandLine=""*0x*"""
"Suspicious Plink Port Forwarding","Florian Roth (Nextron Systems)","Detects suspicious Plink tunnel port forwarding to a local port","attack.command_and_control, attack.t1572, attack.lateral_movement, attack.t1021.001","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of the port forwarding 
Check if there are any documented procedures or tickets related to the observed activity 
Correlate the event with other security controls or logs to determine if the activity is part of a known process 
Engage with the system or network administrators to validate the legitimacy of the port forwarding activity","Administrative tasks involving legitimate use of Plink for port forwarding 
Scheduled tasks or scripts that involve Plink port forwarding 
Authorized tunneling for specific applications or services","Description=""Command-line SSH, Telnet, and Rlogin client"" CommandLine=""* -R *"""
"Potential RDP Tunneling Via Plink","Florian Roth (Nextron Systems)","Execution of plink to perform data exfiltration and tunneling","attack.command_and_control, attack.t1572","process_creation","windows","Not classified","Review the command-line arguments of plink.exe instances to determine the intent 
Check for any authorized or scheduled tasks that involve plink usage 
Correlate the plink.exe execution with other network or process-related logs for context 
Verify the legitimacy of the tunneling activity with the responsible personnel","Legitimate use of plink for authorized tunneling purposes 
Scheduled tasks or scripts that involve plink usage 
Administrative activities that require tunneling","(Image=""*\\plink.exe"" CommandLine=""*:127.0.0.1:3389*"") OR (Image=""*\\plink.exe"" CommandLine=""*:3389*"" CommandLine IN (""* -P 443*"", ""* -P 22*""))"
"AADInternals PowerShell Cmdlets Execution - ProccessCreation","Austin Songer (@austinsonger), Nasreddine Bencherchali (Nextron Systems)","Detects ADDInternals Cmdlet execution. A tool for administering Azure AD and Office 365. Which can be abused by threat actors to attack Azure AD or Office 365.","attack.execution, attack.reconnaissance, attack.discovery, attack.credential_access, attack.impact","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the specific AADInternals cmdlet being executed 
Correlate the process creation event with user context and other security events to determine the legitimacy of the activity 
Check for any scheduled tasks or scripts that are known to use AADInternals for legitimate purposes 
Engage with the system or application owners to confirm the purpose of AADInternals usage in the environment","Scheduled legitimate administrative tasks using AADInternals 
Automated scripts leveraging AADInternals for authorized operations 
Development or testing environments where AADInternals is frequently used 
Authorized security assessments or red team exercises involving AADInternals","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.Exe"", ""pwsh.dll"") CommandLine IN (""*Add-AADInt*"", ""*ConvertTo-AADInt*"", ""*Disable-AADInt*"", ""*Enable-AADInt*"", ""*Export-AADInt*"", ""*Get-AADInt*"", ""*Grant-AADInt*"", ""*Install-AADInt*"", ""*Invoke-AADInt*"", ""*Join-AADInt*"", ""*New-AADInt*"", ""*Open-AADInt*"", ""*Read-AADInt*"", ""*Register-AADInt*"", ""*Remove-AADInt*"", ""*Restore-AADInt*"", ""*Search-AADInt*"", ""*Send-AADInt*"", ""*Set-AADInt*"", ""*Start-AADInt*"", ""*Update-AADInt*"")"
"Potential AMSI Bypass Via .NET Reflection","Markus Neis, @Kostastsale","Detects Request to ""amsiInitFailed"" that can be used to disable AMSI Scanning","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the command line arguments of the process creation event to identify the presence of 'System.Management.Automation.AmsiUtils' and 'amsiInitFailed' 
Check for the use of '[Ref].Assembly.GetType', 'SetValue($null,$true)', and 'NonPublic,Static' in the command line arguments 
Correlate with additional events or logs to determine the context and potential impact of the detected activity 
Investigate the reputation and source of the process to determine if it is a known or trusted entity","Legitimate use of .NET Reflection in applications 
Upgrades or installations of legitimate software that trigger similar commands 
Scripting or automation tools that utilize similar commands","CommandLine IN (""*System.Management.Automation.AmsiUtils*"", ""*amsiInitFailed*"") OR (CommandLine=""*[Ref].Assembly.GetType*"" CommandLine=""*SetValue($null,$true)*"" CommandLine=""*NonPublic,Static*"")"
"Suspicious Encoded PowerShell Command Line","Florian Roth (Nextron Systems), Markus Neis, Jonhnathan Ribeiro, Daniil Yugoslavskiy, Anton Kutepov, oscd.community","Detects suspicious powershell process starts with base64 encoded commands (e.g. Emotet)","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line arguments of the PowerShell process to understand the context of the encoded commands 
Check if the encoded commands are part of a known legitimate script or tool used in the environment 
Correlate with network or endpoint logs to determine if the encoded commands resulted in any malicious activity 
Investigate the parent process that initiated the suspicious PowerShell command for additional context","Legitimate use of base64 encoded PowerShell commands for administrative tasks 
Encoded commands used by security tools or scripts 
Encoded commands used in penetration testing engagements","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") (CommandLine=""* -e*"" CommandLine IN (""* JAB*"", ""* SUVYI*"", ""* SQBFAFgA*"", ""* aQBlAHgA*"", ""* aWV4I*"", ""* IAA*"", ""* IAB*"", ""* UwB*"", ""* cwB*"")) OR CommandLine IN (""*.exe -ENCOD *"", ""* BA^J e-*"") NOT CommandLine=""* -ExecutionPolicy remotesigned *"""
"Suspicious PowerShell Encoded Command Patterns","Florian Roth (Nextron Systems)","Detects PowerShell command line patterns in combincation with encoded commands that often appear in malware infection chains","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the parent process of the PowerShell execution to determine if it is a known administrative tool or script 
Check if the encoded PowerShell command is part of a scheduled task or a legitimate script 
Analyze the context of the encoded PowerShell command to see if it aligns with development or testing activities 
Correlate the PowerShell execution with other security events to identify any malicious behavior or indicators of compromise","Legitimate administrative or monitoring tools that use encoded PowerShell commands 
Scheduled tasks or scripts that use encoded PowerShell commands 
Development or testing environments where encoded PowerShell commands are used for specific purposes","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.Exe"", ""pwsh.dll"") CommandLine IN (""* -e *"", ""* -en *"", ""* -enc *"", ""* -enco*"") CommandLine IN (""* JAB*"", ""* SUVYI*"", ""* SQBFAFgA*"", ""* aWV4I*"", ""* IAB*"", ""* PAA*"", ""* aQBlAHgA*"") NOT (ParentImage IN (""*C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\*"", ""*\\gc_worker.exe*""))"
"Suspicious Obfuscated PowerShell Code","Florian Roth (Nextron Systems)","Detects suspicious UTF16 and base64 encoded and often obfuscated PowerShell code often used in command lines","attack.defense_evasion","process_creation","windows","Not classified","Review the context in which the suspicious PowerShell code was executed 
Check if the PowerShell code is part of a known administrative script or tool 
Analyze the behavior of the process executing the PowerShell code 
Verify the source and intent of the PowerShell code","Legitimate use of obfuscated PowerShell code for administrative tasks 
Encoded PowerShell code used by security tools or scripts 
Base64 encoded PowerShell code in legitimate applications 
Use of obfuscation techniques for benign purposes","CommandLine IN (""*IAAtAGIAeABvAHIAIAAwAHgA*"", ""*AALQBiAHgAbwByACAAMAB4A*"", ""*gAC0AYgB4AG8AcgAgADAAeA*"", ""*AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg*"", ""*AuAEkAbgB2AG8AawBlACgAKQAgAHwAI*"", ""*ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC*"", ""*AHsAMQB9AHsAMAB9ACIAIAAtAGYAI*"", ""*B7ADEAfQB7ADAAfQAiACAALQBmAC*"", ""*AewAxAH0AewAwAH0AIgAgAC0AZgAg*"", ""*AHsAMAB9AHsAMwB9ACIAIAAtAGYAI*"", ""*B7ADAAfQB7ADMAfQAiACAALQBmAC*"", ""*AewAwAH0AewAzAH0AIgAgAC0AZgAg*"", ""*AHsAMgB9AHsAMAB9ACIAIAAtAGYAI*"", ""*B7ADIAfQB7ADAAfQAiACAALQBmAC*"", ""*AewAyAH0AewAwAH0AIgAgAC0AZgAg*"", ""*AHsAMQB9AHsAMAB9ACcAIAAtAGYAI*"", ""*B7ADEAfQB7ADAAfQAnACAALQBmAC*"", ""*AewAxAH0AewAwAH0AJwAgAC0AZgAg*"", ""*AHsAMAB9AHsAMwB9ACcAIAAtAGYAI*"", ""*B7ADAAfQB7ADMAfQAnACAALQBmAC*"", ""*AewAwAH0AewAzAH0AJwAgAC0AZgAg*"", ""*AHsAMgB9AHsAMAB9ACcAIAAtAGYAI*"", ""*B7ADIAfQB7ADAAfQAnACAALQBmAC*"", ""*AewAyAH0AewAwAH0AJwAgAC0AZgAg*"")"
"PowerShell Base64 Encoded FromBase64String Cmdlet","Florian Roth (Nextron Systems)","Detects usage of a base64 encoded ""FromBase64String"" cmdlet in a process command line","attack.defense_evasion, attack.t1140, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the process command line arguments to understand the context of base64 encoding 
Check if the base64 encoded strings are related to known benign processes or applications 
Correlate with additional logs to determine the origin and purpose of the base64 encoding 
Investigate the parent process and any subsequent actions taken by the process for potential malicious behavior","Legitimate use of base64 encoding in benign scripts or applications 
Base64 encoding used for encoding non-malicious data 
Base64 encoding used for legitimate data transfer mechanisms","CommandLine=""*OjpGcm9tQmFzZTY0U3RyaW5n*"" OR CommandLine=""*o6RnJvbUJhc2U2NFN0cmluZ*"" OR CommandLine=""*6OkZyb21CYXNlNjRTdHJpbm*"" OR CommandLine IN (""*OgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcA*"", ""*oAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnA*"", ""*6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZw*"")"
"Malicious Base64 Encoded PowerShell Keywords in Command Lines","John Lambert (rule)","Detects base64 encoded strings used in hidden malicious PowerShell command lines","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line of the process to understand the context of the base64 encoded string 
Check if the base64 encoded string is part of a known legitimate script or application 
Analyze the behavior of the process to determine if it is malicious despite the base64 encoding 
Investigate the source of the process and any related network activity for signs of compromise","Legitimate use of base64 encoding in PowerShell scripts 
Administrative scripts using base64 encoding 
Development or testing scripts utilizing base64 encoding","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") CommandLine=""* hidden *"" CommandLine IN (""*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA*"", ""*aXRzYWRtaW4gL3RyYW5zZmVy*"", ""*IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA*"", ""*JpdHNhZG1pbiAvdHJhbnNmZX*"", ""*YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg*"", ""*Yml0c2FkbWluIC90cmFuc2Zlc*"", ""*AGMAaAB1AG4AawBfAHMAaQB6AGUA*"", ""*JABjAGgAdQBuAGsAXwBzAGkAegBlA*"", ""*JGNodW5rX3Npem*"", ""*QAYwBoAHUAbgBrAF8AcwBpAHoAZQ*"", ""*RjaHVua19zaXpl*"", ""*Y2h1bmtfc2l6Z*"", ""*AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A*"", ""*kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg*"", ""*lPLkNvbXByZXNzaW9u*"", ""*SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA*"", ""*SU8uQ29tcHJlc3Npb2*"", ""*Ty5Db21wcmVzc2lvb*"", ""*AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ*"", ""*kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA*"", ""*lPLk1lbW9yeVN0cmVhb*"", ""*SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A*"", ""*SU8uTWVtb3J5U3RyZWFt*"", ""*Ty5NZW1vcnlTdHJlYW*"", ""*4ARwBlAHQAQwBoAHUAbgBrA*"", ""*5HZXRDaHVua*"", ""*AEcAZQB0AEMAaAB1AG4Aaw*"", ""*LgBHAGUAdABDAGgAdQBuAGsA*"", ""*LkdldENodW5r*"", ""*R2V0Q2h1bm*"", ""*AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A*"", ""*QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA*"", ""*RIUkVBRF9JTkZPNj*"", ""*SFJFQURfSU5GTzY0*"", ""*VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA*"", ""*VEhSRUFEX0lORk82N*"", ""*AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA*"", ""*cmVhdGVSZW1vdGVUaHJlYW*"", ""*MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA*"", ""*NyZWF0ZVJlbW90ZVRocmVhZ*"", ""*Q3JlYXRlUmVtb3RlVGhyZWFk*"", ""*QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA*"", ""*0AZQBtAG0AbwB2AGUA*"", ""*1lbW1vdm*"", ""*AGUAbQBtAG8AdgBlA*"", ""*bQBlAG0AbQBvAHYAZQ*"", ""*bWVtbW92Z*"", ""*ZW1tb3Zl*"")"
"PowerShell Base64 Encoded IEX Cmdlet","Florian Roth (Nextron Systems)","Detects usage of a base64 encoded ""IEX"" cmdlet in a process command line","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line of the process to understand the context of the base64 encoded 'IEX' cmdlet 
Check if the base64 encoded string is part of a known and approved script or tool 
Analyze the parent-child process relationship to determine the origin and purpose of the encoded command 
Correlate with network logs to identify any corresponding network activity triggered by the encoded command","Legitimate use of base64 encoding in PowerShell scripts 
Use of 'IEX' cmdlet for benign purposes 
Encoded commands used by system administration tools 
Base64 encoded data transfer over the network","CommandLine=""*SUVYIChb*"" OR CommandLine=""*lFWCAoW*"" OR CommandLine=""*JRVggKF*"" OR CommandLine=""*aWV4IChb*"" OR CommandLine=""*lleCAoW*"" OR CommandLine=""*pZXggKF*"" OR CommandLine=""*aWV4IChOZX*"" OR CommandLine=""*lleCAoTmV3*"" OR CommandLine=""*pZXggKE5ld*"" OR CommandLine=""*SUVYIChOZX*"" OR CommandLine=""*lFWCAoTmV3*"" OR CommandLine=""*JRVggKE5ld*"" OR CommandLine=""*SUVYKF*"" OR CommandLine=""*lFWChb*"" OR CommandLine=""*JRVgoW*"" OR CommandLine=""*aWV4KF*"" OR CommandLine=""*lleChb*"" OR CommandLine=""*pZXgoW*"" OR CommandLine=""*aWV4KE5ld*"" OR CommandLine=""*lleChOZX*"" OR CommandLine=""*pZXgoTmV3*"" OR CommandLine=""*SUVYKE5ld*"" OR CommandLine=""*lFWChOZX*"" OR CommandLine=""*JRVgoTmV3*"" OR CommandLine=""*SUVYKCgn*"" OR CommandLine=""*lFWCgoJ*"" OR CommandLine=""*JRVgoKC*"" OR CommandLine=""*aWV4KCgn*"" OR CommandLine=""*lleCgoJ*"" OR CommandLine=""*pZXgoKC*"" OR CommandLine IN (""*SQBFAFgAIAAoAFsA*"", ""*kARQBYACAAKABbA*"", ""*JAEUAWAAgACgAWw*"", ""*aQBlAHgAIAAoAFsA*"", ""*kAZQB4ACAAKABbA*"", ""*pAGUAeAAgACgAWw*"", ""*aQBlAHgAIAAoAE4AZQB3A*"", ""*kAZQB4ACAAKABOAGUAdw*"", ""*pAGUAeAAgACgATgBlAHcA*"", ""*SQBFAFgAIAAoAE4AZQB3A*"", ""*kARQBYACAAKABOAGUAdw*"", ""*JAEUAWAAgACgATgBlAHcA*"")"
"PowerShell Base64 Encoded Invoke Keyword","pH-T (Nextron Systems), Harjot Singh, @cyb3rjy0t","Detects UTF-8 and UTF-16 Base64 encoded powershell 'Invoke-' calls","attack.execution, attack.t1059.001, attack.defense_evasion, attack.t1027","process_creation","windows","Not classified","Review the full command line arguments of the process to understand the context of the Base64 encoding 
Check if the encoded PowerShell command is part of a known whitelisted script or tool 
Correlate with network logs to determine if the encoded data is being sent externally 
Investigate the parent process and user context to identify any suspicious behavior","Legitimate use of Base64 encoding in PowerShell scripts 
Encoded commands used by security tools or scripts 
Base64 encoded data transfer over legitimate channels","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") CommandLine=""* -e*"" CommandLine IN (""*SQBuAHYAbwBrAGUALQ*"", ""*kAbgB2AG8AawBlAC0A*"", ""*JAG4AdgBvAGsAZQAtA*"", ""*SW52b2tlL*"", ""*ludm9rZS*"", ""*JbnZva2Ut*"")"
"Powershell Base64 Encoded MpPreference Cmdlet","Florian Roth (Nextron Systems)","Detects base64 encoded ""MpPreference"" PowerShell cmdlet code that tries to modifies or tamper with Windows Defender AV","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the full command line of the process to understand the context of the base64 encoded content 
Check if the base64 encoded content is part of a known and approved script or tool in your environment 
Investigate the process and its parent processes to determine the origin and intent of the base64 encoded MpPreference cmdlet 
Correlate with other security events or logs to identify any suspicious behavior or related activities","Legitimate scripts or tools that use base64 encoding for benign purposes 
Administrative scripts that legitimately interact with Windows Defender AV settings 
Scripts used by security tools or monitoring solutions that may trigger this detection 
Base64 encoded data that is not related to Windows Defender AV tampering","CommandLine=""*QWRkLU1wUHJlZmVyZW5jZS*"" OR CommandLine=""*FkZC1NcFByZWZlcmVuY2Ug*"" OR CommandLine=""*BZGQtTXBQcmVmZXJlbmNlI*"" OR CommandLine=""*U2V0LU1wUHJlZmVyZW5jZS*"" OR CommandLine=""*NldC1NcFByZWZlcmVuY2Ug*"" OR CommandLine=""*TZXQtTXBQcmVmZXJlbmNlI*"" OR CommandLine=""*YWRkLW1wcHJlZmVyZW5jZS*"" OR CommandLine=""*FkZC1tcHByZWZlcmVuY2Ug*"" OR CommandLine=""*hZGQtbXBwcmVmZXJlbmNlI*"" OR CommandLine=""*c2V0LW1wcHJlZmVyZW5jZS*"" OR CommandLine=""*NldC1tcHByZWZlcmVuY2Ug*"" OR CommandLine=""*zZXQtbXBwcmVmZXJlbmNlI*"" OR CommandLine IN (""*QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA*"", ""*EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA*"", ""*BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA*"", ""*UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA*"", ""*MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA*"", ""*TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA*"", ""*YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA*"", ""*EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA*"", ""*hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA*"", ""*cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA*"", ""*MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA*"", ""*zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA*"")"
"PowerShell Base64 Encoded Reflective Assembly Load","Christian Burkard (Nextron Systems), pH-T (Nextron Systems)","Detects base64 encoded .NET reflective loading of Assembly","attack.execution, attack.t1059.001, attack.defense_evasion, attack.t1027, attack.t1620","process_creation","windows","Not classified","Review the command line arguments to determine the context of the base64 encoded reflective assembly load 
Check for legitimate software or scripts known to use base64 encoding for reflective loading 
Correlate with additional logs or events to identify the source and intent of the reflective assembly load 
Investigate the process and parent-child relationships to understand the execution flow","Legitimate use of base64 encoding for benign purposes 
Updates or installations of software that involve reflective loading 
Scripts or tools that use base64 encoding for obfuscation 
Development or testing environments where reflective loading is common","CommandLine IN (""*WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA*"", ""*sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA*"", ""*bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA*"", ""*AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiAC*"", ""*BbAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgAp*"", ""*AWwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAK*"", ""*WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAKQ*"", ""*sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiACkA*"", ""*bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgApA*"", ""*WwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA*"", ""*sAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA*"", ""*bAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA*"")"
"Suspicious Encoded And Obfuscated Reflection Assembly Load Function Call","pH-T (Nextron Systems)","Detects suspicious base64 encoded and obfuscated ""LOAD"" keyword used in .NET ""reflection.assembly""","attack.execution, attack.defense_evasion, attack.t1059.001, attack.t1027","process_creation","windows","Not classified","Review the parent process and its behavior to determine if the suspicious command line is part of a known legitimate operation 
Check for any whitelisted applications or scripts that are known to use base64 encoding and obfuscation techniques 
Analyze the network traffic or file activity associated with the process to identify any malicious behavior 
Consult with the development or security team to understand if the observed behavior is expected in the environment","Legitimate use of base64 encoding and obfuscation in benign scripts or applications 
Development or testing environments where such techniques are commonly used 
Tools or scripts that utilize similar encoding for legitimate purposes","CommandLine IN (""*OgA6ACgAIgBMACIAKwAiAG8AYQBkACIAKQ*"", ""*oAOgAoACIATAAiACsAIgBvAGEAZAAiACkA*"", ""*6ADoAKAAiAEwAIgArACIAbwBhAGQAIgApA*"", ""*OgA6ACgAIgBMAG8AIgArACIAYQBkACIAKQ*"", ""*oAOgAoACIATABvACIAKwAiAGEAZAAiACkA*"", ""*6ADoAKAAiAEwAbwAiACsAIgBhAGQAIgApA*"", ""*OgA6ACgAIgBMAG8AYQAiACsAIgBkACIAKQ*"", ""*oAOgAoACIATABvAGEAIgArACIAZAAiACkA*"", ""*6ADoAKAAiAEwAbwBhACIAKwAiAGQAIgApA*"", ""*OgA6ACgAJwBMACcAKwAnAG8AYQBkACcAKQ*"", ""*oAOgAoACcATAAnACsAJwBvAGEAZAAnACkA*"", ""*6ADoAKAAnAEwAJwArACcAbwBhAGQAJwApA*"", ""*OgA6ACgAJwBMAG8AJwArACcAYQBkACcAKQ*"", ""*oAOgAoACcATABvACcAKwAnAGEAZAAnACkA*"", ""*6ADoAKAAnAEwAbwAnACsAJwBhAGQAJwApA*"", ""*OgA6ACgAJwBMAG8AYQAnACsAJwBkACcAKQ*"", ""*oAOgAoACcATABvAGEAJwArACcAZAAnACkA*"", ""*6ADoAKAAnAEwAbwBhACcAKwAnAGQAJwApA*"")"
"PowerShell Base64 Encoded WMI Classes","Christian Burkard (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects calls to base64 encoded WMI class such as ""Win32_Shadowcopy"", ""Win32_ScheduledJob"", etc.","attack.execution, attack.t1059.001, attack.defense_evasion, attack.t1027","process_creation","windows","Not classified","Review the command line arguments of the process creation event to identify the base64 encoded WMI class being called 
Check if the base64 encoded WMI class call is part of a legitimate administrative task or script 
Correlate the process creation event with other security events to determine the context of the base64 encoded WMI class usage 
Investigate the parent-child process relationship to understand the full execution chain involving the base64 encoded WMI class","Legitimate use of base64 encoded WMI classes by system administrators 
Base64 encoded commands used by security tools or scripts 
Base64 encoded WMI class calls in known benign scripts","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") CommandLine IN (""*VwBpAG4AMwAyAF8AUwBoAGEAZABvAHcAYwBvAHAAeQ*"", ""*cAaQBuADMAMgBfAFMAaABhAGQAbwB3AGMAbwBwAHkA*"", ""*XAGkAbgAzADIAXwBTAGgAYQBkAG8AdwBjAG8AcAB5A*"", ""*V2luMzJfU2hhZG93Y29we*"", ""*dpbjMyX1NoYWRvd2NvcH*"", ""*XaW4zMl9TaGFkb3djb3B5*"") OR CommandLine IN (""*VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQASgBvAGIA*"", ""*cAaQBuADMAMgBfAFMAYwBoAGUAZAB1AGwAZQBkAEoAbwBiA*"", ""*XAGkAbgAzADIAXwBTAGMAaABlAGQAdQBsAGUAZABKAG8AYg*"", ""*V2luMzJfU2NoZWR1bGVkSm9i*"", ""*dpbjMyX1NjaGVkdWxlZEpvY*"", ""*XaW4zMl9TY2hlZHVsZWRKb2*"") OR CommandLine IN (""*VwBpAG4AMwAyAF8AUAByAG8AYwBlAHMAcw*"", ""*cAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMA*"", ""*XAGkAbgAzADIAXwBQAHIAbwBjAGUAcwBzA*"", ""*V2luMzJfUHJvY2Vzc*"", ""*dpbjMyX1Byb2Nlc3*"", ""*XaW4zMl9Qcm9jZXNz*"") OR CommandLine IN (""*VwBpAG4AMwAyAF8AVQBzAGUAcgBBAGMAYwBvAHUAbgB0A*"", ""*cAaQBuADMAMgBfAFUAcwBlAHIAQQBjAGMAbwB1AG4AdA*"", ""*XAGkAbgAzADIAXwBVAHMAZQByAEEAYwBjAG8AdQBuAHQA*"", ""*V2luMzJfVXNlckFjY291bn*"", ""*dpbjMyX1VzZXJBY2NvdW50*"", ""*XaW4zMl9Vc2VyQWNjb3Vud*"") OR CommandLine IN (""*VwBpAG4AMwAyAF8ATABvAGcAZwBlAGQATwBuAFUAcwBlAHIA*"", ""*cAaQBuADMAMgBfAEwAbwBnAGcAZQBkAE8AbgBVAHMAZQByA*"", ""*XAGkAbgAzADIAXwBMAG8AZwBnAGUAZABPAG4AVQBzAGUAcg*"", ""*V2luMzJfTG9nZ2VkT25Vc2Vy*"", ""*dpbjMyX0xvZ2dlZE9uVXNlc*"", ""*XaW4zMl9Mb2dnZWRPblVzZX*"")"
"Potential PowerShell Obfuscation Via Reversed Commands","Teymur Kheirkhabarov (idea), Vasiliy Burov (rule), oscd.community, Tim Shelton","Detects the presence of reversed PowerShell commands in the CommandLine. This is often used as a method of obfuscation by attackers","attack.defense_evasion, attack.t1027, attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the command line arguments to understand the context of the PowerShell execution 
Check if the PowerShell commands are part of a known security tool or legitimate administrative activity 
Analyze the behavior of the process to determine if it aligns with typical malicious activities 
Inspect the parent-child process relationship to identify the origin of the PowerShell execution","Legitimate use of obfuscated PowerShell commands for security testing tools 
Administrators using obfuscation techniques for legitimate purposes 
Script obfuscation tools that may trigger the rule 
Custom scripts or applications that obfuscate commands for non-malicious reasons","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") CommandLine IN (""*hctac*"", ""*kaerb*"", ""*dnammoc*"", ""*ekovn*"", ""*eliFd*"", ""*rahc*"", ""*etirw*"", ""*golon*"", ""*tninon*"", ""*eddih*"", ""*tpircS*"", ""*ssecorp*"", ""*llehsrewop*"", ""*esnopser*"", ""*daolnwod*"", ""*tneilCbeW*"", ""*tneilc*"", ""*ptth*"", ""*elifotevas*"", ""*46esab*"", ""*htaPpmeTteG*"", ""*tcejbO*"", ""*maerts*"", ""*hcaerof*"", ""*retupmoc*"") NOT (CommandLine IN (""* -EncodedCommand *"", ""* -enc *""))"
"Potential PowerShell Command Line Obfuscation","Teymur Kheirkhabarov (idea), Vasiliy Burov (rule), oscd.community, Tim Shelton (fp)","Detects the PowerShell command lines with special characters","attack.execution, attack.defense_evasion, attack.t1027, attack.t1059.001","process_creation","windows","Not classified","Review the full command line arguments of the PowerShell process to understand the context and intent 
Check if the PowerShell command line is part of a known whitelisted script or application 
Investigate the parent process and the user context to determine if the PowerShell activity is expected 
Correlate with network or file activity to see if the PowerShell command is performing malicious actions","Legitimate PowerShell scripts that use special characters for valid purposes 
PowerShell scripts used by security tools or monitoring solutions 
PowerShell scripts obfuscated for legitimate security testing purposes"
"Powershell Defender Disable Scan Feature","Florian Roth (Nextron Systems)","Detects requests to disable Microsoft Defender features using PowerShell commands","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the context of the PowerShell command execution to determine if it aligns with legitimate administrative tasks 
Check for any scheduled tasks or scripts that may be responsible for modifying Defender settings 
Investigate if any security tools or scripts are configured to interact with Defender and could trigger this detection 
Correlate the event with any recent changes or configurations made to the system to understand the root cause","Legitimate administrative actions to configure Defender settings 
Security tools or scripts that modify Defender configurations 
Scheduled tasks or automation that interact with Defender features 
Third-party applications that integrate with Defender and make changes","(CommandLine IN (""*Add-MpPreference *"", ""*Set-MpPreference *"") CommandLine IN (""*DisableArchiveScanning *"", ""*DisableRealtimeMonitoring *"", ""*DisableIOAVProtection *"", ""*DisableBehaviorMonitoring *"", ""*DisableBlockAtFirstSeen *"", ""*DisableCatchupFullScan *"", ""*DisableCatchupQuickScan *"") CommandLine IN (""*$true*"", ""* 1 *"")) OR CommandLine=""*ZGlzYWJsZWFyY2hpdmVzY2FubmluZy*"" OR CommandLine=""*Rpc2FibGVhcmNoaXZlc2Nhbm5pbmcg*"" OR CommandLine=""*kaXNhYmxlYXJjaGl2ZXNjYW5uaW5nI*"" OR CommandLine=""*RGlzYWJsZUFyY2hpdmVTY2FubmluZy*"" OR CommandLine=""*Rpc2FibGVBcmNoaXZlU2Nhbm5pbmcg*"" OR CommandLine=""*EaXNhYmxlQXJjaGl2ZVNjYW5uaW5nI*"" OR CommandLine=""*ZGlzYWJsZWJlaGF2aW9ybW9uaXRvcmluZy*"" OR CommandLine=""*Rpc2FibGViZWhhdmlvcm1vbml0b3Jpbmcg*"" OR CommandLine=""*kaXNhYmxlYmVoYXZpb3Jtb25pdG9yaW5nI*"" OR CommandLine=""*RGlzYWJsZUJlaGF2aW9yTW9uaXRvcmluZy*"" OR CommandLine=""*Rpc2FibGVCZWhhdmlvck1vbml0b3Jpbmcg*"" OR CommandLine=""*EaXNhYmxlQmVoYXZpb3JNb25pdG9yaW5nI*"" OR CommandLine=""*ZGlzYWJsZWJsb2NrYXRmaXJzdHNlZW4g*"" OR CommandLine=""*Rpc2FibGVibG9ja2F0Zmlyc3RzZWVuI*"" OR CommandLine=""*kaXNhYmxlYmxvY2thdGZpcnN0c2Vlbi*"" OR CommandLine=""*RGlzYWJsZUJsb2NrQXRGaXJzdFNlZW4g*"" OR CommandLine=""*Rpc2FibGVCbG9ja0F0Rmlyc3RTZWVuI*"" OR CommandLine=""*EaXNhYmxlQmxvY2tBdEZpcnN0U2Vlbi*"" OR CommandLine=""*ZGlzYWJsZWNhdGNodXBmdWxsc2Nhbi*"" OR CommandLine=""*Rpc2FibGVjYXRjaHVwZnVsbHNjYW4g*"" OR CommandLine=""*kaXNhYmxlY2F0Y2h1cGZ1bGxzY2FuI*"" OR CommandLine=""*RGlzYWJsZUNhdGNodXBGdWxsU2Nhbi*"" OR CommandLine=""*Rpc2FibGVDYXRjaHVwRnVsbFNjYW4g*"" OR CommandLine=""*EaXNhYmxlQ2F0Y2h1cEZ1bGxTY2FuI*"" OR CommandLine=""*ZGlzYWJsZWNhdGNodXBxdWlja3NjYW4g*"" OR CommandLine=""*Rpc2FibGVjYXRjaHVwcXVpY2tzY2FuI*"" OR CommandLine=""*kaXNhYmxlY2F0Y2h1cHF1aWNrc2Nhbi*"" OR CommandLine=""*RGlzYWJsZUNhdGNodXBRdWlja1NjYW4g*"" OR CommandLine=""*Rpc2FibGVDYXRjaHVwUXVpY2tTY2FuI*"" OR CommandLine=""*EaXNhYmxlQ2F0Y2h1cFF1aWNrU2Nhbi*"" OR CommandLine=""*ZGlzYWJsZWlvYXZwcm90ZWN0aW9uI*"" OR CommandLine=""*Rpc2FibGVpb2F2cHJvdGVjdGlvbi*"" OR CommandLine=""*kaXNhYmxlaW9hdnByb3RlY3Rpb24g*"" OR CommandLine=""*RGlzYWJsZUlPQVZQcm90ZWN0aW9uI*"" OR CommandLine=""*Rpc2FibGVJT0FWUHJvdGVjdGlvbi*"" OR CommandLine=""*EaXNhYmxlSU9BVlByb3RlY3Rpb24g*"" OR CommandLine=""*ZGlzYWJsZXJlYWx0aW1lbW9uaXRvcmluZy*"" OR CommandLine=""*Rpc2FibGVyZWFsdGltZW1vbml0b3Jpbmcg*"" OR CommandLine=""*kaXNhYmxlcmVhbHRpbWVtb25pdG9yaW5nI*"" OR CommandLine=""*RGlzYWJsZVJlYWx0aW1lTW9uaXRvcmluZy*"" OR CommandLine=""*Rpc2FibGVSZWFsdGltZU1vbml0b3Jpbmcg*"" OR CommandLine=""*EaXNhYmxlUmVhbHRpbWVNb25pdG9yaW5nI*"" OR CommandLine IN (""*RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA*"", ""*QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA*"", ""*EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA*"", ""*RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA*"", ""*QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA*"", ""*EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA*"", ""*RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA*"", ""*QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA*"", ""*EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA*"", ""*RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA*"", ""*QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA*"", ""*EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA*"", ""*ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA*"", ""*QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA*"", ""*kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA*"", ""*ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA*"", ""*QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA*"", ""*kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA*"", ""*ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA*"", ""*QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA*"", ""*kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA*"", ""*ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA*"", ""*QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA*"", ""*kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA*"", ""*RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAEYAdQBsAGwAUwBjAGEAbgA*"", ""*RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAFEAdQBpAGMAawBTAGMAYQBuAA*"", ""*RABpAHMAYQBiAGwAZQBBAHIAYwBoAGkAdgBlAFMAYwBhAG4AbgBpAG4AZwA*"")"
"Disable Windows Defender AV Security Monitoring","ok @securonix invrep-de, oscd.community, frack113","Detects attackers attempting to disable Windows Defender using Powershell","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Check the context of the event to determine if the action was performed by a legitimate user or system process 
Review any documentation or change management records related to the event to verify if it was an authorized action 
Correlate the event with other security events or logs to identify any suspicious patterns or additional malicious activities 
Conduct interviews with relevant personnel to understand the reasons behind the action and validate its legitimacy","Developers disabling Windows Defender for performance reasons using tools like pycharm 
Legitimate system administrators temporarily disabling Windows Defender for troubleshooting purposes 
Security software installations that require temporary disabling of Windows Defender for compatibility reasons 
Scheduled maintenance tasks or scripts that involve stopping Windows Defender services","(Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") CommandLine IN (""*-DisableBehaviorMonitoring $true*"", ""*-DisableRuntimeMonitoring $true*"")) OR (Image=""*\\sc.exe"" OR OriginalFileName=""sc.exe"" (CommandLine=""*stop*"" CommandLine=""*WinDefend*"") OR (CommandLine=""*delete*"" CommandLine=""*WinDefend*"") OR (CommandLine=""*config*"" CommandLine=""*WinDefend*"" CommandLine=""*start=disabled*""))"
"Disabled IE Security Features","Florian Roth (Nextron Systems)","Detects command lines that indicate unwanted modifications to registry keys that disable important Internet Explorer security features","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the command line arguments and the process context to determine if the modification was unauthorized 
Check for any legitimate reasons or known activities that could have triggered the detection 
Correlate with other security events or logs to identify any suspicious patterns or behaviors 
Verify the source and integrity of the process making the registry modifications","Legitimate system administrators making authorized changes to Internet Explorer security settings 
Security tools or scripts that modify these registry keys for legitimate purposes 
Updates or installations of software that temporarily disable these features","(CommandLine=""* -name IEHarden *"" CommandLine=""* -value 0 *"") OR (CommandLine=""* -name DEPOff *"" CommandLine=""* -value 1 *"") OR (CommandLine=""* -name DisableFirstRunCustomize *"" CommandLine=""* -value 2 *"")"
"PowerShell Download and Execution Cradles","Florian Roth (Nextron Systems)","Detects PowerShell download and execution cradles.","attack.execution, attack.t1059","process_creation","windows","Not classified","Review the full command line of the PowerShell process to understand the context of the download and execution 
Check if the script is part of a known whitelisted application or process 
Analyze the reputation of the URLs or domains being accessed for downloads 
Correlate with other security events to determine if the behavior is part of a larger attack pattern","Legitimate PowerShell scripts that use similar download and execution methods 
Scheduled tasks or scripts that are part of normal system operations 
Scripts used by system administrators for legitimate purposes","CommandLine IN (""*.DownloadString(*"", ""*.DownloadFile(*"", ""*Invoke-WebRequest *"", ""*iwr *"") CommandLine IN (""*;iex $*"", ""*| IEX*"", ""*|IEX *"", ""*I`E`X*"", ""*I`EX*"", ""*IE`X*"", ""*iex *"", ""*IEX (*"", ""*IEX(*"", ""*Invoke-Expression*"")"
"Email Exifiltration Via Powershell","Nasreddine Bencherchali (Nextron Systems),  Azure-Sentinel (idea)","Detects email exfiltration via powershell cmdlets","attack.exfiltration","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of PowerShell execution 
Check if the PowerShell commands are part of a known and approved script or tool 
Correlate with other security events to determine if the email exfiltration behavior is part of a larger attack campaign 
Verify the destination of the email addresses or SMTP addresses to confirm if exfiltration is occurring","Legitimate use of PowerShell for email-related tasks 
Scheduled scripts or automation that involve similar commands 
Administrative scripts or tools that interact with email systems","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") CommandLine=""*Add-PSSnapin*"" CommandLine=""*Get-Recipient*"" CommandLine=""*-ExpandProperty*"" CommandLine=""*EmailAddresses*"" CommandLine=""*SmtpAddress*"" CommandLine=""*-hidetableheaders*"""
"Base64 Encoded PowerShell Command Detected","Florian Roth (Nextron Systems)","Detects usage of the ""FromBase64String"" function in the commandline which is used to decode a base64 encoded string","attack.t1027, attack.defense_evasion, attack.t1140, attack.t1059.001","process_creation","windows","Not classified","Review the commandline arguments for the process that triggered the detection 
Check if the base64 encoded string is part of a known administrative or legitimate script 
Investigate the parent-child process relationship to understand the context of the base64 decoding activity 
Look for any additional suspicious activities or commands executed before or after the base64 decoding","Legitimate scripts or tools that use base64 encoding/decoding 
Development or testing environments where base64 encoding/decoding is common 
Encoded commands used by security tools or monitoring scripts","CommandLine=""*::FromBase64String(*"""
"PowerShell Get-Process LSASS","Florian Roth (Nextron Systems)","Detects a ""Get-Process"" cmdlet and it's aliases on lsass process, which is in almost all cases a sign of malicious activity","attack.credential_access, attack.t1552.004","process_creation","windows","Not classified","Check if the process execution is part of a known and approved script or tool on the system 
Review the user context under which the process was executed for any anomalies 
Correlate the process execution with other security events to determine if it is part of a larger attack chain 
Investigate the parent process and network connections associated with the suspicious process execution","Legitimate system administration tasks may involve querying lsass process for troubleshooting purposes 
Security tools or scripts may also use Get-Process on lsass for monitoring purposes 
Scheduled tasks or scripts may trigger this behavior as part of normal operations","CommandLine IN (""*Get-Process lsas*"", ""*ps lsas*"", ""*gps lsas*"")"
"Abuse of Service Permissions to Hide Services Via Set-Service","Nasreddine Bencherchali (Nextron Systems)","Detects usage of the ""Set-Service"" powershell cmdlet to configure a new SecurityDescriptor that allows a service to be hidden from other utilities such as ""sc.exe"", ""Get-Service""...etc. (Works only in powershell 7)","attack.persistence, attack.defense_evasion, attack.privilege_escalation, attack.t1574.011","process_creation","windows","Not classified","Review PowerShell logs for Set-Service cmdlet executions 
Check for any abnormal changes in service configurations 
Correlate with network or endpoint logs for any suspicious activities related to hidden services 
Investigate the user context and permissions of the process executing Set-Service","Legitimate use of Set-Service for authorized service configurations 
Scheduled tasks or scripts that involve service management 
Installation or updates of software that modify service permissions","Image=""*\\pwsh.exe"" OR OriginalFileName=""pwsh.dll"" CommandLine=""*Set-Service *"" CommandLine=""*DCLCWPDTSD*"" CommandLine IN (""*-SecurityDescriptorSddl *"", ""*-sd *"")"
"Suspicious PowerShell IEX Execution Patterns","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects suspicious ways to run Invoke-Execution using IEX alias","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the command line arguments of the process to determine the context of IEX usage 
Check for whitelisted scripts or scheduled tasks that may be using IEX 
Correlate with system and network logs to identify any additional suspicious activities 
Investigate the parent process and user context to understand the origin of the PowerShell execution","Scheduled tasks or scripts legitimately using IEX 
Administrative scripts leveraging IEX for automation 
Development environments where IEX is used for testing 
Third-party tools or applications that utilize IEX","(Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") CommandLine IN (""* | iex;*"", ""* | iex *"", ""* | iex}*"", ""* | IEX ;*"", ""* | IEX -Error*"", ""* | IEX (new*"", ""*);IEX *"") CommandLine IN (""*::FromBase64String*"", ""*.GetString([System.Convert]::*"")) OR CommandLine IN (""*)|iex;$*"", ""*);iex($*"", ""*);iex $*"", ""* | IEX | *"", ""* | iex\\\""*"")"
"Root Certificate Installed From Susp Locations","Nasreddine Bencherchali (Nextron Systems)","Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.","attack.defense_evasion, attack.t1553.004","process_creation","windows","Not classified","Check if the root certificate installation was part of a known and approved process 
Review the system's certificate store for any other suspicious certificates 
Analyze the parent-child process relationship to understand the context of the certificate installation 
Verify if the certificate installation is related to a security tool or software deployment","Legitimate installation of root certificates by system administrators or security tools 
Certificate management tools performing legitimate operations 
Legitimate software installations that involve adding root certificates","CommandLine=""*Import-Certificate*"" CommandLine=""* -FilePath *"" CommandLine=""*Cert:\\LocalMachine\\Root*"" CommandLine IN (""*\\AppData\\Local\\Temp\\*"", ""*:\\Windows\\TEMP\\*"", ""*\\Desktop\\*"", ""*\\Downloads\\*"", ""*\\Perflogs\\*"", ""*:\\Users\\Public\\*"")"
"Suspicious PowerShell Mailbox Export to Share","Florian Roth (Nextron Systems)","Detects usage of the powerShell New-MailboxExportRequest Cmdlet to exports a mailbox to a remote or local share, as used in ProxyShell exploitations","attack.exfiltration","process_creation","windows","Not classified","Review the command line arguments of the process to identify the source and destination of the mailbox export 
Check for any scheduled tasks or scripts that may be responsible for the activity 
Correlate the event with other security logs to determine if the action is part of a larger attack campaign 
Verify the legitimacy of the operation with the mailbox owner or relevant IT personnel","Legitimate mailbox export operations to shares 
Scheduled tasks or scripts performing similar actions 
Administrative tools or scripts that involve exporting mailboxes","CommandLine=""*New-MailboxExportRequest*"" CommandLine=""* -Mailbox *"" CommandLine=""* -FilePath \\\\*"""
"Potential PowerShell Obfuscation Via WCHAR","Florian Roth (Nextron Systems)","Detects suspicious encoded character syntax often used for defense evasion","attack.execution, attack.t1059.001, attack.defense_evasion, attack.t1027","process_creation","windows","Not classified","Review the full command line context to determine the purpose of the WCHAR encoding 
Check if the command is executed by a whitelisted or trusted process 
Analyze the parent-child process relationship to understand the execution flow 
Compare the observed WCHAR encoding with known benign use cases","Legitimate use of WCHAR encoding in benign scripts or applications 
Use of WCHAR encoding by security tools or monitoring scripts 
Use of WCHAR encoding in known administrative tasks","CommandLine=""*(WCHAR)0x*"""
"Execution of Powershell Script in Public Folder","Max Altgelt (Nextron Systems)","This rule detects execution of PowerShell scripts located in the ""C:\Users\Public"" folder","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the command line arguments of the process to determine the nature of the PowerShell script being executed 
Check the user context under which the PowerShell script is running to verify if it is an authorized user or system process 
Correlate the process execution with other security events to identify any suspicious behavior or indicators of compromise 
Investigate the origin of the PowerShell script in the Public folder to understand its purpose and legitimacy","Legitimate use of PowerShell scripts in the Public folder by authorized users 
Automated scripts or tools that are designed to run from the Public folder 
Scripts executed as part of legitimate software installations 
Scheduled tasks or system processes that run PowerShell scripts from the Public folder","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") CommandLine IN (""*-f C:\\Users\\Public*"", ""*-f \""C:\\Users\\Public*"", ""*-f %Public%*"", ""*-fi C:\\Users\\Public*"", ""*-fi \""C:\\Users\\Public*"", ""*-fi %Public%*"", ""*-fil C:\\Users\\Public*"", ""*-fil \""C:\\Users\\Public*"", ""*-fil %Public%*"", ""*-file C:\\Users\\Public*"", ""*-file \""C:\\Users\\Public*"", ""*-file %Public%*"")"
"RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses","frack113","Detects calls to the AtomicTestHarnesses ""Invoke-ATHRemoteFXvGPUDisablementCommand"" which is designed to abuse the ""RemoteFXvGPUDisablement.exe"" binary to run custom PowerShell code via module load-order hijacking.","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to understand the context of the execution 
Check if the execution of AtomicTestHarnesses or RemoteFXvGPUDisablement.exe is part of a scheduled or authorized activity 
Correlate with other security events to determine if there are indicators of compromise or malicious behavior","Legitimate use of AtomicTestHarnesses for authorized testing purposes 
Legitimate use of RemoteFXvGPUDisablement.exe for valid system administration tasks 
Use of similar command-line arguments in non-malicious scripts or tools","CommandLine IN (""*Invoke-ATHRemoteFXvGPUDisablementCommand*"", ""*Invoke-ATHRemoteFXvGPUDisableme*"")"
"Tamper Windows Defender Remove-MpPreference","Nasreddine Bencherchali (Nextron Systems)","Detects attempts to remove Windows Defender configurations using the 'MpPreference' cmdlet","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the command line arguments of the process creation event to determine the intent behind the 'Remove-MpPreference' cmdlet 
Check if the tampering with Windows Defender configurations was authorized or part of a legitimate operation 
Correlate the event with other security logs to identify any suspicious activities or patterns 
Verify the reputation and source of the PowerShell script or tool that triggered the rule","Legitimate PowerShell scripts may trigger this rule 
Administrative changes to Windows Defender configurations 
Security tools or scripts that interact with Windows Defender settings","CommandLine=""*Remove-MpPreference*"" CommandLine IN (""*-ControlledFolderAccessProtectedFolders *"", ""*-AttackSurfaceReductionRules_Ids *"", ""*-AttackSurfaceReductionRules_Actions *"", ""*-CheckForSignaturesBeforeRunningScan *"")"
"Potential Powershell ReverseShell Connection","FPT.EagleEye, wagga, Nasreddine Bencherchali (Nextron Systems)","Detects usage of the ""TcpClient"" class. Which can be abused to establish remote connections and reverse-shells. As seen used by the Nishang ""Invoke-PowerShellTcpOneLine"" reverse shell and other.","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of TcpClient usage 
Check for any associated network connections or traffic to determine if a reverse shell connection was established 
Correlate with other security events or logs to identify any malicious behavior or indicators of compromise 
Consult with system administrators or developers to confirm the purpose of TcpClient usage","Legitimate administrative or troubleshooting activities involving TcpClient class 
Usage in authorized penetration testing or red teaming exercises 
Third-party applications or scripts that utilize TcpClient for legitimate purposes","OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") OR Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") CommandLine=""* Net.Sockets.TCPClient*"" CommandLine=""*.GetStream(*"" CommandLine=""*.Write(*"""
"Run PowerShell Script from ADS","Sergey Soldatov, Kaspersky Lab, oscd.community","Detects PowerShell script execution from Alternate Data Stream (ADS)","attack.defense_evasion, attack.t1564.004","process_creation","windows","Not classified","Review the ParentImage field to determine if the PowerShell execution is part of a known legitimate process or tool 
Check if the PowerShell script being executed from ADS is related to a scheduled task or a known administrative activity 
Investigate if any security tools or scripts running on the system are using ADS for authorized operations 
Analyze the content of the PowerShell script to determine its purpose and legitimacy","Legitimate use of PowerShell scripts from Alternate Data Streams by system administrators for specific purposes 
Scheduled tasks or scripts that use ADS for benign reasons 
Security tools or scripts that utilize ADS for legitimate operations","ParentImage IN (""*\\powershell.exe"", ""*\\pwsh.exe"") Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") CommandLine=""*Get-Content*"" CommandLine=""*-Stream*"""
"Run PowerShell Script from Redirected Input Stream","Moriarty Meng (idea), Anton Kutepov (rule), oscd.community","Detects PowerShell script execution via input stream redirect","attack.defense_evasion, attack.execution, attack.t1059","process_creation","windows","Not classified","Review the command-line arguments and the parent process of the PowerShell execution to determine if it is part of a legitimate operation 
Check for any scheduled tasks or scripts that may be triggering the PowerShell execution 
Investigate the network traffic and communication patterns associated with the system to identify any suspicious activities 
Analyze the PowerShell script content to understand its purpose and potential impact","Legitimate administrative or scripting activity involving PowerShell 
Use of PowerShell remoting or scheduled tasks 
Third-party applications that interact with PowerShell 
Scripting frameworks or automation tools that use PowerShell","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"")\"
"PowerShell SAM Copy","Florian Roth (Nextron Systems)","Detects suspicious PowerShell scripts accessing SAM hives","attack.credential_access, attack.t1003.002","process_creation","windows","Not classified","Check the parent process of the PowerShell script to determine if it is a scheduled task or a legitimate administrative action 
Review the script content to identify if it is related to fixing HiveNightmare / SeriousSAM ACLs 
Verify if the script execution is part of a known software installation or update process","Scheduled tasks or scripts that legitimately access SAM hives 
Administrative scripts that copy SAM hives for backup purposes 
Legitimate software that interacts with SAM hives","CommandLine=""*\\HarddiskVolumeShadowCopy*"" CommandLine=""*System32\\config\\sam*"" CommandLine IN (""*Copy-Item*"", ""*cp $_.*"", ""*cpi $_.*"", ""*copy $_.*"", ""*.File]::Copy(*"")"
"Suspicious Service DACL Modification Via Set-Service Cmdlet","Nasreddine Bencherchali (Nextron Systems)","Detects suspicious DACL modifications via the ""Set-Service"" cmdlet using the ""SecurityDescriptorSddl"" flag (Only available with PowerShell 7) that can be used to hide services or make them unstopable","attack.persistence, attack.t1543.003","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the Set-Service cmdlet with specific flags related to DACL modifications 
Check for any legitimate reasons for service DACL modifications, such as software installations or updates 
Correlate the suspicious activity with other security events to determine the impact and scope of the potential threat 
Investigate the service in question to understand its normal behavior and permissions","Legitimate changes to service DACLs by system administrators 
Updates or installations of legitimate software that modify service permissions 
Scheduled tasks or scripts that involve service configuration changes","Image=""*\\pwsh.exe"" OR OriginalFileName=""pwsh.dll"" CommandLine IN (""*-SecurityDescriptorSddl *"", ""*-sd *"") CommandLine=""*Set-Service *"" CommandLine=""*D;;*"" CommandLine IN (""*;;;IU*"", ""*;;;SU*"", ""*;;;BA*"", ""*;;;SY*"", ""*;;;WD*"")"
"PowerShell Script Change Permission Via Set-Acl","Nasreddine Bencherchali (Nextron Systems)","Detects PowerShell execution to set the ACL of a file or a folder","attack.defense_evasion","process_creation","windows","Not classified","Review the command-line arguments of the PowerShell process to understand the context of the Set-Acl command 
Check if the file or folder being modified is part of a known administrative task or legitimate operation 
Correlate the event with other security logs to determine if the action is part of a larger attack pattern 
Investigate the user context and permissions of the process to determine if it aligns with expected behavior","Legitimate administrative tasks involving changing file or folder permissions 
Scheduled scripts or automation that involve setting ACLs 
Installation or update processes that require modifying permissions 
Security tools or scripts that manage access control lists","OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") OR Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") CommandLine=""*Set-Acl *"" CommandLine=""*-AclObject *"" CommandLine=""*-Path *"""
"PowerShell Set-Acl On Windows Folder","Nasreddine Bencherchali (Nextron Systems)","Detects PowerShell scripts to set the ACL to a file in the Windows folder","attack.defense_evasion","process_creation","windows","Not classified","Review the context of the PowerShell script execution to determine if it aligns with legitimate administrative tasks 
Check if the script is part of a documented change management process 
Verify if the script is triggered by a known third-party software or scheduled task 
Investigate the user context and permissions of the process executing the PowerShell script","Legitimate administrative actions to set ACL on Windows system files 
Script used for authorized system configuration changes 
Third-party software that manages file permissions may trigger this rule 
Scheduled tasks or scripts that involve setting ACLs","OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") OR Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") CommandLine=""*Set-Acl *"" CommandLine=""*-AclObject *"" CommandLine IN (""*-Path \""C:\\Windows*"", ""*-Path 'C:\\Windows*"", ""*-Path %windir%*"", ""*-Path $env:windir*"") CommandLine IN (""*FullControl*"", ""*Allow*"")"
"Deletion of Volume Shadow Copies via WMI with PowerShell","Tim Rauch, Elastic (idea)","Detects deletion of Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil","attack.impact, attack.t1490","process_creation","windows","Not classified","Review the context of the process execution to determine if it aligns with legitimate administrative activities. 
Check if the process execution is part of a scheduled backup job or system maintenance task. 
Investigate the user context and permissions of the process to understand if it's a routine operation. 
Correlate the event with other security events to identify any malicious behavior beyond just the deletion of Volume Shadow Copies.","Legitimate administrative tasks may involve deleting Volume Shadow Copies using PowerShell. 
Backup software or system maintenance tools may also trigger similar commands. 
Scripting or automation tasks that involve WMI operations could lead to false positives.","CommandLine IN (""*Get-WmiObject*"", ""*gwmi*"", ""*Get-CimInstance*"", ""*gcim*"") CommandLine=""*Win32_Shadowcopy*"" CommandLine IN (""*.Delete()*"", ""*Remove-WmiObject*"", ""*rwmi*"", ""*Remove-CimInstance*"", ""*rcim*"")"
"Exchange PowerShell Snap-Ins Usage","FPT.EagleEye, Nasreddine Bencherchali (Nextron Systems)","Detects adding and using Exchange PowerShell snap-ins to export mailbox data. As seen used by HAFNIUM and APT27","attack.execution, attack.t1059.001, attack.collection, attack.t1114","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the specific cmdlets or snap-ins being used 
Check for any legitimate administrative activities or scripts that may trigger the detection 
Correlate the process creation event with other security events to determine the context of the PowerShell snap-in usage 
Investigate the source of the process creation to determine if it aligns with expected behavior or if it is anomalous","Legitimate administrative actions involving Exchange PowerShell snap-ins 
Scheduled tasks or scripts that use Exchange PowerShell snap-ins 
Third-party applications that interact with Exchange using PowerShell snap-ins","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") CommandLine=""*Add-PSSnapin*"" CommandLine IN (""*Microsoft.Exchange.Powershell.Snapin*"", ""*Microsoft.Exchange.Management.PowerShell.SnapIn*"") NOT (ParentImage=""C:\\Windows\\System32\\msiexec.exe"" CommandLine=""*$exserver=Get-ExchangeServer ([Environment]::MachineName) -ErrorVariable exerr 2> $null*"")"
"Suspicious PowerShell Download and Execute Pattern","Florian Roth (Nextron Systems)","Detects suspicious PowerShell download patterns that are often used in malicious scripts, stagers or downloaders (make sure that your backend applies the strings case-insensitive)","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the command line arguments of the process creation event to understand the context of the PowerShell execution 
Check if the script or process is part of a known and approved software installation or update procedure 
Analyze the network traffic to determine the destination of the downloaded file and verify its reputation using threat intelligence feeds 
Correlate the PowerShell execution with other security events to identify any additional suspicious activities on the system","Legitimate scripts or tools that download files from the internet for updates or installations 
Scheduled tasks or scripts that fetch resources from trusted sources 
Administrative scripts that use web clients to download files for system maintenance","CommandLine IN (""*IEX ((New-Object Net.WebClient).DownloadString*"", ""*IEX (New-Object Net.WebClient).DownloadString*"", ""*IEX((New-Object Net.WebClient).DownloadString*"", ""*IEX(New-Object Net.WebClient).DownloadString*"", ""* -command (New-Object System.Net.WebClient).DownloadFile(*"", ""* -c (New-Object System.Net.WebClient).DownloadFile(*"")"
"Suspicious PowerShell Parameter Substring","Florian Roth (Nextron Systems), Daniel Bohannon (idea), Roberto Rodriguez (Fix)","Detects suspicious PowerShell invocation with a parameter substring","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the full command line context to understand the purpose of the PowerShell invocation 
Check if the PowerShell command is part of a known and approved script or process 
Analyze the parent process and user context to determine if the activity is expected 
Compare the observed parameters with legitimate use cases in the environment","Legitimate use of PowerShell with similar parameters 
Scripting or automation tools that use similar syntax 
Upgrades or installations that trigger similar command line patterns 
Security tools or scripts that utilize obfuscation techniques","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") CommandLine IN (""* -windowstyle h *"", ""* -windowstyl h*"", ""* -windowsty h*"", ""* -windowst h*"", ""* -windows h*"", ""* -windo h*"", ""* -wind h*"", ""* -win h*"", ""* -wi h*"", ""* -win h *"", ""* -win hi *"", ""* -win hid *"", ""* -win hidd *"", ""* -win hidde *"", ""* -NoPr *"", ""* -NoPro *"", ""* -NoProf *"", ""* -NoProfi *"", ""* -NoProfil *"", ""* -nonin *"", ""* -nonint *"", ""* -noninte *"", ""* -noninter *"", ""* -nonintera *"", ""* -noninterac *"", ""* -noninteract *"", ""* -noninteracti *"", ""* -noninteractiv *"", ""* -ec *"", ""* -encodedComman *"", ""* -encodedComma *"", ""* -encodedComm *"", ""* -encodedCom *"", ""* -encodedCo *"", ""* -encodedC *"", ""* -encoded *"", ""* -encode *"", ""* -encod *"", ""* -enco *"", ""* -en *"", ""* -executionpolic *"", ""* -executionpoli *"", ""* -executionpol *"", ""* -executionpo *"", ""* -executionp *"", ""* -execution bypass*"", ""* -executio bypass*"", ""* -executi bypass*"", ""* -execut bypass*"", ""* -execu bypass*"", ""* -exec bypass*"", ""* -exe bypass*"", ""* -ex bypass*"", ""* -ep bypass*"", ""* /windowstyle h *"", ""* /windowstyl h*"", ""* /windowsty h*"", ""* /windowst h*"", ""* /windows h*"", ""* /windo h*"", ""* /wind h*"", ""* /win h*"", ""* /wi h*"", ""* /win h *"", ""* /win hi *"", ""* /win hid *"", ""* /win hidd *"", ""* /win hidde *"", ""* /NoPr *"", ""* /NoPro *"", ""* /NoProf *"", ""* /NoProfi *"", ""* /NoProfil *"", ""* /nonin *"", ""* /nonint *"", ""* /noninte *"", ""* /noninter *"", ""* /nonintera *"", ""* /noninterac *"", ""* /noninteract *"", ""* /noninteracti *"", ""* /noninteractiv *"", ""* /ec *"", ""* /encodedComman *"", ""* /encodedComma *"", ""* /encodedComm *"", ""* /encodedCom *"", ""* /encodedCo *"", ""* /encodedC *"", ""* /encoded *"", ""* /encode *"", ""* /encod *"", ""* /enco *"", ""* /en *"", ""* /executionpolic *"", ""* /executionpoli *"", ""* /executionpol *"", ""* /executionpo *"", ""* /executionp *"", ""* /execution bypass*"", ""* /executio bypass*"", ""* /executi bypass*"", ""* /execut bypass*"", ""* /execu bypass*"", ""* /exec bypass*"", ""* /exe bypass*"", ""* /ex bypass*"", ""* /ep bypass*"")"
"Suspicious PowerShell Parent Process","Teymur Kheirkhabarov, Harish Segar","Detects a suspicious or uncommon parent processes of PowerShell","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the command line arguments of the parent process to determine the legitimacy of the PowerShell execution 
Check if the PowerShell execution is part of a known and approved script or administrative task 
Investigate the reputation and purpose of the parent process to assess the likelihood of a false positive 
Correlate with network and endpoint logs to identify any malicious activities associated with the PowerShell execution","Scheduled tasks triggering PowerShell scripts 
Legitimate administration tools launching PowerShell 
PowerShell scripts executed by security monitoring tools","ParentImage=""*tomcat*"" OR ParentImage IN (""*\\amigo.exe"", ""*\\browser.exe"", ""*\\chrome.exe"", ""*\\firefox.exe"", ""*\\httpd.exe"", ""*\\iexplore.exe"", ""*\\jbosssvc.exe"", ""*\\microsoftedge.exe"", ""*\\microsoftedgecp.exe"", ""*\\MicrosoftEdgeSH.exe"", ""*\\mshta.exe"", ""*\\nginx.exe"", ""*\\outlook.exe"", ""*\\php-cgi.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\safari.exe"", ""*\\services.exe"", ""*\\sqlagent.exe"", ""*\\sqlserver.exe"", ""*\\sqlservr.exe"", ""*\\vivaldi.exe"", ""*\\w3wp.exe"") Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR CommandLine IN (""*/c powershell*"", ""*/c pwsh*"") OR Description=""Windows PowerShell"" OR Product=""PowerShell Core 6"" OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"")"
"PowerShell DownloadFile","Florian Roth (Nextron Systems)","Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line","attack.execution, attack.t1059.001, attack.command_and_control, attack.t1104, attack.t1105","process_creation","windows","Not classified","Review the full command line of the PowerShell execution to understand the context and intent 
Check if the WebClient object creation and DownloadFile invocation are part of a known and approved script or process 
Investigate the source and destination of the downloaded file to determine if it is malicious 
Correlate the PowerShell activity with other security events to identify any related suspicious behavior","Legitimate use of PowerShell for downloading files from the internet 
Scheduled tasks or scripts that involve downloading files using PowerShell 
Updates or installations that use PowerShell to download resources 
Administrative scripts or tools that leverage WebClient for legitimate purposes","CommandLine=""*powershell*"" CommandLine=""*.DownloadFile*"" CommandLine=""*System.Net.WebClient*"""
"Powershell Token Obfuscation - Process Creation","frack113","Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation","attack.defense_evasion, attack.t1027.009","process_creation","windows","Not classified","Review the process command line arguments for suspicious token obfuscation patterns 
Check if there are known legitimate reasons for token obfuscation in the environment 
Correlate with other security events to determine the context of the process creation 
Investigate the parent-child process relationship to understand the full execution chain","Legitimate use of obfuscation tools for security testing purposes 
Scripting languages or automation tools that use similar obfuscation techniques 
Custom scripts or applications that employ token obfuscation for legitimate reasons"
"Net WebClient Casing Anomalies","Florian Roth (Nextron Systems)","Detects PowerShell command line contents that include a suspicious abnormal casing in the Net.Webclient (e.g. nEt.WEbCliEnT) string as used in obfuscation techniques","attack.execution, attack.t1059.001","process_creation","windows","Not classified","Review the command line arguments of the PowerShell process to understand the context of the abnormal casing 
Check if the abnormal casing is part of a known legitimate script or application 
Investigate the parent process and the overall behavior of the system for any signs of malicious activity 
Consult with the system owner or application developer to confirm the legitimacy of the observed behavior","Legitimate use of casing anomalies in PowerShell scripts for specific applications 
Legitimate use of obfuscation techniques by authorized users 
Legitimate use of Net.Webclient with abnormal casing in non-malicious scripts","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"") CommandLine IN (""*TgBlAFQALgB3AEUAQg*"", ""*4AZQBUAC4AdwBFAEIA*"", ""*OAGUAVAAuAHcARQBCA*"", ""*bgBFAHQALgB3AGUAYg*"", ""*4ARQB0AC4AdwBlAGIA*"", ""*uAEUAdAAuAHcAZQBiA*"", ""*TgBFAHQALgB3AGUAYg*"", ""*OAEUAdAAuAHcAZQBiA*"", ""*bgBlAFQALgB3AGUAYg*"", ""*4AZQBUAC4AdwBlAGIA*"", ""*uAGUAVAAuAHcAZQBiA*"", ""*TgBlAFQALgB3AGUAYg*"", ""*OAGUAVAAuAHcAZQBiA*"", ""*bgBFAFQALgB3AGUAYg*"", ""*4ARQBUAC4AdwBlAGIA*"", ""*uAEUAVAAuAHcAZQBiA*"", ""*bgBlAHQALgBXAGUAYg*"", ""*4AZQB0AC4AVwBlAGIA*"", ""*uAGUAdAAuAFcAZQBiA*"", ""*bgBFAHQALgBXAGUAYg*"", ""*4ARQB0AC4AVwBlAGIA*"", ""*uAEUAdAAuAFcAZQBiA*"", ""*TgBFAHQALgBXAGUAYg*"", ""*OAEUAdAAuAFcAZQBiA*"", ""*bgBlAFQALgBXAGUAYg*"", ""*4AZQBUAC4AVwBlAGIA*"", ""*uAGUAVAAuAFcAZQBiA*"", ""*TgBlAFQALgBXAGUAYg*"", ""*OAGUAVAAuAFcAZQBiA*"", ""*bgBFAFQALgBXAGUAYg*"", ""*4ARQBUAC4AVwBlAGIA*"", ""*uAEUAVAAuAFcAZQBiA*"", ""*bgBlAHQALgB3AEUAYg*"", ""*4AZQB0AC4AdwBFAGIA*"", ""*uAGUAdAAuAHcARQBiA*"", ""*TgBlAHQALgB3AEUAYg*"", ""*OAGUAdAAuAHcARQBiA*"", ""*bgBFAHQALgB3AEUAYg*"", ""*4ARQB0AC4AdwBFAGIA*"", ""*uAEUAdAAuAHcARQBiA*"", ""*TgBFAHQALgB3AEUAYg*"", ""*OAEUAdAAuAHcARQBiA*"", ""*bgBlAFQALgB3AEUAYg*"", ""*4AZQBUAC4AdwBFAGIA*"", ""*uAGUAVAAuAHcARQBiA*"", ""*TgBlAFQALgB3AEUAYg*"", ""*OAGUAVAAuAHcARQBiA*"", ""*bgBFAFQALgB3AEUAYg*"", ""*4ARQBUAC4AdwBFAGIA*"", ""*uAEUAVAAuAHcARQBiA*"", ""*TgBFAFQALgB3AEUAYg*"", ""*OAEUAVAAuAHcARQBiA*"", ""*bgBlAHQALgBXAEUAYg*"", ""*4AZQB0AC4AVwBFAGIA*"", ""*uAGUAdAAuAFcARQBiA*"", ""*TgBlAHQALgBXAEUAYg*"", ""*OAGUAdAAuAFcARQBiA*"", ""*bgBFAHQALgBXAEUAYg*"", ""*4ARQB0AC4AVwBFAGIA*"", ""*uAEUAdAAuAFcARQBiA*"", ""*TgBFAHQALgBXAEUAYg*"", ""*OAEUAdAAuAFcARQBiA*"", ""*bgBlAFQALgBXAEUAYg*"", ""*4AZQBUAC4AVwBFAGIA*"", ""*uAGUAVAAuAFcARQBiA*"", ""*TgBlAFQALgBXAEUAYg*"", ""*OAGUAVAAuAFcARQBiA*"", ""*bgBFAFQALgBXAEUAYg*"", ""*4ARQBUAC4AVwBFAGIA*"", ""*uAEUAVAAuAFcARQBiA*"", ""*TgBFAFQALgBXAEUAYg*"", ""*OAEUAVAAuAFcARQBiA*"", ""*bgBlAHQALgB3AGUAQg*"", ""*4AZQB0AC4AdwBlAEIA*"", ""*uAGUAdAAuAHcAZQBCA*"", ""*TgBlAHQALgB3AGUAQg*"", ""*OAGUAdAAuAHcAZQBCA*"", ""*bgBFAHQALgB3AGUAQg*"", ""*4ARQB0AC4AdwBlAEIA*"", ""*uAEUAdAAuAHcAZQBCA*"", ""*TgBFAHQALgB3AGUAQg*"", ""*OAEUAdAAuAHcAZQBCA*"", ""*bgBlAFQALgB3AGUAQg*"", ""*4AZQBUAC4AdwBlAEIA*"", ""*uAGUAVAAuAHcAZQBCA*"", ""*TgBlAFQALgB3AGUAQg*"", ""*OAGUAVAAuAHcAZQBCA*"", ""*bgBFAFQALgB3AGUAQg*"", ""*4ARQBUAC4AdwBlAEIA*"", ""*uAEUAVAAuAHcAZQBCA*"", ""*TgBFAFQALgB3AGUAQg*"", ""*OAEUAVAAuAHcAZQBCA*"", ""*bgBlAHQALgBXAGUAQg*"", ""*4AZQB0AC4AVwBlAEIA*"", ""*uAGUAdAAuAFcAZQBCA*"", ""*TgBlAHQALgBXAGUAQg*"", ""*OAGUAdAAuAFcAZQBCA*"", ""*bgBFAHQALgBXAGUAQg*"", ""*4ARQB0AC4AVwBlAEIA*"", ""*uAEUAdAAuAFcAZQBCA*"", ""*TgBFAHQALgBXAGUAQg*"", ""*OAEUAdAAuAFcAZQBCA*"", ""*bgBlAFQALgBXAGUAQg*"", ""*4AZQBUAC4AVwBlAEIA*"", ""*uAGUAVAAuAFcAZQBCA*"", ""*TgBlAFQALgBXAGUAQg*"", ""*OAGUAVAAuAFcAZQBCA*"", ""*bgBFAFQALgBXAGUAQg*"", ""*4ARQBUAC4AVwBlAEIA*"", ""*uAEUAVAAuAFcAZQBCA*"", ""*TgBFAFQALgBXAGUAQg*"", ""*OAEUAVAAuAFcAZQBCA*"", ""*bgBlAHQALgB3AEUAQg*"", ""*4AZQB0AC4AdwBFAEIA*"", ""*uAGUAdAAuAHcARQBCA*"", ""*TgBlAHQALgB3AEUAQg*"", ""*OAGUAdAAuAHcARQBCA*"", ""*bgBFAHQALgB3AEUAQg*"", ""*4ARQB0AC4AdwBFAEIA*"", ""*uAEUAdAAuAHcARQBCA*"", ""*TgBFAHQALgB3AEUAQg*"", ""*OAEUAdAAuAHcARQBCA*"", ""*bgBlAFQALgB3AEUAQg*"", ""*uAGUAVAAuAHcARQBCA*"", ""*bgBFAFQALgB3AEUAQg*"", ""*4ARQBUAC4AdwBFAEIA*"", ""*uAEUAVAAuAHcARQBCA*"", ""*TgBFAFQALgB3AEUAQg*"", ""*OAEUAVAAuAHcARQBCA*"", ""*TgBlAHQALgBXAEUAQg*"", ""*4AZQB0AC4AVwBFAEIA*"", ""*OAGUAdAAuAFcARQBCA*"", ""*bgBFAHQALgBXAEUAQg*"", ""*4ARQB0AC4AVwBFAEIA*"", ""*uAEUAdAAuAFcARQBCA*"", ""*TgBFAHQALgBXAEUAQg*"", ""*OAEUAdAAuAFcARQBCA*"", ""*bgBlAFQALgBXAEUAQg*"", ""*4AZQBUAC4AVwBFAEIA*"", ""*uAGUAVAAuAFcARQBCA*"", ""*TgBlAFQALgBXAEUAQg*"", ""*OAGUAVAAuAFcARQBCA*"", ""*bgBFAFQALgBXAEUAQg*"", ""*4ARQBUAC4AVwBFAEIA*"", ""*uAEUAVAAuAFcARQBCA*"")"
"PUA - 3Proxy Execution","Florian Roth (Nextron Systems)","Detects the use of 3proxy, a tiny free proxy server","attack.command_and_control, attack.t1572","process_creation","windows","Not classified","Check if the 3proxy execution was part of a scheduled or authorized task 
Review any documentation or change management records related to the use of 3proxy 
Verify the source and destination of network traffic associated with the 3proxy execution 
Conduct interviews with system administrators or developers to confirm the purpose of 3proxy usage","Legitimate use of 3proxy for authorized proxy server setups 
Development or testing environments where 3proxy is intentionally used 
Third-party applications that may use 3proxy for legitimate purposes","Image=""*\\3proxy.exe"" OR Description=""3proxy - tiny proxy server"" OR CommandLine=""*.exe -i127.0.0.1 -p*"""
"PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE","frack113","Detects active directory enumeration activity using known AdFind CLI flags","attack.discovery, attack.t1087.002","process_creation","windows","Not classified","Check if the AdFind process was executed by a privileged account 
Review the command-line arguments passed to AdFind for any suspicious flags 
Correlate the AdFind activity with other security events for context 
Verify if the Active Directory enumeration was part of a sanctioned security assessment","Scheduled system tasks that involve Active Directory enumeration 
Legitimate use of AdFind by IT administrators for troubleshooting 
Third-party security tools that utilize AdFind for scanning","CommandLine IN (""*lockoutduration*"", ""*lockoutthreshold*"", ""*lockoutobservationwindow*"", ""*maxpwdage*"", ""*minpwdage*"", ""*minpwdlength*"", ""*pwdhistorylength*"", ""*pwdproperties*"") OR CommandLine=""*-sc admincountdmp*"" OR CommandLine=""*-sc exchaddresses*"""
"PUA - AdFind Suspicious Execution","Janantha Marasinghe (https://github.com/blueteam0ps), FPT.EagleEye Team, omkar72, oscd.community","Detects AdFind execution with common flags seen used during attacks","attack.discovery, attack.t1018, attack.t1087.002, attack.t1482, attack.t1069.002, stp.1u","process_creation","windows","Not classified","Review the context of the command execution to determine if it aligns with expected admin activities 
Check for any scheduled tasks or scripts that may be using the flagged commands 
Verify the source and intent of the command execution with the user or system owner 
Cross-reference the flagged commands with known legitimate tools or utilities in the environment","Scheduled system tasks that use similar flags 
Legitimate network monitoring tools 
Scripting or automation tools that utilize similar commands","CommandLine IN (""*domainlist*"", ""*trustdmp*"", ""*dcmodes*"", ""*adinfo*"", ""* dclist *"", ""*computer_pwdnotreqd*"", ""*objectcategory=*"", ""*-subnets -f*"", ""*name=\""Domain Admins\""*"", ""*-sc u:*"", ""*domainncs*"", ""*dompol*"", ""* oudmp *"", ""*subnetdmp*"", ""*gpodmp*"", ""*fspdmp*"", ""*users_noexpire*"", ""*computers_active*"", ""*computers_pwdnotreqd*"")"
"PUA - AdvancedRun Suspicious Execution","Florian Roth (Nextron Systems)","Detects the execution of AdvancedRun utility in the context of the TrustedInstaller, SYSTEM, Local Service or Network Service accounts","attack.defense_evasion, attack.privilege_escalation, attack.t1134.002","process_creation","windows","Not classified","Review the command-line arguments of the process to determine if AdvancedRun utility is being used 
Check if the process execution is part of a known and approved administrative task or script 
Correlate the process execution with any scheduled tasks or installations on the system 
Investigate if any software updates or installations were performed around the time of the detection","Legitimate use of AdvancedRun utility by system administrators 
Scheduled tasks or scripts that use the TrustedInstaller, SYSTEM, Local Service, or Network Service accounts 
Updates or installations that involve running programs as TrustedInstaller, SYSTEM, Local Service, or Network Service","CommandLine IN (""*/EXEFilename*"", ""*/CommandLine*"") CommandLine IN (""* /RunAs 8 *"", ""* /RunAs 4 *"", ""* /RunAs 10 *"", ""* /RunAs 11 *"") OR CommandLine IN (""*/RunAs 8"", ""*/RunAs 4"", ""*/RunAs 10"", ""*/RunAs 11"")"
"PUA - Chisel Tunneling Tool Execution","Florian Roth (Nextron Systems)","Detects usage of the Chisel tunneling tool via the commandline arguments","attack.command_and_control, attack.t1090.001","process_creation","windows","Not classified","Verify the legitimacy of the process by checking with the system owner or network administrators 
Analyze the context in which the Chisel tool is being used to determine if it aligns with expected network behavior 
Cross-reference the process execution with authorized change management records or tickets 
Inspect the process behavior for any additional suspicious activities or indicators of compromise","Legitimate use of Chisel tunneling tool for authorized network operations 
Similar command-line arguments used by other legitimate tools 
Chisel tool used for testing or development purposes","Image=""*\\chisel.exe"" OR (CommandLine IN (""*exe client *"", ""*exe server *"") CommandLine IN (""*-socks5*"", ""*-reverse*"", ""* r:*"", ""*:127.0.0.1:*"", ""*-tls-skip-verify *"", ""*:socks*""))"
"PUA - CleanWipe Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the use of CleanWipe a tool usually used to delete Symantec antivirus.","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Verify the legitimacy of the process by checking with the system administrator or IT team 
Cross-reference the activity with change management records to confirm authorized actions 
Look for patterns of activity or context that indicate routine system maintenance rather than malicious intent 
Check for any alerts or notifications from the antivirus software itself regarding uninstallation or updates","Legitimate use of Symantec tools for uninstallation purposes 
Scheduled maintenance tasks that involve similar executables 
Authorized security software installations or updates","Image=""*\\SepRemovalToolNative_x64.exe"" OR (Image=""*\\CATClean.exe"" CommandLine=""*--uninstall*"") OR (Image=""*\\NetInstaller.exe"" CommandLine=""*-r*"") OR (Image=""*\\WFPUnins.exe"" CommandLine=""*/uninstall*"" CommandLine=""*/enterprise*"")"
"PUA - Crassus Execution","pH-T (Nextron Systems)","Detects Crassus, a Windows privilege escalation discovery tool, based on PE metadata characteristics.","attack.discovery, attack.t1590.001","process_creation","windows","Not classified","Check if the process execution of Crassus.exe is part of authorized security assessments or red teaming exercises 
Verify the source and integrity of the Crassus.exe file to determine if it is a legitimate version 
Review any documentation or change management records related to the deployment or use of Crassus 
Compare the process behavior with known benign executions of Crassus to identify anomalies","Legitimate use of Crassus tool for authorized security testing purposes 
Presence of files named Crassus.exe in non-malicious contexts 
Use of software with similar PE metadata characteristics to Crassus 
Development or testing environments where Crassus is intentionally used","Image=""*\\Crassus.exe"" OR OriginalFileName=""Crassus.exe"" OR Description=""*Crassus*"""
"PUA - CsExec Execution","Florian Roth (Nextron Systems)","Detects the use of the lesser known remote execution tool named CsExec a PsExec alternative","attack.resource_development, attack.t1587.001, attack.execution, attack.t1569.002","process_creation","windows","Not classified","Check the command-line arguments used with the csexec.exe process to determine the intent and legitimacy of the execution 
Verify the digital signature of the csexec.exe file to confirm its authenticity 
Review the parent process that spawned csexec.exe to understand the context of its execution 
Cross-reference the execution of csexec.exe with known good sources or authorized activities in the environment","Legitimate use of CsExec tool for authorized administrative purposes 
Presence of a file named csexec.exe that is not related to the CsExec tool 
Use of a different tool or legitimate software with a similar name to csexec.exe 
False positive due to naming convention or file path","Image=""*\\csexec.exe"" OR Description=""csexec"""
"PUA - DefenderCheck Execution","Florian Roth (Nextron Systems)","Detects the use of DefenderCheck, a tool to evaluate the signatures used in Microsoft Defender. It can be used to figure out the strings / byte chains used in Microsoft Defender to detect a tool and thus used for AV evasion.","attack.defense_evasion, attack.t1027.005","process_creation","windows","Not classified","Check the process command line arguments for any suspicious behavior or additional parameters 
Review the parent process of DefenderCheck.exe to determine how it was spawned 
Look for any network connections or file modifications made by DefenderCheck.exe 
Correlate the execution of DefenderCheck.exe with other security events or alerts for context","Legitimate use of DefenderCheck tool by authorized security personnel for testing purposes 
Presence of DefenderCheck in a sandbox environment for research purposes 
Use of DefenderCheck as part of a red team exercise with proper authorization 
DefenderCheck being used in a documented security assessment","Image=""*\\DefenderCheck.exe"" OR Description=""DefenderCheck"""
"PUA - DIT Snapshot Viewer","Furkan Caliskan (@caliskanfurkan_)","Detects the use of Ditsnap tool, an inspection tool for Active Directory database, ntds.dit.","attack.credential_access, attack.t1003.003","process_creation","windows","Not classified","Check if the use of Ditsnap was authorized by reviewing change management records 
Verify if the Ditsnap tool was used during scheduled security assessments 
Interview the user or admin associated with the Ditsnap activity to confirm the purpose 
Cross-reference the Ditsnap activity with system maintenance logs to ensure legitimacy","Legitimate admin usage of Ditsnap tool 
Authorized security assessments using Ditsnap 
Legitimate troubleshooting involving Ditsnap 
Use of Ditsnap by IT personnel for system maintenance","Image=""*\\ditsnap.exe"" OR CommandLine=""*ditsnap.exe*"""
"PUA - Fast Reverse Proxy (FRP) Execution","frack113, Florian Roth","Detects the use of Fast Reverse Proxy. frp is a fast reverse proxy to help you expose a local server behind a NAT or firewall to the Internet.","attack.command_and_control, attack.t1090","process_creation","windows","Not classified","Check if FRP is part of the organization's approved software list 
Verify if FRP is being used for legitimate purposes such as network testing or development 
Review any change management records indicating the deployment of FRP 
Cross-reference with system administrator activities to confirm authorized use of FRP","Legitimate use cases of Fast Reverse Proxy (FRP) 
Development or testing environments where FRP is intentionally used 
Authorized use of FRP by system administrators","Image IN (""*\\frpc.exe"", ""*\\frps.exe"") OR CommandLine=""*\\frpc.ini*"" OR Hashes IN (""*MD5=7D9C233B8C9E3F0EA290D2B84593C842*"", ""*SHA1=06DDC9280E1F1810677935A2477012960905942F*"", ""*SHA256=57B0936B8D336D8E981C169466A15A5FD21A7D5A2C7DAF62D5E142EE860E387C*"") OR md5=""7d9c233b8c9e3f0ea290d2b84593c842"" OR sha1=""06ddc9280e1f1810677935a2477012960905942f"" OR sha256=""57b0936b8d336d8e981c169466a15a5fd21a7d5a2c7daf62d5e142ee860e387c"""
"PUA- IOX Tunneling Tool Execution","Florian Roth (Nextron Systems)","Detects the use of IOX - a tool for port forwarding and intranet proxy purposes","attack.command_and_control, attack.t1090","process_creation","windows","Not classified","Verify the context in which IOX is being used within the network 
Check if the tool execution aligns with authorized network operations 
Review any documentation or change management records related to the IOX tool 
Correlate the IOX activity with other security events or network traffic for additional context","Legitimate use of IOX tool for authorized network operations 
Legitimate use of similar tools for network administration purposes 
Presence of IOX in a testing or development environment 
IOX used as part of a security assessment or penetration testing","Image=""*\\iox.exe"" OR CommandLine IN (""*.exe fwd -l *"", ""*.exe fwd -r *"", ""*.exe proxy -l *"", ""*.exe proxy -r *"") OR Hashes IN (""*MD5=9DB2D314DD3F704A02051EF5EA210993*"", ""*SHA1=039130337E28A6623ECF9A0A3DA7D92C5964D8DD*"", ""*SHA256=C6CF82919B809967D9D90EA73772A8AA1C1EB3BC59252D977500F64F1A0D6731*"") OR md5=""9db2d314dd3f704a02051ef5ea210993"" OR sha1=""039130337e28a6623ecf9a0a3da7d92c5964d8dd"" OR sha256=""c6cf82919b809967d9d90ea73772a8aa1c1eb3bc59252d977500f64f1a0d6731"""
"PUA - Netcat Suspicious Execution","frack113, Florian Roth (Nextron Systems)","Detects execution of Netcat. Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network","attack.command_and_control, attack.t1095","process_creation","windows","Not classified","Check if the Netcat execution was part of a scheduled task or legitimate script 
Review the command-line arguments used with Netcat for any known legitimate purposes 
Correlate the Netcat execution with other security events to determine if it is part of a malicious activity 
Investigate the source and destination of network traffic associated with the Netcat execution","Legitimate use of Netcat for network troubleshooting or administration 
Legitimate use of Netcat in a DevOps environment for automation 
Legitimate use of Netcat in penetration testing engagements","Image IN (""*\\nc.exe"", ""*\\ncat.exe"", ""*\\netcat.exe"") OR CommandLine IN (""* -lvp *"", ""* -lvnp*"", ""* -l -v -p *"", ""* -lv -p *"", ""* -l --proxy-type http *"", ""* -vnl --exec *"", ""* -vnl -e *"", ""* --lua-exec *"", ""* --sh-exec *"")"
"PUA - Ngrok Execution","Florian Roth (Nextron Systems)","Detects the use of Ngrok, a utility used for port forwarding and tunneling, often used by threat actors to make local protected services publicly available.
Involved domains are bin.equinox.io for download and *.ngrok.io for connections.
","attack.command_and_control, attack.t1572","process_creation","windows","Not classified","Check if Ngrok is being used as part of a known development or testing environment 
Verify if the command line parameters match a legitimate use case within the organization 
Investigate the source and destination of the connections made by Ngrok 
Cross-reference with authorized personnel or teams that may be using Ngrok","Legitimate use of Ngrok for development or testing purposes 
Tools that have similar command line parameters to Ngrok 
Use of Ngrok by authorized personnel for legitimate business reasons","CommandLine IN (""* tcp 139*"", ""* tcp 445*"", ""* tcp 3389*"", ""* tcp 5985*"", ""* tcp 5986*"") OR (CommandLine=""* start *"" CommandLine=""*--all*"" CommandLine=""*--config*"" CommandLine=""*.yml*"") OR (Image=""*ngrok.exe"" CommandLine IN (""* tcp *"", ""* http *"", ""* authtoken *"")) OR CommandLine IN (""*.exe authtoken *"", ""*.exe start --all*"")"
"PUA - Nimgrab Execution","frack113","Detects the usage of nimgrab, a tool bundled with the Nim programming framework and used for downloading files.","attack.command_and_control, attack.t1105","process_creation","windows","Not classified","Check if Nim programming framework is officially used within the organization 
Review any scheduled tasks or automation scripts that involve Nim 
Verify if any authorized penetration testing activities are ongoing","Legitimate use of Nim on developer systems 
Scheduled tasks or automation using Nim 
Authorized penetration testing activities","Image=""*\\nimgrab.exe"" OR Hashes IN (""*MD5=2DD44C3C29D667F5C0EF5F9D7C7FFB8B*"", ""*SHA256=F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559*"", ""*IMPHASH=C07FDDD21D123EA9B3A08EEF44AAAC45*"") OR md5=""2DD44C3C29D667F5C0EF5F9D7C7FFB8B"" OR sha256=""F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559"" OR Imphash=""C07FDDD21D123EA9B3A08EEF44AAAC45"""
"PUA - NirCmd Execution As LOCAL SYSTEM","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects the use of NirCmd tool for command execution as SYSTEM user","attack.execution, attack.t1569.002, attack.s0029","process_creation","windows","Not classified","Check the parent process of NirCmd to determine if it is initiated by a legitimate system process 
Review scheduled tasks that involve NirCmd execution to verify if they are authorized 
Analyze the context of the command execution to identify any legitimate reasons for using NirCmd as SYSTEM 
Cross-reference with system administration logs to confirm authorized use of NirCmd","Scheduled legitimate tasks that run commands as SYSTEM 
Legitimate use by system administration tools 
Scripting or automation tools that require SYSTEM privileges","CommandLine=""* runassystem *"""
"PUA - NPS Tunneling Tool Execution","Florian Roth (Nextron Systems)","Detects the use of NPS, a port forwarding and intranet penetration proxy server","attack.command_and_control, attack.t1090","process_creation","windows","Not classified","Verify the context in which NPS is being used within the organization 
Check for any documented approvals or legitimate reasons for NPS usage 
Review network architecture and security policies to confirm authorized use of NPS 
Correlate with other security controls and logs to ensure no malicious activity is associated","Legitimate use of NPS for authorized purposes 
Use of similar tools for legitimate network administration tasks 
Presence of test or development environments where NPS is used 
Use of NPS in a controlled red team exercise","Image=""*\\npc.exe"" OR (CommandLine=""* -server=*"" CommandLine=""* -vkey=*"" CommandLine=""* -password=*"") OR CommandLine=""* -config=npc*"" OR Hashes IN (""*MD5=AE8ACF66BFE3A44148964048B826D005*"", ""*SHA1=CEA49E9B9B67F3A13AD0BE1C2655293EA3C18181*"", ""*SHA256=5A456283392FFCEEEACA3D3426C306EB470304637520D72FED1CC1FEBBBD6856*"") OR md5=""ae8acf66bfe3a44148964048b826d005"" OR sha1=""cea49e9b9b67f3a13ad0be1c2655293ea3c18181"" OR sha256=""5a456283392ffceeeaca3d3426c306eb470304637520d72fed1cc1febbbd6856"""
"PUA - NSudo Execution","Florian Roth (Nextron Systems), Nasreddine Bencherchali","Detects the use of NSudo tool for command execution","attack.execution, attack.t1569.002, attack.s0029","process_creation","windows","Not classified","Review the command-line arguments and context of NSudo execution 
Check if the NSudo execution is part of a known administrative task or script 
Correlate NSudo executions with authorized activities or scheduled tasks 
Investigate the parent processes that triggered NSudo execution","Scripting or automation tools that may use NSudo for legitimate purposes 
Security tools or scripts that leverage NSudo for specific tasks 
Development environments where NSudo is used for testing or debugging","Image IN (""*\\NSudo.exe"", ""*\\NSudoLC.exe"", ""*\\NSudoLG.exe"") OR OriginalFileName IN (""NSudo.exe"", ""NSudoLC.exe"", ""NSudoLG.exe"") CommandLine IN (""*-U:S *"", ""*-U:T *"", ""*-U:E *"", ""*-P:E *"", ""*-M:S *"", ""*-M:H *"", ""*-U=S *"", ""*-U=T *"", ""*-U=E *"", ""*-P=E *"", ""*-M=S *"", ""*-M=H *"", ""*-ShowWindowMode:Hide*"")"
"PUA - Rclone Execution","Bhabesh Raj, Sittikorn S, Aaron Greetham (@beardofbinary) - NCC Group","Detects execution of RClone utility for exfiltration as used by various ransomwares strains like REvil, Conti, FiveHands, etc","attack.exfiltration, attack.t1567.002","process_creation","windows","Not classified","Review the parent process of RClone execution to determine if it is initiated from a legitimate source 
Check if the RClone execution is part of a scheduled backup or synchronization task 
Verify if the RClone command-line parameters align with known authorized use cases within the environment 
Investigate the destination of the data transfer to ensure it is a legitimate and authorized location","Legitimate use of RClone for authorized data transfer operations 
Development or testing environments where RClone is used for legitimate purposes 
Backup operations that involve RClone for authorized backups 
Authorized synchronization of files to cloud storage using RClone","(CommandLine=""*--config *"" CommandLine=""*--no-check-certificate *"" CommandLine=""* copy *"") OR (Image=""*\\rclone.exe"" OR Description=""Rsync for cloud storage"" CommandLine IN (""*pass*"", ""*user*"", ""*copy*"", ""*sync*"", ""*config*"", ""*lsd*"", ""*remote*"", ""*ls*"", ""*mega*"", ""*pcloud*"", ""*ftp*"", ""*ignore-existing*"", ""*auto-confirm*"", ""*transfers*"", ""*multi-thread-streams*"", ""*no-check-certificate *""))"
"PUA - RunXCmd Execution","Florian Roth (Nextron Systems)","Detects the use of the RunXCmd tool to execute commands with System or TrustedInstaller accounts","attack.execution, attack.t1569.002, attack.s0029","process_creation","windows","Not classified","Check the Parent Process of the suspicious command execution 
Review the command line arguments for any unusual or unauthorized commands 
Correlate with other security events to determine the context of the activity 
Verify the legitimacy of the account used for the command execution","Scheduled tasks running with System account 
Legitimate use by system management tools 
Scripts or applications running with elevated privileges","CommandLine IN (""* /account=system *"", ""* /account=ti *"") CommandLine=""*/exec=*"""
"PUA - Seatbelt Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of the PUA/Recon tool Seatbelt via PE information of command line parameters","attack.discovery, attack.t1526, attack.t1087, attack.t1083","process_creation","windows","Not classified","Verify if the Seatbelt tool execution was authorized and part of a security assessment 
Check if the Seatbelt tool execution was part of a red teaming exercise 
Review system administration logs to confirm if Seatbelt tool was used for legitimate tasks 
Look for additional context or justification for Seatbelt tool execution in change management records","Legitimate use of Seatbelt tool by authorized users for security assessments 
Seatbelt tool used in a controlled environment for red teaming exercises 
Seatbelt tool executed as part of a legitimate system administration task","Image=""*\\Seatbelt.exe"" OR OriginalFileName=""Seatbelt.exe"" OR Description=""Seatbelt"" OR CommandLine IN (""* DpapiMasterKeys*"", ""* InterestingProcesses*"", ""* InterestingFiles*"", ""* CertificateThumbprints*"", ""* ChromiumBookmarks*"", ""* ChromiumHistory*"", ""* ChromiumPresence*"", ""* CloudCredentials*"", ""* CredEnum*"", ""* CredGuard*"", ""* FirefoxHistory*"", ""* ProcessCreationEvents*"") OR (CommandLine IN (""* -group=misc*"", ""* -group=remote*"", ""* -group=chromium*"", ""* -group=slack*"", ""* -group=system*"", ""* -group=user*"", ""* -group=all*"") CommandLine=""* -outputfile=*"")"
"PUA - Wsudo Suspicious Execution","Nasreddine Bencherchali (Nextron Systems)","Detects usage of wsudo (Windows Sudo Utility). Which is a tool that let the user execute programs with different permissions (System, Trusted Installer, Administrator...etc)","attack.execution, attack.privilege_escalation, attack.t1059","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of wsudo usage 
Check if the wsudo execution is part of a known and approved workflow or script 
Correlate the wsudo execution with other security events to determine if it is part of a larger attack chain 
Investigate the parent process of wsudo to identify the origin of the execution","Legitimate use of wsudo for authorized system administration tasks 
Installation or update of software that requires elevated permissions 
Scripts or applications designed to run with specific permissions 
Development or testing environments where elevated privileges are necessary","Image=""*\\wsudo.exe"" OR OriginalFileName=""wsudo.exe"" OR Description=""Windows sudo utility"" OR ParentImage=""*\\wsudo-bridge.exe"" OR CommandLine IN (""*-u System*"", ""*-uSystem*"", ""*-u TrustedInstaller*"", ""*-uTrustedInstaller*"", ""* --ti *"")"
"Python Spawning Pretty TTY on Windows","Nextron Systems","Detects python spawning a pretty tty","attack.execution, attack.t1059","process_creation","windows","Not classified","Review the parent process of the Python execution to determine if it is part of a legitimate workflow 
Check if the pretty TTY activity is expected based on the user and system context 
Analyze the command-line arguments passed to Python to identify the intent behind spawning a pretty TTY 
Correlate the Python activity with other security events or logs to understand the full scope of the activity","Legitimate use of Python for administrative tasks 
Development environments where pretty TTY is required 
Tools or scripts that utilize pty.spawn for valid purposes","Image IN (""*python.exe"", ""*python3.exe"", ""*python2.exe"") (CommandLine=""*import pty*"" CommandLine=""*.spawn(*"") OR CommandLine=""*from pty import spawn*"""
"Rar Usage with Password and Compression Level","@ROxPinTeddy","Detects the use of rar.exe, on the command line, to create an archive with password protection or with a specific compression level. This is pretty indicative of malicious actions.","attack.collection, attack.t1560.001","process_creation","windows","Not classified","Check the command line arguments used with rar.exe to determine if it matches the detection criteria 
Review the context of the rar.exe execution to see if it aligns with expected or authorized activities 
Correlate the rar.exe activity with other security events or logs to identify any associated suspicious behavior 
Verify the source and user context of the rar.exe execution to confirm if it is part of a legitimate operation","Legitimate use of Winrar command line version by authorized users 
Scheduled backup tasks that involve password-protected archives 
Compression utilities like 7-Zip or WinZip that use similar flags 
Automated scripts or applications that utilize rar.exe with password protection","CommandLine=""* -hp*"" CommandLine IN (""* -m*"", ""* a *"")"
"Process Memory Dump via RdrLeakDiag.EXE","Cedric MAURUGEON, Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)","Detects the use of the Microsoft Windows Resource Leak Diagnostic tool ""rdrleakdiag.exe"" to dump process memory","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Check the command-line arguments of the process creation event to identify the presence of rdrleakdiag.exe and memory dump-related parameters 
Correlate the process creation event with network or file activity to determine if the memory dump was exfiltrated 
Review the parent process and user context to understand the origin and intent of the memory dump operation 
Look for any subsequent suspicious activities or lateral movement post memory dump","Legitimate use of rdrleakdiag.exe for diagnostic purposes 
Use of similar tools for memory dump operations 
Legitimate memory dump operations initiated by system administrators","(CommandLine IN (""*fullmemdmp*"", ""*/memdmp*"", ""*-memdmp*"") CommandLine IN (""* -o *"", ""* /o *"") CommandLine IN (""* -p *"", ""* /p *"")) OR (Image=""*\\rdrleakdiag.exe"" OR OriginalFileName=""RdrLeakDiag.exe"" CommandLine IN (""*fullmemdmp*"", ""*/memdmp*"", ""*-memdmp*""))"
"Exports Critical Registry Keys To a File","Oddvar Moe, Sander Wiebing, oscd.community","Detects the export of a crital Registry key to a file.","attack.exfiltration, attack.t1012","process_creation","windows","Not classified","Review the ParentImage field to identify the process that initiated the export 
Inspect the CommandLine field to understand the specific registry key being exported 
Check for any scheduled tasks or scripts that may be exporting registry keys 
Correlate the event with other security events to determine if the action is part of a larger attack","Legitimate use of regedit.exe for system backup purposes 
Forensic analysis tools exporting registry keys 
Scheduled tasks or scripts that export registry keys for monitoring purposes","Image=""*\\regedit.exe"" OR OriginalFileName=""REGEDIT.EXE"" CommandLine IN (""* /E *"", ""* -E *"") CommandLine IN (""*hklm*"", ""*hkey_local_machine*"") CommandLine IN (""*\\system"", ""*\\sam"", ""*\\security"")"
"Imports Registry Key From an ADS","Oddvar Moe, Sander Wiebing, oscd.community","Detects the import of a alternate datastream to the registry with regedit.exe.","attack.t1112, attack.defense_evasion","process_creation","windows","Not classified","Check if the registry import was part of a known software installation or update process 
Verify if the registry import was performed by a system administrator or a legitimate user 
Analyze the context of the registry import to determine if it aligns with expected system behavior 
Cross-reference the registry import with authorized change management records","Legitimate use of regedit.exe to import registry keys 
Software installations that involve registry modifications 
Administrative tasks that involve registry changes","Image=""*\\regedit.exe"" OR OriginalFileName=""REGEDIT.EXE"" CommandLine IN (""* /i *"", ""*.reg*"") NOT (CommandLine IN (""* /e *"", ""* /a *"", ""* /c *"", ""* -e *"", ""* -a *"", ""* -c *""))\"
"Regedit as Trusted Installer","Florian Roth (Nextron Systems)","Detects a regedit started with TrustedInstaller privileges or by ProcessHacker.exe","attack.privilege_escalation, attack.t1548","process_creation","windows","Not classified","Check the command-line arguments of the regedit process to determine the source of execution 
Review the process creation events leading up to the regedit execution for context 
Correlate with other security events or logs to identify any suspicious behavior or related activities","Legitimate use of TrustedInstaller privileges for system maintenance tasks 
Legitimate use of ProcessHacker.exe for system monitoring purposes 
Instances where regedit is launched by trusted system administrators","Image=""*\\regedit.exe"" ParentImage IN (""*\\TrustedInstaller.exe"", ""*\\ProcessHacker.exe"")"
"Suspicious Registry Modification From ADS Via Regini.EXE","Eli Salem, Sander Wiebing, oscd.community","Detects the import of an alternate data stream with regini.exe, regini.exe can be used to modify registry keys.","attack.t1112, attack.defense_evasion","process_creation","windows","Not classified","Check if the process execution is part of a scheduled task or legitimate system operation 
Review the command line arguments to determine the intent of the registry modification 
Correlate with other security events to identify any malicious behavior","Legitimate use of regini.exe for system administration tasks 
Software installations that involve modifying registry keys 
Updates or patches that modify registry settings","Image=""*\\regini.exe"" OR OriginalFileName=""REGINI.EXE""\"
"Suspicious Debugger Registration Cmdline","Florian Roth (Nextron Systems), oscd.community, Jonhnathan Ribeiro","Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).","attack.persistence, attack.privilege_escalation, attack.t1546.008","process_creation","windows","Not classified","Check if the debugger registration is part of a legitimate software development process 
Verify if the Image File Execution Options were configured by authorized administrators 
Investigate if any third-party software installed on the system interacts with the mentioned executables 
Look for any additional suspicious activities or indicators of compromise on the system","Legitimate use of debuggers during software development may trigger this rule 
Administrators legitimately configuring Image File Execution Options for troubleshooting purposes 
Third-party software that interacts with the mentioned executables may trigger this rule","CommandLine=""*\\CurrentVersion\\Image File Execution Options\\*"" CommandLine IN (""*sethc.exe*"", ""*utilman.exe*"", ""*osk.exe*"", ""*magnify.exe*"", ""*narrator.exe*"", ""*displayswitch.exe*"", ""*atbroker.exe*"", ""*HelpPane.exe*"")"
"Potential Credential Dumping Attempt Using New NetworkProvider - CLI","Nasreddine Bencherchali (Nextron Systems)","Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it","attack.credential_access, attack.t1003","process_creation","windows","Not classified","Check the command line arguments of the process creation event to identify the specific network provider being added 
Review the process tree to understand the context of the network provider addition 
Correlate with other security events to determine if the network provider addition is part of a larger attack pattern 
Verify the legitimacy of the network provider addition with system administrators or through documentation","Legitimate changes to network provider configurations by system administrators 
Installation or updates of software that legitimately add network providers 
Scheduled tasks or scripts that interact with network providers 
Custom configurations that involve network providers","CommandLine=""*\\System\\CurrentControlSet\\Services\\*"" CommandLine=""*\\NetworkProvider*"""
"Potential Privilege Escalation via Service Permissions Weakness","Teymur Kheirkhabarov","Detect modification of services configuration (ImagePath, FailureCommand and ServiceDLL) in registry by processes with Medium integrity level","attack.privilege_escalation, attack.t1574.011","process_creation","windows","Not classified","Review the process creation logs to identify the process that made the changes 
Check the integrity level of the process to determine if it matches the expected Medium level 
Verify if the service configuration changes were authorized and expected 
Investigate further to understand the context and potential impact of the detected activity","Legitimate changes to service configurations by authorized administrators 
Updates or installations of software that require service modifications 
Scheduled tasks or scripts that interact with services","IntegrityLevel=""Medium"" CommandLine=""*ControlSet*"" CommandLine=""*services*"" CommandLine IN (""*\\ImagePath*"", ""*\\FailureCommand*"", ""*\\ServiceDll*"")"
"Potential PowerShell Execution Policy Tampering - ProcCreation","Nasreddine Bencherchali (Nextron Systems)","Detects changes to the PowerShell execution policy registry key in order to bypass signing requirements for script execution from the CommandLine","attack.defense_evasion","process_creation","windows","Not classified","Review PowerShell logs for legitimate changes to the execution policy 
Check with system administrators if they made any intentional changes to the execution policy 
Investigate if there are any approved scripts that require bypassing the execution policy 
Analyze if any authorized third-party tools or applications are responsible for the changes","Legitimate changes to PowerShell execution policy by administrators 
Script execution that requires bypassing the execution policy 
Third-party tools or applications that modify the execution policy","CommandLine IN (""*\\ShellIds\\Microsoft.PowerShell\\ExecutionPolicy*"", ""*\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy*"") CommandLine IN (""*Bypass*"", ""*RemoteSigned*"", ""*Unrestricted*"")"
"Suspicious Regsvr32 Execution From Remote Share","Nasreddine Bencherchali (Nextron Systems)","Detects REGSVR32.exe to execute DLL hosted on remote shares","attack.defense_evasion, attack.t1218.010","process_creation","windows","Not classified","Check the command-line arguments of the regsvr32.exe process to identify the DLL being executed from the remote share 
Verify the legitimacy of the remote share being accessed by regsvr32.exe 
Review any scheduled tasks or scripts that involve regsvr32.exe and remote shares for known activities 
Correlate the event with other security logs to determine the context of the activity","Legitimate use of regsvr32.exe to register DLLs from remote shares in a controlled environment 
Scheduled tasks or scripts that involve regsvr32.exe and remote shares 
Updates or installations that legitimately use regsvr32.exe from remote shares","Image=""*\\regsvr32.exe"" OR OriginalFileName=""\\REGSVR32.EXE"" CommandLine=""* \\\\*"""
"Add SafeBoot Keys Via Reg Utility","Nasreddine Bencherchali (Nextron Systems)","Detects execution of ""reg.exe"" commands with the ""add"" or ""copy"" flags on safe boot registry keys. Often used by attacker to allow the ransomware to work in safe mode as some security products do not","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of the reg.exe execution 
Check if the modification of safe boot keys aligns with any authorized changes or maintenance activities 
Correlate the reg.exe activity with other security events to determine if it is part of a larger attack chain 
Investigate the reputation and behavior of the process and associated files to determine if they are malicious","Legitimate system administration tasks may involve modifying safe boot keys using reg.exe 
Software installations or updates may also trigger this detection 
Scheduled tasks or scripts that interact with safe boot keys can lead to false positives","Image=""*reg.exe"" OR OriginalFileName=""reg.exe"" CommandLine=""*\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot*"" CommandLine IN (""* copy *"", ""* add *"")"
"Suspicious Reg Add BitLocker","frack113","Detects suspicious addition to BitLocker related registry keys via the reg.exe utility","attack.impact, attack.t1486","process_creation","windows","Not classified","Check if the registry modification was performed by a known and authorized administrator 
Review system change management records to verify if the change was scheduled or expected 
Correlate the registry modification with other security events to determine if it is part of a larger attack campaign 
Inspect the process command line arguments for additional context or indicators of compromise","Legitimate changes to BitLocker settings made by authorized administrators 
Updates or installations that involve BitLocker configuration changes 
Legitimate software that interacts with BitLocker-related registry keys","CommandLine=""*REG*"" CommandLine=""*ADD*"" CommandLine=""*\\SOFTWARE\\Policies\\Microsoft\\FVE*"" CommandLine=""*/v*"" CommandLine=""*/f*"" CommandLine IN (""*EnableBDEWithNoTPM*"", ""*UseAdvancedStartup*"", ""*UseTPM*"", ""*UseTPMKey*"", ""*UseTPMKeyPIN*"", ""*RecoveryKeyMessageSource*"", ""*UseTPMPIN*"", ""*RecoveryKeyMessage*"")"
"SafeBoot Registry Key Deleted Via Reg.EXE","Nasreddine Bencherchali (Nextron Systems), Tim Shelton","Detects execution of ""reg.exe"" commands with the ""delete"" flag on safe boot registry keys. Often used by attacker to prevent safeboot execution of security products","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Check the command-line arguments and the context in which the reg.exe command was executed 
Verify if the deletion of safe boot registry keys was part of a known system maintenance or security operation 
Correlate the event with other security logs to determine if the action was isolated or part of a larger suspicious activity 
Investigate the reputation and history of the process and the user/account involved in the activity","Legitimate system administrators or security tools may also delete safe boot registry keys for valid reasons 
Software updates or installations may trigger similar behavior 
Scripting or automation tasks could lead to false positives","Image=""*reg.exe"" OR OriginalFileName=""reg.exe"" CommandLine=""* delete *"" CommandLine=""*\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot*"""
"Service Registry Key Deleted Via Reg.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects execution of ""reg.exe"" commands with the ""delete"" flag on services registry key. Often used by attacker to remove AV software services","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to understand the context of the reg.exe command execution 
Check if the service registry key deletion was part of a known and authorized software installation or update process 
Correlate the event with other security events to determine if there are signs of malicious activity beyond just the reg.exe command execution 
Investigate the parent process of reg.exe to identify the origin of the command and potential chain of events","Legitimate use of reg.exe to delete a service registry key during software uninstallation 
Automated system maintenance tasks that involve deleting service registry keys 
Scripted actions that delete service registry keys for specific configurations","Image=""*reg.exe"" OR OriginalFileName=""reg.exe"" CommandLine=""* delete *"" CommandLine=""*\\SYSTEM\\CurrentControlSet\\services\\*"""
"Security Service Disabled Via Reg.EXE","Florian Roth (Nextron Systems), John Lambert (idea), elhoim","Detects execution of ""reg.exe"" to disable security services such as Windows Defender.","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Check if the reg.exe command was executed as part of a scheduled task or script known to be benign. 
Review the context in which reg.exe was used to disable security services to determine if it aligns with legitimate system administration activities. 
Correlate the event with other security events or logs to identify any malicious patterns or behaviors associated with the activity. 
Investigate the reputation and source of the process that initiated the reg.exe command to assess its trustworthiness.","Legitimate system administration tasks may involve the use of reg.exe to modify registry settings, which can include stopping or disabling services for valid reasons. 
Some security software may legitimately interact with Windows Defender services using reg.exe. 
Third-party applications or scripts may also use reg.exe to manage services in a benign manner.","CommandLine=""*reg*"" CommandLine=""*add*"" CommandLine=""*d 4*"" CommandLine=""*v Start*"" CommandLine IN (""*\\AppIDSvc*"", ""*\\MsMpSvc*"", ""*\\NisSrv*"", ""*\\SecurityHealthService*"", ""*\\Sense*"", ""*\\UsoSvc*"", ""*\\WdBoot*"", ""*\\WdFilter*"", ""*\\WdNisDrv*"", ""*\\WdNisSvc*"", ""*\\WinDefend*"", ""*\\wscsvc*"", ""*\\wuauserv*"")"
"Dumping of Sensitive Hives Via Reg.EXE","Teymur Kheirkhabarov, Endgame, JHasenbusch, Daniil Yugoslavskiy, oscd.community, frack113","Detects the usage of ""reg.exe"" in order to dump sensitive registry hives. This includes SAM, SYSTEM and SECURITY hives.","attack.credential_access, attack.t1003.002, attack.t1003.004, attack.t1003.005, car.2013-07-001","process_creation","windows","Not classified","Check if the reg.exe command was executed as part of a scheduled task or system maintenance script 
Verify if the registry hive dump was triggered by a known backup software 
Analyze the context of the registry hive dump to determine if it aligns with legitimate system administration activities 
Cross-reference the activity with authorized forensic investigations or incident response actions","Legitimate use of reg.exe for system administration tasks 
Backup software performing registry backups 
Forensic tools accessing registry hives","Image=""*\\reg.exe"" OR OriginalFileName=""reg.exe"" CommandLine IN (""* save *"", ""* export *"", ""* ave *"", ""* eport *"") CommandLine IN (""*hklm*"", ""*hkm*"", ""*hkey_local_machine*"", ""*hkey_ocal_machine*"", ""*hkey_loca_machine*"", ""*hkey_oca_machine*"") CommandLine IN (""*\\system*"", ""*\\sam*"", ""*\\security*"", ""*\\ystem*"", ""*\\sytem*"", ""*\\ytem*"", ""*\\am*"", ""*\\ecurity*"")"
"RestrictedAdminMode Registry Value Tampering - ProcCreation","frack113","Detects changes to the ""DisableRestrictedAdmin"" registry value in order to disable or enable RestrictedAdmin mode.
RestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.
This prevents your credentials from being harvested during the initial connection process if the remote server has been compromise
","attack.defense_evasion, attack.t1112","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the specific process that modified the registry value 
Check for any legitimate system changes or software installations that may have triggered the detection 
Correlate the event with system administrator activity logs to confirm authorized changes","Legitimate changes to the registry value by system administrators for valid reasons 
Updates or installations of software that may modify the registry value 
Changes made by security tools or scripts as part of legitimate operations","CommandLine=""*\\System\\CurrentControlSet\\Control\\Lsa\\*"" CommandLine=""*DisableRestrictedAdmin*"""
"LSA PPL Protection Disabled Via Reg.EXE","Florian Roth (Nextron Systems)","Detects the usage of the ""reg.exe"" utility to disable PPL protection on the LSA process","attack.defense_evasion, attack.t1562.010","process_creation","windows","Not classified","Verify the context in which reg.exe was executed, such as the user account, time of execution, and originating process 
Check if the modification to LSA settings aligns with any planned or authorized changes in the environment 
Review additional logs or system artifacts to corroborate the suspicious activity flagged by the rule 
Conduct interviews with system administrators or users to gather more information on the observed behavior","Legitimate system administration tasks may involve the use of reg.exe to modify LSA settings 
Software installations or updates may also trigger the use of reg.exe in a similar manner 
Security tools or scripts that interact with LSA settings may produce similar patterns","Image=""*\\reg.exe"" OR OriginalFileName=""reg.exe"" CommandLine=""*SYSTEM\\CurrentControlSet\\Control\\Lsa*"" CommandLine=""* add *"" CommandLine=""* /d 0*"" CommandLine=""* /v RunAsPPL *"""
"Enable LM Hash Storage - ProcCreation","Nasreddine Bencherchali (Nextron Systems)","Detects changes to the ""NoLMHash"" registry value in order to allow Windows to store LM Hashes.
By setting this registry value to ""0"" (DWORD), Windows will be allowed to store a LAN manager hash of your password in Active Directory and local SAM databases.
","attack.defense_evasion, attack.t1112","process_creation","windows","Not classified","Review system administrator activity logs to confirm if the change was authorized. 
Check change management records to validate if the modification was part of a scheduled update. 
Verify with the IT security team if any approved software installations necessitated the modification. 
Cross-reference with security policy documentation to ensure compliance with organizational requirements.","Legitimate changes to the NoLMHash registry value by system administrators for specific reasons. 
Changes made during authorized security configuration updates. 
Changes made during legitimate software installations that require LM Hash storage.","CommandLine=""*\\System\\CurrentControlSet\\Control\\Lsa*"" CommandLine=""*NoLMHash*"" CommandLine=""* 0*"""
"Potential Tampering With RDP Related Registry Keys Via Reg.EXE","pH-T (Nextron Systems), @Kostastsale, @TheDFIRReport","Detects the execution of ""reg.exe"" for enabling/disabling the RDP service on the host by tampering with the 'CurrentControlSet\Control\Terminal Server' values","attack.defense_evasion, attack.lateral_movement, attack.t1021.001, attack.t1112","process_creation","windows","Not classified","Review the command-line arguments of reg.exe processes to determine the specific registry keys being modified 
Check for any associated network connections or file modifications that may indicate malicious activity 
Correlate the timestamp of the reg.exe execution with other security events on the system for context 
Verify the legitimacy of the changes made to the RDP-related registry keys with the IT or security team","Legitimate changes to RDP settings by authorized administrators 
Software installations or updates that involve modifying RDP-related registry keys 
Scheduled tasks or scripts that interact with RDP configurations","Image=""*\\reg.exe"" OR OriginalFileName=""reg.exe"" CommandLine=""* add *"" CommandLine=""*\\CurrentControlSet\\Control\\Terminal Server*"" CommandLine=""*REG_DWORD*"" CommandLine=""* /f*"" (CommandLine=""*Licensing Core*"" CommandLine=""*EnableConcurrentSessions*"") OR CommandLine IN (""*WinStations\\RDP-Tcp*"", ""*MaxInstanceCount*"", ""*fEnableWinStation*"", ""*TSUserEnabled*"", ""*TSEnabled*"", ""*TSAppCompat*"", ""*IdleWinStationPoolCount*"", ""*TSAdvertise*"", ""*AllowTSConnections*"", ""*fSingleSessionPerUser*"", ""*fDenyTSConnections*"")"
"Reg Add Suspicious Paths","frack113, Nasreddine Bencherchali (Nextron Systems)","Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys","attack.defense_evasion, attack.t1112, attack.t1562.001","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the intent behind the registry modification 
Check if the registry modification is part of a known and approved change management process 
Correlate the event with other security events to determine if it is part of a larger attack pattern 
Investigate the reputation and behavior of the process and associated files for any signs of malicious activity","Legitimate system administration tasks may involve adding or modifying registry keys using reg.exe 
Software installations or updates may also use reg.exe to modify registry keys 
Scheduled tasks or scripts may legitimately interact with the registry using reg.exe","Image=""*\\reg.exe"" OR OriginalFileName=""reg.exe"" CommandLine IN (""*\\AppDataLow\\Software\\Microsoft\\*"", ""*\\Policies\\Microsoft\\Windows\\OOBE*"", ""*\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon*"", ""*\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon*"", ""*\\CurrentControlSet\\Control\\SecurityProviders\\WDigest*"", ""*\\Microsoft\\Windows Defender\\*"")"
"Disabled Volume Snapshots","Florian Roth (Nextron Systems)","Detects commands that temporarily turn off Volume Snapshots","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to understand the context of the command execution 
Check if there are any scheduled tasks or scripts known to interact with Volume Snapshots around the same time 
Correlate with backup software logs to verify if the action was initiated by a legitimate process 
Investigate the user context and permissions of the process to determine if it aligns with authorized actions","Scheduled maintenance tasks 
Backup software that temporarily disables Volume Snapshots for its own operations 
Scripting or automation tools that interact with Volume Shadow Copy Service (VSS)","CommandLine=""*\\Services\\VSS\\Diag*"" CommandLine=""*/d Disabled*"""
"Remote Access Tool - AnyDesk Silent Installation","Jn Trenansk","Detects AnyDesk Remote Desktop silent installation. Which can be used by attackers to gain remote access.","attack.command_and_control, attack.t1219","process_creation","windows","Not classified","Verify the source and integrity of the installation package 
Check if the installation was part of a planned deployment 
Review any change management records related to the installation 
Investigate the user account associated with the installation for any signs of compromise","Legitimate deployment scenarios where AnyDesk is installed silently for authorized purposes 
Automated deployment tools that use similar installation parameters 
Installation of other legitimate software that coincidentally uses similar flags","CommandLine=""*--install*"" CommandLine=""*--start-with-win*"" CommandLine=""*--silent*"""
"Remote Access Tool - Anydesk Execution From Suspicious Folder","Florian Roth (Nextron Systems)","An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.
These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.
Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)
","attack.command_and_control, attack.t1219","process_creation","windows","Not classified","Check if the AnyDesk execution was part of a scheduled task or legitimate IT operation 
Verify if the AnyDesk execution was initiated by authorized personnel or support teams 
Review the context of the execution to determine if it aligns with known upgrade or installation activities involving AnyDesk 
Cross-reference with change management records to confirm authorized changes related to AnyDesk","Legitimate use of AnyDesk from a non-standard folder 
Scheduled legitimate tasks involving AnyDesk 
Authorized use of AnyDesk by IT support teams 
Upgrades or installations of AnyDesk to new locations","Image=""*\\AnyDesk.exe"" OR Description=""AnyDesk"" OR Product=""AnyDesk"" OR Company=""AnyDesk Software GmbH"" NOT (Image IN (""*\\AppData\\*"", ""*Program Files (x86)\\AnyDesk*"", ""*Program Files\\AnyDesk*""))"
"Renamed AdFind Execution","Florian Roth (Nextron Systems)","Detects the use of a renamed Adfind.exe. AdFind continues to be seen across majority of breaches. It is used to domain trust discovery to plan out subsequent steps in the attack chain.","attack.discovery, attack.t1018, attack.t1087.002, attack.t1482, attack.t1069.002","process_creation","windows","Not classified","Verify the context in which AdFind.exe was executed (e.g., authorized user, legitimate use case) 
Check if there are any documented security tools or testing frameworks that rename AdFind.exe 
Correlate the command-line arguments with known legitimate tools or administrative tasks 
Investigate the presence of the specified hashes or imphashes in benign files or processes","Legitimate use of AdFind.exe in the environment for authorized purposes 
Renaming of AdFind.exe for legitimate reasons such as security tools or testing 
Use of similar command-line arguments for other legitimate tools 
Presence of the specified hashes or imphashes in benign scenarios","CommandLine IN (""*domainlist*"", ""*trustdmp*"", ""*dcmodes*"", ""*adinfo*"", ""* dclist *"", ""*computer_pwdnotreqd*"", ""*objectcategory=*"", ""*-subnets -f*"", ""*name=\""Domain Admins\""*"", ""*-sc u:*"", ""*domainncs*"", ""*dompol*"", ""* oudmp *"", ""*subnetdmp*"", ""*gpodmp*"", ""*fspdmp*"", ""*users_noexpire*"", ""*computers_active*"", ""*computers_pwdnotreqd*"") OR Imphash IN (""bca5675746d13a1f246e2da3c2217492"", ""53e117a96057eaf19c41380d0e87f1c2"") OR Hashes IN (""*IMPHASH=BCA5675746D13A1F246E2DA3C2217492*"", ""*IMPHASH=53E117A96057EAF19C41380D0E87F1C2*"") OR OriginalFileName=""AdFind.exe"" NOT Image=""*\\AdFind.exe"""
"Potential Defense Evasion Via Rename Of Highly Relevant Binaries","Matthew Green - @mgreen27, Florian Roth (Nextron Systems), frack113","Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.","attack.defense_evasion, attack.t1036.003, car.2013-05-009","process_creation","windows","Not classified","Check if the renamed binary is part of a known legitimate application or script 
Analyze the behavior of the process to determine if it aligns with malicious activities 
Verify if any security tools or EDR solutions on the system are responsible for the binary renaming","Legitimate software or custom scripts may rename binaries for specific purposes, which can trigger this detection 
Certain security tools or EDR solutions may rename binaries for obfuscation or protection purposes","Description=""Execute processes remotely"" OR Product=""Sysinternals PsExec"" OR Description IN (""Windows PowerShell*"", ""pwsh*"") OR OriginalFileName IN (""certutil.exe"", ""cmstp.exe"", ""cscript.exe"", ""mshta.exe"", ""msiexec.exe"", ""powershell_ise.exe"", ""powershell.exe"", ""psexec.c"", ""psexec.exe"", ""psexesvc.exe"", ""pwsh.dll"", ""reg.exe"", ""regsvr32.exe"", ""rundll32.exe"", ""WerMgr"", ""wmic.exe"", ""wscript.exe"") NOT (Image IN (""*\\certutil.exe"", ""*\\cmstp.exe"", ""*\\cscript.exe"", ""*\\mshta.exe"", ""*\\msiexec.exe"", ""*\\powershell_ise.exe"", ""*\\powershell.exe"", ""*\\psexec.exe"", ""*\\psexec64.exe"", ""*\\PSEXESVC.exe"", ""*\\pwsh.exe"", ""*\\reg.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\wermgr.exe"", ""*\\wmic.exe"", ""*\\wscript.exe""))"
"Renamed BrowserCore.EXE Execution","Max Altgelt (Nextron Systems)","Detects process creation with a renamed BrowserCore.exe (used to extract Azure tokens)","attack.t1528, attack.t1036.003","process_creation","windows","Not classified","Check the process command line arguments to understand the context of the execution 
Review the parent process and its behavior to determine if it's part of a normal operation 
Correlate with network logs to see if any suspicious network activity is associated with the process 
Investigate the file path and digital signature of the executed BrowserCore.exe for anomalies","Legitimate software or system updates may also involve process creation with a renamed BrowserCore.exe 
Development or testing environments where such behavior is expected 
Security tools or scripts that interact with processes and may trigger this detection 
Custom applications or scripts that use a similar naming convention for legitimate purposes","OriginalFileName=""BrowserCore.exe"" NOT Image=""*\\BrowserCore.exe"""
"Renamed CreateDump Utility Execution","Florian Roth (Nextron Systems)","Detects uses of a renamed legitimate createdump.exe LOLOBIN utility to dump process memory","attack.defense_evasion, attack.t1036, attack.t1003.001","process_creation","windows","Not classified","Check the process command line arguments for the presence of specific flags like '-u', '-f', and '.dmp' 
Verify the process image path to see if it ends with '\createdump.exe' 
Correlate the process execution with other security events to determine the context of the activity 
Investigate the parent-child process relationship to understand the execution chain","Legitimate use of createdump.exe for authorized memory dump operations 
Use of similar flags in benign processes 
Renaming of executables for legitimate purposes","OriginalFileName=""FX_VER_INTERNALNAME_STR"" OR (CommandLine=""* -u *"" CommandLine=""* -f *"" CommandLine=""*.dmp*"") OR (CommandLine=""* --full *"" CommandLine=""* --name *"" CommandLine=""*.dmp*"") NOT Image=""*\\createdump.exe"""
"Renamed ZOHO Dctask64 Execution","Florian Roth (Nextron Systems)","Detects a renamed dctask64.exe used for process injection, command execution, process creation with a signed binary by ZOHO Corporation","attack.defense_evasion, attack.t1036, attack.t1055.001, attack.t1202, attack.t1218","process_creation","windows","Not classified","Verify the legitimacy of the ZOHO software installation on the system 
Check if the process named dctask64.exe is a known and legitimate process in the environment 
Review security tools or scripts that may be interacting with processes and causing this detection","Legitimate use of ZOHO software may trigger this rule 
Legitimate process named dctask64.exe used in the environment 
Security tools or scripts that interact with processes may trigger this rule","Hashes=""*6834B1B94E49701D77CCB3C0895E1AFD*"" NOT Image=""*\\dctask64.exe"""
"Renamed Jusched.EXE Execution","Markus Neis, Swisscom","Detects the execution of a renamed ""jusched.exe"" as seen used by the cobalt group","attack.execution, attack.defense_evasion, attack.t1036.003","process_creation","windows","Not classified","Check the command-line arguments used when jusched.exe was executed 
Review the parent process of jusched.exe to identify the source of the execution 
Look for any network connections or unusual behavior associated with the execution of jusched.exe 
Compare the hash of the executed jusched.exe with known good hashes","Legitimate use of jusched.exe by Java updates 
Scheduled tasks or scripts that involve jusched.exe 
Renaming of jusched.exe for legitimate purposes","Description IN (""Java Update Scheduler"", ""Java(TM) Update Scheduler"") NOT Image=""*\\jusched.exe"""
"Renamed Mavinject.EXE Execution","frack113, Florian Roth","Detects the execution of a renamed version of the ""Mavinject"" process. Which can be abused to perform process injection using the ""/INJECTRUNNING"" flag","attack.defense_evasion, attack.privilege_escalation, attack.t1055.001, attack.t1218.013","process_creation","windows","Not classified","Check the parent process of the renamed Mavinject.EXE to determine if it is part of a legitimate operation 
Analyze the command-line arguments used during the execution of the renamed Mavinject.EXE for any suspicious behavior 
Correlate the execution of the renamed Mavinject.EXE with other security events to identify any related malicious activities 
Verify the digital signature of the renamed Mavinject.EXE to determine its authenticity","Legitimate use of tools that rename executables for benign purposes 
Legitimate software updates or installations that involve renaming files 
Legitimate security tools or EDR solutions that may rename files for protection purposes","OriginalFileName IN (""mavinject32.exe"", ""mavinject64.exe"") NOT (Image IN (""*\\mavinject32.exe"", ""*\\mavinject64.exe""))"
"Renamed MegaSync Execution","Sittikorn S","Detects the execution of a renamed MegaSync.exe as seen used by ransomware families like Nefilim, Sodinokibi, Pysa, and Conti.","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Check the file path of the executed process to verify if it is indeed MegaSync.exe 
Analyze the command-line arguments used during the process execution for any suspicious activity 
Review the parent process and its behavior to understand the context of the execution 
Cross-reference with endpoint security solutions or threat intelligence feeds for additional context","Legitimate software that uses a similar renaming convention 
Custom scripts or tools that involve renaming MegaSync.exe 
Updates or patches that may involve renaming MegaSync.exe","OriginalFileName=""megasync.exe"" NOT Image=""*\\megasync.exe"""
"Renamed Msdt.EXE Execution","pH-T (Nextron Systems)","Detects the execution of a renamed ""Msdt.exe"" binary","attack.defense_evasion, attack.t1036.003","process_creation","windows","Not classified","Check the parent process of the renamed Msdt.exe binary for any suspicious activity 
Review the command-line arguments used during the execution of the renamed Msdt.exe binary 
Look for any network connections or file modifications associated with the execution of the renamed Msdt.exe binary 
Correlate the event with other security logs to determine the context of the activity","Legitimate use of tools that involve renaming Msdt.exe for specific purposes 
Software installations that involve renaming Msdt.exe 
Updates or patches that involve renaming Msdt.exe","OriginalFileName=""msdt.exe"" NOT Image=""*\\msdt.exe"""
"Renamed NetSupport RAT Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of a renamed ""client32.exe"" (NetSupport RAT) via Imphash, Product and OriginalFileName strings","attack.defense_evasion","process_creation","windows","Not classified","Check the legitimacy of the process execution by verifying the context and purpose of NetSupport Remote Control software in the environment 
Investigate the reason behind the renaming of client32.exe to determine if it was done for a valid business reason 
Analyze the system to confirm if the Imphash value is associated with a benign application or process","Legitimate use of NetSupport Remote Control software 
Renaming of client32.exe for legitimate purposes 
Presence of the specified Imphash in non-malicious scenarios","Product=""*NetSupport Remote Control*"" OR OriginalFileName=""*client32.exe*"" OR Imphash=""a9d50692e95b79723f3e76fcf70d023e"" OR Hashes=""*IMPHASH=A9D50692E95B79723F3E76FCF70D023E*"" NOT Image=""*\\client32.exe"""
"Renamed Office Binary Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of a renamed office binary","attack.defense_evasion","process_creation","windows","Not classified","Review the process creation logs on the endpoint where the detection occurred 
Check for any legitimate software installations or updates that may have caused the binary renaming 
Investigate if any scripting or automation tools are being used on the system that could have renamed the binaries 
Look for any customized software deployment mechanisms in the environment that involve renaming binaries","Legitimate software installations or updates may involve renaming binaries temporarily 
Scripting or automation tools renaming binaries for legitimate purposes 
Customized software deployment mechanisms may involve renaming binaries","OriginalFileName IN (""Excel.exe"", ""MSACCESS.EXE"", ""MSPUB.EXE"", ""OneNote.exe"", ""OneNoteM.exe"", ""OUTLOOK.EXE"", ""POWERPNT.EXE"", ""WinWord.exe"") OR Description IN (""Microsoft Access"", ""Microsoft Excel"", ""Microsoft OneNote"", ""Microsoft Outlook"", ""Microsoft PowerPoint"", ""Microsoft Publisher"", ""Microsoft Word"", ""Sent to OneNote Tool"") NOT (Image IN (""*\\EXCEL.exe"", ""*\\excelcnv.exe"", ""*\\MSACCESS.exe"", ""*\\MSPUB.EXE"", ""*\\ONENOTE.EXE"", ""*\\ONENOTEM.EXE"", ""*\\OUTLOOK.EXE"", ""*\\POWERPNT.EXE"", ""*\\WINWORD.exe""))"
"Renamed PAExec Execution","Florian Roth (Nextron Systems), Jason Lynch","Detects execution of renamed version of PAExec. Often used by attackers","attack.defense_evasion, attack.t1202","process_creation","windows","Not classified","Check the command-line arguments used during the process execution to determine if PAExec was invoked with specific flags or parameters 
Review the parent process of the PAExec execution to understand the context in which it was launched 
Inspect the file path of the executed process to identify any unusual naming conventions or locations that may indicate a false positive 
Correlate the process execution with other security events or logs to determine if there are any indicators of compromise or malicious activity","Legitimate software installations that include PAExec and rename it for legitimate purposes 
Scheduled tasks or scripts that use PAExec and have been renamed for organizational reasons 
Updates or patches that modify PAExec and result in a different filename","Description=""PAExec Application"" OR OriginalFileName=""PAExec.exe"" OR Product=""*PAExec*"" OR Imphash IN (""11D40A7B7876288F919AB819CC2D9802"", ""6444f8a34e99b8f7d9647de66aabe516"", ""dfd6aa3f7b2b1035b76b718f1ddc689f"", ""1a6cca4d5460b1710a12dea39e4a592c"") OR Hashes IN (""*IMPHASH=11D40A7B7876288F919AB819CC2D9802*"", ""*IMPHASH=6444f8a34e99b8f7d9647de66aabe516*"", ""*IMPHASH=dfd6aa3f7b2b1035b76b718f1ddc689f*"", ""*IMPHASH=1a6cca4d5460b1710a12dea39e4a592c*"") NOT (Image IN (""*\\paexec.exe"", ""C:\\Windows\\PAExec-*""))"
"Renamed Plink Execution","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of a renamed version of the Plink binary","attack.defense_evasion, attack.t1036","process_creation","windows","Not classified","Check the legitimacy of the process by correlating with authorized activities or known software installations 
Review the command-line arguments used to determine if they align with expected legitimate use cases 
Investigate if there are any third-party tools or scripts that may have renamed Plink for compatibility reasons 
Cross-reference with endpoint security solutions or network logs to identify any suspicious behavior or indicators of compromise","Legitimate use of Plink for authorized activities 
Renaming of Plink for legitimate purposes 
Use of similar command-line arguments for other tools 
Third-party software renaming Plink for compatibility reasons","OriginalFileName=""Plink"" OR (CommandLine=""* -l forward*"" CommandLine=""* -P *"" CommandLine=""* -R *"") NOT Image=""*\\plink.exe"""
"Potential Renamed Rundll32 Execution","Nasreddine Bencherchali (Nextron Systems)","Detects when 'DllRegisterServer' is called in the commandline and the image is not rundll32. This could mean that the 'rundll32' utility has been renamed in order to avoid detection","attack.execution","process_creation","windows","Not classified","Review the commandline arguments of the process to understand the context of DllRegisterServer usage 
Check the system configuration for any legitimate reasons for renaming rundll32 
Correlate with other security events to determine if the activity is part of a larger malicious operation 
Investigate the parent processes and network connections of the suspicious process for additional context","Legitimate use of DllRegisterServer in non-malicious scenarios 
Legitimate renaming of rundll32 for specific system configurations 
Use of rundll32 in non-malicious activities 
Software installations that involve rundll32","CommandLine=""*DllRegisterServer*"" NOT Image=""*\\rundll32.exe"""
"Renamed SysInternals DebugView Execution","Florian Roth (Nextron Systems)","Detects suspicious renamed SysInternals DebugView execution","attack.resource_development, attack.t1588.002","process_creation","windows","Not classified","Check the reason for the execution of the renamed DebugView with the user or system owner 
Verify the legitimacy of the process by reviewing the parent-child process relationship 
Inspect the command-line arguments and parameters used during the execution 
Cross-reference the process execution with known software installations or updates on the system","Legitimate use of SysInternals DebugView with a valid reason for renaming the executable 
Custom scripts or applications that have a legitimate need to execute a renamed DebugView 
Legitimate software that renames executables for compatibility reasons","Product=""Sysinternals DebugView"" NOT (OriginalFileName=""Dbgview.exe"" Image=""*\\Dbgview.exe"")"
"Renamed ProcDump Execution","Florian Roth (Nextron Systems)","Detects the execution of a renamed ProcDump executable often used by attackers or malware","attack.defense_evasion, attack.t1036.003","process_creation","windows","Not classified","Check if the renamed ProcDump executable is part of a known legitimate software installation 
Verify if the ProcDump execution was initiated by authorized system administrators 
Review any documentation or change management records related to binary renaming 
Cross-reference with endpoint security solutions for additional context","Procdump bundled with legitimate software 
Legitimate use of ProcDump by system administrators 
Renaming of binaries by authorized personnel","OriginalFileName=""procdump"" OR (CommandLine IN (""* -ma *"", ""* /ma *"") CommandLine IN (""* -accepteula *"", ""* /accepteula *"")) NOT (Image IN (""*\\procdump.exe"", ""*\\procdump64.exe""))"
"Renamed PsExec Service Execution","Florian Roth (Nextron Systems)","Detects suspicious launch of a renamed version of the PSEXESVC service with, which is not often used by legitimate administrators","attack.execution","process_creation","windows","Not classified","Check the command-line arguments used to launch the process for any suspicious activity 
Review the parent process that initiated the execution of the renamed service 
Correlate the event with other security logs to determine the context of the activity 
Verify the digital signature of the renamed service executable","Legitimate use of PsExec for administrative purposes 
Renaming of the PSEXESVC service for authorized changes 
Third-party software that renames services for legitimate reasons","OriginalFileName=""psexesvc.exe"" NOT Image=""C:\\Windows\\PSEXESVC.exe"""
"Renamed Sysinternals Sdelete Execution","Florian Roth (Nextron Systems)","Detects the use of a renamed SysInternals Sdelete, which is something an administrator shouldn't do (the renaming)","attack.impact, attack.t1485","process_creation","windows","Not classified","Check the system administrator activity logs for any authorized renaming of Sdelete 
Verify if the renaming of Sdelete was part of a known software installation or update process 
Interview the system administrators to confirm if they have renamed Sdelete for legitimate reasons 
Analyze the context of the Sdelete renaming, such as the timing and the user involved","Legitimate use of renamed SysInternals Sdelete by system administrators 
Renaming of Sdelete as part of a legitimate software installation 
Renaming of Sdelete for testing or educational purposes","OriginalFileName=""sdelete.exe"" NOT (Image IN (""*\\sdelete.exe"", ""*\\sdelete64.exe""))"
"Renamed Vmnat.exe Execution","elhoim","Detects renamed vmnat.exe or portable version that can be used for DLL side-loading","attack.defense_evasion, attack.t1574.002","process_creation","windows","Not classified","Check the process command line arguments to understand the context of the execution 
Review the parent process and its legitimacy to determine if the execution is part of a known operation 
Inspect the file path and attributes of the executed file to identify any suspicious characteristics 
Correlate the event with other security logs to look for indicators of compromise or malicious behavior","Legitimate software installations or updates may involve renaming files, such as during software patching processes 
Custom scripts or applications that involve renaming files for specific purposes 
Legitimate user actions where files are renamed for organizational or personal reasons","OriginalFileName=""vmnat.exe"" NOT Image=""*vmnat.exe"""
"Renamed Whoami Execution","Florian Roth (Nextron Systems)","Detects the execution of whoami that has been renamed to a different name to avoid detection","attack.discovery, attack.t1033, car.2016-03-001","process_creation","windows","Not classified","Check the parent process of the renamed whoami.exe for any suspicious activity 
Analyze the command-line arguments used when executing the renamed whoami.exe 
Look for any network connections or file modifications associated with the execution of the renamed whoami.exe 
Correlate the event with other security events or alerts to determine the context of the activity","Legitimate software renaming executables for compatibility reasons 
Scripting or automation tools renaming files for specific tasks 
Security tools or EDR solutions renaming executables for obfuscation purposes","OriginalFileName=""whoami.exe"" NOT Image=""*\\whoami.exe"""
"Potential Rundll32 Execution With DLL Stored In ADS","Harjot Singh, '@cyb3rjy0t'","Detects execution of rundll32 where the DLL being called is stored in an Alternate Data Stream (ADS).","attack.defense_evasion, attack.t1564.004","process_creation","windows","Not classified","Review the command line arguments of rundll32 processes to identify the DLL being called 
Check the file path of the DLL to see if it is stored in an Alternate Data Stream 
Investigate the parent process and the context in which rundll32 is being executed 
Look for any legitimate reasons within the environment for rundll32 to execute with DLLs in ADS","Legitimate use of rundll32 with DLLs stored in ADS for specific applications 
Upgrades or installations of software that utilize rundll32 with DLLs in ADS 
Scripting or automation that involves rundll32 with DLLs in ADS","Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE""\"
"Suspicious Call by Ordinal","Florian Roth (Nextron Systems)","Detects suspicious calls of DLLs in rundll32.dll exports by ordinal","attack.defense_evasion, attack.t1218.011","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of the DLL call 
Check for whitelisted applications or scripts that may be triggering the detection 
Correlate with system changes or software updates to determine if the activity is expected 
Investigate the parent process and its purpose to assess the legitimacy of the DLL call","Legitimate administrative tools that use DLLs in rundll32.dll exports 
Scripting languages or automation tools that trigger similar patterns 
Updates or installations of software that involve DLL calls","Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" CommandLine IN (""*,#*"", ""*, #*"", ""*.dll #*"", ""*.ocx #*"") NOT ((CommandLine=""*EDGEHTML.dll*"" CommandLine=""*#141*"") OR (ParentImage IN (""*\\Msbuild\\Current\\Bin\\*"", ""*\\VC\\Tools\\MSVC\\*"", ""*\\Tracker.exe*"") CommandLine IN (""*\\FileTracker32.dll,#1*"", ""*\\FileTracker32.dll\"",#1*"", ""*\\FileTracker64.dll,#1*"", ""*\\FileTracker64.dll\"",#1*"")))"
"Suspicious Rundll32 Invoking Inline VBScript","Florian Roth (Nextron Systems)","Detects suspicious process related to rundll32 based on command line that invokes inline VBScript as seen being used by UNC2452","attack.defense_evasion, attack.t1055","process_creation","windows","Not classified","Check if the rundll32.exe process was executed from a trusted location or path 
Verify the context in which the rundll32.exe process was invoked (e.g., user context, network connections) 
Inspect the content of the VBScript being executed for any indicators of malicious intent 
Correlate the event with other security logs to determine if any other suspicious activities occurred around the same time","Legitimate use of rundll32.exe with inline VBScript for system administration tasks 
Legitimate software utilizing rundll32.exe with similar command line arguments 
Scripting frameworks or automation tools that may trigger similar behavior","CommandLine=""*rundll32.exe*"" CommandLine=""*Execute*"" CommandLine=""*RegRead*"" CommandLine=""*window.close*"""
"Suspicious Key Manager Access","Florian Roth (Nextron Systems)","Detects the invocation of the Stored User Names and Passwords dialogue (Key Manager)","attack.credential_access, attack.t1555.004","process_creation","windows","Not classified","Review the process command line arguments to understand the context of the Key Manager access 
Check if the access to the Key Manager aligns with any known administrative tasks or scripts 
Correlate the Key Manager access with other security events to determine if it is part of a larger attack campaign 
Investigate the user account associated with the process to determine if it is a legitimate action","Legitimate use of the Key Manager by system administrators 
Scheduled tasks or scripts that involve the Key Manager 
Third-party applications that interact with the Key Manager","Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" CommandLine=""*keymgr*"" CommandLine=""*KRShowKeyMgr*"""
"Mshtml.DLL RunHTMLApplication Suspicious Usage","Nasreddine Bencherchali (Nextron Systems),  Florian Roth (Nextron Systems), Josh Nickels, frack113, Zaw Min Htun (ZETA)","Detects execution of commands that leverage the ""mshtml.dll"" RunHTMLApplication export to run arbitrary code via different protocol handlers (vbscript, javascript, file, http...)
","attack.defense_evasion, attack.execution","process_creation","windows","Not classified","Check the parent process of the suspicious mshtml.dll execution to determine if it is part of a known application or process 
Analyze the command line arguments and parameters passed to mshtml.dll to identify the nature of the execution 
Review the network connections or file operations associated with the mshtml.dll execution for any malicious indicators 
Compare the behavior of the process with historical data to identify anomalies or deviations from normal activity","Legitimate use of mshtml.dll for web browsing or legitimate applications 
Development or testing environments where such commands are expected 
Scripting or automation tools that use mshtml.dll 
Updates or installations that involve mshtml.dll","CommandLine=""*\\..\\*"" CommandLine=""*mshtml*"" CommandLine IN (""*#135*"", ""*RunHTMLApplication*"")"
"Suspicious NTLM Authentication on the Printer Spooler Service","Elastic (idea), Tobias Michalski (Nextron Systems)","Detects a privilege elevation attempt by coercing NTLM authentication on the Printer Spooler service","attack.privilege_escalation, attack.credential_access, attack.t1212","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of the NTLM authentication attempt 
Check for any legitimate activities or configurations that may trigger false positives 
Correlate the suspicious activity with other security events to determine the scope of the potential threat 
Investigate the user context and permissions associated with the process for any anomalies","Legitimate use of NTLM authentication for printer-related activities 
Scheduled tasks or scripts that interact with the Printer Spooler service 
Updates or installations that involve the Printer Spooler service","Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" CommandLine=""*C:\\windows\\system32\\davclnt.dll,DavSetCookie*"" CommandLine=""*http*"" CommandLine IN (""*spoolss*"", ""*srvsvc*"", ""*/print/pipe/*"")"
"Process Memory Dump Via Comsvcs.DLL","Florian Roth (Nextron Systems), Modexp, Nasreddine Bencherchali (Nextron Systems)","Detects a process memory dump via ""comsvcs.dll"" using rundll32, covering multiple different techniques (ordinal, minidump function, etc.)","attack.defense_evasion, attack.credential_access, attack.t1036, attack.t1003.001, car.2013-05-009","process_creation","windows","Not classified","Review the parent process of rundll32.exe to determine if it is initiated by a trusted source or system operation 
Check if the memory dump operation is part of a scheduled task or legitimate system process 
Verify if any security tools or backup software are configured to perform memory dumps at the time of detection 
Investigate recent updates or installations that may involve memory dump functionality to rule out false positives","Legitimate use of rundll32.exe with comsvcs.dll for valid system operations 
Legitimate memory dump operations initiated by trusted processes 
Security tools or backup software performing memory dumps 
Updates or installations that involve memory dump functionality","(Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" OR CommandLine=""*rundll32*"" CommandLine=""*comsvcs*"" CommandLine=""*full*"" CommandLine IN (""*#-*"", ""*#+*"", ""*#24*"", ""*24 *"", ""*MiniDump*"")) OR (CommandLine=""*24*"" CommandLine=""*comsvcs*"" CommandLine=""*full*"" CommandLine IN (""* #*"", ""*,#*"", ""*, #*""))"
"Rundll32 Registered COM Objects","frack113","load malicious registered COM objects","attack.privilege_escalation, attack.persistence, attack.t1546.015","process_creation","windows","Not classified","Check the parent process of rundll32.exe to determine if it is initiated by a trusted application 
Analyze the command-line arguments of rundll32.exe to identify the COM objects being loaded 
Verify the presence of curly braces '{}' in the command line to indicate loading of COM objects 
Cross-reference with whitelists of known legitimate COM objects and their associated applications","Legitimate use of rundll32.exe for system operations 
Legitimate use of COM objects by trusted applications 
Legitimate use of -sta and -localserver parameters by valid software","Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" CommandLine IN (""*-sta *"", ""*-localserver *"") CommandLine=""*{*"" CommandLine=""*}*"""
"Shell32 DLL Execution in Suspicious Directory","Christian Burkard (Nextron Systems)","Detects shell32.dll executing a DLL in a suspicious directory","attack.defense_evasion, attack.execution, attack.t1218.011","process_creation","windows","Not classified","Review the parent process of rundll32.exe to determine if it is a known and trusted application 
Check if the DLL being executed by shell32.dll is a legitimate system file or a known software component 
Analyze the command-line arguments passed to rundll32.exe for any suspicious or unusual behavior 
Correlate the activity with other security events or logs to identify any related malicious behavior","Legitimate software installations that use shell32.dll in common directories 
Updates or patches that involve rundll32.exe and shell32.dll 
Scripting or automation tools that interact with shell32.dll","Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" CommandLine=""*shell32.dll*"" CommandLine=""*Control_RunDLL*"" CommandLine IN (""*%AppData%*"", ""*%LocalAppData%*"", ""*%Temp%*"", ""*%tmp%*"", ""*\\AppData\\*"", ""*\\Temp\\*"", ""*\\Users\\Public\\*"")"
"RunDLL32 Spawning Explorer","elhoim, CD_ROM_","Detects RunDLL32.exe spawning explorer.exe as child, which is very uncommon, often observes Gamarue spawning the explorer.exe process in an unusual way","attack.defense_evasion, attack.t1218.011","process_creation","windows","Not classified","Check the command-line arguments of the RunDLL32.exe process to determine the purpose of spawning explorer.exe 
Review the parent-child process relationship to identify the context of the execution 
Analyze the timing of the event to see if it coincides with known system activities or legitimate operations 
Correlate the event with other security telemetry to look for indicators of compromise or malicious behavior","Legitimate use of RunDLL32.exe to spawn explorer.exe for specific system operations 
Software installations that involve RunDLL32.exe and explorer.exe 
Scheduled tasks or scripts that use RunDLL32.exe to launch explorer.exe 
Updates or patches that trigger RunDLL32.exe to start explorer.exe","ParentImage=""*\\rundll32.exe"" Image=""*\\explorer.exe"" NOT ParentCommandLine=""*\\shell32.dll,Control_RunDLL*"""
"Suspicious Control Panel DLL Load","Florian Roth (Nextron Systems)","Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits","attack.defense_evasion, attack.t1218.011","process_creation","windows","Not classified","Review the command-line arguments of control.exe and rundll32.exe processes to identify the specific DLL being loaded 
Check for legitimate software installations or updates that may trigger this behavior 
Correlate with system logs to determine if the activity is part of a known and authorized process","Legitimate use of control.exe and rundll32.exe for system operations 
Updates or installations that involve loading DLLs 
Scripted actions that are part of normal system behavior","ParentImage=""*\\System32\\control.exe"" Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" NOT CommandLine=""*Shell32.dll*"""
"Suspicious Rundll32 Execution With Image Extension","Hieu Tran","Detects the execution of Rundll32.exe with DLL files masquerading as image files","attack.defense_evasion, attack.t1218.011","process_creation","windows","Not classified","Check the parent process of Rundll32.exe to determine if it is initiated from a trusted source 
Analyze the command line arguments passed to Rundll32.exe for any suspicious parameters or file paths 
Inspect the file path and extension of the image file being processed by Rundll32.exe for legitimacy 
Correlate the Rundll32.exe execution with other security events or logs to identify any related malicious activities","Legitimate use of Rundll32.exe with image files 
Updates or installations that involve Rundll32.exe and image extensions 
Scripted actions that utilize Rundll32.exe with image file formats","Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.exe"" CommandLine IN (""*.bmp*"", ""*.cr2*"", ""*.eps*"", ""*.gif*"", ""*.ico*"", ""*.jpeg*"", ""*.jpg*"", ""*.nef*"", ""*.orf*"", ""*.png*"", ""*.raw*"", ""*.sr2*"", ""*.tif*"", ""*.tiff*"")"
"Suspicious Usage Of ShellExec_RunDLL","Nasreddine Bencherchali (Nextron Systems)","Detects suspicious usage of the ShellExec_RunDLL function to launch other commands as seen in the the raspberry-robin attack","attack.defense_evasion","process_creation","windows","Not classified","Review the command-line arguments of the process to determine the context of the ShellExec_RunDLL usage 
Check if the process execution is part of a known and approved software installation 
Investigate the parent-child process relationship to identify the origin of the suspicious command execution 
Look for any additional indicators of compromise on the system such as new files or network connections","Legitimate use of ShellExec_RunDLL for system maintenance tasks 
Software installations that involve legitimate use of regsvr32 or msiexec 
Scripting or automation tools that use similar commands","CommandLine=""*ShellExec_RunDLL*"" CommandLine IN (""*regsvr32*"", ""*msiexec*"", ""*\\Users\\Public\\*"", ""*odbcconf*"", ""*\\Desktop\\*"", ""*\\Temp\\*"", ""*Invoke-*"", ""*iex*"", ""*comspec*"")"
"ShimCache Flush","Florian Roth (Nextron Systems)","Detects actions that clear the local ShimCache and remove forensic evidence","attack.defense_evasion, attack.t1112","process_creation","windows","Not classified","Check the legitimacy of the process and its associated command-line arguments 
Correlate with system and application update logs to determine if the activity is expected 
Verify if the action was triggered by a scheduled task or legitimate administrative activity 
Cross-reference with endpoint security logs to identify any security tool alerts or EDR activity","Legitimate software or system updates may trigger similar commands 
Administrators performing maintenance tasks may execute similar commands 
Security tools or EDR solutions may trigger false positives","(CommandLine=""*rundll32*"" CommandLine=""*apphelp.dll*"" CommandLine IN (""*ShimFlushCache*"", ""*#250*"")) OR (CommandLine=""*rundll32*"" CommandLine=""*kernel32.dll*"" CommandLine IN (""*BaseFlushAppcompatCache*"", ""*#46*""))"
"Suspicious Rundll32 Activity Invoking Sys File","Florian Roth (Nextron Systems)","Detects suspicious process related to rundll32 based on command line that includes a *.sys file as seen being used by UNC2452","attack.defense_evasion, attack.t1218.011","process_creation","windows","Not classified","Check the parent process of rundll32.exe to determine if it is initiated from a suspicious source 
Analyze the specific .sys file being invoked to verify its legitimacy and origin 
Correlate the rundll32.exe activity with other security events to identify any related malicious behavior 
Investigate network connections or file modifications associated with the suspicious rundll32 activity","Legitimate use of rundll32.exe with .sys files during system operations 
Software installations that involve .sys files 
Updates or patches that utilize rundll32.exe with .sys files","CommandLine=""*rundll32.exe*"" CommandLine IN (""*.sys,*"", ""*.sys *"")"
"Rundll32 UNC Path Execution","Nasreddine Bencherchali (Nextron Systems)","Detects rundll32 execution where the DLL is located on a remote location (share)","attack.defense_evasion, attack.execution, attack.t1021.002, attack.t1218.011","process_creation","windows","Not classified","Check if the rundll32 execution with UNC path is part of a known and approved process or script 
Review scheduled tasks or automated processes that involve rundll32 and UNC paths 
Analyze the network traffic to confirm communication with the remote location is expected 
Verify if there are legitimate software installations or updates occurring that trigger rundll32 with UNC paths","Legitimate use of rundll32 to load DLLs from network shares in specific environments 
Scheduled tasks or scripts that legitimately use rundll32 with UNC paths 
Updates or installations that involve rundll32 and network shares","Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" OR CommandLine=""*rundll32*"" CommandLine=""* \\\\*"""
"Rundll32 Execution Without Parameters","Bartlomiej Czyz, Relativity","Detects rundll32 execution without parameters as observed when running Metasploit windows/smb/psexec exploit module","attack.lateral_movement, attack.t1021.002, attack.t1570, attack.execution, attack.t1569.002","process_creation","windows","Not classified","Check the context of the rundll32 execution to see if it is part of a known legitimate process or activity 
Review the command line arguments and parent process to determine the origin of the rundll32 execution 
Correlate the rundll32 execution with other security events to identify any associated suspicious behavior 
Verify the reputation of the file path and parent process to assess the likelihood of malicious activity","User legitimately running rundll32 without parameters for a specific purpose 
Scheduled tasks or system processes invoking rundll32 without parameters 
Legitimate software installations or updates triggering rundll32 without parameters","CommandLine IN (""rundll32.exe"", ""rundll32"")"
"Suspicious Schtasks Execution AppData Folder","pH-T (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects the creation of a schtask that executes a file from C:\Users\<USER>\AppData\Local","attack.execution, attack.persistence, attack.t1053.005, attack.t1059.001","process_creation","windows","Not classified","Check the details of the scheduled task to determine its origin and purpose 
Review the command line arguments of the schtasks execution for any suspicious parameters 
Investigate the parent process that triggered the schtasks execution for any signs of compromise 
Correlate the schtasks execution with other security events or logs to identify any related malicious activities","Legitimate scheduled tasks that are created by system administrators 
Updates or installations that legitimately use schtasks 
Scheduled tasks created by trusted software installations","Image=""*\\schtasks.exe"" CommandLine=""*/Create*"" CommandLine=""*/RU*"" CommandLine=""*/TR*"" CommandLine=""*C:\\Users\\*"" CommandLine=""*\\AppData\\Local\\*"" CommandLine IN (""*NT AUT*"", ""* SYSTEM *"") NOT (ParentImage=""*\\AppData\\Local\\Temp\\*"" ParentImage=""*TeamViewer_.exe*"" Image=""*\\schtasks.exe"" CommandLine=""*/TN TVInstallRestore*"")"
"Suspicious Modification Of Scheduled Tasks","Nasreddine Bencherchali (Nextron Systems)","Detects when an attacker tries to modify an already existing scheduled tasks to run from a suspicious location
Attackers can create a simple looking task in order to avoid detection on creation as it's often the most focused on
Instead they modify the task after creation to include their malicious payload
","attack.execution, attack.t1053.005","process_creation","windows","Not classified","Review the command line arguments of the schtasks.exe process to identify the specific task being modified and the changes made 
Check the user context under which the schtasks.exe process is running to determine if it aligns with expected behavior 
Correlate the modification of scheduled tasks with other security events or logs to understand the context of the activity 
Investigate the history of the scheduled task to determine if the modification was authorized or expected","Legitimate changes to scheduled tasks by system administrators or automated processes 
Scheduled tasks that are legitimately modified by security tools or scripts 
Scheduled tasks modified during software installations or updates","Image=""*\\schtasks.exe"" CommandLine=""* /Change *"" CommandLine=""* /TN *"" CommandLine IN (""*\\AppData\\Local\\Temp*"", ""*\\AppData\\Roaming\\*"", ""*\\Users\\Public\\*"", ""*\\WINDOWS\\Temp\\*"", ""*\\Desktop\\*"", ""*\\Downloads\\*"", ""*\\Temporary Internet*"", ""*C:\\ProgramData\\*"", ""*C:\\Perflogs\\*"", ""*%ProgramData%*"", ""*%appdata%*"", ""*%comspec%*"", ""*%localappdata%*"") CommandLine IN (""*regsvr32*"", ""*rundll32*"", ""*cmd /c *"", ""*cmd /k *"", ""*cmd /r *"", ""*cmd.exe /c *"", ""*cmd.exe /k *"", ""*cmd.exe /r *"", ""*powershell*"", ""*mshta*"", ""*wscript*"", ""*cscript*"", ""*certutil*"", ""*bitsadmin*"", ""*bash.exe*"", ""*bash *"", ""*scrcons*"", ""*wmic *"", ""*wmic.exe*"", ""*forfiles*"", ""*scriptrunner*"", ""*hh.exe*"", ""*hh *"")"
"Suspicious Scheduled Task Creation Involving Temp Folder","Florian Roth (Nextron Systems)","Detects the creation of scheduled tasks that involves a temporary folder and runs only once","attack.execution, attack.persistence, attack.t1053.005","process_creation","windows","Not classified","Check the details of the scheduled task creation to determine if it was part of a legitimate administrative activity 
Review the purpose of the scheduled task to see if it aligns with known software installation processes 
Investigate if the scheduled task was created by a trusted system maintenance tool","Legitimate administrative tasks involving scheduled task creation 
Scripted software installations that use temporary folders 
Scheduled tasks created by system maintenance tools","Image=""*\\schtasks.exe"" CommandLine=""* /create *"" CommandLine=""* /sc once *"" CommandLine=""*\\Temp\\*"""
"Delete Important Scheduled Task","Nasreddine Bencherchali (Nextron Systems)","Detects when adversaries stop services or processes by deleting their respective scheduled tasks in order to conduct data destructive activities","attack.impact, attack.t1489","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to confirm the presence of '/delete' and '/tn' flags 
Check if the scheduled task being deleted is related to a known system process or maintenance task 
Correlate the event with other security logs to determine if the action was performed by an authorized user or an adversary 
Investigate the context of the deletion, such as the timing and the user account associated with the action","Legitimate administrative tasks may involve deleting scheduled tasks 
Scheduled task deletion as part of a known maintenance process 
Scheduled task deletion by authorized personnel for system cleanup","Image=""*\\schtasks.exe"" CommandLine=""*/delete*"" CommandLine=""*/tn*"" CommandLine IN (""*\\Windows\\SystemRestore\\SR*"", ""*\\Windows\\Windows Defender\\*"", ""*\\Windows\\BitLocker*"", ""*\\Windows\\WindowsBackup\\*"", ""*\\Windows\\WindowsUpdate\\*"", ""*\\Windows\\UpdateOrchestrator\\*"", ""*\\Windows\\ExploitGuard*"")"
"Delete All Scheduled Tasks","Nasreddine Bencherchali (Nextron Systems)","Detects the usage of schtasks with the delete flag and the asterisk symbol to delete all tasks from the schedule of the local computer, including tasks scheduled by other users.","attack.impact, attack.t1489","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to confirm the presence of '/delete', '/tn *', and '/f' flags 
Check if the process execution is part of a legitimate administrative task or script 
Correlate with other security events to determine the context of the activity 
Verify the user context and privileges of the process","Legitimate use of schtasks to delete all scheduled tasks 
Scheduled task management tools that use similar commands 
Scripting or automation that involves deleting scheduled tasks","Image=""*\\schtasks.exe"" CommandLine=""* /delete *"" CommandLine=""*/tn \**"" CommandLine=""* /f*"""
"Disable Important Scheduled Task","frack113, Nasreddine Bencherchali (Nextron Systems)","Detects when adversaries stop services or processes by disabling their respective scheduled tasks in order to conduct data destructive activities","attack.impact, attack.t1489","process_creation","windows","Not classified","Review the context around the event to determine if it was part of a known maintenance window or system change 
Check if the scheduled task was disabled by a legitimate user account or process 
Correlate with other security events to identify any suspicious activities before or after the task was disabled 
Investigate if there are any alerts or logs indicating unauthorized access or malicious activity on the system","Legitimate administrative actions may involve disabling scheduled tasks for maintenance purposes 
Software updates or installations may temporarily disable scheduled tasks 
Scheduled tasks may be disabled as part of a system configuration change","Image=""*\\schtasks.exe"" CommandLine=""*/Change*"" CommandLine=""*/TN*"" CommandLine=""*/disable*"" CommandLine IN (""*\\Windows\\SystemRestore\\SR*"", ""*\\Windows\\Windows Defender\\*"", ""*\\Windows\\BitLocker*"", ""*\\Windows\\WindowsBackup\\*"", ""*\\Windows\\WindowsUpdate\\*"", ""*\\Windows\\UpdateOrchestrator\\*"", ""*\\Windows\\ExploitGuard*"")"
"Schtasks From Suspicious Folders","Florian Roth (Nextron Systems)","Detects scheduled task creations that have suspicious action command and folder combinations","attack.execution, attack.t1053.005","process_creation","windows","Not classified","Review the scheduled task details to determine if the action command and folder combination is indeed suspicious 
Check the context of the scheduled task creation, such as the user context and time of creation 
Investigate the reputation of the file or command executed by the scheduled task 
Correlate with other security events to identify any related suspicious activities","Legitimate scheduled task creation by system administrators 
Scheduled tasks created by legitimate software installations 
Scheduled tasks created by endpoint management tools","Image=""*\\schtasks.exe"" OR OriginalFileName=""schtasks.exe"" CommandLine=""* /create *"" CommandLine IN (""*powershell*"", ""*pwsh*"", ""*cmd /c *"", ""*cmd /k *"", ""*cmd /r *"", ""*cmd.exe /c *"", ""*cmd.exe /k *"", ""*cmd.exe /r *"") CommandLine IN (""*C:\\ProgramData\\*"", ""*%ProgramData%*"")"
"Uncommon One Time Only Scheduled Task At 00:00","pH-T (Nextron Systems)","Detects scheduled task creation events that include suspicious actions, and is run once at 00:00","attack.execution, attack.persistence, attack.privilege_escalation, attack.t1053.005","process_creation","windows","Not classified","Review the command line arguments of the process creation event to identify the specific actions being performed 
Check the scheduled task details to determine if it was created by a legitimate process or user 
Correlate the scheduled task creation event with other security events to look for patterns of malicious behavior 
Verify the reputation of the process and associated files using threat intelligence feeds","Legitimate system maintenance tasks scheduled by administrators 
Scheduled backups configured by IT teams 
Updates initiated by trusted software applications","Image=""*\\schtasks.exe*"" OR OriginalFileName=""schtasks.exe"" CommandLine IN (""*wscript*"", ""*vbscript*"", ""*cscript*"", ""*wmic *"", ""*wmic.exe*"", ""*regsvr32.exe*"", ""*powershell*"", ""*\\AppData\\*"") CommandLine=""*once*"" CommandLine=""*00:00*"""
"Potential Persistence Via Powershell Search Order Hijacking - Task","pH-T (Nextron Systems), Florian Roth (Nextron Systems)","Detects suspicious powershell execution via a schedule task where the command ends with an suspicious flags to hide the powershell instance instead of executeing scripts or commands. This could be a sign of persistence via PowerShell ""Get-Variable"" technique as seen being used in Colibri Loader","attack.execution, attack.persistence, attack.t1053.005, attack.t1059.001","process_creation","windows","Not classified","Review the scheduled tasks on the system for any legitimate PowerShell executions 
Check if any administrative scripts are configured to run with similar flags 
Verify if any security tools or scripts are set to run with hidden windows","Legitimate use of PowerShell with scheduled tasks 
Administrative scripts utilizing similar flags 
Security tools or scripts designed to run with hidden windows","ParentImage=""C:\\WINDOWS\\System32\\svchost.exe"" ParentCommandLine=""*-k netsvcs*"" ParentCommandLine=""*-s Schedule*"" CommandLine IN (""* -windowstyle hidden"", ""* -w hidden"", ""* -ep bypass"", ""* -noni"")"
"Scheduled Task Executing Encoded Payload from Registry","pH-T (Nextron Systems), @Kostastsale, @TheDFIRReport, X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects the creation of a schtask that potentially executes a base64 encoded payload stored in the Windows Registry using PowerShell.","attack.execution, attack.persistence, attack.t1053.005, attack.t1059.001","process_creation","windows","Not classified","Review the details of the scheduled task to determine its purpose and origin 
Check if the base64 encoded payload is related to a known, authorized application or script 
Investigate the registry keys accessed by the scheduled task to identify any suspicious activity 
Analyze the PowerShell commands executed by the scheduled task for any malicious intent","Legitimate scheduled tasks that involve base64 encoding for benign purposes 
Scheduled tasks that interact with the registry for normal system operations 
Scheduled tasks that use PowerShell for legitimate administrative tasks","Image=""*\\schtasks.exe"" OR OriginalFileName=""schtasks.exe"" CommandLine=""*/Create*"" CommandLine IN (""*FromBase64String*"", ""*encodedcommand*"") CommandLine IN (""*Get-ItemProperty*"", ""* gp *"") CommandLine IN (""*HKCU:*"", ""*HKLM:*"", ""*registry::*"", ""*HKEY_*"")"
"Suspicious Schtasks Schedule Types","Nasreddine Bencherchali (Nextron Systems)","Detects scheduled task creations or modification on a suspicious schedule type","attack.execution, attack.t1053.005","process_creation","windows","Not classified","Review the command line arguments of the schtasks.exe process to understand the scheduled task being created or modified 
Check the context in which the scheduled task is being created or modified to determine if it aligns with legitimate activities 
Correlate the scheduled task creation/modification with other security events to identify any malicious behavior","Scheduled tasks legitimately created or modified by system administrators 
Scheduled tasks created by trusted automation scripts 
Scheduled tasks related to known software installations","Image=""*\\schtasks.exe"" OR OriginalFileName=""schtasks.exe"" CommandLine IN (""* ONLOGON *"", ""* ONSTART *"", ""* ONCE *"", ""* ONIDLE *"") NOT (CommandLine IN (""*NT AUT*"", ""* SYSTEM*"", ""*HIGHEST*""))"
"Script Event Consumer Spawning Process","Sittikorn S","Detects a suspicious child process of Script Event Consumer (scrcons.exe).","attack.execution, attack.t1047","process_creation","windows","Not classified","Check if the parent process is a legitimate system process or software 
Verify if the child process is related to a scheduled task or administrative activity 
Review any recent changes or configurations involving Script Event Consumer 
Correlate with other security events to determine the context of the process spawning","Legitimate use of scrcons.exe for system administration tasks 
Known software that may spawn child processes of scrcons.exe 
Script Event Consumer used in legitimate scheduled tasks","ParentImage=""*\\scrcons.exe"" Image IN (""*\\svchost.exe"", ""*\\dllhost.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\wscript.exe"", ""*\\cscript.exe"", ""*\\schtasks.exe"", ""*\\regsvr32.exe"", ""*\\mshta.exe"", ""*\\rundll32.exe"", ""*\\msiexec.exe"", ""*\\msbuild.exe"")"
"Possible Privilege Escalation via Weak Service Permissions","Teymur Kheirkhabarov","Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand","attack.persistence, attack.defense_evasion, attack.privilege_escalation, attack.t1574.011","process_creation","windows","Not classified","Review the command-line arguments of the sc.exe process to determine the intent of the command 
Check the user context under which the sc.exe process was executed 
Correlate the process creation event with other security events to identify any suspicious patterns 
Verify if the service ImagePath or FailureCommand was actually modified by the sc.exe process","Legitimate use of sc.exe by authorized administrators to manage services 
Updates or installations that legitimately require service configuration changes 
Third-party applications that use sc.exe for legitimate purposes","Image=""*\\sc.exe"" IntegrityLevel=""Medium"" (CommandLine=""*config*"" CommandLine=""*binPath*"") OR (CommandLine=""*failure*"" CommandLine=""*command*"")"
"Allow Service Access Using Security Descriptor Tampering Via Sc.EXE","Nasreddine Bencherchali (Nextron Systems)","Detects suspicious DACL modifications to allow access to a service from a suspicious trustee. This can be used to override access restrictions set by previous ACLs.","attack.persistence, attack.t1543.003","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the specific service being targeted 
Check for any legitimate administrative actions that may have caused the DACL modifications 
Correlate with other security events to determine if the modification was part of a larger attack campaign","Legitimate changes to service permissions by administrators 
Scheduled tasks or scripts that modify service permissions 
Updates or installations that require changes to service permissions","Image=""*\\sc.exe"" OR OriginalFileName=""sc.exe"" CommandLine=""*sdset*"" CommandLine=""*A;*"" CommandLine IN (""*;IU*"", ""*;SU*"", ""*;BA*"", ""*;SY*"", ""*;WD*"")"
"Deny Service Access Using Security Descriptor Tampering Via Sc.EXE","Jonhnathan Ribeiro, oscd.community","Detects suspicious DACL modifications to deny access to a service that affects critical trustees. This can be used to hide services or make them unstoppable.","attack.persistence, attack.t1543.003","process_creation","windows","Not classified","Review Windows security event logs for related service access events 
Check for legitimate service permission changes by authorized personnel 
Analyze the command-line arguments of the process for context and intent 
Correlate with network and endpoint logs to determine impact and scope","Legitimate changes to service permissions by administrators 
Scheduled service maintenance tasks 
Third-party software that legitimately interacts with service permissions","Image=""*\\sc.exe"" OR OriginalFileName=""sc.exe"" CommandLine=""*sdset*"" CommandLine=""*D;*"" CommandLine IN (""*;IU*"", ""*;SU*"", ""*;BA*"", ""*;SY*"", ""*;WD*"")"
"Service DACL Abuse To Hide Services Via Sc.EXE","Andreas Hunkeler (@Karneades)","Detects usage of the ""sc.exe"" utility adding a new service with special permission seen used by threat actors which makes the service hidden and unremovable.","attack.persistence, attack.defense_evasion, attack.privilege_escalation, attack.t1574.011","process_creation","windows","Not classified","Review Windows process creation logs for instances of sc.exe being used with suspicious command line parameters 
Check for any new hidden services created on the system 
Analyze the permissions of existing services to identify any unauthorized changes 
Correlate with network or endpoint logs to determine if the service is communicating with external entities","Legitimate use of sc.exe to manage Windows services 
Administrators making legitimate changes to service permissions 
Security tools or scripts using sc.exe for authorized actions","Image=""*\\sc.exe"" OR OriginalFileName=""sc.exe"" CommandLine=""*sdset*"" CommandLine=""*DCLCWPDTSD*"""
"Suspicious Service Path Modification","Victor Sergeev, oscd.community, Nasreddine Bencherchali (Nextron Systems)","Detects service path modification via the ""sc"" binary to a suspicious command or path","attack.persistence, attack.privilege_escalation, attack.t1543.003","process_creation","windows","Not classified","Review system administrator activity logs to confirm legitimate changes 
Check for software installations or updates around the same time as the detection 
Analyze scheduled tasks or scripts for modifications to service paths 
Correlate with authorized tools or scripts used in the environment","Legitimate changes to service paths by system administrators 
Updates or installations of legitimate software that may trigger similar commands 
Scheduled tasks or scripts that modify service paths 
Changes made by authorized tools or scripts","Image=""*\\sc.exe"" CommandLine=""*config*"" CommandLine=""*binPath*"" CommandLine IN (""*powershell*"", ""*cmd *"", ""*mshta*"", ""*wscript*"", ""*cscript*"", ""*rundll32*"", ""*svchost*"", ""*dllhost*"", ""*cmd.exe /c*"", ""*cmd.exe /k*"", ""*cmd.exe /r*"", ""*cmd /c*"", ""*cmd /k*"", ""*cmd /r*"", ""*C:\\Users\\Public*"", ""*\\Downloads\\*"", ""*\\Desktop\\*"", ""*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\*"", ""*C:\\Windows\\TEMP\\*"", ""*\\AppData\\Local\\Temp*"")"
"Sdiagnhost Calling Suspicious Child Process","Nextron Systems","Detects sdiagnhost.exe calling a suspicious child process (e.g. used in exploits for Follina / CVE-2022-30190)","attack.defense_evasion, attack.t1036, attack.t1218","process_creation","windows","Not classified","Review the command-line arguments of the sdiagnhost.exe process to understand the context of the child process execution 
Check the reputation and digital signatures of the child processes to determine if they are malicious 
Correlate the process creation events with other security logs to identify any related suspicious activities 
Investigate the parent-child process relationship to determine if the behavior is part of a legitimate or malicious activity","Legitimate use of sdiagnhost.exe calling known child processes during system maintenance or troubleshooting 
Scheduled tasks or scripts legitimately calling the listed child processes 
Third-party applications or security tools interacting with the listed child processes 
Known software installations or updates triggering the detection","ParentImage=""*\\sdiagnhost.exe"" Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\cmd.exe"", ""*\\mshta.exe"", ""*\\cscript.exe"", ""*\\wscript.exe"", ""*\\taskkill.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\calc.exe"")"
"Suspicious Serv-U Process Pattern","Florian Roth (Nextron Systems)","Detects a suspicious process pattern which could be a sign of an exploited Serv-U service","attack.credential_access, attack.t1555, cve.2021.35211","process_creation","windows","Not classified","Review the command-line arguments of the suspicious process to determine intent 
Check the process execution context for any abnormal behavior or anomalies 
Correlate with network logs to identify any unusual communication patterns with external hosts 
Verify the integrity of the Serv-U service binary and associated files for signs of compromise","Scheduled legitimate tasks that involve the listed executables 
Administrative scripts or tools that interact with Serv-U 
Known software installations that trigger the process pattern","ParentImage=""*\\Serv-U.exe"" Image IN (""*\\cmd.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\wscript.exe"", ""*\\cscript.exe"", ""*\\sh.exe"", ""*\\bash.exe"", ""*\\schtasks.exe"", ""*\\regsvr32.exe"", ""*\\wmic.exe"", ""*\\mshta.exe"", ""*\\rundll32.exe"", ""*\\msiexec.exe"", ""*\\forfiles.exe"", ""*\\scriptrunner.exe"")"
"Suspicious Splwow64 Without Params","Florian Roth (Nextron Systems)","Detects suspicious Splwow64.exe process without any command line parameters","attack.defense_evasion, attack.t1202","process_creation","windows","Not classified","Check the parent process of Splwow64.exe to determine if it is initiated by a legitimate process 
Review the process command line arguments to see if there are any hidden parameters or obfuscation techniques used 
Correlate the Splwow64.exe process with other events or logs to identify any suspicious behavior or patterns 
Compare the behavior of the process with historical data to determine if it deviates from normal activity","Legitimate use of Splwow64.exe without parameters 
Scheduled tasks or system processes launching Splwow64.exe without parameters 
Updates or installations triggering Splwow64.exe without parameters","Image=""*\\splwow64.exe"" CommandLine=""*splwow64.exe"""
"Suspicious Spool Service Child Process","Justin C. (@endisphotic), @dreadphones (detection), Thomas Patzke (Sigma rule)","Detects suspicious print spool service (spoolsv.exe) child processes.","attack.execution, attack.t1203, attack.privilege_escalation, attack.t1068","process_creation","windows","Not classified","Review the parent-child process relationship to determine if the activity is part of a legitimate operation. 
Check for any recent software installations or updates that may have triggered the suspicious child processes. 
Analyze the command-line arguments of the child processes to identify any unusual or unauthorized activities. 
Correlate the suspicious process activity with other security events or logs to understand the context of the activity.","Legitimate use of print spool service child processes for normal printing operations. 
Legitimate software or system tools launching child processes that match the suspicious criteria. 
Updates or installations that trigger child processes related to the print spool service. 
Scheduled tasks or scripts that involve print spool service child processes.","ParentImage=""*\\spoolsv.exe"" IntegrityLevel=""System"" Image IN (""*\\gpupdate.exe"", ""*\\whoami.exe"", ""*\\nltest.exe"", ""*\\taskkill.exe"", ""*\\wmic.exe"", ""*\\taskmgr.exe"", ""*\\sc.exe"", ""*\\findstr.exe"", ""*\\curl.exe"", ""*\\wget.exe"", ""*\\certutil.exe"", ""*\\bitsadmin.exe"", ""*\\accesschk.exe"", ""*\\wevtutil.exe"", ""*\\bcdedit.exe"", ""*\\fsutil.exe"", ""*\\cipher.exe"", ""*\\schtasks.exe"", ""*\\write.exe"", ""*\\wuauclt.exe"", ""*\\systeminfo.exe"", ""*\\reg.exe"", ""*\\query.exe"") OR (Image IN (""*\\net.exe"", ""*\\net1.exe"") NOT CommandLine=""*start*"") OR (Image=""*\\cmd.exe"" NOT (CommandLine IN (""*.spl*"", ""*route add*"", ""*program files*""))) OR (Image=""*\\netsh.exe"" NOT (CommandLine IN (""*add portopening*"", ""*rule name*""))) OR (Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") NOT CommandLine=""*.spl*"") OR (Image=""*\\rundll32.exe"" OR OriginalFileName=""RUNDLL32.EXE"" CommandLine=""*rundll32.exe"")"
"VeeamBackup Database Credentials Dump Via Sqlcmd.EXE","frack113","Detects dump of credentials in VeeamBackup dbo","attack.collection, attack.t1005","process_creation","windows","Not classified","Check if the sqlcmd.exe process was initiated by a scheduled task or script 
Verify if the query executed against the VeeamBackup database was part of a legitimate administrative action 
Review the context of the command line to determine if the query was intentional and authorized","Legitimate use of sqlcmd.exe for querying VeeamBackup database 
Scheduled tasks or scripts that involve querying VeeamBackup database 
Administrative actions that involve accessing VeeamBackup database credentials","Image=""*\\sqlcmd.exe"" CommandLine=""*SELECT*"" CommandLine=""*TOP*"" CommandLine=""*[VeeamBackup].[dbo].[Credentials]*"""
"SQLite Chromium Profile Data DB Access","TropChaud","Detect usage of the ""sqlite"" binary to query databases in Chromium-based browsers for potential data stealing.","attack.credential_access, attack.t1539, attack.t1555.003, attack.collection, attack.t1005","process_creation","windows","Not classified","Review the process command line arguments to understand the context of SQLite usage 
Check if the SQLite queries are related to legitimate browser activities or known development/testing tasks 
Correlate the SQLite activity with user authentication logs to determine if it aligns with authorized access patterns 
Investigate the reputation and history of the process accessing the SQLite databases","Legitimate use of SQLite for authorized purposes in Chromium-based browsers 
Development or testing activities involving SQLite and Chromium 
Automated scripts or tools that interact with SQLite databases in a benign manner","Product=""SQLite"" OR Image IN (""*\\sqlite.exe"", ""*\\sqlite3.exe"") CommandLine IN (""*\\User Data\\*"", ""*\\Opera Software\\*"", ""*\\ChromiumViewer\\*"") CommandLine IN (""*Login Data*"", ""*Cookies*"", ""*Web Data*"", ""*History*"", ""*Bookmarks*"")"
"SQLite Firefox Profile Data DB Access","frack113","Detect usage of the ""sqlite"" binary to query databases in Firefox and other Gecko-based browsers for potential data stealing.","attack.credential_access, attack.t1539, attack.collection, attack.t1005","process_creation","windows","Not classified","Review the process command line arguments to determine the context of SQLite usage 
Check if the SQLite activity is part of a known and authorized process or application 
Correlate the SQLite activity with other security events or logs to identify any malicious behavior 
Investigate the user account associated with the process for any signs of compromise","Legitimate use of SQLite for authorized purposes in Firefox or other applications 
Development or testing activities involving SQLite databases 
Third-party tools or utilities that interact with SQLite databases","Product=""SQLite"" OR Image IN (""*\\sqlite.exe"", ""*\\sqlite3.exe"") CommandLine IN (""*cookies.sqlite*"", ""*places.sqlite*"")"
"Potential RDP Tunneling Via SSH","Nasreddine Bencherchali (Nextron Systems)","Execution of ssh.exe to perform data exfiltration and tunneling through RDP","attack.command_and_control, attack.t1572","process_creation","windows","Not classified","Review the command-line arguments of the ssh.exe process to identify the target port 
Check for any unusual or unauthorized SSH connections to the RDP port 
Correlate process creation events with network traffic logs to identify potential data exfiltration 
Investigate the user context and source of the ssh.exe process for anomalies","Legitimate use of SSH for administrative purposes 
Use of legitimate tools for tunneling purposes 
SSH connections to non-standard ports","Image=""*\\ssh.exe"" CommandLine=""*:3389*"""
"Execution via stordiag.exe","Austin Songer (@austinsonger)","Detects the use of stordiag.exe to execute schtasks.exe systeminfo.exe and fltmc.exe","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Verify the legitimacy of the process execution by stordiag.exe. 
Check if the execution of schtasks.exe, systeminfo.exe, or fltmc.exe was part of a known operation. 
Review scheduled tasks and system information gathering activities on the host. 
Investigate any third-party applications that may interact with stordiag.exe.","Legitimate usage of stordiag.exe in specific environments. 
Scheduled tasks or system information gathering tools triggering the rule. 
Third-party applications that use stordiag.exe for valid purposes.","ParentImage=""*\\stordiag.exe"" Image IN (""*\\schtasks.exe"", ""*\\systeminfo.exe"", ""*\\fltmc.exe"") NOT (ParentImage IN (""c:\\windows\\system32\\*"", ""c:\\windows\\syswow64\\*""))"
"Abused Debug Privilege by Arbitrary Parent Processes","Semanur Guneysu @semanurtg, oscd.community","Detection of unusual child processes by different system processes","attack.privilege_escalation, attack.t1548","process_creation","windows","Not classified","Verify the legitimacy of the parent processes identified in the 'selection_parent' condition 
Review the user context provided in the 'selection_parent' condition for any authorized activities 
Inspect the child processes specified in the 'selection_img' condition to determine their purpose 
Analyze the command line arguments in the 'filter' condition to understand the specific commands being executed","Legitimate administrative tasks may trigger this rule 
Development or testing environments may exhibit similar behavior 
Certain security tools or scripts may also match this detection logic","ParentImage IN (""*\\winlogon.exe"", ""*\\services.exe"", ""*\\lsass.exe"", ""*\\csrss.exe"", ""*\\smss.exe"", ""*\\wininit.exe"", ""*\\spoolsv.exe"", ""*\\searchindexer.exe"") User IN (""*AUTHORI*"", ""*AUTORI*"") Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\cmd.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"", ""Cmd.Exe"") NOT (CommandLine=""* route *"" CommandLine=""* ADD *"")"
"User Added To Highly Privileged Group","Nasreddine Bencherchali (Nextron Systems)","Detects addition of users to highly privileged groups via ""Net"" or ""Add-LocalGroupMember"".","attack.persistence, attack.t1098","process_creation","windows","Not classified","Review the user account that performed the action for legitimacy 
Check if the activity was part of a documented change control process 
Correlate with ticketing system to verify authorized changes 
Investigate if the activity aligns with regular maintenance windows","Legitimate changes made by authorized administrators 
Scheduled system maintenance activities 
Changes made by automated scripts or tools","(CommandLine=""*localgroup *"" CommandLine=""* /add*"") OR (CommandLine=""*Add-LocalGroupMember *"" CommandLine=""* -Group *"") CommandLine IN (""*Group Policy Creator Owners*"", ""*Schema Admins*"")"
"User Added to Remote Desktop Users Group","Florian Roth (Nextron Systems)","Detects addition of users to the local Remote Desktop Users group via ""Net"" or ""Add-LocalGroupMember"".","attack.persistence, attack.lateral_movement, attack.t1133, attack.t1136.001, attack.t1021.001","process_creation","windows","Not classified","Check if the user addition was part of a scheduled task or script execution 
Verify if the user addition was performed by a privileged account 
Review the user addition in the context of other security events on the system 
Cross-reference with ticketing or change management systems for authorized changes","Legitimate user administration tasks 
Automated system processes 
Third-party applications that manage user groups","(CommandLine=""*localgroup *"" CommandLine=""* /add*"") OR (CommandLine=""*Add-LocalGroupMember *"" CommandLine=""* -Group *"") CommandLine IN (""*Remote Desktop Users*"", ""*Utilisateurs du Bureau  distance*"", ""*Usuarios de escritorio remoto*"")"
"Phishing Pattern ISO in Archive","Florian Roth (Nextron Systems)","Detects cases in which an ISO files is opend within an archiver like 7Zip or Winrar, which is a sign of phishing as threat actors put small ISO files in archives as email attachments to bypass certain filters and protective measures (mark of web)","attack.initial_access, attack.t1566","process_creation","windows","Not classified","Check the ParentImage and Image fields in the process creation logs to confirm the presence of the specified executables 
Review the context of the ISO file opening to determine if it was initiated by the user or automatically 
Correlate with network logs to identify any suspicious communication related to the opened ISO file 
Analyze the behavior of the system post ISO file opening for any signs of malicious activity","ISO files legitimately used within archives for non-phishing purposes 
ISO files opened by security researchers for analysis 
ISO files opened as part of legitimate software installation processes","ParentImage IN (""*\\Winrar.exe"", ""*\\7zFM.exe"", ""*\\peazip.exe"") Image IN (""*\\isoburn.exe"", ""*\\PowerISO.exe"", ""*\\ImgBurn.exe"")"
"Suspicious Child Process Created as System","Teymur Kheirkhabarov, Roberto Rodriguez (@Cyb3rWard0g), Open Threat Research (OTR)","Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE accounts","attack.privilege_escalation, attack.t1134.002","process_creation","windows","Not classified","Review the parent process and user context to determine if it is a known and authorized service 
Check if the child process is part of a legitimate operation or software installation 
Investigate the command line arguments of rundll32.exe to understand the purpose of the process","Legitimate use of SYSTEM privileges by authorized processes 
Legitimate child processes created by services running as SYSTEM 
Legitimate use of rundll32.exe with specific command line arguments","ParentUser IN (""*AUTHORI*"", ""*AUTORI*"") ParentUser IN (""*\\NETWORK SERVICE"", ""*\\LOCAL SERVICE"") User IN (""*AUTHORI*"", ""*AUTORI*"") User IN (""*\\SYSTEM"", ""*\\Systme"", ""*\\"") IntegrityLevel=""System"" NOT (Image=""*\\rundll32.exe"" CommandLine=""*DavSetCookie*"")"
"Potential Commandline Obfuscation Using Unicode Characters","frack113, Florian Roth (Nextron Systems)","Detects potential commandline obfuscation using unicode characters.
Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.
","attack.defense_evasion, attack.t1027","process_creation","windows","Not classified","Review the command line arguments for the process in question to understand the context of unicode characters 
Check if the unicode characters are part of a known legitimate application or script 
Analyze the behavior of the process to determine if the unicode characters are indicative of malicious activity 
Compare the command line arguments with baseline data to identify anomalies","Legitimate use of unicode characters in benign applications 
Scripting languages that use unicode characters for normal operations 
Legitimate use of unicode characters in non-malicious scripts","CommandLine IN (""**"", ""**"", ""**"") OR CommandLine IN (""**"", ""**"") OR CommandLine IN (""**"", ""**"") OR CommandLine IN (""**"", ""**"", ""**"", ""**"", ""**"", ""**"", ""**"")"
"Potential Crypto Mining Activity","Florian Roth (Nextron Systems)","Detects command line parameters or strings often used by crypto miners","attack.impact, attack.t1496","process_creation","windows","Not classified","Check if the detected command line parameters are part of authorized mining software installations 
Review the context of the process creation to determine if it aligns with legitimate activities 
Investigate the user or system context to understand if crypto mining is expected behavior 
Cross-reference the identified strings with known build frameworks or development tools","Legitimate use of mining software for authorized purposes 
Development environments using similar command line parameters 
Legitimate use of build frameworks","CommandLine IN (""* --cpu-priority=*"", ""*--donate-level=0*"", ""* -o pool.*"", ""* --nicehash*"", ""* --algo=rx/0 *"", ""*stratum+tcp://*"", ""*stratum+udp://*"", ""*LS1kb25hdGUtbGV2ZWw9*"", ""*0tZG9uYXRlLWxldmVsP*"", ""*tLWRvbmF0ZS1sZXZlbD*"", ""*c3RyYXR1bSt0Y3A6Ly*"", ""*N0cmF0dW0rdGNwOi8v*"", ""*zdHJhdHVtK3RjcDovL*"", ""*c3RyYXR1bSt1ZHA6Ly*"", ""*N0cmF0dW0rdWRwOi8v*"", ""*zdHJhdHVtK3VkcDovL*"") NOT (CommandLine IN (""* pool.c *"", ""* pool.o *"", ""*gcc -*""))"
"Raccine Uninstall","Florian Roth (Nextron Systems)","Detects commands that indicate a Raccine removal from an end system. Raccine is a free ransomware protection tool.","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Check the user context of the process that triggered the uninstall commands 
Review any associated ticket or change management request for the uninstall activity 
Correlate with other security tools or logs to verify if the uninstall was part of a planned activity 
Investigate if any new security software was installed around the time of the Raccine removal","Legitimate deinstallation by administrative staff 
Automated removal scripts used by security tools 
Temporary disabling of Raccine for system maintenance","(CommandLine=""*taskkill *"" CommandLine=""*RaccineSettings.exe*"") OR (CommandLine=""*reg.exe*"" CommandLine=""*delete*"" CommandLine=""*Raccine Tray*"") OR (CommandLine=""*schtasks*"" CommandLine=""*/DELETE*"" CommandLine=""*Raccine Rules Updater*"")"
"Suspicious Double Extension File Execution","Florian Roth (Nextron Systems), @blu3_team (idea), Nasreddine Bencherchali (Nextron Systems)","Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns","attack.initial_access, attack.t1566.001","process_creation","windows","Not classified","Review the process creation logs for the specific Image and CommandLine containing the suspicious double extension 
Check the reputation of the file and its source for any legitimate reasons for the double extension 
Analyze the behavior of the process to determine if it exhibits any malicious activities 
Inspect network connections or file modifications associated with the process for further context","Legitimate use of double extensions for specific applications 
Updates or installations that involve temporary double extensions 
Compression or archival tools that create double extensions 
Custom scripts or tools that intentionally use double extensions","Image IN (""*.doc.exe"", ""*.docx.exe"", ""*.xls.exe"", ""*.xlsx.exe"", ""*.ppt.exe"", ""*.pptx.exe"", ""*.rtf.exe"", ""*.pdf.exe"", ""*.txt.exe"", ""*      .exe"", ""*______.exe"", ""*.doc.js"", ""*.docx.js"", ""*.xls.js"", ""*.xlsx.js"", ""*.ppt.js"", ""*.pptx.js"", ""*.rtf.js"", ""*.pdf.js"", ""*.txt.js"") CommandLine IN (""*.doc.exe*"", ""*.docx.exe*"", ""*.xls.exe*"", ""*.xlsx.exe*"", ""*.ppt.exe*"", ""*.pptx.exe*"", ""*.rtf.exe*"", ""*.pdf.exe*"", ""*.txt.exe*"", ""*      .exe*"", ""*______.exe*"", ""*.doc.js*"", ""*.docx.js*"", ""*.xls.js*"", ""*.xlsx.js*"", ""*.ppt.js*"", ""*.pptx.js*"", ""*.rtf.js*"", ""*.pdf.js*"", ""*.txt.js*"")"
"Suspicious Parent Double Extension File Execution","frack113, Nasreddine Bencherchali (Nextron Systems)","Detect execution of suspicious double extension files in ParentCommandLine","attack.defense_evasion, attack.t1036.007","process_creation","windows","Not classified","Review the ParentCommandLine field in the process creation logs for the suspicious double extensions 
Check the reputation of the file hash or file path using threat intelligence sources like VirusTotal 
Correlate the process execution with other security events to determine the context of the suspicious activity 
Investigate the ParentImage field to identify the origin of the suspicious file execution","Legitimate use of double extensions in benign scenarios 
File renaming by users for personal organization 
Legitimate software installations that use double extensions 
Scripting languages that may use double extensions","ParentImage IN (""*.doc.lnk"", ""*.docx.lnk"", ""*.xls.lnk"", ""*.xlsx.lnk"", ""*.ppt.lnk"", ""*.pptx.lnk"", ""*.rtf.lnk"", ""*.pdf.lnk"", ""*.txt.lnk"", ""*.doc.js"", ""*.docx.js"", ""*.xls.js"", ""*.xlsx.js"", ""*.ppt.js"", ""*.pptx.js"", ""*.rtf.js"", ""*.pdf.js"", ""*.txt.js"") OR ParentCommandLine IN (""*.doc.lnk*"", ""*.docx.lnk*"", ""*.xls.lnk*"", ""*.xlsx.lnk*"", ""*.ppt.lnk*"", ""*.pptx.lnk*"", ""*.rtf.lnk*"", ""*.pdf.lnk*"", ""*.txt.lnk*"", ""*.doc.js*"", ""*.docx.js*"", ""*.xls.js*"", ""*.xlsx.js*"", ""*.ppt.js*"", ""*.pptx.js*"", ""*.rtf.js*"", ""*.pdf.js*"", ""*.txt.js*"")"
"Suspicious Download from Office Domain","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects suspicious ways to download files from Microsoft domains that are used to store attachments in Emails or OneNote documents","attack.command_and_control, attack.t1105, attack.t1608","process_creation","windows","Not classified","Review the command-line arguments of the process to determine the nature of the download activity 
Check the reputation of the process and associated domains using threat intelligence feeds 
Correlate the suspicious download activity with other security events for context 
Verify the legitimacy of the download by confirming it with the user or relevant team","Legitimate tools or scripts used for downloading attachments from Microsoft domains 
Scheduled tasks or automation scripts accessing the specified domains 
Authorized applications or services interacting with the mentioned URLs","Image IN (""*\\curl.exe"", ""*\\wget.exe"") OR CommandLine IN (""*Invoke-WebRequest*"", ""*iwr *"", ""*curl *"", ""*wget *"", ""*Start-BitsTransfer*"", ""*.DownloadFile(*"", ""*.DownloadString(*"") CommandLine IN (""*https://attachment.outlook.live.net/owa/*"", ""*https://onenoteonlinesync.onenote.com/onenoteonlinesync/*"")"
"DumpStack.log Defender Evasion","Florian Roth (Nextron Systems)","Detects the use of the filename DumpStack.log to evade Microsoft Defender","attack.defense_evasion","process_creation","windows","Not classified","Check the parent process of the suspicious activity to determine its origin 
Verify if the activity is part of a known and authorized operation on the system 
Inspect the command-line arguments and parameters used in the process creation 
Correlate the event with other security logs to identify any related suspicious activities","Legitimate use of the filename DumpStack.log by authorized system processes 
Use of similar filenames that are not related to evasion 
Use of DumpStack.log in non-Windows environments","Image=""*\\DumpStack.log"" OR CommandLine=""* -o DumpStack.log*"""
"ETW Logging Tamper In .NET Processes","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)","Detects changes to environment variables related to ETW logging. This could indicate potential adversaries stopping ETW providers recording loaded .NET assemblies.","attack.defense_evasion, attack.t1562","process_creation","windows","Not classified","Review the process creation logs for the affected process to identify the user/context making the changes 
Check for any legitimate reasons for the changes such as software updates or configuration modifications 
Correlate with other security events to determine if the change is part of a larger attack pattern 
Investigate the history of changes to the ETW logging environment variables to establish a baseline","Legitimate changes to ETW logging configurations by system administrators or applications 
Changes made during software updates or installations 
Changes made by security tools or monitoring solutions","CommandLine IN (""*COMPlus_ETWEnabled*"", ""*COMPlus_ETWFlags*"")"
"Disable of ETW Trace","@neu5ron, Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community","Detects a command that clears or disables any ETW trace log which could indicate a logging evasion.","attack.defense_evasion, attack.t1070, attack.t1562.006, car.2016-04-002","process_creation","windows","Not classified","Review the context of the command execution to determine if it was part of a legitimate administrative task. 
Check if the command was triggered by a known software installation or update process. 
Investigate if the command was executed as part of a scripted action or automation workflow. 
Verify if the command was initiated by a security tool or EDR solution for authorized monitoring purposes.","Legitimate administrative actions may involve disabling or clearing ETW traces. 
Software installations or updates may trigger actions similar to disabling ETW traces. 
Scripted actions or automation tasks could lead to false positives. 
Security tools or EDR solutions may interact with ETW traces for legitimate purposes.","(CommandLine=""*cl*"" CommandLine=""*/Trace*"") OR (CommandLine=""*clear-log*"" CommandLine=""*/Trace*"") OR (CommandLine=""*sl*"" CommandLine=""*/e:false*"") OR (CommandLine=""*set-log*"" CommandLine=""*/e:false*"") OR (CommandLine=""*logman*"" CommandLine=""*update*"" CommandLine=""*trace*"" CommandLine=""*--p*"" CommandLine=""*-ets*"") OR CommandLine=""*Remove-EtwTraceProvider*"" OR (CommandLine=""*Set-EtwTraceProvider*"" CommandLine=""*0x11*"")"
"Suspicious Eventlog Clear or Configuration Change","Ecco, Daniil Yugoslavskiy, oscd.community, D3F7A5105","Detects clearing or configuration of eventlogs using wevtutil, powershell and wmic. Might be used by ransomwares during the attack (seen by NotPetya and others).","attack.defense_evasion, attack.t1070.001, attack.t1562.002, car.2016-04-002","process_creation","windows","Not classified","Check for scheduled tasks or scripts that may be clearing event logs 
Review the activity of administrative users who have permissions to clear event logs 
Correlate with system maintenance schedules to rule out legitimate activities 
Analyze the context of the event log clearing to determine if it aligns with known maintenance activities","Admins performing legitimate event log maintenance 
Scheduled tasks or scripts that clear event logs 
Security tools or agents that manage event logs","(Image=""*\\wevtutil.exe"" CommandLine IN (""*clear-log *"", ""* cl *"", ""*set-log *"", ""* sl *"", ""*lfn:*"")) OR (Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"") CommandLine IN (""*Clear-EventLog *"", ""*Remove-EventLog *"", ""*Limit-EventLog *"", ""*Clear-WinEvent *"")) OR (Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\wmic.exe"") CommandLine=""*ClearEventLog*"") NOT (ParentImage IN (""C:\\Windows\\SysWOW64\\msiexec.exe"", ""C:\\Windows\\System32\\msiexec.exe"") CommandLine=""* sl *"")"
"Parent in Public Folder Suspicious Process","Florian Roth (Nextron Systems)","This rule detects suspicious processes with parent images located in the C:\Users\Public folder","attack.defense_evasion, attack.execution, attack.t1564, attack.t1059","process_creation","windows","Not classified","Review the parent-child process relationship to determine if the activity is part of a legitimate workflow 
Check for any scheduled tasks or scripts that may be triggering the suspicious processes 
Analyze the command line arguments of the processes to understand their intended purpose 
Correlate the process execution with user activity and other security events for context","Legitimate processes launched from the Public folder 
Scheduled tasks or scripts legitimately using Public folder paths 
Development or testing activities involving the Public folder","ParentImage=""C:\\Users\\Public\\*"" CommandLine IN (""*powershell*"", ""*cmd.exe /c *"", ""*cmd.exe /r *"", ""*cmd.exe /k *"", ""*cmd /c *"", ""*cmd /r *"", ""*cmd /k *"", ""*wscript.exe*"", ""*cscript.exe*"", ""*bitsadmin*"", ""*certutil*"", ""*mshta.exe*"")"
"Execution from Suspicious Folder","Florian Roth (Nextron Systems), Tim Shelton","Detects a suspicious execution from an uncommon folder","attack.defense_evasion, attack.t1036","process_creation","windows","Not classified","Review the command line and parent command line of the process to determine the nature of the execution 
Check the reputation of the process and the folder path from where it was executed 
Correlate with other security events or logs to identify any related suspicious activities 
Verify the legitimacy of the process and its execution context within the environment","Legitimate software installations may use some of the folders listed in the detection criteria 
Scheduled tasks or system processes may also trigger this detection 
Development or testing environments may have legitimate use cases for these folders","Image IN (""*\\$Recycle.bin\\*"", ""*\\config\\systemprofile\\*"", ""*\\Intel\\Logs\\*"", ""*\\RSA\\MachineKeys\\*"", ""*\\Users\\All Users\\*"", ""*\\Users\\Default\\*"", ""*\\Users\\NetworkService\\*"", ""*\\Users\\Public\\*"", ""*\\Windows\\addins\\*"", ""*\\Windows\\debug\\*"", ""*\\Windows\\Fonts\\*"", ""*\\Windows\\Help\\*"", ""*\\Windows\\IME\\*"", ""*\\Windows\\Media\\*"", ""*\\Windows\\repair\\*"", ""*\\Windows\\security\\*"", ""*\\Windows\\System32\\Tasks\\*"", ""*\\Windows\\Tasks\\*"") OR Image=""C:\\Perflogs\\*"" NOT (Image=""C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\*"" OR (Image=""C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\*"" Image=""*\\CitrixReceiverUpdater.exe""))"
"Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS","Nasreddine Bencherchali (Nextron Systems)","Detects execution of the built-in script located in ""C:\Windows\System32\gatherNetworkInfo.vbs"". Which can be used to gather information about the target machine","attack.discovery, attack.execution, attack.t1615, attack.t1059.005","process_creation","windows","Not classified","Review the command-line arguments passed to gatherNetworkInfo.vbs to determine the intent of the execution 
Check for any associated network connections or file modifications made by the script 
Correlate the execution of gatherNetworkInfo.vbs with other potentially malicious activities on the system 
Verify the legitimacy of the process by checking the parent process and user context","Legitimate use of gatherNetworkInfo.vbs for system administration purposes 
Scheduled tasks or scripts that legitimately use gatherNetworkInfo.vbs 
Third-party applications that use gatherNetworkInfo.vbs for benign purposes","CommandLine=""*gatherNetworkInfo.vbs*"" NOT (Image IN (""*\\cscript.exe"", ""*\\wscript.exe""))"
"Execution Of Non-Existing File","Max Altgelt (Nextron Systems)","Checks whether the image specified in a process creation event is not a full, absolute path (caused by process ghosting or other unorthodox methods to start a process)","attack.defense_evasion","process_creation","windows","Not classified","Review the process creation event logs for the specific image name 
Check if the process creation was triggered by a known application or system process 
Analyze the command line arguments associated with the process creation event 
Cross-reference with endpoint security solutions for any related alerts or behaviors","Legitimate use of relative paths in certain applications 
Script interpreters that do not require full paths 
Legitimate use of common system binaries with no path specified","NOT Image=""*\\*"" NOT (Image!=* OR Image IN (""-"", """") OR Image IN (""System"", ""Registry"", ""MemCompression"", ""vmmem"") OR CommandLine IN (""Registry"", ""MemCompression"", ""vmmem""))"
"Base64 MZ Header In CommandLine","Nasreddine Bencherchali (Nextron Systems)","Detects encoded base64 MZ header in the commandline","attack.execution","process_creation","windows","Not classified","Review the process command line arguments to understand the context of the base64 encoded MZ header 
Check if the process is a known and trusted application that may use base64 encoding 
Investigate the parent-child process relationship to determine the origin and purpose of the encoded data 
Analyze the behavior of the process for any other suspicious activities or indicators of compromise","Legitimate software using encoded data in the command line arguments 
Scripts or tools that have a valid reason to use base64 encoding in the command line 
Custom applications that use base64 encoding for legitimate purposes","CommandLine IN (""*TVqQAAMAAAAEAAAA*"", ""*TVpQAAIAAAAEAA8A*"", ""*TVqAAAEAAAAEABAA*"", ""*TVoAAAAAAAAAAAAA*"", ""*TVpTAQEAAAAEAAAA*"")"
"Potential WinAPI Calls Via CommandLine","Nasreddine Bencherchali (Nextron Systems)","Detects the use of WinAPI Functions via the commandline. As seen used by threat actors via the tool winapiexec","attack.execution, attack.t1106","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of WinAPI function calls 
Check if the process is a known system or application component that legitimately uses WinAPI functions 
Correlate with additional security tools or logs to determine if the behavior is part of a larger attack pattern 
Investigate the parent-child process relationship to identify the origin and purpose of the WinAPI calls","Legitimate use of WinAPI functions by trusted system administration tools 
Development or debugging activities that involve WinAPI calls 
Scripting or automation tasks that utilize WinAPI functions 
Custom applications or software that interact with WinAPI","CommandLine IN (""*AddSecurityPackage*"", ""*AdjustTokenPrivileges*"", ""*Advapi32*"", ""*CloseHandle*"", ""*CreateProcessWithToken*"", ""*CreatePseudoConsole*"", ""*CreateRemoteThread*"", ""*CreateThread*"", ""*CreateUserThread*"", ""*DangerousGetHandle*"", ""*DuplicateTokenEx*"", ""*EnumerateSecurityPackages*"", ""*FreeHGlobal*"", ""*FreeLibrary*"", ""*GetDelegateForFunctionPointer*"", ""*GetLogonSessionData*"", ""*GetModuleHandle*"", ""*GetProcAddress*"", ""*GetProcessHandle*"", ""*GetTokenInformation*"", ""*ImpersonateLoggedOnUser*"", ""*kernel32*"", ""*LoadLibrary*"", ""*memcpy*"", ""*MiniDumpWriteDump*"", ""*ntdll*"", ""*OpenDesktop*"", ""*OpenProcess*"", ""*OpenProcessToken*"", ""*OpenThreadToken*"", ""*OpenWindowStation*"", ""*PtrToString*"", ""*QueueUserApc*"", ""*ReadProcessMemory*"", ""*RevertToSelf*"", ""*RtlCreateUserThread*"", ""*secur32*"", ""*SetThreadToken*"", ""*VirtualAlloc*"", ""*VirtualFree*"", ""*VirtualProtect*"", ""*WaitForSingleObject*"", ""*WriteInt32*"", ""*WriteProcessMemory*"", ""*ZeroFreeGlobalAllocUnicode*"") NOT (Image=""*\\MpCmdRun.exe"" CommandLine=""*GetLoadLibraryWAddress32*"")"
"LSASS Dump Keyword In CommandLine","E.M. Anhaus, Tony Lambert, oscd.community, Nasreddine Bencherchali (Nextron Systems)","Detects the presence of the keywords ""lsass"" and "".dmp"" in the commandline, which could indicate a potential attempt to dump or create a dump of the lsass process.
","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Review the process command line arguments to understand the context of the LSASS dump keywords 
Check if the process execution is part of a known and approved operation 
Correlate with other security events to determine if there are indicators of malicious activity beyond the keyword match 
Investigate the user context and privileges of the process to assess the potential impact","Legitimate system administration tasks may involve dumping LSASS for troubleshooting purposes 
Development or testing environments may trigger this detection 
Certain security tools or scripts may use similar keywords in legitimate operations","CommandLine IN (""*lsass.dmp*"", ""*lsass.zip*"", ""*lsass.rar*"", ""*Andrew.dmp*"", ""*Coredump.dmp*"", ""*NotLSASS.zip*"", ""*lsass_2*"", ""*lsassdump*"", ""*lsassdmp*"") OR (CommandLine=""*lsass*"" CommandLine=""*.dmp*"") OR (CommandLine=""*SQLDmpr*"" CommandLine=""*.mdmp*"") OR (CommandLine=""*nanodump*"" CommandLine=""*.dmp*"")"
"Non-privileged Usage of Reg or Powershell","Teymur Kheirkhabarov (idea), Ryan Plas (rule), oscd.community","Search for usage of reg or Powershell by non-privileged users to modify service configuration in registry","attack.defense_evasion, attack.t1112","process_creation","windows","Not classified","Check the user account associated with the process to determine if it is a non-privileged user 
Review the specific commands executed to understand the intent behind the reg or Powershell usage 
Correlate the process creation event with other security events to identify any suspicious patterns or activities 
Verify if the modifications made to service configuration in the registry were authorized or unauthorized","Legitimate system administrators may use reg or Powershell for system maintenance tasks 
Automated scripts or tools may use reg or Powershell for legitimate purposes 
Development or testing environments may exhibit similar behavior","(CommandLine=""*reg *"" CommandLine=""*add*"") OR CommandLine IN (""*powershell*"", ""*set-itemproperty*"", ""* sp *"", ""*new-itemproperty*"") IntegrityLevel=""Medium"" CommandLine=""*ControlSet*"" CommandLine=""*Services*"" CommandLine IN (""*ImagePath*"", ""*FailureCommand*"", ""*ServiceDLL*"")"
"Suspicious Process Patterns NTDS.DIT Exfil","Florian Roth (Nextron Systems)","Detects suspicious process patterns used in NTDS.DIT exfiltration","attack.credential_access, attack.t1003.003","process_creation","windows","Not classified","Review the process command line arguments to understand the context of the access to NTDS.DIT 
Check the parent process and user context to determine if the activity is expected or suspicious 
Correlate the process execution with other security events to identify any related malicious activities 
Verify the reputation and integrity of the process and associated files for signs of compromise","Legitimate administrative tools or scripts accessing NTDS.DIT for authorized purposes 
Backup or monitoring tools that interact with NTDS.DIT 
Legitimate processes that may have similar command line patterns to exfiltration techniques","Image IN (""*\\NTDSDump.exe"", ""*\\NTDSDumpEx.exe"") OR (CommandLine=""*ntds.dit*"" CommandLine=""*system.hiv*"") OR CommandLine=""*NTDSgrab.ps1*"" OR (CommandLine=""*ac i ntds*"" CommandLine=""*create full*"") OR (CommandLine=""*/c copy *"" CommandLine=""*\\windows\\ntds\\ntds.dit*"") OR (CommandLine=""*activate instance ntds*"" CommandLine=""*create full*"") OR (CommandLine=""*powershell*"" CommandLine=""*ntds.dit*"") OR (CommandLine=""*ntds.dit*"" ParentImage IN (""*\\apache*"", ""*\\tomcat*"", ""*\\AppData\\*"", ""*\\Temp\\*"", ""*\\Public\\*"", ""*\\PerfLogs\\*"") OR Image IN (""*\\apache*"", ""*\\tomcat*"", ""*\\AppData\\*"", ""*\\Temp\\*"", ""*\\Public\\*"", ""*\\PerfLogs\\*""))"
"Suspicious Process Parents","Florian Roth (Nextron Systems)","Detects suspicious parent processes that should not have any children or should only have a single possible child program","attack.defense_evasion, attack.t1036","process_creation","windows","Not classified","Review the command-line arguments of the parent process and its children 
Check the reputation of the parent process and child processes 
Analyze the behavior of the processes in a sandbox environment 
Correlate with other security events to determine the context of the activity","Legitimate use of tools like bitsadmin.exe or winver.exe 
Parent processes spawning multiple legitimate child processes 
Scheduled tasks triggering specific parent processes 
Known software that exhibits this behavior","ParentImage IN (""*\\minesweeper.exe"", ""*\\winver.exe"", ""*\\bitsadmin.exe"") OR (ParentImage IN (""*\\csrss.exe"", ""*\\certutil.exe"", ""*\\eventvwr.exe"", ""*\\calc.exe"", ""*\\notepad.exe"") NOT (Image IN (""*\\WerFault.exe"", ""*\\wermgr.exe"", ""*\\conhost.exe"", ""*\\mmc.exe"", ""*\\win32calc.exe"", ""*\\notepad.exe"") OR Image!=*))"
"Potential PowerShell Execution Via DLL","Markus Neis, Nasreddine Bencherchali (Nextron Systems)","Detects potential PowerShell execution from a DLL instead of the usual PowerShell process as seen used in PowerShdll.
This detection assumes that PowerShell commands are passed via the CommandLine.
","attack.defense_evasion, attack.t1218.011","process_creation","windows","Not classified","Review the command-line arguments of the processes using InstallUtil.exe, RegAsm.exe, RegSvcs.exe, regsvr32.exe, rundll32.exe 
Check the parent-child process relationship to identify the origin of the suspicious activity 
Inspect the content of the DLLs loaded by the processes for any malicious payloads 
Correlate with network logs to see if there are any corresponding network communications","Legitimate use of InstallUtil.exe, RegAsm.exe, RegSvcs.exe, regsvr32.exe, rundll32.exe 
Legitimate use of PowerShell commands in the CommandLine 
Legitimate use of DLLs in the environment","Image IN (""*\\InstallUtil.exe"", ""*\\RegAsm.exe"", ""*\\RegSvcs.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"") OR OriginalFileName IN (""InstallUtil.exe"", ""RegAsm.exe"", ""RegSvcs.exe"", ""REGSVR32.EXE"", ""RUNDLL32.EXE"") CommandLine IN (""*Default.GetString*"", ""*DownloadString*"", ""*FromBase64String*"", ""*ICM *"", ""*IEX *"", ""*Invoke-Command*"", ""*Invoke-Expression*"")"
"Privilege Escalation via Named Pipe Impersonation","Tim Rauch, Elastic (idea)","Detects a remote file copy attempt to a hidden network share. This may indicate lateral movement or data staging activity.","attack.lateral_movement, attack.t1021","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of the file copy attempt 
Check if the file copy operation was part of a scheduled task or a known administrative process 
Investigate the network share to determine if it is a legitimate destination or a suspicious location 
Correlate the process creation event with other security events to identify any related suspicious activities","Legitimate administrative tasks that involve copying files to hidden network shares 
Backup software that uses named pipes for communication 
Scripting or automation tools that utilize named pipes for inter-process communication 
Legitimate software installations that involve named pipes","Image IN (""*\\cmd.exe"", ""*\\powershell.exe"") OR OriginalFileName IN (""Cmd.Exe"", ""PowerShell.EXE"") CommandLine=""*echo*"" CommandLine=""*>*"" CommandLine=""*\\\\.\\pipe\\*"""
"Suspicious Program Names","Florian Roth (Nextron Systems)","Detects suspicious patterns in program names or folders that are often found in malicious samples or hacktools","attack.execution, attack.t1059","process_creation","windows","Not classified","Review the parent process of the suspicious program name to understand the context 
Check the current directory of the process for any additional clues 
Verify the reputation of the program or folder using threat intelligence feeds 
Analyze the behavior of the process for any malicious activities","Development tools that use similar naming conventions 
Custom scripts or utilities created by the organization 
Legitimate software that may have obfuscated names","Image IN (""*\\CVE-202*"", ""*\\CVE202*"") OR Image IN (""*\\poc.exe"", ""*\\artifact.exe"", ""*\\artifact64.exe"", ""*\\artifact_protected.exe"", ""*\\artifact32.exe"", ""*\\artifact32big.exe"", ""*obfuscated.exe"", ""*obfusc.exe"", ""*\\meterpreter"") OR CommandLine IN (""*inject.ps1*"", ""*Invoke-CVE*"", ""*pupy.ps1*"", ""*payload.ps1*"", ""*beacon.ps1*"", ""*PowerView.ps1*"", ""*bypass.ps1*"", ""*obfuscated.ps1*"", ""*obfusc.ps1*"", ""*obfus.ps1*"", ""*obfs.ps1*"", ""*evil.ps1*"", ""*MiniDogz.ps1*"", ""*_enc.ps1*"", ""*\\shell.ps1*"", ""*\\rshell.ps1*"", ""*revshell.ps1*"", ""*\\av.ps1*"", ""*\\av_test.ps1*"", ""*adrecon.ps1*"", ""*mimikatz.ps1*"", ""*\\PowerUp_*"", ""*powerup.ps1*"", ""*\\Temp\\a.ps1*"", ""*\\Temp\\p.ps1*"", ""*\\Temp\\1.ps1*"", ""*Hound.ps1*"", ""*encode.ps1*"", ""*powercat.ps1*"")"
"Suspicious Redirection to Local Admin Share","Florian Roth (Nextron Systems)","Detects a suspicious output redirection to the local admins share, this technique is often found in malicious scripts or hacktool stagers","attack.exfiltration, attack.t1048","process_creation","windows","Not classified","Review the command line arguments of the process that triggered the detection 
Check if there are legitimate reasons for the redirection to the local admin share 
Investigate the process reputation and behavior for any signs of malicious activity 
Correlate with other security events to determine the context of the suspicious redirection","Legitimate administrative tasks that involve redirection to local admin shares 
Scheduled tasks or scripts that redirect output to admin shares 
Backup or synchronization processes that use admin shares for storage","CommandLine=""*>*"" CommandLine IN (""*\\\\127.0.0.1\\admin$\\*"", ""*\\\\localhost\\admin$\\*"")"
"Potential Defense Evasion Via Right-to-Left Override","Micah Babinski, @micahbabinski","Detects the presence of the ""u202+E"" character, which causes a terminal, browser, or operating system to render text in a right-to-left sequence.
This is used as an obfuscation and masquerading techniques.
","attack.defense_evasion, attack.t1036.002","process_creation","windows","Not classified","Review the command line arguments of the process to identify the presence of the right-to-left override character 
Check if the process is related to known applications or scripts that use this character 
Analyze the context of the command line to determine if the usage is legitimate or suspicious 
Correlate with other security events to understand the full scope of the potential defense evasion","Legitimate use of right-to-left languages like Arabic or Hebrew 
Development tools or scripts that intentionally use this character 
Certain applications that use this character for legitimate purposes","CommandLine=""**"""
"Script Interpreter Execution From Suspicious Folder","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects a suspicious script execution in temporary folders or folders accessible by environment variables","attack.execution, attack.t1059","process_creation","windows","Not classified","Review the command-line arguments of the process to determine the nature of the script being executed 
Check the parent process and user context to understand the origin and intent of the script execution 
Verify the reputation of the script interpreter and the accessed folders for any legitimate use cases 
Correlate the event with other security logs to identify any related suspicious activities or indicators of compromise","Legitimate script execution from common temporary folders 
Scheduled tasks or legitimate scripts running from accessible folders 
Development or administrative tools that execute scripts from monitored locations 
Script execution as part of authorized software installation or updates","Image IN (""*\\cscript.exe"", ""*\\mshta.exe"", ""*\\wscript.exe"") OR CommandLine IN (""* -ep bypass *"", ""* -ExecutionPolicy bypass *"", ""* -w hidden *"", ""*/e:javascript *"", ""*/e:Jscript *"", ""*/e:vbscript *"") OR OriginalFileName IN (""cscript.exe"", ""mshta.exe"", ""wscript.exe"") CommandLine IN (""*:\\Perflogs\\*"", ""*:\\Users\\Public\\*"", ""*\\AppData\\Local\\Temp*"", ""*\\AppData\\Roaming\\Temp*"", ""*\\Temporary Internet*"", ""*\\Windows\\Temp*"") OR (CommandLine=""*:\\Users\\*"" CommandLine=""*\\Favorites\\*"") OR (CommandLine=""*:\\Users\\*"" CommandLine=""*\\Favourites\\*"") OR (CommandLine=""*:\\Users\\*"" CommandLine=""*\\Contacts\\*"")"
"Suspicious Script Execution From Temp Folder","Florian Roth (Nextron Systems), Max Altgelt (Nextron Systems), Tim Shelton","Detects a suspicious script executions from temporary folder","attack.execution, attack.t1059","process_creation","windows","Not classified","Review the command line arguments of the process to determine the nature of the script being executed 
Check the parent process and user context to understand the origin of the suspicious script execution 
Look for any network connections or file modifications associated with the script execution 
Correlate the event with other security logs to identify any related suspicious activities","Scheduled tasks that run legitimate scripts from temporary folders 
Software installations that extract files to temporary folders 
Development environments where scripts are tested in temporary folders","Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\mshta.exe"", ""*\\wscript.exe"", ""*\\cscript.exe"") CommandLine IN (""*\\Windows\\Temp*"", ""*\\Temporary Internet*"", ""*\\AppData\\Local\\Temp*"", ""*\\AppData\\Roaming\\Temp*"", ""*%TEMP%*"", ""*%TMP%*"", ""*%LocalAppData%\\Temp*"") NOT (CommandLine IN (""* >*"", ""*Out-File*"", ""*ConvertTo-Json*"", ""*-WindowStyle hidden -Verb runAs*"", ""*\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\Temp\\Amazon\\EC2-Windows\\*""))"
"Sensitive File Access Via Volume Shadow Copy Backup","Max Altgelt (Nextron Systems), Tobias Michalski (Nextron Systems)","Detects a command that accesses the VolumeShadowCopy in order to extract sensitive files such as the Security or SAM registry hives or the AD database (ntds.dit)
","attack.impact, attack.t1490","process_creation","windows","Not classified","Review the command-line arguments of the process that triggered the detection 
Check if the access to Volume Shadow Copy was part of a scheduled backup job 
Correlate the activity with legitimate system administration tasks that involve accessing Volume Shadow Copies 
Verify if the accessed files are indeed sensitive and unauthorized","Legitimate backup or restore operations may trigger this detection 
Certain system maintenance or monitoring tools may access Volume Shadow Copies 
File synchronization software may interact with Volume Shadow Copies","CommandLine=""*\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy*"" CommandLine IN (""*\\NTDS.dit*"", ""*\\SYSTEM*"", ""*\\SECURITY*"")"
"Suspicious New Service Creation","Nasreddine Bencherchali (Nextron Systems)","Detects creation of a new service via ""sc"" command or the powershell ""new-service"" cmdlet with suspicious binary paths","attack.persistence, attack.privilege_escalation, attack.t1543.003","process_creation","windows","Not classified","Check the service name and binary path to determine if it matches known legitimate software 
Review the user context under which the service creation occurred 
Correlate with other security events to identify any related suspicious activities 
Verify if the service creation was part of a planned change or maintenance activity","Legitimate service creation by system administrators 
Software installations that create services 
Scheduled tasks that create services","(Image=""*\\sc.exe"" CommandLine=""*create*"" CommandLine=""*binPath=*"") OR (CommandLine=""*New-Service*"" CommandLine=""*-BinaryPathName*"") CommandLine IN (""*powershell*"", ""*mshta*"", ""*wscript*"", ""*cscript*"", ""*svchost*"", ""*dllhost*"", ""*cmd *"", ""*cmd.exe /c*"", ""*cmd.exe /k*"", ""*cmd.exe /r*"", ""*rundll32*"", ""*C:\\Users\\Public*"", ""*\\Downloads\\*"", ""*\\Desktop\\*"", ""*\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\*"", ""*C:\\Windows\\TEMP\\*"", ""*\\AppData\\Local\\Temp*"")"
"Suspicious Service Binary Directory","Florian Roth (Nextron Systems)","Detects a service binary running in a suspicious directory","attack.defense_evasion, attack.t1202","process_creation","windows","Not classified","Review the process creation logs for the identified suspicious directories and parent processes 
Check if the binaries in the suspicious directories are digitally signed and have legitimate purposes 
Investigate the context of the process execution to determine if it aligns with normal system behavior 
Correlate with other security events or alerts to identify any potential malicious activities","Legitimate software installations may use these directories 
Temporary files or folders created by applications 
Custom configurations that intentionally place binaries in these directories","Image IN (""*\\Users\\Public\\*"", ""*\\$Recycle.bin*"", ""*\\Users\\All Users\\*"", ""*\\Users\\Default\\*"", ""*\\Users\\Contacts\\*"", ""*\\Users\\Searches\\*"", ""*C:\\Perflogs\\*"", ""*\\config\\systemprofile\\*"", ""*\\Windows\\Fonts\\*"", ""*\\Windows\\IME\\*"", ""*\\Windows\\addins\\*"") ParentImage IN (""*\\services.exe"", ""*\\svchost.exe"")"
"Shadow Copies Deletion Using Operating Systems Utilities","Florian Roth (Nextron Systems), Michael Haag, Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community, Andreas Hunkeler (@Karneades)","Shadow Copies deletion using operating systems utilities","attack.defense_evasion, attack.impact, attack.t1070, attack.t1490","process_creation","windows","Not classified","Check if the deletion was performed by a privileged user account 
Review the context of the deletion command to determine if it aligns with known maintenance activities 
Correlate the deletion event with other system events to identify any patterns of legitimate activity 
Verify if the deletion was part of a scheduled task or backup operation","Legitimate Administrator performing maintenance tasks on the system 
Scheduled backup software deleting old shadow copies 
Automated system cleanup scripts removing unnecessary files 
Security software performing system scans","(Image IN (""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\wmic.exe"", ""*\\vssadmin.exe"", ""*\\diskshadow.exe"") OR OriginalFileName IN (""PowerShell.EXE"", ""pwsh.dll"", ""wmic.exe"", ""VSSADMIN.EXE"", ""diskshadow.exe"") CommandLine=""*shadow*"" CommandLine=""*delete*"") OR (Image=""*\\wbadmin.exe"" OR OriginalFileName=""WBADMIN.EXE"" CommandLine=""*delete*"" CommandLine=""*catalog*"" CommandLine=""*quiet*"") OR (Image=""*\\vssadmin.exe"" OR OriginalFileName=""VSSADMIN.EXE"" CommandLine=""*resize*"" CommandLine=""*shadowstorage*"" CommandLine IN (""*unbounded*"", ""*/MaxSize=*""))"
"Windows Shell/Scripting Processes Spawning Suspicious Programs","Florian Roth (Nextron Systems), Tim Shelton","Detects suspicious child processes of a Windows shell and scripting processes such as wscript, rundll32, powershell, mshta...etc.","attack.execution, attack.defense_evasion, attack.t1059.005, attack.t1059.001, attack.t1218","process_creation","windows","Not classified","Check the command line arguments of the suspicious child processes to determine the nature of the spawned processes 
Review the parent processes and their command lines to understand the context of the suspicious activity 
Investigate the current directory of the processes to identify any unusual locations being accessed 
Correlate with network logs to see if there are any corresponding network connections to potentially malicious destinations","Administrative scripts are known to trigger this rule 
Legitimate use of Microsoft SCCM may also trigger this rule","ParentImage IN (""*\\mshta.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\rundll32.exe"", ""*\\cscript.exe"", ""*\\wscript.exe"", ""*\\wmiprvse.exe"", ""*\\regsvr32.exe"") Image IN (""*\\schtasks.exe"", ""*\\nslookup.exe"", ""*\\certutil.exe"", ""*\\bitsadmin.exe"", ""*\\mshta.exe"") NOT (CurrentDirectory=""*\\ccmcache\\*"" OR ParentCommandLine IN (""*\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\setup-scheduledtask.ps1*"", ""*\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\set-selfhealing.ps1*"", ""*\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\check-workspacehealth.ps1*"", ""*\\nessus_*"") OR CommandLine=""*\\nessus_*"" OR (ParentImage=""*\\mshta.exe"" Image=""*\\mshta.exe"" ParentCommandLine=""*C:\\MEM_Configmgr_*"" ParentCommandLine=""*\\splash.hta*"" ParentCommandLine=""*{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}*"" CommandLine=""*C:\\MEM_Configmgr_*"" CommandLine=""*\\SMSSETUP\\BIN\\*"" CommandLine=""*\\autorun.hta*"" CommandLine=""*{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}*""))"
"Suspicious SYSTEM User Process Creation","Florian Roth (Nextron Systems), David ANDRE (additional keywords)","Detects a suspicious process creation as SYSTEM user (suspicious program or command line parameter)","attack.credential_access, attack.defense_evasion, attack.privilege_escalation, attack.t1134, attack.t1003, attack.t1027","process_creation","windows","Not classified","Check if the suspicious process creation is part of a known administrative activity 
Review scheduled tasks or scripts that run under the SYSTEM account 
Verify if the process is related to a legitimate software installation involving SYSTEM user","Administrative activity where SYSTEM user is legitimately used 
Scheduled tasks or scripts running under SYSTEM account 
Legitimate software installations that involve SYSTEM user","IntegrityLevel=""System"" User IN (""*AUTHORI*"", ""*AUTORI*"") Image IN (""*\\calc.exe"", ""*\\wscript.exe"", ""*\\cscript.exe"", ""*\\hh.exe"", ""*\\mshta.exe"", ""*\\forfiles.exe"", ""*\\ping.exe"") OR CommandLine IN (""* -NoP *"", ""* -W Hidden *"", ""* -decode *"", ""* /decode *"", ""* /urlcache *"", ""* -urlcache *"", ""* -e* JAB*"", ""* -e* SUVYI*"", ""* -e* SQBFAFgA*"", ""* -e* aWV4I*"", ""* -e* IAB*"", ""* -e* PAA*"", ""* -e* aQBlAHgA*"", ""*vssadmin delete shadows*"", ""*reg SAVE HKLM*"", ""* -ma *"", ""*Microsoft\\Windows\\CurrentVersion\\Run*"", ""*.downloadstring(*"", ""*.downloadfile(*"", ""* /ticket:*"", ""*dpapi::*"", ""*event::clear*"", ""*event::drop*"", ""*id::modify*"", ""*kerberos::*"", ""*lsadump::*"", ""*misc::*"", ""*privilege::*"", ""*rpc::*"", ""*sekurlsa::*"", ""*sid::*"", ""*token::*"", ""*vault::cred*"", ""*vault::list*"", ""* p::d *"", ""*;iex(*"", ""*MiniDump*"", ""*net user *"") NOT (CommandLine=""ping 127.0.0.1 -n 5"" OR (Image=""*\\PING.EXE"" ParentCommandLine=""*\\DismFoDInstall.cmd*"") OR ParentImage=""*:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\*"" OR (ParentImage IN (""*:\\Program Files (x86)\\Java\\*"", ""*:\\Program Files\\Java\\*"") ParentImage=""*\\bin\\javaws.exe"" Image IN (""*:\\Program Files (x86)\\Java\\*"", ""*:\\Program Files\\Java\\*"") Image=""*\\bin\\jp2launcher.exe"" CommandLine=""* -ma *""))"
"Tasks Folder Evasion","Sreeman","The Tasks folder in system32 and syswow64 are globally writable paths.
Adversaries can take advantage of this and load or influence any script hosts or ANY .NET Application
in Tasks to load and execute a custom assembly into cscript, wscript, regsvr32, mshta, eventvwr
","attack.defense_evasion, attack.persistence, attack.execution, attack.t1574.002","process_creation","windows","Not classified","Review the parent process to determine if it is a legitimate system process or an unknown/unauthorized process 
Check if the command line executed is part of a known scheduled task or administrative operation 
Investigate the content of the file being created or manipulated in the Tasks folder for malicious indicators 
Correlate the event with other security events to determine if there is a broader attack pattern or campaign","Legitimate administrative or system tasks may legitimately write to the Tasks folder 
Scheduled tasks that are known and authorized may write to the Tasks folder 
Software installations or updates may write to the Tasks folder 
Scripting or automation tools may write to the Tasks folder","CommandLine IN (""*echo *"", ""*copy *"", ""*type *"", ""*file createnew*"") CommandLine IN (""* C:\\Windows\\System32\\Tasks\\*"", ""* C:\\Windows\\SysWow64\\Tasks\\*"")"
"WhoAmI as Parameter","Florian Roth (Nextron Systems)","Detects a suspicious process command line that uses whoami as first parameter (as e.g. used by EfsPotato)","attack.discovery, attack.t1033, car.2016-03-001","process_creation","windows","Not classified","Review the process command line arguments to understand the context of the whoami parameter 
Check if the process execution is part of a known and approved script or administrative task 
Correlate with other security events to determine if the use of whoami is part of a larger suspicious activity 
Investigate the parent process and user context to identify any anomalies or signs of compromise","Legitimate use of whoami in scripts or administrative tasks 
Use of legitimate tools that happen to include whoami in their command line arguments 
Scheduled tasks or system processes that use whoami 
Use of whoami in benign software installations","CommandLine=""*.exe whoami*"""
"Execution via WorkFolders.exe","Maxime Thiebaut (@0xThiebaut)","Detects using WorkFolders.exe to execute an arbitrary control.exe","attack.defense_evasion, attack.t1218","process_creation","windows","Not classified","Check the command-line arguments of the WorkFolders.exe process to identify the purpose of execution 
Review the process tree to understand the context of WorkFolders.exe launching control.exe 
Inspect the network connections established by the processes to determine any malicious activity 
Correlate the event with other security logs to look for indicators of compromise","Scheduled legitimate tasks that involve WorkFolders.exe and control.exe 
Administrative scripts or tools leveraging WorkFolders.exe and control.exe 
Updates or installations that trigger the use of WorkFolders.exe and control.exe","Image=""*\\control.exe"" ParentImage=""*\\WorkFolders.exe"" NOT Image=""C:\\Windows\\System32\\control.exe"""
"Suspect Svchost Activity","David Burkett, @signalblur","It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.","attack.defense_evasion, attack.privilege_escalation, attack.t1055","process_creation","windows","Not classified","Check the parent process of svchost.exe to determine if it is a known and legitimate process. 
Review the command line arguments of the parent process to understand why svchost.exe was spawned without CLI arguments. 
Look for any associated network connections or file modifications by the suspicious svchost.exe process. 
Compare the behavior of the suspicious svchost.exe process with known good behavior of svchost.exe on the system.","Legitimate software that may spawn svchost.exe without CLI arguments for specific operations. 
Scheduled tasks or services that trigger svchost.exe without CLI arguments. 
Updates or patches that may cause svchost.exe to run without CLI arguments. 
Certain system monitoring tools or security products that interact with svchost.exe.","CommandLine=""*svchost.exe"" Image=""*\\svchost.exe"" NOT (ParentImage IN (""*\\rpcnet.exe"", ""*\\rpcnetp.exe"") OR CommandLine!=*)"
"Terminal Service Process Spawn","Florian Roth (Nextron Systems)","Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)","attack.initial_access, attack.t1190, attack.lateral_movement, attack.t1210, car.2013-07-002","process_creation","windows","Not classified","Review the Parent Process Command Line to understand the context of the spawned process 
Check for legitimate activities or configurations that may trigger similar process creation 
Correlate with network logs to identify any suspicious communication or lateral movement 
Investigate the reputation and behavior of the spawned process for any indicators of compromise","Legitimate use of terminal service server process spawning child processes 
Scheduled tasks or legitimate software triggering similar process creation 
Updates or installations that involve spawning processes from terminal service server 
Scripted actions or automation that may mimic the behavior","ParentCommandLine=""*\\svchost.exe*"" ParentCommandLine=""*termsvcs*"" NOT (Image IN (""*\\rdpclip.exe"", ""*:\\Windows\\System32\\csrss.exe"", ""*:\\Windows\\System32\\wininit.exe"", ""*:\\Windows\\System32\\winlogon.exe"") OR Image!=*)"
"Suspicious Active Directory Database Snapshot Via ADExplorer","Nasreddine Bencherchali (Nextron Systems)","Detects the execution of Sysinternals ADExplorer with the ""-snapshot"" flag in order to save a local copy of the active directory database to a suspicious directory.","attack.credential_access, attack.t1552.001, attack.t1003.003","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to confirm the presence of the '-snapshot' flag 
Check the parent-child process relationship to understand the context of ADExplorer execution 
Inspect the destination directory where the snapshot is saved for any suspicious activities or unauthorized access","Legitimate use of ADExplorer for system administration purposes 
Snapshot creation for authorized backup processes 
Use of legitimate directories for snapshot storage","Image=""*\\ADExplorer.exe"" OR OriginalFileName=""AdExp"" CommandLine=""*snapshot*"" CommandLine IN (""*\\Downloads\\*"", ""*\\Users\\Public\\*"", ""*\\AppData\\*"", ""*\\Windows\\Temp\\*"")"
"Potential SysInternals ProcDump Evasion","Florian Roth (Nextron Systems)","Detects uses of the SysInternals ProcDump utility in which ProcDump or its output get renamed, or a dump file is moved or copied to a different name","attack.defense_evasion, attack.t1036, attack.t1003.001","process_creation","windows","Not classified","Review the context of the process creation event to determine if the use of ProcDump was part of normal operations 
Check if the file operations involving dump files were authorized and align with expected behavior 
Investigate the reason behind any file renaming or moving to differentiate between evasion attempts and legitimate actions 
Correlate with other security events or logs to identify any suspicious patterns or behaviors","Legitimate use of ProcDump for troubleshooting purposes may trigger this rule 
File operations involving dump files that are not related to evasion techniques 
Renaming or moving files for legitimate reasons may lead to false positives","CommandLine IN (""*copy procdump*"", ""*move procdump*"") OR (CommandLine=""*copy *"" CommandLine=""*.dmp *"" CommandLine IN (""*2.dmp*"", ""*lsass*"", ""*out.dmp*"")) OR CommandLine IN (""*copy lsass.exe_*"", ""*move lsass.exe_*"")"
"Potential LSASS Process Dump Via Procdump","Florian Roth (Nextron Systems)","Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process.
This way we are also able to catch cases in which the attacker has renamed the procdump executable.
","attack.defense_evasion, attack.t1036, attack.credential_access, attack.t1003.001, car.2013-05-009","process_creation","windows","Not classified","Check if the Procdump process was executed by a trusted system administrator account 
Review the command line arguments passed to Procdump to determine the intent and target process 
Correlate the Procdump activity with other security events to identify any malicious behavior","Legitimate use of Procdump for system troubleshooting or monitoring purposes 
Scheduled tasks or scripts that use Procdump with similar command line parameters","CommandLine IN (""* -ma *"", ""* /ma *"") CommandLine=""* ls*"""
"PsExec/PAExec Escalation to LOCAL SYSTEM","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects suspicious commandline flags used by PsExec and PAExec to escalate a command line to LOCAL_SYSTEM rights","attack.resource_development, attack.t1587.001","process_creation","windows","Not classified","Review the command-line arguments and context of the process execution to determine if it aligns with legitimate administrative tasks 
Check for authorized maintenance activities or troubleshooting documented in the organization's procedures 
Correlate the process execution with scheduled tasks or scripts known to use PsExec or PAExec for authorized purposes 
Verify the presence of relevant logs or documentation supporting the observed activity","Admins using PsExec or PAExec for legitimate system administration tasks 
Users troubleshooting specific Microsoft Intune issues as per official documentation 
Scheduled tasks or scripts leveraging PsExec or PAExec for authorized operations","CommandLine=""* -s cmd*"" OR CommandLine=""* /s cmd*"" OR CommandLine=""* -s -i cmd*"" OR CommandLine=""* -s /i cmd*"" OR CommandLine=""* /s -i cmd*"" OR CommandLine=""* /s /i cmd*"" OR CommandLine=""* -i -s cmd*"" OR CommandLine=""* -i /s cmd*"" OR CommandLine=""* /i -s cmd*"" OR CommandLine=""* /i /s cmd*"" OR CommandLine=""* -s pwsh*"" OR CommandLine=""* /s pwsh*"" OR CommandLine=""* -s -i pwsh*"" OR CommandLine=""* -s /i pwsh*"" OR CommandLine=""* /s -i pwsh*"" OR CommandLine=""* /s /i pwsh*"" OR CommandLine=""* -i -s pwsh*"" OR CommandLine=""* -i /s pwsh*"" OR CommandLine=""* /i -s pwsh*"" OR CommandLine=""* /i /s pwsh*"" OR CommandLine=""* -s powershell*"" OR CommandLine=""* /s powershell*"" OR CommandLine=""* -s -i powershell*"" OR CommandLine=""* -s /i powershell*"" OR CommandLine=""* /s -i powershell*"" OR CommandLine=""* /s /i powershell*"" OR CommandLine=""* -i -s powershell*"" OR CommandLine=""* -i /s powershell*"" OR CommandLine=""* /i -s powershell*"" OR CommandLine=""* /i /s powershell*"" CommandLine IN (""*psexec*"", ""*paexec*"", ""*accepteula*"")"
"Potential PsExec Remote Execution","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects potential psexec command that initiate execution on a remote systems via common commandline flags used by the utility","attack.resource_development, attack.t1587.001","process_creation","windows","Not classified","Review the process creation logs to understand the context of the command execution 
Check for legitimate reasons for using PsExec in the environment 
Correlate with other security events to determine if the activity is part of a larger attack chain 
Verify the source and destination systems involved in the potential PsExec execution","Legitimate use of PsExec tool within the organization for system administration purposes 
Scripting or automation tools that use similar command-line arguments 
Third-party applications that may exhibit similar behavior","CommandLine=""*accepteula*"" CommandLine=""* -u *"" CommandLine=""* -p *"" CommandLine=""* \\\\*"""
"PsExec Service Child Process Execution as LOCAL SYSTEM","Florian Roth (Nextron Systems)","Detects suspicious launch of the PSEXESVC service on this system and a sub process run as LOCAL_SYSTEM (-s), which means that someone remotely started a command on this system running it with highest privileges and not only the privileges of the login user account (e.g. the administrator account)","attack.execution","process_creation","windows","Not classified","Review the command-line arguments of the PSEXESVC service process to determine the nature of the executed command 
Check the network connections established by the suspicious process for any unusual or unauthorized communication 
Inspect the file system and registry changes made by the spawned process for any malicious activity 
Correlate the event with other security logs to identify any additional suspicious behavior or indicators of compromise","Legitimate use of PsExec tool by system administrators for remote administration tasks 
Scheduled tasks or scripts that utilize PsExec for legitimate purposes 
Third-party applications that use PsExec for authorized actions","ParentImage=""C:\\Windows\\PSEXESVC.exe"" User IN (""*AUTHORI*"", ""*AUTORI*"")"
"Sysinternals PsSuspend Suspicious Execution","Nasreddine Bencherchali (Nextron Systems)","Detects suspicious execution of Sysinternals PsSuspend, where the utility is used to suspend critical processes such as AV or EDR to bypass defenses","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review process creation logs for instances of PsSuspend being used 
Check for any patterns or anomalies in the command line arguments of PsSuspend executions 
Correlate PsSuspend executions with other security events to determine the context and potential threat 
Investigate the parent processes that triggered the execution of PsSuspend for additional context","Legitimate use of PsSuspend for system administration tasks 
Scheduled tasks or scripts that involve suspending processes 
Security tools that may use PsSuspend for legitimate purposes","OriginalFileName=""pssuspend.exe"" OR Image IN (""*\\pssuspend.exe"", ""*\\pssuspend64.exe"") CommandLine=""*msmpeng.exe*"""
"Potential File Overwrite Via Sysinternals SDelete","frack113","Detects the use of SDelete to erase a file not the free space","attack.impact, attack.t1485","process_creation","windows","Not classified","Check the context of the process execution to determine if it aligns with expected or authorized activities 
Review any associated documentation or change management records for planned use of SDelete 
Correlate the process execution with other security events or logs to identify any suspicious patterns or anomalies 
Conduct interviews with relevant personnel to confirm the legitimacy of the SDelete usage","Legitimate use of SDelete utility by authorized users for secure file deletion 
Scheduled tasks or scripts utilizing SDelete for legitimate purposes 
Use of SDelete in a controlled testing environment","OriginalFileName=""sdelete.exe"" NOT (CommandLine IN (""* -h*"", ""* -c*"", ""* -z*"", ""* /?*""))"
"Potential Privilege Escalation To LOCAL SYSTEM","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects unknown program using commandline flags usually used by tools such as PsExec and PAExec to start programs with SYSTEM Privileges","attack.resource_development, attack.t1587.001","process_creation","windows","Not classified","Review the process creation logs to identify the parent process of the suspicious commandline execution 
Check the digital signature of the executable to determine its legitimacy 
Analyze network traffic for any communication to known malicious IPs or domains 
Conduct memory analysis to identify any suspicious activities or artifacts related to privilege escalation","Scheduled tasks or scripts legitimately using similar commandline flags 
Administrators testing or troubleshooting legitimate tools that mimic PsExec/PAExec behavior 
Legitimate software installations that use similar commandline arguments","CommandLine=""* -s cmd*"" OR CommandLine=""* /s cmd*"" OR CommandLine=""* -s -i cmd*"" OR CommandLine=""* -s /i cmd*"" OR CommandLine=""* /s -i cmd*"" OR CommandLine=""* /s /i cmd*"" OR CommandLine=""* -i -s cmd*"" OR CommandLine=""* -i /s cmd*"" OR CommandLine=""* /i -s cmd*"" OR CommandLine=""* /i /s cmd*"" OR CommandLine=""* -s pwsh*"" OR CommandLine=""* /s pwsh*"" OR CommandLine=""* -s -i pwsh*"" OR CommandLine=""* -s /i pwsh*"" OR CommandLine=""* /s -i pwsh*"" OR CommandLine=""* /s /i pwsh*"" OR CommandLine=""* -i -s pwsh*"" OR CommandLine=""* -i /s pwsh*"" OR CommandLine=""* /i -s pwsh*"" OR CommandLine=""* /i /s pwsh*"" OR CommandLine=""* -s powershell*"" OR CommandLine=""* /s powershell*"" OR CommandLine=""* -s -i powershell*"" OR CommandLine=""* -s /i powershell*"" OR CommandLine=""* /s -i powershell*"" OR CommandLine=""* /s /i powershell*"" OR CommandLine=""* -i -s powershell*"" OR CommandLine=""* -i /s powershell*"" OR CommandLine=""* /i -s powershell*"" OR CommandLine=""* /i /s powershell*"" NOT (CommandLine IN (""*paexec*"", ""*PsExec*"", ""*accepteula*""))"
"Uninstall Sysinternals Sysmon","frack113","Detects the removal of Sysmon, which could be a potential attempt at defense evasion","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Check for any legitimate system maintenance or troubleshooting activities that may have triggered the removal of Sysmon 
Review system upgrade or migration logs to confirm if Sysmon removal was intentional 
Investigate if any security software conflicts or misconfigurations caused the uninstallation of Sysmon 
Correlate with change management records to determine if the Sysmon removal was authorized","Legitimate administrators may uninstall Sysmon as part of troubleshooting or system maintenance 
Automated scripts or tools may remove Sysmon as part of a legitimate process 
Sysmon may be uninstalled as part of a system upgrade or migration 
Security software conflicts or misconfigurations may lead to the removal of Sysmon","Image IN (""*\\Sysmon64.exe"", ""*\\Sysmon.exe"") OR Description=""System activity monitor"" CommandLine IN (""*-u*"", ""*/u*"")"
"Potential Signing Bypass Via Windows Developer Features","Nasreddine Bencherchali (Nextron Systems)","Detects when a user enable developer features such as ""Developer Mode"" or ""Application Sideloading"". Which allows the user to install untrusted packages.","attack.defense_evasion","process_creation","windows","Not classified","Check if the user who triggered the event is authorized to use developer features 
Review the software being installed to determine if it is legitimate 
Verify if the system administrator enabled developer features for a valid purpose","Legitimate use of developer features by authorized users 
Legitimate software installations that require developer mode 
System administrators enabling developer features for valid reasons","Image=""*\\SystemSettingsAdminFlows.exe"" OR OriginalFileName=""SystemSettingsAdminFlows.EXE"" CommandLine=""*TurnOnDeveloperFeatures*"" CommandLine IN (""*DeveloperUnlock*"", ""*EnableSideloading*"")"
"Taskkill Symantec Endpoint Protection","Ilya Krestinichev, Florian Roth (Nextron Systems)","Detects one of the possible scenarios for disabling Symantec Endpoint Protection.
Symantec Endpoint Protection antivirus software services incorrectly implement the protected service mechanism.
As a result, the NT AUTHORITY/SYSTEM user can execute the taskkill /im command several times ccSvcHst.exe /f, thereby killing the process belonging to the service, and thus shutting down the service.
","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to understand the context of the taskkill command 
Check for any legitimate maintenance or operational activities that involve stopping Symantec Endpoint Protection services 
Correlate with other security events to determine if the taskkill activity is part of a larger attack chain","Legitimate use of taskkill command for system maintenance or troubleshooting purposes 
Scheduled tasks or scripts that involve killing processes 
Updates or installations that require stopping specific services","CommandLine=""*taskkill*"" CommandLine=""* /F *"" CommandLine=""* /IM *"" CommandLine=""*ccSvcHst.exe*"""
"Taskmgr as LOCAL_SYSTEM","Florian Roth (Nextron Systems)","Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM","attack.defense_evasion, attack.t1036","process_creation","windows","Not classified","Check if the taskmgr.exe process was spawned by a scheduled task or script 
Review the command-line arguments of the taskmgr.exe process for any suspicious parameters 
Correlate the process creation event with other security events to determine the context of the taskmgr.exe execution 
Verify the digital signature of the taskmgr.exe executable to ensure its integrity","Legitimate use of taskmgr.exe by system administrators for troubleshooting purposes 
Scheduled tasks or scripts that legitimately use taskmgr.exe 
Third-party applications that may spawn taskmgr.exe processes","User IN (""*AUTHORI*"", ""*AUTORI*"") Image=""*\\taskmgr.exe"""
"Suspicious TSCON Start as SYSTEM","Florian Roth (Nextron Systems)","Detects a tscon.exe start as LOCAL SYSTEM","attack.command_and_control, attack.t1219","process_creation","windows","Not classified","Check if the tscon.exe execution was triggered by a scheduled task or script 
Review the command-line arguments passed to tscon.exe for any legitimate use 
Investigate if any authorized system administrator activity coincides with the tscon.exe execution","Legitimate use of tscon.exe by authorized system administrators 
Scheduled tasks or scripts that involve tscon.exe 
Third-party applications that use tscon.exe for legitimate purposes","User IN (""*AUTHORI*"", ""*AUTORI*"") Image=""*\\tscon.exe"""
"Suspicious RDP Redirect Using TSCON","Florian Roth (Nextron Systems)","Detects a suspicious RDP session redirect using tscon.exe","attack.lateral_movement, attack.t1563.002, attack.t1021.001, car.2013-07-002","process_creation","windows","Not classified","Review the command-line arguments of the tscon.exe process to understand the context of the RDP session redirect 
Check for any legitimate reasons within the organization for using tscon.exe with the specified destination 
Correlate the RDP session redirect activity with other security events to determine if it is part of a larger attack campaign 
Verify the source and destination of the RDP session to confirm if it aligns with authorized activities","Legitimate administrative actions involving RDP session redirection 
Scheduled tasks or scripts that use tscon.exe for valid purposes 
Third-party applications that utilize tscon.exe for legitimate functions","CommandLine=""* /dest:rdp-tcp#*"""
"UAC Bypass Using ChangePK and SLUI","Christian Burkard (Nextron Systems)","Detects an UAC bypass that uses changepk.exe and slui.exe (UACMe 61)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Review the command-line arguments passed to changepk.exe and slui.exe for any suspicious or unauthorized activity 
Check the integrity level of the processes to determine if they are running with elevated privileges 
Correlate the process creation events with other security logs to identify any related suspicious activities 
Investigate the parent-child process relationship to understand the execution flow and potential malicious behavior","Legitimate use of changepk.exe and slui.exe for system maintenance or updates 
Scripted installations that involve these executables 
Third-party applications that may trigger similar process creation patterns","Image=""*\\changepk.exe"" ParentImage=""*\\slui.exe"" IntegrityLevel IN (""High"", ""System"")"
"UAC Bypass Using Disk Cleanup","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using scheduled tasks and variable expansion of cleanmgr.exe (UACMe 34)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the scheduled tasks on the system for any legitimate tasks triggering cleanmgr.exe 
Verify if the cleanmgr.exe command is being used for routine disk cleanup operations 
Investigate the parent processes of cleanmgr.exe to ensure they are legitimate and expected 
Review the Integrity Level of the processes involved to confirm they are within expected ranges","Legitimate use of cleanmgr.exe for disk cleanup tasks 
Scheduled tasks legitimately triggering cleanmgr.exe 
Legitimate use of svchost.exe with specific parameters 
Legitimate processes running at High or System Integrity Level","CommandLine=""*\""\\system32\\cleanmgr.exe /autoclean /d C:"" ParentCommandLine=""C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule"" IntegrityLevel IN (""High"", ""System"")"
"Bypass UAC via CMSTP","E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community","Detect commandline usage of Microsoft Connection Manager Profile Installer (cmstp.exe) to install specially formatted local .INF files","attack.privilege_escalation, attack.defense_evasion, attack.t1548.002, attack.t1218.003","process_creation","windows","Not classified","Check the context of the cmstp.exe execution to determine if it aligns with known legitimate use cases 
Review the command-line arguments passed to cmstp.exe to identify the purpose of the execution 
Correlate cmstp.exe activity with system administration tasks or software installations to rule out false positives 
Investigate the source and origin of the .INF files being installed via cmstp.exe","Legitimate use of cmstp.exe for system administration tasks 
Installation of legitimate software that leverages cmstp.exe 
Scripted deployments that use cmstp.exe 
Updates or patches that utilize cmstp.exe","Image=""*\\cmstp.exe"" OR OriginalFileName=""CMSTP.EXE"" CommandLine IN (""*/s*"", ""*-s*"", ""*/au*"", ""*-au*"", ""*/ni*"", ""*-ni*"")"
"CMSTP UAC Bypass via COM Object Access","Nik Seetharaman, Christian Burkard (Nextron Systems)","Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65)","attack.execution, attack.defense_evasion, attack.privilege_escalation, attack.t1548.002, attack.t1218.003, attack.g0069, car.2019-04-001","process_creation","windows","Not classified","Verify the context of the CMSTP execution to determine if it aligns with known legitimate activities in the environment 
Check if the autoelevate-capable COM objects accessed are part of authorized scripts or applications 
Review the integrity level of the process to assess if it matches the expected behavior for the system 
Investigate the history of the DllHost.exe process to identify any patterns or anomalies","Legitimate CMSTP usage in specific enterprise environments 
Legitimate use of autoelevate-capable COM objects for system administration tasks 
Legitimate use of UACMe tool for authorized security testing 
Legitimate use of DllHost.exe with specific command line parameters","ParentImage=""*\\DllHost.exe"" ParentCommandLine IN (""* /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}*"", ""* /Processid:{3E000D72-A845-4CD9-BD83-80C07C3B881F}*"", ""* /Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}*"", ""* /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}*"", ""* /Processid:{E9495B87-D950-4AB5-87A5-FF6D70BF3E90}*"") IntegrityLevel IN (""High"", ""System"")"
"UAC Bypass Tools Using ComputerDefaults","Christian Burkard (Nextron Systems)","Detects tools such as UACMe used to bypass UAC with computerdefaults.exe (UACMe 59)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Review the command-line arguments passed to ComputerDefaults.exe for any suspicious or unauthorized changes 
Check the process tree to identify the parent process that launched ComputerDefaults.exe 
Inspect the integrity level of the process to determine if it matches the expected levels for legitimate operations 
Correlate the process creation event with other security events to identify any related suspicious activities","Legitimate use of computerdefaults.exe during system updates or installations 
Legitimate software that may have similar behavior to UAC bypass tools 
Scripting or automation tools that interact with system settings 
Customized system configurations that involve elevated privileges","IntegrityLevel IN (""High"", ""System"") Image=""C:\\Windows\\System32\\ComputerDefaults.exe"" NOT (ParentImage IN (""*:\\Windows\\System32*"", ""*:\\Program Files*""))"
"UAC Bypass Using Consent and Comctl32 - Process","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the command-line arguments of the processes to determine the intent 
Verify the digital signatures of consent.exe and comctl32.dll 
Review the process behavior for any unusual or unauthorized actions 
Correlate with other security events to identify the root cause","Legitimate use of consent.exe and comctl32.dll by trusted applications 
Upgrades or installations of software that trigger UAC prompts 
Scheduled system tasks that involve consent.exe and comctl32.dll","ParentImage=""*\\consent.exe"" Image=""*\\werfault.exe"" IntegrityLevel IN (""High"", ""System"")"
"UAC Bypass Using DismHost","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using DismHost DLL hijacking (UACMe 63)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the command-line arguments of the DismHost.exe process to determine the nature of its execution 
Verify the digital signature of the DismHost.exe file to ensure its authenticity 
Review the process creation events leading up to the execution of DismHost.exe for any suspicious behavior 
Correlate the process creation event with other security events to identify any related suspicious activities","Legitimate use of DismHost.exe by system administrators for system maintenance tasks 
Legitimate software installation that involves DismHost.exe 
Updates or patches that trigger UAC prompts and use DismHost.exe 
Custom scripts or applications that interact with DismHost.exe","ParentImage=""*C:\\Users\\*"" ParentImage=""*\\AppData\\Local\\Temp\\*"" ParentImage=""*\\DismHost.exe*"" IntegrityLevel IN (""High"", ""System"")"
"UAC Bypass Using Event Viewer RecentViews","Nasreddine Bencherchali (Nextron Systems)","Detects the pattern of UAC Bypass using Event Viewer RecentViews","attack.defense_evasion, attack.privilege_escalation","process_creation","windows","Not classified","Review the command-line arguments of the process to understand the context of the Event Viewer RecentViews access. 
Check the process reputation and behavior to determine if it aligns with known legitimate actions. 
Correlate the Event Viewer RecentViews access with other security events to identify any suspicious patterns or anomalies. 
Investigate the user context and privileges associated with the process to assess the potential risk of privilege escalation.","Legitimate administrative actions may involve accessing Event Viewer RecentViews. 
Software installations or updates may trigger similar patterns. 
Scripting or automation tools may use similar commands for legitimate purposes.","CommandLine IN (""*\\Event Viewer\\RecentViews*"", ""*\\EventV~1\\RecentViews*"") CommandLine=""*>*"""
"Bypass UAC via Fodhelper.exe","E.M. Anhaus (originally from Atomic Blue Detections, Tony Lambert), oscd.community","Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.","attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the command-line arguments passed to fodhelper.exe for any suspicious or unauthorized actions 
Review the user context under which fodhelper.exe was executed for anomalies 
Correlate fodhelper.exe execution with other security events to determine the full scope of activity 
Investigate the parent process that triggered fodhelper.exe for any signs of compromise","Scheduled legitimate tasks that involve fodhelper.exe 
Administrative scripts or tools that use fodhelper.exe 
Updates or installations that trigger fodhelper.exe","ParentImage=""*\\fodhelper.exe"""
"UAC Bypass via ICMLuaUtil","Florian Roth (Nextron Systems), Elastic (idea)","Detects the pattern of UAC Bypass using ICMLuaUtil Elevated COM interface","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the ParentImage and ParentCommandLine fields in the process creation logs for instances of ICMLuaUtil being used with specific Process IDs 
Investigate the context of the process creation event to determine if the activity is part of a known administrative task or if it appears suspicious 
Look for patterns of behavior such as repeated use of ICMLuaUtil with different Process IDs or unusual command line parameters 
Correlate the process creation event with other security events or logs to build a more comprehensive picture of the activity","Legitimate use of ICMLuaUtil for system administration tasks 
Updates or installations that require elevated privileges 
Legitimate software utilizing COM interfaces 
Scheduled tasks or scripts that interact with COM objects","ParentImage=""*\\dllhost.exe"" ParentCommandLine IN (""*/Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}*"", ""*/Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}*"") NOT (Image=""*\\WerFault.exe"" OR OriginalFileName=""WerFault.exe"")"
"UAC Bypass Using IDiagnostic Profile","Nasreddine Bencherchali (Nextron Systems)","Detects the ""IDiagnosticProfileUAC"" UAC bypass technique","attack.execution, attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the ParentImage and ParentCommandLine fields in process creation logs for DllHost.exe and the specific Processid 
Verify the IntegrityLevel of the process to ensure it matches the expected values (High, System) 
Correlate the event with other security logs to determine the context of the activity 
Investigate the reputation and history of the involved processes and command lines","Legitimate use of IDiagnosticProfileUAC for system diagnostics 
Updates or installations that involve DllHost.exe 
Legitimate processes with high integrity level 
Scheduled system tasks","ParentImage=""*\\DllHost.exe"" ParentCommandLine=""* /Processid:{12C21EA7-2EB8-4B55-9249-AC243DA8C666}*"" IntegrityLevel IN (""High"", ""System"")"
"UAC Bypass Using IEInstal - Process","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the command-line arguments of the IEInstal.exe process to determine the purpose of its execution 
Verify the digital signature of the IEInstal.exe binary to ensure its authenticity 
Investigate the parent-child process relationship to understand the context of the IEInstal.exe execution 
Review the process tree to identify any abnormal behavior or suspicious processes leading to the UAC bypass","Legitimate use of IEInstal.exe for system updates or installations 
Legitimate processes running from AppData\Local\Temp\ 
Legitimate processes named consent.exe 
Legitimate processes with IntegrityLevel set to High or System","IntegrityLevel IN (""High"", ""System"") ParentImage=""*\\ieinstal.exe"" Image=""*\\AppData\\Local\\Temp\\*"" Image=""*consent.exe"""
"UAC Bypass Using MSConfig Token Modification - Process","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe 55)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the command-line arguments of the process creation event to verify if msconfig.exe is being used with the specific command '-5' 
Review the parent process to ensure it is a legitimate process and not a malicious one 
Verify the Integrity Level of the process to determine if it matches the expected values of 'High' or 'System' 
Correlate with other security events to check for any additional suspicious activities or indicators of compromise","Legitimate use of msconfig.exe with valid reasons for modifying system configuration 
Software installations that legitimately require elevated privileges 
Scheduled tasks or scripts that involve msconfig.exe 
Administrative tools or scripts that interact with system configuration","IntegrityLevel IN (""High"", ""System"") ParentImage=""*\\AppData\\Local\\Temp\\pkgmgr.exe"" CommandLine=""\""C:\\Windows\\system32\\msconfig.exe\"" -5"""
"UAC Bypass Using NTFS Reparse Point - Process","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe DLL hijacking (UACMe 36)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the legitimacy of the parent processes invoking wusa.exe and dism.exe 
Verify if the file paths and commands are part of a known system update or software installation 
Review scheduled tasks or scripts that may trigger similar behavior 
Correlate with other security events to determine the context of the activity","Legitimate use of wusa.exe and dism.exe for system updates 
Legitimate software installation that matches the criteria 
Scheduled tasks or scripts that perform similar actions","(CommandLine=""\""C:\\Windows\\system32\\wusa.exe\""  /quiet C:\\Users\\*"" CommandLine=""*\\AppData\\Local\\Temp\\update.msu"" IntegrityLevel IN (""High"", ""System"")) OR (ParentCommandLine=""\""C:\\Windows\\system32\\dism.exe\"" /online /quiet /norestart /add-package /packagepath:\""C:\\Windows\\system32\\pe386\"" /ignorecheck"" IntegrityLevel IN (""High"", ""System"") CommandLine=""*C:\\Users\\*"" CommandLine=""*\\AppData\\Local\\Temp\\*"" CommandLine=""*\\dismhost.exe {*"" Image=""*\\DismHost.exe"")"
"UAC Bypass Using PkgMgr and DISM","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using pkgmgr.exe and dism.exe (UACMe 23)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Review the command-line arguments of pkgmgr.exe and dism.exe processes for any suspicious or unauthorized activities 
Check the integrity level of the processes to determine if they are running with elevated privileges 
Correlate process creation events with other security logs to identify any related suspicious activities 
Verify the digital signatures of pkgmgr.exe and dism.exe to ensure they are legitimate and not tampered with","Legitimate use of pkgmgr.exe and dism.exe during system maintenance or updates 
Use of third-party applications that may trigger similar process creation patterns 
Scripted installations or configurations that involve pkgmgr.exe and dism.exe","ParentImage=""*\\pkgmgr.exe"" Image=""*\\dism.exe"" IntegrityLevel IN (""High"", ""System"")"
"TrustedPath UAC Bypass Pattern","Florian Roth (Nextron Systems)","Detects indicators of a UAC bypass method by mocking directories","attack.defense_evasion, attack.t1548.002","process_creation","windows","Not classified","Review the process creation logs to identify the process that triggered the detection 
Check the reputation of the process and its associated image path 
Analyze the behavior of the process for any other suspicious activities 
Correlate the event with other security events or alerts to determine the scope of the potential threat","Legitimate software or scripts that use similar directory mocking techniques 
Temporary files or artifacts created during system updates or installations 
Custom tools or scripts used by system administrators for specific tasks","Image=""*C:\\Windows \\System32\\*"""
"UAC Bypass Abusing Winsat Path Parsing - Process","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the legitimacy of the parent process that triggered winsat.exe 
Review the command-line arguments of winsat.exe for any suspicious parameters 
Correlate the event with other security logs to determine the context of the activity 
Investigate the integrity level of the process and its parent process","Legitimate use of winsat.exe in specific environments 
Scheduled tasks or scripts that involve winsat.exe 
Updates or installations that trigger winsat.exe 
Known system maintenance processes","IntegrityLevel IN (""High"", ""System"") ParentImage=""*\\AppData\\Local\\Temp\\system32\\winsat.exe"" ParentCommandLine=""*C:\\Windows \\system32\\winsat.exe*"""
"UAC Bypass Using Windows Media Player - Process","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the reputation and history of the processes involved in the detection 
Verify if the UAC bypass attempt was part of a known administrative task 
Review the context of the process execution to determine if it was triggered by a legitimate action 
Investigate if any software or scripts are designed to interact with UAC mechanisms","Legitimate use of Windows Media Player or cmd.exe with high integrity level 
Legitimate administrative activities that involve similar processes 
Updates or installations that trigger UAC prompts 
Legitimate software that interacts with UAC mechanisms","(Image=""C:\\Program Files\\Windows Media Player\\osk.exe"" IntegrityLevel IN (""High"", ""System"")) OR (Image=""C:\\Windows\\System32\\cmd.exe"" ParentCommandLine=""\""C:\\Windows\\system32\\mmc.exe\"" \""C:\\Windows\\system32\\eventvwr.msc\"" /s"" IntegrityLevel IN (""High"", ""System""))"
"Bypass UAC via WSReset.exe","E.M. Anhaus (originally from Atomic Blue Detections, Tony Lambert), oscd.community, Florian Roth","Detects use of WSReset.exe to bypass User Account Control (UAC). Adversaries use this technique to execute privileged processes.","attack.privilege_escalation, attack.defense_evasion, attack.t1548.002","process_creation","windows","Not classified","Check the command-line arguments of WSReset.exe to identify the purpose of its execution 
Review the parent process of WSReset.exe to determine if it was launched from a suspicious source 
Correlate the timestamp of WSReset.exe execution with other security events to identify any related suspicious activities 
Inspect the process tree to understand the context of WSReset.exe execution","Legitimate use of WSReset.exe by system processes during Windows Update 
Legitimate use of WSReset.exe by Microsoft Store applications 
Legitimate use of WSReset.exe during system maintenance tasks","ParentImage=""*\\wsreset.exe"" NOT (Image=""*\\conhost.exe"" OR OriginalFileName=""CONHOST.EXE"")"
"UAC Bypass WSReset","Christian Burkard (Nextron Systems)","Detects the pattern of UAC Bypass via WSReset usable by default sysmon-config","attack.defense_evasion, attack.privilege_escalation, attack.t1548.002","process_creation","windows","Not classified","Check the command-line arguments used with WSReset.exe for any suspicious parameters 
Review the parent process of WSReset.exe to determine if it is launched from an expected source 
Correlate the execution of WSReset.exe with other events to identify any anomalous behavior 
Verify the integrity level of the process and compare it with known legitimate executions","Legitimate use of WSReset.exe for system maintenance tasks 
Legitimate use of WSReset.exe by trusted applications 
Legitimate use of WSReset.exe during Windows Update operations","Image=""*\\wsreset.exe"" IntegrityLevel IN (""High"", ""System"")"
"Suspicious UltraVNC Execution","Bhabesh Raj","Detects suspicious UltraVNC command line flag combination that indicate a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon threat group)","attack.lateral_movement, attack.g0047, attack.t1021.005","process_creation","windows","Not classified","Review the process command line arguments to identify the context of UltraVNC execution 
Check for legitimate reasons for the presence of the suspicious command line flags 
Correlate the process execution with other security events to determine if it is part of a larger attack chain 
Investigate the source and destination of the connection attempt for any anomalies or unauthorized access","Legitimate use of UltraVNC with auto-reconnect feature enabled 
Administrative tasks involving UltraVNC 
Third-party applications that utilize similar command line flags 
Scheduled tasks or scripts that involve UltraVNC","CommandLine=""*-autoreconnect *"" CommandLine=""*-connect *"" CommandLine=""*-id:*"""
"Uninstall Crowdstrike Falcon Sensor","frack113","Adversaries may disable security tools to avoid possible detection of their tools and activities by uninstalling Crowdstrike Falcon","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Review the user account associated with the process to determine if it was performed by an authorized user 
Check for any scheduled tasks or scripts that may explain the uninstallation activity 
Correlate the event with other security tool logs to identify any anomalies or suspicious behavior 
Verify if there were any recent changes in the environment that required the uninstallation of the security tool","Legitimate uninstallation of Crowdstrike Falcon Sensor by authorized administrators 
Scheduled maintenance tasks that involve uninstalling and reinstalling security tools 
Third-party software installations that trigger similar command lines 
Automated scripts or deployment tools used for software management","CommandLine=""*\\WindowsSensor.exe*"" CommandLine=""* /uninstall*"" CommandLine=""* /quiet*"""
"Uncommon Userinit Child Process","Tom Ueltschi (@c_APT_ure), Tim Shelton","Detects uncommon ""userinit.exe"" child processes, which could be a sign of uncommon shells or login scripts used for persistence.","attack.t1037.001, attack.persistence","process_creation","windows","Not classified","Verify the purpose and origin of the detected child process. 
Check if the process is related to any known logon scripts or custom shells in the environment. 
Review the command line arguments of the process to identify any suspicious behavior. 
Cross-reference the process with known whitelisted processes in the environment.","Legitimate logon scripts like netlogon.bat or UsrLogon.cmd may trigger false positives. 
Legitimate processes like PowerShell.exe may be used and should be whitelisted. 
Citrix-related processes may be legitimate in certain environments. 
Processes with null Image information should be investigated further to determine legitimacy.","ParentImage=""*\\userinit.exe"" NOT Image=""*:\\WINDOWS\\explorer.exe"" NOT (CommandLine IN (""*netlogon.bat*"", ""*UsrLogon.cmd*"") OR CommandLine=""PowerShell.exe"" OR Image IN (""*:\\Windows\\System32\\proquota.exe"", ""*:\\Windows\\SysWOW64\\proquota.exe"") OR Image IN (""*:\\Program Files (x86)\\Citrix\\HDX\\bin\\cmstart.exe"", ""*:\\Program Files (x86)\\Citrix\\HDX\\bin\\icast.exe"", ""*:\\Program Files (x86)\\Citrix\\System32\\icast.exe"", ""*:\\Program Files\\Citrix\\HDX\\bin\\cmstart.exe"", ""*:\\Program Files\\Citrix\\HDX\\bin\\icast.exe"", ""*:\\Program Files\\Citrix\\System32\\icast.exe"") OR Image!=*)"
"Use of W32tm as Timer","frack113","When configured with suitable command line arguments, w32tm can act as a delay mechanism","attack.discovery, attack.t1124","process_creation","windows","Not classified","Check the scheduled tasks on the system for any legitimate use of w32tm 
Review system maintenance logs to identify authorized use of w32tm 
Analyze network traffic for time synchronization activities in a domain environment","Scheduled legitimate tasks using w32tm 
System maintenance tasks 
Time synchronization in a domain environment","Image=""*\\w32tm.exe"" OR OriginalFileName=""w32time.dll"" CommandLine=""*/stripchart*"" CommandLine=""*/computer:*"" CommandLine=""*/period:*"" CommandLine=""*/dataonly*"" CommandLine=""*/samples:*"""
"Wab Execution From Non Default Location","Nasreddine Bencherchali (Nextron Systems)","Detects execution of wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) from non default locations as seen with bumblebee activity","attack.defense_evasion, attack.execution","process_creation","windows","Not classified","Check if the execution of wab.exe or Wabmig.exe from non-default locations was triggered by a known software installation or update 
Review scheduled tasks or scripts that may be responsible for running wab.exe or Wabmig.exe from non-default locations 
Verify if the user executing wab.exe or Wabmig.exe from non-default locations is authorized to do so 
Investigate network traffic or other logs to determine if the activity is part of a larger malicious campaign","Legitimate use of wab.exe or Wabmig.exe from non-default locations by authorized users 
Software installations or updates that involve wab.exe or Wabmig.exe 
Scheduled tasks or scripts that run wab.exe or Wabmig.exe from non-default locations","Image IN (""*\\wab.exe"", ""*\\wabmig.exe"") NOT (Image IN (""C:\\Windows\\WinSxS\\*"", ""C:\\Program Files\\Windows Mail\\*"", ""C:\\Program Files (x86)\\Windows Mail\\*""))"
"Wab/Wabmig Unusual Parent Or Child Processes","Nasreddine Bencherchali (Nextron Systems)","Detects unusual parent or children of the wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) processes as seen being used with bumblebee activity","attack.defense_evasion, attack.execution","process_creation","windows","Not classified","Review process creation logs for legitimate use cases of wab.exe and Wabmig.exe 
Check for any recent software updates or installations that involve wab.exe or Wabmig.exe 
Verify if there are any scheduled tasks or scripts that interact with wab.exe or Wabmig.exe","Legitimate use of wab.exe or Wabmig.exe in specific environments 
Updates or installations involving wab.exe or Wabmig.exe 
Scheduled tasks or scripts that interact with wab.exe or Wabmig.exe","(ParentImage IN (""*\\WmiPrvSE.exe"", ""*\\svchost.exe"", ""*\\dllhost.exe"") Image IN (""*\\wab.exe"", ""*\\wabmig.exe"")) OR ParentImage IN (""*\\wab.exe"", ""*\\wabmig.exe"")"
"SystemStateBackup Deleted Using Wbadmin.EXE","frack113","Deletes the Windows systemstatebackup using wbadmin.exe.
This technique is used by numerous ransomware families.
This may only be successful on server platforms that have Windows Backup enabled.
","attack.impact, attack.t1490","process_creation","windows","Not classified","Review the command-line arguments of wbadmin.exe processes to identify the specific commands being executed 
Check if the deletion of system state backups aligns with any scheduled maintenance tasks or known administrative actions 
Correlate the process creation event with other security events to determine if the activity is part of a larger malicious operation 
Monitor for any unusual or unauthorized access to the wbadmin.exe executable","Legitimate system maintenance tasks may involve deleting system state backups using wbadmin.exe 
Scheduled backup tasks may trigger this behavior 
Administrators manually deleting system state backups","Image=""*\\wbadmin.exe"" OR OriginalFileName=""WBADMIN.EXE"" CommandLine=""*delete *"" CommandLine=""*systemstatebackup *"" CommandLine=""*-keepVersions:0*"""
"Chopper Webshell Process Pattern","Florian Roth (Nextron Systems), MSTI (query)","Detects patterns found in process executions cause by China Chopper like tiny (ASPX) webshells","attack.persistence, attack.t1505.003, attack.t1018, attack.t1033, attack.t1087","process_creation","windows","Not classified","Review the parent-child process relationship to determine if the w3wp.exe process is spawned by a legitimate process 
Analyze the context of the command line arguments to identify any benign reasons for the commands being executed 
Check for any scheduled or authorized tasks that may involve the observed commands 
Correlate the process execution with other security events or logs to identify any malicious behavior","Legitimate use of commands in the command line arguments 
Legitimate use of w3wp.exe process for web server operations 
Legitimate use of echo commands for scripting or debugging purposes","Image=""*\\w3wp.exe"" OR ParentImage=""*\\w3wp.exe"" CommandLine IN (""*&ipconfig&echo*"", ""*&quser&echo*"", ""*&whoami&echo*"", ""*&c:&echo*"", ""*&cd&echo*"", ""*&dir&echo*"", ""*&echo [E]*"", ""*&echo [S]*"")"
"Webshell Hacking Activity Patterns","Florian Roth (Nextron Systems)","Detects certain parent child patterns found in cases in which a web shell is used to perform certain credential dumping or exfiltration activities on a compromised system
","attack.persistence, attack.t1505.003, attack.t1018, attack.t1033, attack.t1087","process_creation","windows","Not classified","Review the context of the process creation events to determine if the observed behavior is part of normal operations 
Check for any scheduled tasks or scripts that could explain the detected patterns 
Correlate the events with system changes or known maintenance activities 
Verify the legitimacy of the parent and child processes by analyzing their purpose and origin","Legitimate administrative activities may trigger some of the child process patterns 
Development or testing activities may exhibit similar behavior 
Certain security tools or scripts may also match the detection criteria 
Updates or installations of software components may lead to false positives","ParentImage IN (""*\\caddy.exe"", ""*\\httpd.exe"", ""*\\nginx.exe"", ""*\\php-cgi.exe"", ""*\\w3wp.exe"", ""*\\ws_tomcatservice.exe"") OR (ParentImage IN (""*\\java.exe"", ""*\\javaw.exe"") ParentImage IN (""*-tomcat-*"", ""*\\tomcat*"")) OR (ParentImage IN (""*\\java.exe"", ""*\\javaw.exe"") CommandLine IN (""*catalina.jar*"", ""*CATALINA_HOME*"")) (CommandLine=""*rundll32*"" CommandLine=""*comsvcs*"") OR (CommandLine=""* -hp*"" CommandLine=""* a *"" CommandLine=""* -m*"") OR (CommandLine=""*net*"" CommandLine=""* user *"" CommandLine=""* /add*"") OR (CommandLine=""*net*"" CommandLine=""* localgroup *"" CommandLine=""* administrators *"" CommandLine=""*/add*"") OR Image IN (""*\\ntdsutil.exe"", ""*\\ldifde.exe"", ""*\\adfind.exe"", ""*\\procdump.exe"", ""*\\Nanodump.exe"", ""*\\vssadmin.exe"", ""*\\fsutil.exe"") OR CommandLine IN (""* -decode *"", ""* -NoP *"", ""* -W Hidden *"", ""* /decode *"", ""* /ticket:*"", ""* sekurlsa*"", ""*.dmp full*"", ""*.downloadfile(*"", ""*.downloadstring(*"", ""*FromBase64String*"", ""*process call create*"", ""*reg save *"", ""*whoami /priv*"")"
"Webshell Detection With Command Line Keywords","Florian Roth (Nextron Systems), Jonhnathan Ribeiro, Anton Kutepov, oscd.community","Detects certain command line parameters often used during reconnaissance activity via web shells","attack.persistence, attack.t1505.003, attack.t1018, attack.t1033, attack.t1087","process_creation","windows","Not classified","Review the command line parameters and the parent process to determine if the activity is expected or suspicious 
Check the context in which the suspicious commands were executed to understand the intent behind them 
Correlate the detected activity with other security events or indicators of compromise to validate the potential threat 
Investigate the reputation of the processes and commands executed to identify known benign use cases","Legitimate administration or monitoring tools may trigger these rules 
Development or testing activities may exhibit similar behavior 
Certain system configurations or applications may have legitimate reasons to execute these commands 
Scripting or automation tasks could also lead to false positives","ParentImage IN (""*\\w3wp.exe"", ""*\\php-cgi.exe"", ""*\\nginx.exe"", ""*\\httpd.exe"", ""*\\caddy.exe"", ""*\\ws_tomcatservice.exe"") OR (ParentImage IN (""*\\java.exe"", ""*\\javaw.exe"") ParentImage IN (""*-tomcat-*"", ""*\\tomcat*"")) OR (ParentImage IN (""*\\java.exe"", ""*\\javaw.exe"") CommandLine IN (""*catalina.jar*"", ""*CATALINA_HOME*"")) (OriginalFileName IN (""net.exe"", ""net1.exe"") CommandLine IN (""* user *"", ""* use *"", ""* group *"")) OR (OriginalFileName=""ping.exe"" CommandLine=""* -n *"") OR CommandLine IN (""*&cd&echo*"", ""*cd /d *"") OR (OriginalFileName=""wmic.exe"" CommandLine=""* /node:*"") OR Image IN (""*\\dsquery.exe"", ""*\\find.exe"", ""*\\findstr.exe"", ""*\\ipconfig.exe"", ""*\\netstat.exe"", ""*\\nslookup.exe"", ""*\\pathping.exe"", ""*\\quser.exe"", ""*\\schtasks.exe"", ""*\\systeminfo.exe"", ""*\\tasklist.exe"", ""*\\tracert.exe"", ""*\\ver.exe"", ""*\\wevtutil.exe"", ""*\\whoami.exe"") OR OriginalFileName IN (""dsquery.exe"", ""find.exe"", ""findstr.exe"", ""ipconfig.exe"", ""netstat.exe"", ""nslookup.exe"", ""pathping.exe"", ""quser.exe"", ""schtasks.exe"", ""sysinfo.exe"", ""tasklist.exe"", ""tracert.exe"", ""ver.exe"", ""VSSADMIN.EXE"", ""wevtutil.exe"", ""whoami.exe"") OR CommandLine IN (""* Test-NetConnection *"", ""*dir \\*"")"
"Suspicious Process By Web Server Process","Thomas Patzke, Florian Roth (Nextron Systems), Zach Stanford @svch0st, Tim Shelton, Nasreddine Bencherchali (Nextron Systems)","Detects potentially suspicious processes being spawned by a web server process which could be the result of a successfully placed web shell or exploitation
","attack.persistence, attack.t1505.003, attack.t1190","process_creation","windows","Not classified","Review the parent-child process relationship to understand the context of the suspicious process 
Check if the process execution is part of a known and approved workflow or application 
Analyze the command line arguments and parameters of the suspicious process for any indicators of compromise 
Correlate the process creation event with other security logs to determine if any malicious activities are ongoing","Legitimate administration tools or scripts may trigger false positives 
Scheduled tasks or system maintenance processes may exhibit similar behavior 
Development or testing environments may spawn processes that resemble suspicious activity","ParentImage IN (""*\\caddy.exe"", ""*\\httpd.exe"", ""*\\nginx.exe"", ""*\\php-cgi.exe"", ""*\\php.exe"", ""*\\tomcat.exe"", ""*\\UMWorkerProcess.exe"", ""*\\w3wp.exe"", ""*\\ws_TomcatService.exe"") OR (ParentImage IN (""*\\java.exe"", ""*\\javaw.exe"") ParentImage IN (""*-tomcat-*"", ""*\\tomcat*"")) OR (ParentImage IN (""*\\java.exe"", ""*\\javaw.exe"") ParentCommandLine IN (""*CATALINA_HOME*"", ""*catalina.home*"", ""*catalina.jar*"")) Image IN (""*\\arp.exe"", ""*\\at.exe"", ""*\\bash.exe"", ""*\\bitsadmin.exe"", ""*\\certutil.exe"", ""*\\cmd.exe"", ""*\\cscript.exe"", ""*\\dsget.exe"", ""*\\hostname.exe"", ""*\\nbtstat.exe"", ""*\\net.exe"", ""*\\net1.exe"", ""*\\netdom.exe"", ""*\\netsh.exe"", ""*\\nltest.exe"", ""*\\ntdutil.exe"", ""*\\powershell_ise.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\qprocess.exe"", ""*\\query.exe"", ""*\\qwinsta.exe"", ""*\\reg.exe"", ""*\\rundll32.exe"", ""*\\sc.exe"", ""*\\sh.exe"", ""*\\wmic.exe"", ""*\\wscript.exe"", ""*\\wusa.exe"") NOT ((ParentImage=""*\\java.exe"" CommandLine=""*Windows\\system32\\cmd.exe /c C:\\ManageEngine\\ADManager \""Plus\\ES\\bin\\elasticsearch.bat -Enode.name=RMP-NODE1 -pelasticsearch-pid.txt"") OR (ParentImage=""*\\java.exe"" CommandLine=""*sc query*"" CommandLine=""*ADManager Plus*""))"
"Webshell Tool Reconnaissance Activity","Cian Heasley, Florian Roth (Nextron Systems)","Detects processes spawned from web servers (PHP, Tomcat, IIS, etc.) that perform reconnaissance looking for the existence of popular scripting tools (perl, python, wget) on the system via the help commands
","attack.persistence, attack.t1505.003","process_creation","windows","Not classified","Review the parent process to determine if it is a legitimate web server process 
Check if the commands executed are part of routine system maintenance or development activities 
Investigate the context in which the commands were run to identify any scheduled tasks or scripts 
Correlate the activity with other security events or logs to determine if it is part of a larger attack pattern","Legitimate use of scripting tools for system administration tasks 
Development or testing environments where such commands are commonly used 
Automated scripts or tools that perform regular checks for updates or dependencies 
Third-party applications that utilize these scripting languages for specific functionalities","ParentImage IN (""*\\caddy.exe"", ""*\\httpd.exe"", ""*\\nginx.exe"", ""*\\php-cgi.exe"", ""*\\w3wp.exe"", ""*\\ws_tomcatservice.exe"") OR (ParentImage IN (""*\\java.exe"", ""*\\javaw.exe"") ParentImage IN (""*-tomcat-*"", ""*\\tomcat*"")) OR (ParentImage IN (""*\\java.exe"", ""*\\javaw.exe"") CommandLine IN (""*CATALINA_HOME*"", ""*catalina.jar*"")) CommandLine IN (""*perl --help*"", ""*perl -h*"", ""*python --help*"", ""*python -h*"", ""*python3 --help*"", ""*python3 -h*"", ""*wget --help*"")"
"Potential Credential Dumping Via WER","@pbssubhash , Nasreddine Bencherchali","Detects potential credential dumping via Windows Error Reporting LSASS Shtinkering technique which uses the Windows Error Reporting to dump lsass","attack.credential_access, attack.t1003.001","process_creation","windows","Not classified","Verify the context in which WerFault.exe is being executed, including the Parent Process and User 
Check the command-line arguments of WerFault.exe to identify any suspicious parameters like '-u -p', '-ip', or '-s' 
Investigate the Parent Process of WerFault.exe to determine if it is related to lsass.exe 
Cross-reference the PID associated with the '-p' parameter in the CommandLine with legitimate processes to rule out false positives","Legitimate use of Windows Error Reporting for non-malicious purposes may trigger this rule 
Legitimate administrative actions involving lsass.exe may be flagged by this rule 
Third-party applications may use similar command-line parameters as the ones specified in the detection logic","Image=""*\\Werfault.exe"" OR OriginalFileName=""WerFault.exe"" ParentUser IN (""*AUTHORI*"", ""*AUTORI*"") User IN (""*AUTHORI*"", ""*AUTORI*"") CommandLine=""* -u -p *"" CommandLine=""* -ip *"" CommandLine=""* -s *"" NOT ParentImage=""C:\\Windows\\System32\\lsass.exe"""
"Security Privileges Enumeration Via Whoami.EXE","Florian Roth (Nextron Systems)","Detects a whoami.exe executed with the /priv command line flag instructing the tool to show all current user privileges. This is often used after a privilege escalation attempt.","attack.privilege_escalation, attack.discovery, attack.t1033","process_creation","windows","Not classified","Review the command line arguments of the process creation event to confirm the presence of /priv flag with whoami.exe 
Check the parent process of whoami.exe to determine if it was initiated by a scheduled task or a legitimate application 
Correlate the process creation event with other security events to identify any suspicious behavior or privilege escalation attempts","Legitimate use of whoami.exe with /priv flag by system administrators for troubleshooting purposes 
Scheduled tasks or scripts that use whoami.exe with /priv flag 
Third-party applications that run whoami.exe with /priv flag for legitimate reasons","Image=""*\\whoami.exe"" OR OriginalFileName=""whoami.exe"" CommandLine IN (""* /priv*"", ""* -priv*"")"
"Add Insecure Download Source To Winget","Nasreddine Bencherchali (Nextron Systems)","Detects usage of winget to add a new insecure (http) download source.
Winget will not allow the addition of insecure sources, hence this could indicate potential suspicious activity (or typos)
","attack.defense_evasion, attack.execution, attack.t1059","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to identify the specific source being added 
Check with the user or system owner to confirm if the addition of an insecure source was intentional 
Verify if there are any documented exceptions or business justifications for using insecure download sources","Users intentionally adding an insecure source for a specific reason 
Legitimate use of HTTP for internal repositories 
Misconfigurations leading to false positives","Image=""*\\winget.exe"" OR OriginalFileName=""winget.exe"" CommandLine=""*source *"" CommandLine=""*add *"" CommandLine=""*http://*"""
"Suspicious Processes Spawned by WinRM","Andreas Hunkeler (@Karneades), Markus Neis","Detects suspicious processes including shells spawnd from WinRM host process","attack.t1190, attack.initial_access, attack.persistence, attack.privilege_escalation","process_creation","windows","Not classified","Check the WinRM configuration and authorized users for any scheduled tasks or scripts 
Review the command-line arguments of the suspicious processes to determine their intent 
Correlate the process creation events with network logs to identify any unusual communication 
Verify the reputation of the processes and binaries spawned by WinRM using threat intelligence sources","Scheduled legitimate tasks executed via WinRM 
Administrative scripts executed via WinRM 
Known applications that use WinRM for management tasks","ParentImage=""*\\wsmprovhost.exe"" Image IN (""*\\cmd.exe"", ""*\\sh.exe"", ""*\\bash.exe"", ""*\\powershell.exe"", ""*\\pwsh.exe"", ""*\\wsl.exe"", ""*\\schtasks.exe"", ""*\\certutil.exe"", ""*\\whoami.exe"", ""*\\bitsadmin.exe"")"
"New ActiveScriptEventConsumer Created Via Wmic.EXE","Florian Roth (Nextron Systems)","Detects WMIC executions in which an event consumer gets created. This could be used to establish persistence","attack.persistence, attack.t1546.003","process_creation","windows","Not classified","Check the parent process of the WMIC execution to determine if it is a legitimate system process or a suspicious one 
Review the command line arguments of the WMIC execution to understand the context of creating the event consumer 
Correlate the event with other security events to determine if it is part of a larger attack pattern 
Investigate the history of the system to identify any patterns of similar activity that could indicate a false positive","Legitimate system administration tasks using WMIC to create event consumers 
Installation or update processes of certain software may trigger this detection 
Scheduled tasks or scripts that create event consumers as part of normal operations","CommandLine=""*ActiveScriptEventConsumer*"" CommandLine=""* CREATE *"""
"Potential Windows Defender Tampering Via Wmic.EXE","frack113","Detects potential tampering with Windows Defender settings such as adding exclusion using wmic","attack.credential_access, attack.t1546.008","process_creation","windows","Not classified","Review the command-line arguments of the WMIC process to determine the specific action taken 
Check for any legitimate system administration tasks that may involve WMIC and Windows Defender 
Correlate the event with other security logs to identify any suspicious patterns or behaviors 
Verify the integrity of the system and Windows Defender settings to ensure no unauthorized changes","Legitimate use of WMIC for system administration tasks 
Third-party security software interacting with Windows Defender 
Updates or changes to Windows Defender settings by authorized users 
Scripting or automation tools that interact with Windows Defender","OriginalFileName=""wmic.exe"" OR Image=""*\\WMIC.exe"" CommandLine=""*/Namespace:\\\\root\\Microsoft\\Windows\\Defender*"""
"Suspicious WMIC Execution Via Office Process","Vadim Khrykov, Cyb3rEng","Office application called wmic to proxye execution through a LOLBIN process. This is often used to break suspicious parent-child chain (Office app spawns LOLBin).","attack.t1204.002, attack.t1047, attack.t1218.010, attack.execution, attack.defense_evasion","process_creation","windows","Not classified","Verify the legitimacy of the WMIC command and the involved processes 
Check for any authorized or scheduled tasks that may involve WMIC and LOLBIN processes 
Review the context of the Office application's interaction with system processes 
Investigate any recent changes in system configurations or software installations that could explain the observed behavior","Legitimate use of WMIC by system administrators for management tasks 
Legitimate use of LOLBIN processes by trusted applications 
Legitimate use of Office applications interacting with system processes 
False positive due to misconfiguration or benign activity","ParentImage IN (""*\\WINWORD.EXE"", ""*\\EXCEL.EXE"", ""*\\POWERPNT.exe"", ""*\\MSPUB.exe"", ""*\\VISIO.exe"", ""*\\MSACCESS.EXE"", ""*\\EQNEDT32.EXE"", ""*\\ONENOTE.EXE"", ""*\\wordpad.exe"", ""*\\wordview.exe"") Image=""*\\wbem\\WMIC.exe"" OR OriginalFileName=""wmic.exe"" CommandLine=""*process*"" CommandLine=""*create*"" CommandLine=""*call*"" CommandLine IN (""*regsvr32*"", ""*rundll32*"", ""*msiexec*"", ""*mshta*"", ""*verclsid*"", ""*wscript*"", ""*cscript*"")"
"Suspicious Process Created Via Wmic.EXE","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects WMIC executing ""process call create"" with suspicious calls to processes such as ""rundll32"", ""regsrv32"", etc.","attack.execution, attack.t1047","process_creation","windows","Not classified","Review the parent process of the WMIC execution to determine if it is initiated from a suspicious source 
Check if the WMIC command is part of a known and approved administrative script or task 
Analyze the parameters passed to the WMIC command to identify any unusual or malicious behavior 
Correlate the WMIC execution with other security events to determine the context and potential impact","Legitimate use of WMIC for system administration tasks 
Scheduled tasks or scripts that use WMIC for legitimate purposes 
Updates or installations that involve WMIC commands","CommandLine=""*process *"" CommandLine=""*call *"" CommandLine=""*create *"" CommandLine IN (""*rundll32*"", ""*bitsadmin*"", ""*regsvr32*"", ""*cmd.exe /c *"", ""*cmd.exe /k *"", ""*cmd.exe /r *"", ""*cmd /c *"", ""*cmd /k *"", ""*cmd /r *"", ""*powershell*"", ""*pwsh*"", ""*certutil*"", ""*cscript*"", ""*wscript*"", ""*mshta*"", ""*\\Users\\Public\\*"", ""*\\Windows\\Temp\\*"", ""*\\AppData\\Local\\*"", ""*%temp%*"", ""*%tmp%*"", ""*%ProgramData%*"", ""*%appdata%*"", ""*%comspec%*"", ""*%localappdata%*"")"
"Potential Tampering With Security Products Via WMIC","Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)","Detects uninstallation or termination of security products using the WMIC utility","attack.defense_evasion, attack.t1562.001","process_creation","windows","Not classified","Check if the WMIC commands were executed by authorized administrators 
Review system logs for any scheduled tasks or scripts that may have triggered the WMIC commands 
Verify if there were any recent software updates or installations that could have caused security product changes 
Investigate if there are any known issues or conflicts with the security products that could result in termination","Legitimate administration tasks may involve uninstalling or terminating security products 
Software updates or upgrades may trigger security product uninstallation 
Security product malfunction or conflicts with other software may lead to termination","(CommandLine=""*wmic*"" CommandLine=""*product where *"" CommandLine=""*call*"" CommandLine=""*uninstall*"" CommandLine=""*/nointeractive*"") OR (CommandLine=""*wmic*"" CommandLine=""*caption like *"" CommandLine IN (""*call delete*"", ""*call terminate*"")) OR (CommandLine=""*process *"" CommandLine=""*where *"" CommandLine=""*delete*"") CommandLine IN (""*%carbon%*"", ""*%cylance%*"", ""*%endpoint%*"", ""*%eset%*"", ""*%malware%*"", ""*%Sophos%*"", ""*%symantec%*"", ""*Antivirus*"", ""*AVG *"", ""*Carbon Black*"", ""*CarbonBlack*"", ""*Cb Defense Sensor 64-bit*"", ""*Crowdstrike Sensor*"", ""*Cylance *"", ""*Dell Threat Defense*"", ""*DLP Endpoint*"", ""*Endpoint Detection*"", ""*Endpoint Protection*"", ""*Endpoint Security*"", ""*Endpoint Sensor*"", ""*ESET File Security*"", ""*LogRhythm System Monitor Service*"", ""*Malwarebytes*"", ""*McAfee Agent*"", ""*Microsoft Security Client*"", ""*Sophos Anti-Virus*"", ""*Sophos AutoUpdate*"", ""*Sophos Credential Store*"", ""*Sophos Management Console*"", ""*Sophos Management Database*"", ""*Sophos Management Server*"", ""*Sophos Remote Management System*"", ""*Sophos Update Manager*"", ""*Threat Protection*"", ""*VirusScan*"", ""*Webroot SecureAnywhere*"", ""*Windows Defender*"")"
"Suspicious WmiPrvSE Child Process","Vadim Khrykov (ThreatIntel), Cyb3rEng, Florian Roth (Nextron Systems)","Detects suspicious and uncommon child processes of WmiPrvSE","attack.execution, attack.defense_evasion, attack.t1047, attack.t1204.002, attack.t1218.010","process_creation","windows","Not classified","Review the command-line arguments of the child processes to determine their intent 
Check the reputation of the processes and their associated files 
Correlate with other security events to identify any malicious behavior 
Investigate the parent-child process relationship to understand the context of the activity","Legitimate administrative or monitoring tools launching child processes 
Scripting or automation tools commonly used in the environment 
Updates or installations triggered by legitimate processes","ParentImage=""*\\wbem\\WmiPrvSE.exe"" Image IN (""*\\certutil.exe"", ""*\\cscript.exe"", ""*\\mshta.exe"", ""*\\msiexec.exe"", ""*\\regsvr32.exe"", ""*\\rundll32.exe"", ""*\\verclsid.exe"", ""*\\wscript.exe"") OR (Image=""*\\cmd.exe"" CommandLine IN (""*cscript*"", ""*mshta*"", ""*powershell*"", ""*pwsh*"", ""*regsvr32*"", ""*rundll32*"", ""*wscript*"")) NOT (Image=""*\\WerFault.exe"" OR Image=""*\\WmiPrvSE.exe"" OR (Image=""*\\msiexec.exe"" CommandLine=""*/i *""))"
"WMI Backdoor Exchange Transport Agent","Florian Roth (Nextron Systems)","Detects a WMI backdoor in Exchange Transport Agents via WMI event filters","attack.persistence, attack.t1546.003","process_creation","windows","Not classified","Review the process creation logs for EdgeTransport.exe and associated parent processes 
Check for any legitimate activities involving conhost.exe and OleConverter.exe 
Correlate the WMI event filters with authorized changes or configurations in Exchange Server 
Investigate any recent changes in Exchange Server environment that could explain the WMI activity","Legitimate WMI activity related to Exchange Transport Agents 
Scheduled tasks or legitimate scripts triggering WMI events 
Updates or installations of Exchange Server components 
Third-party applications interacting with Exchange Server","ParentImage=""*\\EdgeTransport.exe"" NOT (Image=""C:\\Windows\\System32\\conhost.exe"" OR (Image=""C:\\Program Files\\Microsoft\\Exchange Server\\*"" Image=""*\\Bin\\OleConverter.exe""))"
"UEFI Persistence Via Wpbbin - ProcessCreation","Nasreddine Bencherchali (Nextron Systems)","Detects execution of the binary ""wpbbin"" which is used as part of the UEFI based persistence method described in the reference section","attack.persistence, attack.defense_evasion, attack.t1542.001","process_creation","windows","Not classified","Check the digital signature of the wpbbin binary to verify its authenticity 
Review the command-line arguments and parameters used when wpbbin was executed 
Analyze the parent process of wpbbin to understand the context of its execution 
Correlate wpbbin execution with other security events or logs for additional context","Legitimate usage of wpbbin by system administrators for authorized tasks 
Legitimate software utilizing wpbbin for specific functionalities 
Updates or patches from trusted sources that involve wpbbin execution","Image=""C:\\Windows\\System32\\wpbbin.exe"""
"Proxy Execution Via Wuauclt.EXE","Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), Florian Roth (Nextron Systems), Sreeman, FPT.EagleEye Team","Detects the use of the Windows Update Client binary (wuauclt.exe) for proxy execution.","attack.defense_evasion, attack.t1218, attack.execution","process_creation","windows","Not classified","Review the command-line arguments of the process creation event to understand the context of wuauclt.exe execution 
Check for any scheduled tasks or scripts that may be using wuauclt.exe 
Verify if the wuauclt.exe execution is part of a known software installation or update process 
Correlate the wuauclt.exe execution with other security events to determine if it is part of a malicious activity","Legitimate use of wuauclt.exe for Windows Update operations 
Software installations that involve wuauclt.exe 
Scheduled tasks or scripts leveraging wuauclt.exe 
Updates initiated by legitimate applications using wuauclt.exe","Image=""*\\wuauclt.exe"" OR OriginalFileName=""wuauclt.exe"" CommandLine=""*UpdateDeploymentProvider*"" CommandLine=""*RunHandlerComServer*"" NOT (CommandLine=""* /UpdateDeploymentProvider UpdateDeploymentProvider.dll *"" OR CommandLine=""* wuaueng.dll *"" OR CommandLine IN (""*:\\Windows\\UUS\\Packages\\Preview\\amd64\\updatedeploy.dll /ClassId*"", ""*:\\Windows\\UUS\\amd64\\UpdateDeploy.dll /ClassId*"") OR (CommandLine=""*:\\Windows\\WinSxS\\*"" CommandLine=""*\\UpdateDeploy.dll /ClassId *""))"
"Suspicious Windows Update Agent Empty Cmdline","Florian Roth (Nextron Systems)","Detects suspicious Windows Update Agent activity in which a wuauclt.exe process command line doesn't contain any command line flags
","attack.defense_evasion, attack.t1036","process_creation","windows","Not classified","Review the parent process of wuauclt.exe to understand the context in which it was spawned 
Check if the system was undergoing a Windows Update at the time of the wuauclt.exe execution 
Analyze the network connections or file modifications associated with the wuauclt.exe process to determine if any malicious activity occurred 
Correlate the event with other security logs to identify any related suspicious behavior or indicators of compromise","Legitimate use of wuauclt.exe without command line flags during normal Windows Update operations 
Scripted or automated processes that may legitimately use wuauclt.exe without additional command line flags 
Custom applications or tools that interact with the Windows Update Agent and do not require additional command line parameters 
Instances where the lack of command line flags is part of normal system behavior","Image=""*\\Wuauclt.exe"" OR OriginalFileName=""Wuauclt.exe"" CommandLine IN (""*Wuauclt"", ""*Wuauclt.exe"")"
"Wusa.EXE Extracting Cab Files From Suspicious Paths","Nasreddine Bencherchali (Nextron Systems)","Detects usage of the ""wusa.exe"" (Windows Update Standalone Installer) utility to extract cab using the ""/extract"" argument from suspicious paths","attack.execution","process_creation","windows","Not classified","Review the command-line arguments of the wusa.exe process to determine the source and destination paths of the extracted cab files 
Check the parent process of wusa.exe to understand the context in which the extraction is occurring 
Correlate the wusa.exe activity with other security events or logs to identify any associated suspicious behavior or indicators of compromise 
Verify the integrity of the extracted cab files and compare them against known good files to rule out false positives","Legitimate use of wusa.exe for extracting cab files from system directories during Windows updates 
Administrative tasks or software installations that involve extracting cab files 
Scripted or automated processes that use wusa.exe for legitimate purposes","Image=""*\\wusa.exe"" CommandLine=""*/extract:*"" CommandLine IN (""*:\\PerfLogs\\*"", ""*:\\Users\\Public\\*"", ""*:\\Windows\\Temp\\*"", ""*\\Appdata\\Local\\Temp\\*"")"
"Sysmon Configuration Error","frack113","Detects when an adversary is trying to hide it's action from Sysmon logging based on error messages","attack.defense_evasion, attack.t1564","sysmon_error","windows","Not classified","Verify if the error message is triggered by a known administrative action 
Check if any software updates or installations occurred around the time of the error 
Review recent configuration changes made by authorized users 
Correlate the error message with other security events to determine the context","Legitimate administrative actions may trigger similar error messages 
Software updates or installations may also cause similar errors 
Configuration changes by authorized users can lead to these error messages","Description IN (""*Failed to open service configuration with error*"", ""*Failed to connect to the driver to update configuration*"") NOT ((Description=""*Failed to open service configuration with error*"" Description=""*Last error: The media is write protected.*"") OR Description IN (""*Failed to open service configuration with error 19*"", ""*Failed to open service configuration with error 93*""))"
"Sysmon Configuration Modification","frack113","Detects when an attacker tries to hide from Sysmon by disabling or stopping it","attack.defense_evasion, attack.t1564","sysmon_status","windows","Not classified","Check for any scheduled tasks or scripts that may have stopped Sysmon 
Review Sysmon configuration changes made by authorized personnel 
Investigate recent updates or changes to Sysmon that could have triggered the detection 
Analyze interactions of third-party security tools with Sysmon for any unexpected behavior","Scheduled maintenance tasks may stop Sysmon temporarily 
Sysmon updates or reconfigurations may trigger this detection 
Third-party security tools interacting with Sysmon may cause false positives","State=""Stopped"" OR ""Sysmon config state changed"" NOT State=""Started"""
"Suspicious Encoded Scripts in a WMI Consumer","Florian Roth (Nextron Systems)","Detects suspicious encoded payloads in WMI Event Consumers","attack.execution, attack.t1047, attack.persistence, attack.t1546.003","wmi_event","windows","Not classified","Review the content of the encoded payload to determine if it is related to a known legitimate script or tool 
Check if the encoded payload is part of a security tool or monitoring agent used in the environment 
Consult with system administrators to validate the purpose of the encoded payload","Legitimate scripts or tools using encoded payloads in WMI Event Consumers 
Encoded payloads related to security tools or monitoring agents 
Encoded payloads used by system administrators for legitimate purposes"
